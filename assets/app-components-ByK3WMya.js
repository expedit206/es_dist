import{r as g,u as oe,d as ee,a as de,w as ue,o as ie,b as xe,c as o,e as C,f as z,g as t,h as e,i as N,j as Q,k as w,t as p,l as fe,m as $e,n as Ce,F as W,p as K,q as ce,s as X,v as O,x as G,y as Ue,z as De,T as he,A as ae,B as ge,C as we,D as He,E as Ee,G as Xe,H as Ye,I as Ge}from"./vue-DSry_axo.js";import{d as Ne}from"./pinia-CAGcqtbd.js";import{a as Fe}from"./axios-Dq7h7Pqt.js";const et=()=>{const E=window.location.hostname;return E==="localhost"||E==="127.0.0.1"?"http://localhost:8000/api/v1":"https://espacecameroun.devfack.com/api/v1"};Fe.defaults.withCredentials=!0;Fe.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";Fe.defaults.withXSRFToken=!0;const D=Fe.create({withCredentials:!0,baseURL:et(),headers:{Accept:"application/json","Content-Type":"application/json"}});D.interceptors.request.use(E=>(localStorage.getItem("auth_token"),E));const ne=Ne("auth",{state:()=>({user:null,token:localStorage.getItem("token")||null}),actions:{async login(E){const a=await D.post("/login",E);this.user=a.data.user,this.token=a.data.token,localStorage.setItem("token",this.token??""),D.defaults.headers.common.Authorization=`Bearer ${this.token}`},async register(E){const a=await D.post("/register",E);this.user=a.data.user,this.token=a.data.token,localStorage.setItem("token",this.token??""),D.defaults.headers.common.Authorization=`Bearer ${this.token}`},async checkAuth(){if(!this.token)return!1;try{D.defaults.headers.common.Authorization=`Bearer ${this.token}`;const E=await D.get("/user");return this.user=E.data.user,!0}catch{return this.user=null,this.token=null,localStorage.removeItem("token"),!1}},async logout(){try{this.token&&(D.defaults.headers.common.Authorization=`Bearer ${this.token}`,await D.post("/logout"))}catch{}this.user=null,this.token=null,localStorage.removeItem("token"),delete D.defaults.headers.common.Authorization}}}),Ke="/assets/logoOrangeweb-C9Cko1mf.webp",Ie=Ne("userState",()=>{const E=g(0),a=g(0),_=oe(),f=()=>{const r=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");E.value=r.length;const m=localStorage.getItem("unread_messages");a.value=m?parseInt(m,10):0},s=r=>{localStorage.setItem("pending_collaborations",JSON.stringify(r)),E.value=r.length},u=r=>{localStorage.setItem("unread_messages",r.toString()),a.value=r},i=async r=>{var y;const m=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");m.push({produit_id:r.produit_id,prix_revente:r.prix_revente,status:"pending",created_at:new Date().toISOString()}),s(m);try{return await D.post("/collaborations",{produit_id:r.produit_id,prix_revente:r.prix_revente}),await v(),_.success("Demande de collaboration envoyée !"),!0}catch($){const b=m.filter(l=>!(l.produit_id===r.produit_id&&l.prix_revente===r.prix_revente));return s(b),_.error(((y=$.response)==null?void 0:y.data.message)||"Erreur lors de la demande de collaboration"),!1}},v=async()=>{try{const r=await D.get("/user/badges");E.value=r.data.collaborations_pending,console.log(r.data),u(r.data.unread_messages||0)}catch(r){console.error("Erreur lors de la synchronisation des badges:",r)}};return{collaborationsPending:E,unreadMessages:a,initializeState:f,addCollaboration:i,syncCollaborationsWithBackend:v,clearState:()=>{localStorage.removeItem("pending_collaborations"),localStorage.removeItem("unread_messages"),E.value=0,a.value=0},saveCollaborationsToLocalStorage:s,saveUnreadMessagesToLocalStorage:u}}),Le=Ne("product",{state:()=>({product:{},products:[],isLoading:!1,hasMore:!0,page:1,sort:"random",userId:null,relatedProperties:[]}),getters:{user:E=>ne().user},actions:{async fetchProducts(E={},a=!1){var _,f;if(!(this.isLoading||!a&&!this.hasMore)){this.isLoading=!0,a&&(this.products=[],this.page=1,this.hasMore=!0);try{const s=await D.get("/produits",{params:{...E,page:this.page,sort:this.sort}});if(console.log(s.data.data),E.per_page==="all")this.products=a?s.data:[...this.products,...s.data];else{const u=s.data.data;this.products=a?u:[...this.products,...u],this.hasMore=s.data.current_page<s.data.last_page,this.page=s.data.current_page+1}}catch(s){throw((f=(_=s.response)==null?void 0:_.data)==null?void 0:f.message)||"Erreur lors du chargement des produits"}finally{this.isLoading=!1}}},async toggleFavorite(E){var u,i;const a=ne();if(!a.user&&(await a.checkAuth(),!a.user)){console.warn("Utilisateur non connecté, redirection ou action nécessaire");return}const _=a.user;console.log(`user ${JSON.stringify(_)}`);const f=this.products.find(v=>v.id===E);let s=!1;f&&(f.is_favorited_by=!f.is_favorited_by,f.counts.favorites_count=f.is_favorited_by?f.counts.favorites_count+1:f.counts.favorites_count-1,s=!0),this.product&&this.product.id===E&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count+1:this.product.counts.favorites_count-1,s=!0);try{const v=await D.post(`/produits/${E}/favorite`),d=v.data.produit;if(s){const r=this.products.findIndex(m=>m.id===E);r!==-1&&(this.products[r]={...this.products[r],...d}),this.product&&this.product.id===E&&(this.product={...this.product,...d})}return v.data.message}catch(v){if(s){const d=this.products.find(r=>r.id===E);d&&(d.is_favorited_by=!d.is_favorited_by,d.counts.favorites_count=d.is_favorited_by?d.counts.favorites_count-1:d.counts.favorites_count+1),this.product&&this.product.id===E&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count-1:this.product.counts.favorites_count+1)}throw((i=(u=v.response)==null?void 0:u.data)==null?void 0:i.message)||"Erreur lors de la mise à jour des favoris"}},async viewProduct(E){var a,_;try{const f=await D.get(`/produits/${E}`);this.product=f.data.produit;const s=this.products.findIndex(u=>u.id===E);s!==-1?this.products[s]={...this.products[s],...this.product}:this.products.push(this.product)}catch(f){throw((_=(a=f.response)==null?void 0:a.data)==null?void 0:_.message)||"Erreur lors du chargement du produit"}},setSort(E){this.sort=E,this.page=1,this.products=[],this.hasMore=!0,this.fetchProducts({},!0)},setUserId(E){this.userId=E}}}),tt={key:0,class:"fixed top-14 right-4 z-50 flex items-center gap-2 rounded-full px-4 py-2"},st={class:"text-sm font-semibold text-[var(--espace-vert)]"},ot={class:"text-gray-800"},at=ee({__name:"SoldeUser",setup(E){de();const a=ne(),_=g(0),f=async()=>{if(a.user)try{_.value=a.user.jetons,console.log(_.value)}catch(s){console.error("Erreur lors de la récupération des jetons:",s)}};return ue(()=>a.user,()=>{f()}),ie(()=>{f()}),(s,u)=>{const i=xe("router-link");return z(a).user?(t(),o("div",tt,[u[1]||(u[1]=e("i",{class:"fas fa-coins text-[var(--espace-or)] text-lg"},null,-1)),e("span",st,[N(i,{to:"/jeton-history"},{default:Q(()=>[u[0]||(u[0]=w(" Jetons : ")),e("span",ot,p(_.value),1)]),_:1,__:[0]})])])):C("",!0)}}}),te=(E,a)=>{const _=E.__vccOpts||E;for(const[f,s]of a)_[f]=s;return _},Qe=te(at,[["__scopeId","data-v-12adcefd"]]),rt={class:"relative"},lt={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] top-0 left-0 w-full z-50 shadow-md"},nt={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},it={class:"flex items-center gap-1 sm:gap-3"},ut={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},ct=["aria-label"],dt={class:"flex items-center gap-2"},pt=["src"],vt={key:1,class:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-[var(--espace-gris)]"},mt={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},ft=ee({__name:"HeaderBar",setup(E){const a=()=>{const P=window.location.hostname;return P==="localhost"||P==="127.0.0.1"?"http://localhost:8000/storage/":"https://espacecameroun.devfack.com/storage/"},_=fe(()=>a()),f=ne(),s=Ie();de();const u=fe(()=>f.user);$e();const i=g(!1),v=g(!1),d=g(""),r=Le(),m=g(!1),y=g(null),$=g(!1),b=fe(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...u.value?[{to:"/profil",label:"Profil",icon:"fa-user-circle"},{to:"/messages",label:"Messages",icon:"fa-comment-dots",badge:s.unreadMessages},...u.value.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:s.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),l=async()=>{if(u.value)try{await s.syncCollaborationsWithBackend()}catch(P){console.error("Erreur lors du chargement des badges:",P)}},h=async()=>{if(!u.value&&f.token)try{await f.checkAuth()}catch(P){console.error("Erreur lors de la récupération de l'utilisateur:",P),f.logout()}u.value&&await l()};ue(()=>s.collaborationsPending,P=>{P>-1&&(i.value=!0,setTimeout(()=>i.value=!1,300))}),ue(()=>s.unreadMessages,P=>{P>-1&&(v.value=!0,setTimeout(()=>v.value=!1,300))});const M=async()=>{if(d.value.trim())try{await r.fetchProducts({search:d.value.trim()},!0),d.value="",m.value=!1}catch(P){console.error("Erreur lors de la recherche:",P)}},J=P=>{if($.value){$.value=!1;return}y.value&&!y.value.contains(P.target)&&(m.value=!1)},j=async()=>{m.value=!m.value,m.value&&($.value=!0,await De())};return ie(async()=>{var P;await h(),document.addEventListener("click",J),(P=f.user)!=null&&P.id&&window.Echo.channel(`chat.${f.user.id}`).listen("MessageSent",x=>{var R;console.log("📩 header e reçu :",x.message),((R=f.user)==null?void 0:R.id)===x.receiver_id&&(console.log("📩 header e reçu :",x.message),s.saveUnreadMessagesToLocalStorage(x.unread_messages))})}),Ce(()=>{var P;document.removeEventListener("click",J),(P=f.user)!=null&&P.id&&window.Echo.leave(`chat.${f.user.id}`)}),(P,x)=>{const R=xe("RouterLink");return t(),o("div",rt,[e("header",lt,[e("div",nt,[e("div",it,[N(R,{to:"/","aria-label":"Retour à l'accueil"},{default:Q(()=>x[2]||(x[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Ke,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),x[3]||(x[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ",-1))]),e("nav",ut,[(t(!0),o(W,null,K(b.value,L=>(t(),ce(R,{key:L.to,to:L.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:Q(()=>[e("i",{class:X(["fas",L.icon])},null,2),w(" "+p(L.label)+" ",1),L!=null&&L.badge&&L.badge>-1?(t(),o("span",{key:0,class:X(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":L.to==="/collaborations"&&i.value||L.to==="/messages"&&v.value}]),"aria-label":L.to==="/collaborations"?"Collaborations en attente":L.to==="/messages"?"Messages non lus":""},p(L.badge),11,ct)):C("",!0)]),_:2},1032,["to"]))),128))]),N(Qe),e("div",dt,[u.value?(t(),o("button",{key:0,onClick:j,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},x[4]||(x[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)]))):C("",!0),u.value?(t(),ce(R,{key:1,to:"/profil",class:"relative flex items-center justify-center","aria-label":"Profil"},{default:Q(()=>{var L;return[(L=u.value)!=null&&L.photo?(t(),o("img",{key:0,src:_.value+u.value.photo,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,pt)):(t(),o("div",vt,x[5]||(x[5]=[e("i",{class:"fas fa-user-circle text-2xl text-gray-500"},null,-1)])))]}),_:1})):C("",!0),u.value?(t(),ce(R,{key:2,to:"/messages",class:"relative flex items-center justify-center","aria-label":"Messages"},{default:Q(()=>[x[6]||(x[6]=e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},[e("i",{class:"fas fa-comment-dots text-2xl text-white"})],-1)),z(s).unreadMessages>-1?(t(),o("span",{key:0,class:X(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":v.value}]),"aria-label":"Messages non lus"},p(z(s).unreadMessages),3)):C("",!0)]),_:1,__:[6]})):C("",!0)])]),m.value?(t(),o("div",{key:0,ref_key:"searchOverlayRef",ref:y,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",mt,[O(e("input",{"onUpdate:modelValue":x[0]||(x[0]=L=>d.value=L),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Ue(M,["enter"])},null,544),[[G,d.value]]),e("button",{onClick:M,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},x[7]||(x[7]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:x[1]||(x[1]=L=>m.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},x[8]||(x[8]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):C("",!0)])])}}}),du=te(ft,[["__scopeId","data-v-b3e6f7d4"]]),gt={class:"relative"},xt={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},bt={class:"flex justify-around items-center py-2"},ht=["aria-label"],yt=ee({__name:"FooterBar",setup(E){const a=ne(),_=Ie();de();const f=g(!1),s=g(!1),u=fe(()=>[...a.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle"},...a.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open"}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:_.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users"}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt"},{to:"/register",label:"Inscription",icon:"fa-user-plus"}]]);return ue(()=>_.collaborationsPending,i=>{i>0&&(f.value=!0,setTimeout(()=>f.value=!1,300))}),ue(()=>_.unreadMessages,i=>{i>0&&(s.value=!0,setTimeout(()=>s.value=!1,300))}),(i,v)=>{const d=xe("RouterLink");return t(),o("div",gt,[N(he,{name:"slide-up"},{default:Q(()=>[e("nav",xt,[e("div",bt,[(t(!0),o(W,null,K(u.value,r=>(t(),ce(d,{key:r.to,to:r.to,"aria-label":r.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:Q(()=>[e("i",{class:X(["fas text-lg",r.icon])},null,2),r!=null&&r.badge&&r.badge>-1?(t(),o("span",{key:0,class:X(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":r.to==="/collaborations"&&f.value||r.to==="/messages"&&s.value}]),"aria-label":r.to==="/collaborations"?"Collaborations en attente":r.to==="/messages"?"Messages non lus":""},p(r.badge),11,ht)):C("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),pu=te(yt,[["__scopeId","data-v-631325d2"]]),_t={class:"mb-4"},wt={class:"block text-sm sm:text-base font-medium mb-1 text-[var(--espace-gris)]"},kt={class:"relative"},$t={class:"absolute inset-y-0 left-3 flex items-center text-[var(--espace-or)]"},Ct=["type","value","required","placeholder"],At={key:0,class:"text-red-500 text-sm mt-1"},ve=ee({__name:"Form",props:{label:String,icon:String,type:{type:String,default:"text"},modelValue:[String,Number],required:Boolean,placeholder:String,error:String},emits:["update:modelValue"],setup(E){return(a,_)=>(t(),o("div",_t,[e("label",wt,p(E.label),1),e("div",kt,[e("span",$t,[e("i",{class:X(`fas ${E.icon}`)},null,2)]),e("input",{type:E.type,value:E.modelValue,onInput:_[0]||(_[0]=f=>a.$emit("update:modelValue",f.target.value)),required:E.required,placeholder:E.placeholder,class:X(["w-full pl-10 pr-4 py-3 rounded-xl border text-sm sm:text-base transition","focus:outline-none focus:ring-2",E.error?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-[var(--espace-or)]"])},null,42,Ct)]),E.error?(t(),o("p",At,p(E.error),1)):C("",!0)]))}}),Pt={class:"overflow-y-scroll flex items-center justify-center px-4 py-4"},St={class:"w-full max-w-lg bg-gray-30 rounded-2xl shadow-xl p-6 sm:p-10"},jt={class:"text-center text-sm text-gray-600 mt-6"},Vt=ee({__name:"Login",setup(E){const a=g({login:"",mot_de_passe:""}),_=g({}),f=de(),s=oe(),u=ne(),i=async()=>{var v;try{await u.login({login:a.value.login,mot_de_passe:a.value.mot_de_passe}),s.success("Connexion réussie !"),f.push({name:"home"})}catch(d){console.error("Erreur lors de la connexion:",d);const r=d.message||"Erreur lors de la connexion. Veuillez vérifier vos informations.";s.error(r),((v=d.response)==null?void 0:v.status)===422&&(_.value=d.response.data.errors||{})}};return(v,d)=>{const r=xe("router-link");return t(),o("div",Pt,[e("div",St,[d[5]||(d[5]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-sign-in-alt mr-2 text-[var(--espace-or)]"}),w(" Connexion ")],-1)),d[6]||(d[6]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[w(" Connectez-vous à "),e("strong",null,"Espace Cameroun"),w(" pour accéder à vos achats et votre espace commerçant. ")],-1)),e("form",{onSubmit:ae(i,["prevent"]),class:"space-y-5"},[N(ve,{label:"Email ou Téléphone",icon:"fa-envelope",modelValue:a.value.login,"onUpdate:modelValue":d[0]||(d[0]=m=>a.value.login=m),type:"text",required:"",error:_.value.login},null,8,["modelValue","error"]),N(ve,{label:"Mot de passe",icon:"fa-lock",modelValue:a.value.mot_de_passe,"onUpdate:modelValue":d[1]||(d[1]=m=>a.value.mot_de_passe=m),type:"password",required:"",error:_.value.mot_de_passe},null,8,["modelValue","error"]),d[2]||(d[2]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-sign-in-alt mr-2"}),w(" Se connecter ")],-1))],32),e("p",jt,[d[4]||(d[4]=w(" Pas de compte ? ")),N(r,{to:"/register",class:"text-[var(--espace-vert)] font-medium hover:text-[var(--espace-or)] hover:underline"},{default:Q(()=>d[3]||(d[3]=[w(" Inscrivez-vous ici ")])),_:1,__:[3]})])])])}}}),vu=te(Vt,[["__scopeId","data-v-ef8fc6b4"]]),Mt="/assets/logo-ba4eAQQi.png",zt={key:0,class:"fixed inset-0 bg-[var(--espace-white)] bg-opacity-50 flex items-center justify-center z-50","aria-label":"Chargement en cours",role:"status"},Et=ee({__name:"Loader",props:{isLoading:{type:Boolean}},setup(E){return(a,_)=>(t(),ce(he,{name:"fade"},{default:Q(()=>[a.isLoading?(t(),o("div",zt,_[0]||(_[0]=[e("div",{class:"relative p-6"},[e("img",{src:Mt,alt:"Logo Espace Cameroun",class:"h-12 w-12 object-contain animate-spin-pulse"}),e("div",{class:"absolute inset-0 rounded-full border-4 border-[var(--espace-or)] border-t-transparent animate-spin"})],-1)]))):C("",!0)]),_:1}))}}),Ae=te(Et,[["__scopeId","data-v-f60cc94a"]]),It={class:"h-full bg-gray-100 pt-5 px-4 sm:px-2"},Lt={class:"h-full w-full overflow-y-scroll"},Ft={key:0},Tt={key:1,class:"grid grid-cols-1 pt-4 pb-2 lg:pb-12 md:grid-cols-3 sm:grid-cols-2 lg:grid-cols-4 gap-6"},Rt={class:"relative w-full h-40 overflow-hidden rounded-t-lg mb-2"},Ut={key:0,class:"absolute z-12 top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Dt=["src"],Nt=["onClick"],Ot=["onClick"],qt={key:3,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Jt={class:"p-2"},Wt={class:"text-lg font-semibold flex justify-between text-[var(--espace-vert)] truncate"},Bt=["onClick"],Ht={class:"text-sm text-[var(--espace-gris)] line-clamp-2"},Xt={class:"text-md font-bold text-[var(--espace-or)] mt-2"},Gt={class:"text-sm text-[var(--espace-gris)]"},Kt={class:"text-sm text-[var(--espace-gris)] mt-2"},Qt={class:"ml-4"},Zt={key:2,class:"text-center text-[var(--espace-gris)]"},Yt={class:"bg-white rounded-lg p-6 sm:p-8 w-full max-w-md mx-4 shadow-lg"},es={class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},ts={class:"mt-2 p-4 bg-gray-50 rounded-lg border border-gray-200"},ss={key:0,class:"grid grid-cols-3 gap-2 mb-2"},os=["src"],as=["onClick"],rs=["value"],ls={key:0,class:"flex items-center gap-2"},ns={class:"flex gap-4 pt-2"},is={type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition"},us=ee({__name:"CommercantProduits",setup(E){const a=ne(),_=de(),f=oe(),s=g(!1),u=g([]),i=g([]),v=g(!1),d=g(!1),r=g(null),m=g({}),y=g({nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0}),$=g([]),b=g([]),l=g(null),h=async()=>{s.value=!0;try{const S=await D.get("/commercant/produits");u.value=S.data.produits.map(n=>({...n,photo_url:n.photos&&n.photos.length>0?n.photos[0]:"https://via.placeholder.com/150"})),console.log(S.data),u.value.forEach(n=>{m.value[n.id]||(m.value[n.id]=0)})}catch{f.error("Erreur lors du chargement des produits")}finally{s.value=!1}},M=async()=>{s.value=!0;try{const S=await D.get("/categories");i.value=S.data.categories}catch{f.error("Erreur lors de la chargement des catégories")}finally{s.value=!1}},J=()=>{y.value={nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0},$.value=[],b.value=[],v.value=!0},j=S=>{r.value=S,y.value={nom:S.nom,description:S.description||"",prix:S.prix,stock:S.quantite,category_id:S.category_id,collaboratif:!!S.collaboratif,marge_min:S.marge_min||0},$.value=[],b.value=S.photos||[],m.value[S.id]||(m.value[S.id]=0),d.value=!0},P=S=>{const n=S.target;if(n.files){const c=Array.from(n.files);$.value=[...$.value,...c],b.value=[...b.value,...c.map(A=>URL.createObjectURL(A))],l.value&&(l.value.value="")}},x=S=>{$.value.splice(S,1),b.value.splice(S,1)},R=async()=>{var n,c;s.value=!0;const S=new FormData;S.append("nom",y.value.nom),S.append("description",y.value.description),S.append("prix",y.value.prix.toString()),S.append("stock",y.value.stock.toString()),S.append("category_id",y.value.category_id),S.append("collaboratif",y.value.collaboratif?"1":"0"),S.append("marge_min",y.value.marge_min.toString()),$.value.forEach(A=>S.append("photos[]",A));for(let[A,I]of S.entries())console.log(`${A}:`,I);try{if(v.value){const A=await D.post("/commercant/produits",S,{headers:{"Content-Type":"multipart/form-data"}});console.log(A.data),f.success("Produit ajouté avec succès")}else{const A=await D.post(`/commercant/produits/${(n=r.value)==null?void 0:n.id}`,S,{headers:{"Content-Type":"multipart/form-data"}});f.success("Produit modifié avec succès")}await h(),L()}catch(A){f.error(((c=A.response)==null?void 0:c.data.message)||"Erreur lors de la sauvegarde du produit")}finally{s.value=!1}},L=()=>{v.value=!1,d.value=!1,r.value=null,$.value=[],b.value=[]},F=fe(()=>S=>m.value[S]||0),se=S=>{var A;const n=u.value.find(I=>I.id===S),c=(A=n==null?void 0:n.photos)!=null&&A.length?n.photos.length-1:0;m.value[S]=Math.min((m.value[S]||0)+1,c)},re=S=>{m.value[S]=Math.max((m.value[S]||0)-1,0)};return ie(()=>{var S;if(!((S=a.user)!=null&&S.commercant)){f.error("Accès réservé aux commerçants"),_.push("/");return}h(),M()}),(S,n)=>{const c=xe("router-link");return t(),o(W,null,[N(Ae,{isLoading:s.value},null,8,["isLoading"]),e("div",It,[e("div",Lt,[e("div",{class:"flex justify-between items-center"},[n[9]||(n[9]=e("h1",{class:"text-1xl md:text-2xl font-bold text-[var(--espace-vert)] text-md mb-2 font-poppins"},[e("i",{class:"fas fa-box-open mr-1 text-[var(--espace-or)] text-md!important"}),w(" Mes Produits ")],-1)),e("button",{onClick:J,class:"mb-2 md:text-xl text-[var(--espace-vert)] font-semibold px-2 py-1 rounded hover:bg-[var(--espace-vert)] hover:text-white transition inline-flex items-center"},n[8]||(n[8]=[e("i",{class:"fas fa-plus mr-2"},null,-1),w(" Ajouter un produit ")]))]),s.value?(t(),o("div",Ft,n[10]||(n[10]=[e("div",{class:"flex items-center justify-center py-10"},[e("i",{class:"fas fa-spinner animate-spin text-2xl text-[var(--espace-vert)]"})],-1)]))):u.value.length?(t(),o("div",Tt,[(t(!0),o(W,null,K(u.value,A=>(t(),o("div",{key:A.id,class:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition relative"},[e("div",Rt,[A.collaboratif?(t(),o("span",Ut," Collaboratif ")):C("",!0),N(c,{to:`/produits/${A.id}`,class:"block relative"},{default:Q(()=>[e("div",{class:"flex w-full h-full slider-container",style:ge({transform:`translateX(-${F.value(A.id)*100}%)`})},[(t(!0),o(W,null,K(A.photos,(I,B)=>(t(),o("img",{key:B,src:I,class:"h-40 object-contain flex-shrink-0 mx-auto w-full",alt:"Photo du produit"},null,8,Dt))),128))],4)]),_:2},1032,["to"]),A.photos&&A.photos.length>1?(t(),o("button",{key:1,onClick:I=>re(A.id),class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},n[11]||(n[11]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,Nt)):C("",!0),A.photos&&A.photos.length>1?(t(),o("button",{key:2,onClick:I=>se(A.id),class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},n[12]||(n[12]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,Ot)):C("",!0),A.photos&&A.photos.length>1?(t(),o("div",qt,[(t(!0),o(W,null,K(A.photos,(I,B)=>(t(),o("span",{key:B,class:X(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":B===F.value(A.id)}])},null,2))),128))])):C("",!0)]),e("div",Jt,[e("h2",Wt,[N(c,{to:`/produits/${A.id}`,class:"block relative"},{default:Q(()=>[w(p(A.nom),1)]),_:2},1032,["to"]),e("button",{onClick:I=>j(A),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},n[13]||(n[13]=[e("i",{class:"fas fa-pencil text-sm"},null,-1)]),8,Bt)]),e("p",Ht,p(A.description||"Aucune"),1),e("p",Xt,p(A.prix)+" FCFA",1),e("p",Gt,"Stock: "+p(A.quantite),1),e("div",Kt,[e("span",null,[n[14]||(n[14]=e("i",{class:"fas fa-eye mr-1"},null,-1)),w(" "+p(A.raw_views_count||0)+" vues",1)]),e("span",Qt,[n[15]||(n[15]=e("i",{class:"fas fa-heart mr-1"},null,-1)),w(" "+p(A.favorites_count||0)+" favoris",1)])])])]))),128))])):(t(),o("p",Zt,"Aucun produit pour le moment."))]),N(he,{name:"fade"},{default:Q(()=>{var A;return[v.value||d.value?(t(),o("div",{key:0,class:"overflow-y-scroll fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ae(L,["self"])},[e("div",Yt,[e("h2",es,p(v.value?"Ajouter un produit":"Modifier le produit"),1),e("form",{onSubmit:ae(R,["prevent"]),class:"space-y-4"},[e("div",null,[n[19]||(n[19]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Photos du produit",-1)),e("div",ts,[b.value.length?(t(),o("div",ss,[(t(!0),o(W,null,K(b.value,(I,B)=>(t(),o("div",{key:B,class:"relative w-full h-20"},[e("img",{src:I,class:"w-full h-full object-cover rounded-lg",alt:"Prévisualisation"},null,8,os),e("button",{onClick:ae(T=>x(B),["prevent"]),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs"},n[16]||(n[16]=[e("i",{class:"fas fa-times"},null,-1)]),8,as)]))),128))])):C("",!0),e("input",{ref_key:"fileInput",ref:l,type:"file",multiple:"",onChange:P,class:"hidden",accept:"image/*"},null,544),b.value.length?(t(),o("button",{key:2,onClick:n[1]||(n[1]=I=>{var B;return(B=l.value)==null?void 0:B.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},n[18]||(n[18]=[e("i",{class:"fas fa-plus mr-2"},null,-1),w(" Ajouter une autre photo ")]))):(t(),o("button",{key:1,onClick:n[0]||(n[0]=I=>{var B;return(B=l.value)==null?void 0:B.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},n[17]||(n[17]=[e("i",{class:"fas fa-camera mr-2"},null,-1),w(" Ajouter une photo ")])))])]),e("div",null,[n[20]||(n[20]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Nom",-1)),O(e("input",{"onUpdate:modelValue":n[2]||(n[2]=I=>y.value.nom=I),type:"text",required:"",class:"input-style"},null,512),[[G,y.value.nom]])]),e("div",null,[n[21]||(n[21]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Description",-1)),O(e("textarea",{"onUpdate:modelValue":n[3]||(n[3]=I=>y.value.description=I),rows:"3",class:"input-style"},null,512),[[G,y.value.description]])]),e("div",null,[n[22]||(n[22]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Prix (FCFA)",-1)),O(e("input",{"onUpdate:modelValue":n[4]||(n[4]=I=>y.value.prix=I),type:"number",min:"0",required:"",class:"input-style"},null,512),[[G,y.value.prix,void 0,{number:!0}]])]),e("div",null,[n[23]||(n[23]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Stock",-1)),O(e("input",{"onUpdate:modelValue":n[5]||(n[5]=I=>y.value.stock=I),type:"number",min:"0",required:"",class:"input-style"},null,512),[[G,y.value.stock,void 0,{number:!0}]])]),e("div",null,[n[25]||(n[25]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Catégorie",-1)),O(e("select",{"onUpdate:modelValue":n[6]||(n[6]=I=>y.value.category_id=I),required:"",class:"input-style"},[n[24]||(n[24]=e("option",{value:""},"Sélectionner une catégorie",-1)),(t(!0),o(W,null,K(i.value,I=>(t(),o("option",{key:I.id,value:I.id},p(I.nom),9,rs))),128))],512),[[we,y.value.category_id]])]),v.value||!((A=r.value)!=null&&A.collaboratif)?(t(),o("div",ls,[O(e("input",{id:"collaboratif",type:"checkbox","onUpdate:modelValue":n[7]||(n[7]=I=>y.value.collaboratif=I)},null,512),[[He,y.value.collaboratif]]),n[26]||(n[26]=e("label",{for:"collaboratif",class:"text-sm text-[var(--espace-vert)]"},"Collaboratif",-1))])):C("",!0),e("div",ns,[e("button",is,p(v.value?"Ajouter":"Modifier"),1),e("button",{type:"button",onClick:L,class:"flex-1 bg-[var(--espace-gris)] text-white font-semibold px-4 py-2 rounded hover:bg-gray-700 transition"}," Annuler ")])],32)])])):C("",!0)]}),_:1})])],64)}}}),mu=te(us,[["__scopeId","data-v-05d3d6ce"]]),cs={class:"overflow-y-scroll bg-white flex justify-center px-4 pt-8"},ds={class:"flex flex-col w-full max-w-lg rounded-2xl sm:p-10"},ps={class:"text-center text-sm text-gray-600 mt-6"},vs=ee({__name:"Register",setup(E){const a=g({nom:"",telephone:"",email:"",ville:"",mot_de_passe:"",parrain_code:""}),_=g({}),f=de(),s=$e(),u=oe(),i=ne();ie(()=>{const d=s.params.code;d&&(a.value.parrain_code=d)});const v=async()=>{var d,r,m;try{console.log("Envoi des données d'inscription:",a.value),await i.register(a.value),u.success("Inscription réussie !"),f.push({name:"home"})}catch(y){console.error("Erreur lors de l'inscription:",y);const $=((r=(d=y.response)==null?void 0:d.data)==null?void 0:r.message)||"Erreur lors de l'inscription. Veuillez vérifier vos informations.";u.error($),((m=y.response)==null?void 0:m.status)===422&&(_.value=y.response.data.errors)}};return(d,r)=>{const m=xe("router-link");return t(),o("div",cs,[e("div",ds,[r[9]||(r[9]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-user-plus mr-2 text-[var(--espace-or)]"}),w(" Créez votre compte ")],-1)),r[10]||(r[10]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[w(" Rejoignez "),e("strong",null,"Espace Cameroun"),w(" et profitez d’une expérience d’achat unique. Vos informations resteront confidentielles. ")],-1)),e("form",{onSubmit:ae(v,["prevent"]),class:"space-y-5"},[N(ve,{label:"Nom",icon:"fa-user",modelValue:a.value.nom,"onUpdate:modelValue":r[0]||(r[0]=y=>a.value.nom=y),type:"text",required:"",error:_.value.nom},null,8,["modelValue","error"]),N(ve,{label:"Téléphone",icon:"fa-phone",modelValue:a.value.telephone,"onUpdate:modelValue":r[1]||(r[1]=y=>a.value.telephone=y),type:"tel",required:"",error:_.value.telephone},null,8,["modelValue","error"]),N(ve,{label:"Email (optionnel)",icon:"fa-envelope",modelValue:a.value.email,"onUpdate:modelValue":r[2]||(r[2]=y=>a.value.email=y),type:"email",error:_.value.email},null,8,["modelValue","error"]),N(ve,{label:"Ville",icon:"fa-city",modelValue:a.value.ville,"onUpdate:modelValue":r[3]||(r[3]=y=>a.value.ville=y),type:"text",required:"",error:_.value.ville},null,8,["modelValue","error"]),N(ve,{label:"Mot de passe",icon:"fa-lock",modelValue:a.value.mot_de_passe,"onUpdate:modelValue":r[4]||(r[4]=y=>a.value.mot_de_passe=y),type:"password",required:"",error:_.value.mot_de_passe},null,8,["modelValue","error"]),N(ve,{label:"Code de parrainage (optionnel)",icon:"fa-users",modelValue:a.value.parrain_code,"onUpdate:modelValue":r[5]||(r[5]=y=>a.value.parrain_code=y),type:"text",error:_.value.parrain_code},null,8,["modelValue","error"]),r[6]||(r[6]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-user-plus mr-2"}),w(" S'inscrire ")],-1))],32),e("p",ps,[r[8]||(r[8]=w(" Vous avez déjà un compte ? ")),N(m,{to:"/login",class:"text-[var(--espace-vert)] font-medium hover:underline"},{default:Q(()=>r[7]||(r[7]=[w(" Connectez-vous ici ")])),_:1,__:[7]})]),r[11]||(r[11]=e("p",{class:"text-center text-xs text-gray-400 mt-2 pb-24"},[w(" En vous inscrivant, vous acceptez nos "),e("a",{href:"/conditions",class:"hover:underline text-[var(--espace-vert)]"},"conditions d'utilisation"),w(" et notre "),e("a",{href:"/confidentialite",class:"hover:underline text-[var(--espace-vert)]"},"politique de confidentialité"),w(". ")],-1))])])}}}),fu=te(vs,[["__scopeId","data-v-a656ecac"]]),ms={key:0,class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-4"},fs={class:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-y-auto animate-fade-in max-h-[90vh]"},gs={class:"p-6"},xs={key:0,class:"grid md:grid-cols-3 gap-6"},bs={key:1,class:"flex flex-col md:flex-row max-w-3xl mx-auto p-8 bg-white rounded-xl shadow-lg"},hs={class:"md:w-1/3 mb-6 md:mb-0 pr-6 border-r border-gray-200"},ys={class:"font-extrabold text-lg mb-2"},_s={class:"mb-2 text-sm opacity-90"},ws={class:"text-3xl font-extrabold"},ks={class:"flex flex-col text-sm font-medium text-gray-700"},$s={key:0,class:"text-xs text-red-600 mt-1"},Cs={class:"flex gap-4"},As=["value"],Ps=["src"],Ss={key:0,class:"text-xs text-red-600 mt-1 block"},js=["disabled"],Vs={class:"text-xs text-gray-400 mt-4 text-center"},Ms=ee({__name:"SubscriptionModal",props:{isOpen:{type:Boolean}},emits:["close","upgraded"],setup(E,{emit:a}){const _=a,f=oe(),s=g(""),u=g(""),i=g(""),v=g(!1),d=g(!1),r=g(!1),m=b=>{s.value=b,v.value=!1,d.value=!1,u.value="",i.value=""},y=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],$=async()=>{if(v.value=!i.value,d.value=!u.value,v.value||d.value){f.error("Veuillez remplir tous les champs correctement.");return}r.value=!0;try{console.log({subscription_type:s.value,payment_service:u.value,phone_number:i.value});const b=await D.post("/upgrade-to-premium",{subscription_type:s.value,payment_service:u.value,phone_number:i.value});r.value=!1,f.success(b.data.message),_("upgraded"),_("close")}catch(b){b.response&&b.response.data?(b.response.data,f.error("Paiement échoué :Verifiez vos informations et réessayer")):f.error("Verifiez vos informations et réessayer."),console.error(b)}finally{r.value=!1}};return(b,l)=>b.isOpen?(t(),o("div",ms,[e("div",fs,[l[17]||(l[17]=e("div",{class:"bg-gradient-to-r from-[var(--espace-vert)] to-[var(--espace-or)] p-6 text-center"},[e("h2",{class:"text-3xl font-bold text-white"},"🚀 Passez à Premium"),e("p",{class:"text-white/90 mt-1"}," Comparez et choisissez le plan qui boostera votre business ")],-1)),e("div",gs,[s.value?(t(),o("div",bs,[e("div",hs,[l[11]||(l[11]=e("h3",{class:"text-xl font-bold mb-4"},"Votre abonnement",-1)),e("div",{class:X([{"bg-green-600 text-white":s.value==="monthly","bg-yellow-400 text-gray-900":s.value==="yearly"},"rounded-lg p-4"])},[e("h4",ys,p(s.value==="monthly"?"Premium Mensuel":"Premium Annuel"),1),e("p",_s,p(s.value==="monthly"?"Accès complet à toutes les fonctionnalités.":"Payez moins, profitez plus avec 16% d’économie !"),1),e("div",ws,p(s.value==="monthly"?"5 000 FCFA":"50 000 FCFA"),1)],2)]),e("form",{onSubmit:ae($,["prevent"]),class:"md:w-2/3 flex flex-col gap-6",novalidate:""},[l[15]||(l[15]=e("h3",{class:"text-xl font-bold mb-2"},"Détails du paiement",-1)),e("label",ks,[l[12]||(l[12]=w(" Numéro de téléphone ")),O(e("input",{"onUpdate:modelValue":l[4]||(l[4]=h=>i.value=h),type:"tel",placeholder:"Ex: 696428651",class:X(["mt-1 rounded-lg border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",{"border-red-500":v.value}]),onInput:l[5]||(l[5]=h=>v.value=!i.value),required:""},null,34),[[G,i.value]]),v.value?(t(),o("span",$s,"Veuillez entrer un numéro valide.")):C("",!0)]),l[16]||(l[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Service de paiement ",-1)),e("div",Cs,[(t(),o(W,null,K(y,h=>e("label",{key:h.value,class:X(["flex items-center gap-2 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":u.value===h.value,"border-gray-300 bg-white":u.value!==h.value,"border-red-500":d.value&&!u.value}])},[O(e("input",{type:"radio",value:h.value,"onUpdate:modelValue":l[6]||(l[6]=M=>u.value=M),class:"hidden"},null,8,As),[[Xe,u.value]]),e("img",{src:h.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Ps),e("span",{class:X([{"text-[var(--espace-vert)]":u.value===h.value,"text-gray-700":u.value!==h.value},"font-semibold select-none"])},p(h.label),3)],2)),64))]),d.value&&!u.value?(t(),o("span",Ss," Veuillez sélectionner un service. ")):C("",!0),e("button",{type:"submit",disabled:r.value||!i.value||!u.value,class:"w-full py-3 rounded-lg bg-[var(--espace-vert)] text-white font-bold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[r.value?(t(),o(W,{key:0},[l[13]||(l[13]=e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1)),l[14]||(l[14]=w(" Veuillez patienter... "))],64)):(t(),o(W,{key:1},[w(" Payer & Souscrire ")],64))],8,js),e("button",{type:"button",onClick:l[7]||(l[7]=h=>s.value=""),class:"w-full text-center text-gray-500 hover:text-[var(--espace-vert)] transition"}," ← Retour aux plans "),e("p",Vs," 🔒 Paiement sécurisé via "+p(u.value||"votre service"),1)],32)])):(t(),o("div",xs,[l[10]||(l[10]=Ee('<div class="border border-gray-200 bg-gray-50 rounded-xl p-6 flex flex-col justify-between" data-v-7e8d0671><div data-v-7e8d0671><h3 class="text-xl font-bold text-gray-800" data-v-7e8d0671>Gratuit (Base)</h3><p class="text-sm text-gray-500 mb-4" data-v-7e8d0671>Pour débuter sans frais</p><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 10 produits max </li><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 5 collaborations max </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Pas de statistiques détaillées </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Pas de badge Premium </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Position prioritaire </li></ul></div><button disabled class="mt-6 w-full py-2 rounded-lg bg-gray-300 text-gray-600 font-semibold cursor-not-allowed" data-v-7e8d0671> Actuel </button></div>',1)),e("div",{class:"relative bg-gradient-to-br from-[var(--espace-vert)] to-green-500 rounded-xl text-white p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 scale-103 transition cursor-pointer",onClick:l[1]||(l[1]=h=>m("monthly"))},[l[8]||(l[8]=Ee('<span class="absolute top-1 right-3 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>⭐ Populaire</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Mensuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671> Accès complet à toutes les fonctionnalités </p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>5000 FCFA / mois </div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:l[0]||(l[0]=ae(h=>m("monthly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-vert)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")]),e("div",{class:"relative bg-gradient-to-br from-yellow-400 to-[var(--espace-or)] rounded-xl text-gray-900 p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 transition cursor-pointer",onClick:l[3]||(l[3]=h=>m("yearly"))},[l[9]||(l[9]=Ee('<span class="absolute top-1 right-3 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>-16% Économie</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Annuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671>Payez moins, profitez plus</p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>50 000 FCFA / an</div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:l[2]||(l[2]=ae(h=>m("yearly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-or)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")])]))])])])):C("",!0)}}),zs=te(Ms,[["__scopeId","data-v-7e8d0671"]]),Es={class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Is={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 space-y-6 animate-fade-in max-h-[90vh] overflow-auto"},Ls={class:"flex justify-center gap-3 mb-4"},Fs=["onClick"],Ts={key:0,class:"text-xs text-red-600 mt-1"},Rs={class:"flex gap-4"},Us=["value"],Ds=["src"],Ns={key:1,class:"text-xs text-red-600 mt-1"},Os={class:"text-center text-lg font-bold mt-6"},qs={class:"text-[var(--espace-vert)]"},Js=["disabled"],Ws={key:0},Bs={key:1},Hs={key:2,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Xs={class:"w-full mt-2 text-center text-gray-500 hover:text-[var(--espace-vert)] transition"},Gs=ee({__name:"AchatJetonModal",props:{isOpen:{type:Boolean}},emits:["close","purchased"],setup(E,{emit:a}){const _=a,f=oe(),s=g(10),u=g(""),i=g(""),v=g(s.value*25),d=g(!1),r=g(!1),m=g(!1),y=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],$=[10,20,50,100],b=fe(()=>s.value>=10&&u.value.trim().length===9&&/^6\d{8}$/.test(u.value)&&i.value!==""),l=()=>{v.value=s.value*25},h=P=>{s.value=P,l()},M=()=>{l()},J=()=>{m.value=!(u.value.trim().length===9&&/^6\d{8}$/.test(u.value))},j=async()=>{if(r.value=!i.value,!b.value){f.error("Veuillez remplir tous les champs correctement.");return}d.value=!0;try{const P=await D.post("/acheter-jetons",{nombre_jetons:s.value,payment_service:i.value,phone_number:u.value});console.log(P.data),f.success(P.data.message),_("purchased",s.value),_("close")}catch(P){if(P.response&&P.response.data){const x=P.response.data;f.error(`Erreur: ${x.error_message||"Achat échoué"}. Détails: ${x.details||"Aucun détail."}`)}else f.error("Erreur lors de l'achat. Veuillez réessayer.");console.error(P)}finally{d.value=!1}};return ue(u,()=>{J()}),(P,x)=>{const R=xe("router-link");return t(),o("div",Es,[e("div",Is,[x[7]||(x[7]=e("h2",{class:"text-3xl font-extrabold text-[var(--espace-vert)] text-center"}," 🎫 Acheter des Jetons ",-1)),x[8]||(x[8]=e("p",{class:"text-center text-gray-600 text-sm mb-6"},"1 jeton = 25 FCFA",-1)),e("div",Ls,[(t(),o(W,null,K($,L=>e("button",{key:L,type:"button",onClick:F=>h(L),class:X(["rounded-full px-4 py-2 border font-semibold transition",s.value===L?"bg-[var(--espace-vert)] text-white border-[var(--espace-vert)]":"bg-white text-gray-700 border-gray-300 hover:bg-[var(--espace-vert)] hover:text-white"])},p(L),11,Fs)),64))]),x[9]||(x[9]=e("label",{class:"block text-gray-700 font-semibold mb-1",for:"jetonQuantity"},[w(" Nombre de jetons "),e("span",{class:"text-sm text-gray-500"},"(min 10)")],-1)),O(e("input",{id:"jetonQuantity","onUpdate:modelValue":x[0]||(x[0]=L=>s.value=L),type:"number",min:"10",placeholder:"Ex: 10",onInput:M,class:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition"},null,544),[[G,s.value,void 0,{number:!0}]]),x[10]||(x[10]=e("label",{class:"block text-gray-700 font-semibold mb-1 mt-4",for:"phoneNumber"},[w(" Numéro de téléphone "),e("span",{class:"text-sm text-red-500"},"*")],-1)),O(e("input",{id:"phoneNumber","onUpdate:modelValue":x[1]||(x[1]=L=>u.value=L),type:"tel",placeholder:"Ex: 696428651",onInput:J,class:X(["w-full rounded-lg border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",m.value?"border-red-500":"border-gray-300"])},null,34),[[G,u.value]]),m.value?(t(),o("p",Ts," Veuillez entrer un numéro valide (9 chiffres, commençant par 6). ")):C("",!0),x[11]||(x[11]=e("label",{class:"block text-gray-700 font-semibold mb-2 mt-4",for:"paymentService"}," Service de paiement ",-1)),e("div",Rs,[(t(),o(W,null,K(y,L=>e("label",{key:L.value,class:X(["flex items-center gap-3 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":i.value===L.value,"border-gray-300 bg-white":i.value!==L.value}])},[O(e("input",{type:"radio",value:L.value,"onUpdate:modelValue":x[2]||(x[2]=F=>i.value=F),class:"hidden"},null,8,Us),[[Xe,i.value]]),e("img",{src:L.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Ds),e("span",{class:X({"text-[var(--espace-vert)] font-bold":i.value===L.value,"text-gray-700":i.value!==L.value})},p(L.label),3)],2)),64))]),r.value&&!i.value?(t(),o("p",Ns," Veuillez sélectionner un service. ")):C("",!0),e("div",Os,[x[4]||(x[4]=w(" Montant total : ")),e("span",qs,p(v.value)+" FCFA",1)]),e("button",{onClick:j,disabled:!b.value||d.value,class:"w-full mt-4 bg-[var(--espace-vert)] text-white py-3 rounded-lg font-semibold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-3"},[d.value?(t(),o("span",Bs,"veuillez patientez")):(t(),o("span",Ws,"Acheter")),d.value?(t(),o("svg",Hs,x[5]||(x[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))):C("",!0)],8,Js),e("button",Xs,[N(R,{to:"/jeton-history",onClick:x[3]||(x[3]=L=>_("close"))},{default:Q(()=>x[6]||(x[6]=[w("Annuler")])),_:1,__:[6]})])])])}}}),Ks=te(Gs,[["__scopeId","data-v-c7a0e7a2"]]),Qs={class:"space-y-6"},Zs={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},Ys={key:0,class:"space-y-2 text-[var(--espace-gris)]"},eo={class:"flex gap-2"},to={key:0,class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},so={key:0,class:"space-y-2 text-[var(--espace-gris)]"},oo={key:0,class:"w-24 h-24"},ao=["src"],ro={key:0,class:"mt-2 w-24 h-24"},lo=["src"],no={class:"flex gap-2"},io=ee({__name:"userProfile",props:{user:Object},setup(E){var y,$,b,l,h,M,J,j,P,x,R,L,F,se,re,S;const a=ne(),_=oe(),f=g(!1),s=g(a.user),u=g({nom:((y=s.value)==null?void 0:y.nom)||"",telephone:(($=s.value)==null?void 0:$.telephone)||"",email:((b=s.value)==null?void 0:b.email)||"",ville:((l=s.value)==null?void 0:l.ville)||""}),i=g(!1),v=g({nom:((M=(h=s.value)==null?void 0:h.commercant)==null?void 0:M.nom)||"",description:((j=(J=s.value)==null?void 0:J.commercant)==null?void 0:j.description)||"",email:((x=(P=s.value)==null?void 0:P.commercant)==null?void 0:x.email)||"",telephone:((L=(R=s.value)==null?void 0:R.commercant)==null?void 0:L.telephone)||"",ville:((se=(F=s.value)==null?void 0:F.commercant)==null?void 0:se.ville)||"",logo:null,logoPreview:(S=(re=s.value)==null?void 0:re.commercant)!=null&&S.logo?`http://localhost:8000/storage/${s.value.commercant.logo}`:null});console.log(` com ${JSON.stringify(v.value)}`);const d=n=>{var A;const c=(A=n.target.files)==null?void 0:A[0];if(c){if(!c.type.startsWith("image/")){_.error("Veuillez sélectionner une image.");return}if(c.size>2*1024*1024){_.error("Image trop volumineuse (max 2Mo).");return}v.value.logo=c,v.value.logoPreview=URL.createObjectURL(c)}},r=async()=>{var n;try{const c=await D.put("/profile",u.value);s.value&&(s.value.nom=c.data.user.nom||"",s.value.telephone=c.data.user.telephone||"",s.value.email=c.data.user.email||"",s.value.ville=c.data.user.ville||""),a.user=c.data.user,f.value=!1,_.success("Profil mis à jour avec succès.")}catch(c){_.error(((n=c.response)==null?void 0:n.data.message)||"Erreur lors de la mise à jour.")}},m=async()=>{var n,c,A;try{const I=new FormData;I.append("nom",v.value.nom),I.append("description",v.value.description),I.append("email",v.value.email),I.append("telephone",v.value.telephone),I.append("ville",v.value.ville),v.value.logo&&I.append("logo",v.value.logo);const B=await D.post("/commercant/update",I,{headers:{"Content-Type":"multipart/form-data"}});console.log(` com ${JSON.stringify(B.data)}`),(n=s.value)!=null&&n.commercant&&(s.value.commercant.nom=B.data.commercant.nom,s.value.commercant.description=B.data.commercant.description,s.value.commercant.email=B.data.commercant.email,s.value.commercant.telephone=B.data.commercant.telephone,s.value.commercant.ville=B.data.commercant.ville,s.value.commercant.logo=B.data.commercant.logo),a.user=s.value,v.value.logoPreview=B.data.commercant.logo?`http://localhost:8000/storage/${B.data.commercant.logo}`:null,i.value=!1,_.success("Commerce mis à jour avec succès.")}catch(I){_.error(((A=(c=I.response)==null?void 0:c.data)==null?void 0:A.message)||"Erreur lors de la mise à jour du commerce.")}};return ue(()=>a.user,n=>{var c,A,I,B,T,q;s.value=n||null,u.value={nom:(n==null?void 0:n.nom)||"",telephone:(n==null?void 0:n.telephone)||"",email:(n==null?void 0:n.email)||"",ville:(n==null?void 0:n.ville)||""},v.value={nom:((c=n==null?void 0:n.commercant)==null?void 0:c.nom)||"",description:((A=n==null?void 0:n.commercant)==null?void 0:A.description)||"",email:((I=n==null?void 0:n.commercant)==null?void 0:I.email)||"",telephone:((B=n==null?void 0:n.commercant)==null?void 0:B.telephone)||"",ville:((T=n==null?void 0:n.commercant)==null?void 0:T.ville)||"",logo:null,logoPreview:(q=n==null?void 0:n.commercant)!=null&&q.logo?`http://localhost:8000/storage/${n.commercant.logo}`:null}},{immediate:!0}),(n,c)=>{var A,I,B,T,q,Z;return t(),o("div",Qs,[e("section",Zs,[c[23]||(c[23]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations personnelles",-1)),f.value?(t(),o("form",{key:1,onSubmit:ae(r,["prevent"]),class:"space-y-4"},[e("div",null,[c[18]||(c[18]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom"},"Nom",-1)),O(e("input",{"onUpdate:modelValue":c[1]||(c[1]=V=>u.value.nom=V),id:"nom",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre nom"},null,512),[[G,u.value.nom]])]),e("div",null,[c[19]||(c[19]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone"},"Téléphone",-1)),O(e("input",{"onUpdate:modelValue":c[2]||(c[2]=V=>u.value.telephone=V),id:"telephone",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre téléphone"},null,512),[[G,u.value.telephone]])]),e("div",null,[c[20]||(c[20]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email"},"Email",-1)),O(e("input",{"onUpdate:modelValue":c[3]||(c[3]=V=>u.value.email=V),id:"email",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre email (optionnel)"},null,512),[[G,u.value.email]])]),e("div",null,[c[21]||(c[21]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville"},"Ville",-1)),O(e("input",{"onUpdate:modelValue":c[4]||(c[4]=V=>u.value.ville=V),id:"ville",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre ville"},null,512),[[G,u.value.ville]])]),e("div",eo,[c[22]||(c[22]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Enregistrer les modifications"}," Enregistrer ",-1)),e("button",{onClick:c[5]||(c[5]=V=>f.value=!1),class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Annuler"}," Annuler ")])],32)):(t(),o("div",Ys,[e("p",null,[c[13]||(c[13]=e("strong",null,"Nom :",-1)),w(" "+p((A=s.value)==null?void 0:A.nom),1)]),e("p",null,[c[14]||(c[14]=e("strong",null,"Téléphone :",-1)),w(" "+p((I=s.value)==null?void 0:I.telephone),1)]),e("p",null,[c[15]||(c[15]=e("strong",null,"Email :",-1)),w(" "+p(((B=s.value)==null?void 0:B.email)||"Non défini"),1)]),e("p",null,[c[16]||(c[16]=e("strong",null,"Ville :",-1)),w(" "+p((T=s.value)==null?void 0:T.ville),1)]),e("p",null,[c[17]||(c[17]=e("strong",null,"Statut Premium :",-1)),w(" "+p((q=s.value)!=null&&q.premium?"Actif":"Inactif"),1)]),e("button",{onClick:c[0]||(c[0]=V=>f.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Modifier le profil"}," Modifier ")]))]),(Z=s.value)!=null&&Z.commercant?(t(),o("section",to,[c[36]||(c[36]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations du Commerce",-1)),i.value?(t(),o("form",{key:1,onSubmit:ae(m,["prevent"]),class:"space-y-4"},[e("div",null,[c[29]||(c[29]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom_commerce"},"Nom du commerce",-1)),O(e("input",{"onUpdate:modelValue":c[7]||(c[7]=V=>v.value.nom=V),id:"nom_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerce"},null,512),[[G,v.value.nom]])]),e("div",null,[c[30]||(c[30]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"description_commerce"},"Description",-1)),O(e("textarea",{"onUpdate:modelValue":c[8]||(c[8]=V=>v.value.description=V),id:"description_commerce",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Description du commerce",rows:"3"},null,512),[[G,v.value.description]])]),e("div",null,[c[31]||(c[31]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email_commerce"},"Email",-1)),O(e("input",{"onUpdate:modelValue":c[9]||(c[9]=V=>v.value.email=V),id:"email_commerce",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Email du commerce (optionnel)"},null,512),[[G,v.value.email]])]),e("div",null,[c[32]||(c[32]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone_commerce"},"Téléphone",-1)),O(e("input",{"onUpdate:modelValue":c[10]||(c[10]=V=>v.value.telephone=V),id:"telephone_commerce",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Téléphone du commerce"},null,512),[[G,v.value.telephone]])]),e("div",null,[c[33]||(c[33]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville_commerce"},"Ville",-1)),O(e("input",{"onUpdate:modelValue":c[11]||(c[11]=V=>v.value.ville=V),id:"ville_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville du commerce"},null,512),[[G,v.value.ville]])]),e("div",null,[c[34]||(c[34]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"logo_commerce"},"Logo",-1)),e("input",{id:"logo_commerce",type:"file",accept:"image/*",onChange:d,class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},null,32),v.value.logoPreview?(t(),o("div",ro,[e("img",{src:v.value.logoPreview,alt:"Aperçu logo",class:"w-full h-full object-cover rounded-md shadow"},null,8,lo)])):C("",!0)]),e("div",no,[c[35]||(c[35]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Enregistrer ",-1)),e("button",{onClick:c[12]||(c[12]=V=>i.value=!1),type:"button",class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Annuler ")])],32)):(t(),o("div",so,[s.value.commercant.logo?(t(),o("div",oo,[e("img",{src:`http://localhost:8000/storage/${s.value.commercant.logo}`,alt:"Logo du commerce",class:"w-full h-full object-cover rounded-md shadow"},null,8,ao)])):C("",!0),e("p",null,[c[24]||(c[24]=e("strong",null,"Nom du commerce :",-1)),w(" "+p(s.value.commercant.nom),1)]),e("p",null,[c[25]||(c[25]=e("strong",null,"Description :",-1)),w(" "+p(s.value.commercant.description||"Non définie"),1)]),e("p",null,[c[26]||(c[26]=e("strong",null,"Email :",-1)),w(" "+p(s.value.commercant.email||"Non défini"),1)]),e("p",null,[c[27]||(c[27]=e("strong",null,"Téléphone :",-1)),w(" "+p(s.value.commercant.telephone),1)]),e("p",null,[c[28]||(c[28]=e("strong",null,"Ville :",-1)),w(" "+p(s.value.commercant.ville),1)]),e("button",{onClick:c[6]||(c[6]=V=>i.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Modifier ")]))])):C("",!0),c[37]||(c[37]=e("section",{class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},[e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Mon Parrainage")],-1))])}}}),uo=te(io,[["__scopeId","data-v-aaaa75a7"]]),co=ee({__name:"MerchantProfile",props:{user:Object},setup(E){const a=oe(),_=g(null),f=g([]);return ie(async()=>{try{const s=await D.get("/commercant/profil");_.value=s.data.commercant,f.value=s.data.produits||[]}catch(s){a.error("Erreur lors du chargement des données du commerçant: "+(s.message||s))}}),(s,u)=>null}}),po=te(co,[["__scopeId","data-v-ce205108"]]),vo={class:"overflow-y-scroll min-h-screen relative bg-gray-100 py-8 sm:px-6"},mo={class:"flex flex-col sm:flex-row items-center justify-between mb-8 gap-4"},fo={class:"flex items-center space-x-4 relative w-full gap-1 px-3"},go={class:"relative"},xo=["src"],bo={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-lg p-1 rounded-full",style:{}},ho={key:3,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-36 bg-white border rounded-md shadow z-10"},yo={class:"space-y-1"},_o={key:0,class:"text-sm text-gray-500"},wo={key:0,class:"ml-4 flex items-center gap-2"},ko=["src"],$o=["disabled"],Co={class:"flex flex-col sm:flex-row gap-2 items-center"},Ao={class:"container mx-auto max-w-4xl"},Po={key:2,class:"fixed inset-0 bg-black bg-opacity-0 flex items-center justify-center z-50"},So={class:"bg-white rounded-lg p-4 relative w-full max-w-md"},jo=ee({__name:"Profile",setup(E){const a=()=>{const c=window.location.hostname;return c==="localhost"||c==="127.0.0.1"?"http://localhost:8000/storage/":"https://espacecameroun.devfack.com/storage/"},_=fe(()=>a()),f=de(),s=oe(),u=ne(),i=g(u.user);console.log(i==null?void 0:i.value);const v=g(!1),d=g(!1),r=g(null),m=g(null),y=g(!1),$=g(!1),b=g(!1),l=fe(()=>$.value?po:uo),h=g(null),M=g(null),J=g(!1);let j=null;const P=()=>{var c;(c=h.value)==null||c.click(),v.value=!1},x=c=>{const A=c.target;if(A.files&&A.files[0]){const I=A.files[0];if(!I.type.startsWith("image/")){s.error("Veuillez sélectionner une image.");return}if(I.size>2*1024*1024){s.error("Image trop volumineuse (max 2Mo).");return}m.value=I,r.value=URL.createObjectURL(I)}},R=async()=>{try{j=await navigator.mediaDevices.getUserMedia({video:!0}),J.value=!0,v.value=!1,setTimeout(()=>{M.value&&(M.value.srcObject=j)},100)}catch(c){s.error("Impossible d'accéder à la caméra."),console.error(c)}},L=()=>{if(!M.value)return;const c=M.value,A=document.createElement("canvas");A.width=c.videoWidth,A.height=c.videoHeight;const I=A.getContext("2d");I&&(I.drawImage(c,0,0,A.width,A.height),A.toBlob(B=>{B&&(m.value=new File([B],"photo.jpg",{type:"image/jpeg"}),r.value=URL.createObjectURL(m.value),F())},"image/jpeg"))},F=()=>{j&&(j.getTracks().forEach(c=>c.stop()),j=null),J.value=!1},se=()=>{m.value=null,r.value=null},re=async()=>{var c,A;if(m.value){d.value=!0;try{const I=new FormData;I.append("photo",m.value);const B=await D.post("/profile/photo",I,{headers:{"Content-Type":"multipart/form-data"}});B.data.photo&&(i.value&&(i.value.photo=B.data.photo,u.user=i.value),s.success("Photo mise à jour."),se())}catch(I){s.error(((A=(c=I.response)==null?void 0:c.data)==null?void 0:A.message)||"Erreur lors de l'envoi.")}finally{d.value=!1}}},S=async()=>{y.value=!1},n=c=>{s.success(`Vous avez acheté ${c} jetons !`)};return ue(()=>u.user,c=>{i.value=c||null},{immediate:!0}),ie(()=>{}),Ce(()=>{r.value&&URL.revokeObjectURL(r.value),j&&j.getTracks().forEach(c=>c.stop())}),(c,A)=>{var I,B,T,q,Z,V,k,U,H,Y,le,pe,me,be,ye,ke,Pe,Se,je,Ve,Me;return t(),o("div",vo,[e("div",mo,[e("div",fo,[e("div",go,[(I=i.value)!=null&&I.photo?(t(),o("img",{key:0,src:_.value+((B=i.value)==null?void 0:B.photo),alt:"Photo de profil",class:"w-16 h-16 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,xo)):(t(),o("div",{key:1,class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:ge({background:`${((V=(Z=(q=(T=i.value)==null?void 0:T.niveaux_users)==null?void 0:q.at(-1))==null?void 0:Z.parrainage_niveau)==null?void 0:V.couleur)||"#0af"}`})},A[6]||(A[6]=[e("i",{class:"fas fa-user-circle text-4xl"},null,-1)]),4)),(k=i.value)!=null&&k.premium?(t(),o("i",bo)):C("",!0),e("button",{onClick:A[0]||(A[0]=_e=>v.value=!v.value),class:"absolute bottom-0 right-0 w-6 h-6 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full flex items-center justify-center hover:bg-[var(--espace-vert)] hover:text-white",style:{}},A[7]||(A[7]=[e("i",{class:"fas fa-pencil-alt text-xs"},null,-1)])),v.value?(t(),o("div",ho,[e("button",{onClick:R,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Caméra "),e("button",{onClick:P,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Galerie ")])):C("",!0)]),e("input",{ref_key:"galleryInput",ref:h,type:"file",accept:"image/*",class:"hidden",onChange:x},null,544),e("div",yo,[e("h1",{class:"text-2xl sm:text-3xl font-bold flex items-center gap-2 text-blue-500",style:ge({color:`${((le=(Y=(H=(U=i.value)==null?void 0:U.niveaux_users)==null?void 0:H.at(-1))==null?void 0:Y.parrainage_niveau)==null?void 0:le.couleur)||"#0af"}`})},[w(p((pe=i.value)==null?void 0:pe.nom)+" ",1),(me=i.value)!=null&&me.premium?(t(),o("span",{key:0,class:"text-black text-xs px-3 py-1 rounded-full uppercase font-bold",style:ge({background:`${((Pe=(ke=(ye=(be=i.value)==null?void 0:be.niveaux_users)==null?void 0:ye.at(-1))==null?void 0:ke.parrainage_niveau)==null?void 0:Pe.couleur)||"#0af"}`})}," Premium ",4)):C("",!0)],4),(Se=i.value)!=null&&Se.subscription_ends_at?(t(),o("span",_o," Jusqu'au "+p(new Date((je=i.value)==null?void 0:je.subscription_ends_at).toLocaleDateString()),1)):C("",!0)]),r.value?(t(),o("div",wo,[e("img",{src:r.value,alt:"Preview",class:"w-12 h-12 rounded-full object-cover"},null,8,ko),e("button",{onClick:re,disabled:d.value,class:X(["bg-[var(--espace-vert)] text-white px-3 py-1 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]",{"opacity-50 cursor-not-allowed":d.value}])},p(d.value?"Upload...":"Confirmer"),11,$o),e("button",{onClick:se,class:"text-red-500 hover:text-red-700"}," Annuler ")])):C("",!0)]),e("div",Co,[(Ve=i.value)!=null&&Ve.commercant?(t(),o("button",{key:0,onClick:A[1]||(A[1]=_e=>$.value=!$.value),class:"text-[var(--espace-or)] hover:text-[var(--espace-vert)] font-medium flex items-center gap-1"},A[8]||(A[8]=[e("i",{class:"fas fa-store"},null,-1),w(" Compte Commerçant ")]))):(t(),o("button",{key:1,onClick:A[2]||(A[2]=_e=>z(f).push("/commercant/create")),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-vert)] hover:text-white"}," Devenir commerçant ")),(Me=i.value)!=null&&Me.premium?C("",!0):(t(),o("button",{key:2,onClick:A[3]||(A[3]=_e=>y.value=!0),class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"}," Passer Premium "))])]),e("div",Ao,[(t(),ce(Ye(l.value)))]),y.value?(t(),ce(zs,{key:0,"is-open":y.value,onClose:A[4]||(A[4]=_e=>y.value=!1),onUpgraded:S},null,8,["is-open"])):C("",!0),b.value?(t(),ce(Ks,{key:1,"is-open":b.value,onClose:A[5]||(A[5]=_e=>b.value=!1),onPurchased:n},null,8,["is-open"])):C("",!0),J.value?(t(),o("div",Po,[e("div",So,[e("video",{ref_key:"videoRef",ref:M,autoplay:"",playsinline:"",class:"rounded w-full"},null,512),e("div",{class:"mt-2 flex justify-between"},[e("button",{onClick:L,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Capturer "),e("button",{onClick:F,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Annuler ")])])])):C("",!0)])}}}),gu=te(jo,[["__scopeId","data-v-07a4f2cb"]]),Vo={class:"min-h-screen bg-gray-100 pt-16 pb-20 px-4 sm:px-6 flex flex-col lg:flex-row gap-4"},Mo={class:"hidden lg:block w-full max-w-xs bg-[var(--espace-blanc)] rounded-lg shadow-md p-4"},zo={class:"space-y-2"},Eo=["onClick"],Io={class:"font-poppins"},Lo={class:"flex-1 bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Fo={class:"lg:hidden mb-4"},To={class:"flex overflow-x-auto space-x-2 border-b border-[var(--espace-gris)]"},Ro=["onClick"],Uo={key:0,class:"space-y-6"},Do={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},No={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Oo={class:"flex items-center gap-4 mb-4"},qo=["src"],Jo={class:"text-[var(--espace-vert)] font-semibold"},Wo={class:"text-sm text-[var(--espace-gris)]"},Bo={class:"text-sm text-[var(--espace-gris)]"},Ho={class:"text-sm text-[var(--espace-gris)]"},Xo={key:0,class:"space-y-6"},Go={key:0,class:"space-y-6"},Ko={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Qo={class:"text-base font-medium font-poppins"},Zo={class:"text-sm text-[var(--espace-gris)]"},Yo=ee({__name:"Parametres",setup(E){const a=g(!1),_=ne(),f=de(),s=oe(),u=_.user,i=g("profile"),v=g({id:(u==null?void 0:u.id)??0,nom:(u==null?void 0:u.nom)??"",email:(u==null?void 0:u.email)??"",telephone:(u==null?void 0:u.telephone)??"",ville:(u==null?void 0:u.ville)??""});_.user={..._.user,...v.value};const d=g({current_password:"",new_password:"",confirm_password:""});g({});const r=g(""),m=fe(()=>[...u!=null&&u.commercant?[{to:"/commercant",label:"Espace Commerçant",icon:"fa-store-alt",description:"Gérez votre boutique et vos produits"}]:[],{to:"/parrainage",label:"Parrainage",icon:"fa-users",description:"Invitez des amis et gagnez des récompenses"},{to:"/abonnements",label:"Abonnements",icon:"fa-star",description:"Gérez vos abonnements premium"},{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",description:"Gérez vos collaborations sur des produits"}]),y=async()=>{var h,M;a.value=!0;try{await D.put("/user/profile",v.value),localStorage.setItem("user",JSON.stringify(_.user)),s.success("Profil mis à jour avec succès",{timeout:3e3})}catch(J){s.error(((M=(h=J.response)==null?void 0:h.data)==null?void 0:M.message)||"Erreur lors de la mise à jour du profil")}finally{a.value=!1}},$=async()=>{var h,M;a.value=!0;try{if(d.value.new_password!==d.value.confirm_password){s.error("Les mots de passe ne correspondent pas");return}if(r.value==="weak"){s.error("Le mot de passe est trop faible. Utilisez au moins 8 caractères avec des lettres, chiffres et symboles.");return}await D.put("/user/password",d.value),s.success("Mot de passe mis à jour avec succès",{timeout:3e3}),d.value={current_password:"",new_password:"",confirm_password:""},r.value=""}catch(J){s.error(((M=(h=J.response)==null?void 0:h.data)==null?void 0:M.message)||"Erreur lors de la mise à jour du mot de passe")}finally{a.value=!1}},b=()=>{_.logout(),f.push({name:"login"})},l=()=>{const h=d.value.new_password;h.length===0?r.value="":h.length<8||!/[A-Za-z]/.test(h)||!/[0-9]/.test(h)?r.value="weak":/[!@#$%^&*]/.test(h)?r.value="strong":r.value="medium"};return ue(()=>d.value.new_password,l),(h,M)=>{const J=xe("RouterLink");return t(),o(W,null,[N(Ae,{isLoading:a.value},null,8,["isLoading"]),e("div",Vo,[e("aside",Mo,[M[7]||(M[7]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4 font-poppins"},"Paramètres",-1)),e("nav",zo,[(t(),o(W,null,K([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres options",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],j=>e("button",{key:j.id,onClick:P=>j.id==="logout"?b():i.value=j.id,class:X(["w-full flex items-center gap-3 p-3 rounded-lg transition-colors duration-300",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":i.value===j.id,"text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":i.value!==j.id}])},[e("i",{class:X(["fas",j.icon])},null,2),e("span",Io,p(j.label),1)],10,Eo)),64))])]),e("main",Lo,[e("div",Fo,[e("div",To,[(t(),o(W,null,K([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],j=>e("button",{key:j.id,onClick:P=>j.id==="logout"?b():i.value=j.id,class:X(["flex items-center gap-2 px-4 py-2 text-sm font-medium font-poppins transition-colors duration-300",{"border-b-2 border-[var(--espace-or)] text-[var(--espace-vert)]":i.value===j.id,"text-[var(--espace-gris)] hover:text-[var(--espace-vert)]":i.value!==j.id}])},[e("i",{class:X(["fas",j.icon])},null,2),w(" "+p(j.label),1)],10,Ro)),64))])]),N(he,{name:"slide"},{default:Q(()=>{var j,P;return[i.value==="profile"?(t(),o("section",Uo,[M[10]||(M[10]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Profil",-1)),e("div",Do,[e("form",{onSubmit:ae(y,["prevent"]),class:"space-y-4"},[N(ve,{label:"Nom",icon:"fa-user",modelValue:v.value.nom,"onUpdate:modelValue":M[0]||(M[0]=x=>v.value.nom=x),type:"text",required:"",placeholder:"Votre nom"},null,8,["modelValue"]),N(ve,{label:"Email",icon:"fa-envelope",modelValue:v.value.email,"onUpdate:modelValue":M[1]||(M[1]=x=>v.value.email=x),type:"email",placeholder:"Votre email"},null,8,["modelValue"]),N(ve,{label:"Téléphone",icon:"fa-phone",modelValue:v.value.telephone,"onUpdate:modelValue":M[2]||(M[2]=x=>v.value.telephone=x),type:"tel",required:"",placeholder:"Votre numéro de téléphone"},null,8,["modelValue"]),N(ve,{label:"Ville",icon:"fa-city",modelValue:v.value.ville,"onUpdate:modelValue":M[3]||(M[3]=x=>v.value.ville=x),type:"text",required:"",placeholder:"Votre ville"},null,8,["modelValue"]),M[8]||(M[8]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Mettre à jour ",-1))],32),e("div",No,[M[9]||(M[9]=e("h3",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2 font-poppins"},"Aperçu",-1)),e("div",Oo,[e("img",{src:((P=(j=z(u))==null?void 0:j.commercant)==null?void 0:P.logo)||"https://via.placeholder.com/50",alt:"Photo de profil",class:"w-12 h-12 rounded-full object-cover"},null,8,qo),e("div",null,[e("p",Jo,p(v.value.nom||"Nonni"),1),e("p",Wo,p(v.value.email||"Non défini"),1)])]),e("p",Bo,"Téléphone: "+p(v.value.telephone||"Nonni"),1),e("p",Ho,"Ville: "+p(v.value.ville||"Non défini"),1)])])])):C("",!0)]}),_:1}),N(he,{name:"slide"},{default:Q(()=>[i.value==="security"?(t(),o("section",Xo,[M[12]||(M[12]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Sécurité",-1)),e("form",{onSubmit:ae($,["prevent"]),class:"space-y-4"},[N(ve,{label:"Mot de passe actuel",icon:"fa-lock",modelValue:d.value.current_password,"onUpdate:modelValue":M[4]||(M[4]=j=>d.value.current_password=j),type:"password",required:"",placeholder:"Mot de passe actuel"},null,8,["modelValue"]),N(ve,{label:"Nouveau mot de passe",icon:"fa-lock",modelValue:d.value.new_password,"onUpdate:modelValue":M[5]||(M[5]=j=>d.value.new_password=j),type:"password",required:"",placeholder:"Nouveau mot de passe",onInput:l},null,8,["modelValue"]),r.value?(t(),o("div",{key:0,class:X(["text-sm",{"text-red-500":r.value==="weak","text-yellow-500":r.value==="medium","text-green-500":r.value==="strong"}])}," Force du mot de passe : "+p(r.value==="weak"?"Faible":r.value==="medium"?"Moyen":"Fort"),3)):C("",!0),N(ve,{label:"Confirmer le nouveau mot de passe",icon:"fa-lock",modelValue:d.value.confirm_password,"onUpdate:modelValue":M[6]||(M[6]=j=>d.value.confirm_password=j),type:"password",required:"",placeholder:"Confirmer le mot de passe"},null,8,["modelValue"]),M[11]||(M[11]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Changer le mot de passe ",-1))],32)])):C("",!0)]),_:1}),N(he,{name:"slide"},{default:Q(()=>[i.value==="links"?(t(),o("section",Go,[M[13]||(M[13]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Autres options",-1)),e("div",Ko,[(t(!0),o(W,null,K(m.value,j=>(t(),ce(J,{key:j.to,to:j.to,class:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"},{default:Q(()=>[e("i",{class:X(["fas",j.icon])},null,2),e("div",null,[e("h3",Qo,p(j.label),1),e("p",Zo,p(j.description),1)])]),_:2},1032,["to"]))),128))])])):C("",!0)]),_:1})])])],64)}}}),xu=te(Yo,[["__scopeId","data-v-34fd2bf9"]]),ea={class:"bg-[var(--espace-blanc)] border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200"},ta={class:"relative w-full h-32 overflow-hidden rounded-lg mb-2"},sa=["src","alt"],oa={key:0,class:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex space-x-1"},aa={key:0,class:"absolute top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},ra={key:1,class:"absolute top-2 right-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},la={class:"text-sm font-semibold text-[var(--espace-vert)] font-poppins truncate"},na={class:"text-xs text-[var(--espace-gris)] truncate"},ia={class:"text-sm font-medium text-[var(--espace-or)]"},ua={class:"flex items-center justify-between mt-2 text-xs text-[var(--espace-gris)]"},ca={class:"flex items-center gap-1"},da={class:"flex items-center gap-1"},pa=["aria-label"],va=ee({__name:"ProductCard",props:{produit:{}},emits:["toggle-favorite","handleToggleFavorite"],setup(E,{emit:a}){const _=E,f=a,s=oe(),u=Le(),i=r=>{if(r==null||isNaN(r)||r===0)return"0";const m=Math.abs(r);return m<1e3?r.toString():m<1e4?(r/1e3).toFixed(1).replace(/\.0$/,"")+"k":m<1e6?Math.floor(r/1e3)+"k":m<1e9?(r/1e6).toFixed(1).replace(/\.0$/,"")+"M":(r/1e9).toFixed(1).replace(/\.0$/,"")+"B"},v=g(0),d=async()=>{var r,m;try{await u.toggleFavorite(_.produit.id),f("toggle-favorite",_.produit.id)}catch(y){s.error(((m=(r=y.response)==null?void 0:r.data)==null?void 0:m.message)||"Erreur lors de la mise à jour des favoris.")}};return(r,m)=>{var $,b;const y=xe("router-link");return t(),o("div",ea,[N(y,{to:`/produits/${r.produit.id}`,class:"block relative"},{default:Q(()=>[e("div",ta,[e("div",{class:"flex w-full h-full slider-container",style:ge({transform:`translateX(-${v.value*100}%)`})},[(t(!0),o(W,null,K(r.produit.photos||[r.produit.photo_url||"https://via.placeholder.com/150"],(l,h)=>(t(),o("img",{key:h,src:l,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${r.produit.nom} - ${h+1}`},null,8,sa))),128))],4),r.produit.photos&&r.produit.photos.length>1?(t(),o("div",oa,[(t(!0),o(W,null,K(r.produit.photos,(l,h)=>(t(),o("span",{key:h,class:X(["w-1.5 h-1.5 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":h===v.value}])},null,2))),128))])):C("",!0)]),r.produit.collaboratif?(t(),o("span",aa," Collaboratif ")):C("",!0),r.produit.boosted_until&&new Date(r.produit.boosted_until)>new Date?(t(),o("span",ra," Boosté ")):C("",!0),e("h3",la,p(r.produit.nom),1),e("p",na,p(r.produit.description||"Aucune description"),1),e("p",ia,p(r.produit.prix)+" XAF",1)]),_:1},8,["to"]),e("div",ua,[e("div",ca,[m[0]||(m[0]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,p(i(($=r.produit.counts)==null?void 0:$.views_count)),1)]),e("div",da,[e("button",{onClick:d,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] transition active:scale-95 focus:outline-none","aria-label":r.produit.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:X(["fas fa-bookmark text-sm",{"text-[var(--espace-or)]":r.produit.is_favorited_by}])},null,2)],8,pa),e("span",null,p(i((b=r.produit.counts)==null?void 0:b.favorites_count)),1)])])])}}}),Te=te(va,[["__scopeId","data-v-03efe6d5"]]),ma={class:"pt-4 bg-[var(--espace-blanc)] max-h-full relative"},fa={class:"relative overflow-y-scroll mx-auto px-4 sm:px-6 py-4 max-h-full"},ga={class:"fixed flex items-center overflow-x-auto space-x-2 mb-3 snap-x snap-mandatory z-5"},xa=["onClick","aria-label","aria-current"],ba={class:"fixed right-10 z-5 flex justify-end items-center mb-3"},ha=["aria-label","aria-expanded"],ya={key:0,class:"absolute -top-1 -right-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] text-[10px] rounded-full h-5 w-5 flex items-center justify-center"},_a={key:0,class:"bg-[var(--espace-blanc)] rounded-xl shadow-md p-4 mb-4 fixed top-0 left-0 right-0 z-50 sm:static sm:flex sm:items-center sm:gap-3 sm:flex-wrap"},wa={class:"flex-1 min-w-[120px]"},ka={class:"flex-1 min-w-[120px]"},$a=["value"],Ca={class:"flex-1 min-w-[100px]"},Aa={class:"flex-1 min-w-[100px]"},Pa={class:"flex-1 min-w-[120px]"},Sa=["value"],ja={class:"flex-1 min-w-[100px]"},Va=["aria-busy"],Ma={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},za=ee({__name:"Home",setup(E){const a=Le(),_=ne(),f=g([]),s=oe(),u=g(!1),i=g({search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""}),v=g(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),d=g(null),r=g(null),m=async()=>{try{const j=await D.get("/categories");f.value=j.data.categories}catch(j){console.error("Erreur lors du chargement des catégories:",j),s.error("Erreur lors du chargement des catégories.")}},y=()=>{if(i.value.prix_min&&i.value.prix_max&&parseFloat(i.value.prix_min)>parseFloat(i.value.prix_max)){s.error("Le prix minimum doit être inférieur au prix maximum.");return}a.fetchProducts(i.value,!0),u.value=!1},$=()=>{i.value={search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""},a.fetchProducts({},!0)},b=j=>{a.setSort(j)},l=()=>Object.values(i.value).filter(j=>j!=="").length,h=j=>{J(j)},M=j=>{J(j)},J=async j=>{var F,se,re;const P=(F=_.user)==null?void 0:F.id,x=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),R=new Date().toISOString().split("T")[0],L=localStorage.getItem("lastResetDate");if((!L||L!==R)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",R)),!await x[j])try{setTimeout(async()=>{const S=await D.post("/record_view",{product_id:j,user_id:P??null})},1e3),x[j]=!0,localStorage.setItem("viewedProducts",JSON.stringify(x))}catch(S){console.error("Erreur lors de l'enregistrement de la vue:",S),s.error(((re=(se=S.response)==null?void 0:se.data)==null?void 0:re.message)||"Erreur lors de l'enregistrement de la vue.")}};return ie(async()=>{try{await a.fetchProducts(),await m()}catch(j){console.error("Erreur lors du chargement des produits ou catégories:",j),s.error("Erreur lors du chargement des produits. Veuillez réessayer.")}d.value=new IntersectionObserver(j=>{j[0].isIntersecting&&!a.isLoading&&a.hasMore&&a.fetchProducts(i.value)},{threshold:.1}),r.value&&d.value.observe(r.value)}),Ce(()=>{d.value&&r.value&&d.value.unobserve(r.value)}),(j,P)=>(t(),o("div",ma,[N(Ae,{isLoading:z(a).isLoading},null,8,["isLoading"]),e("div",fa,[e("div",ga,[(t(),o(W,null,K([{id:"popular",label:"Populaire",icon:"fa-fire"},{id:"favorites",label:"Favoris",icon:"fa-heart"}],x=>e("button",{key:x.id,onClick:R=>b(x.id),class:X(["flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium font-poppins snap-center shrink-0 transition-all duration-200",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":z(a).sort===x.id,"bg-gray-100 text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":z(a).sort!==x.id}]),"aria-label":`Trier par ${x.label}`,"aria-current":z(a).sort===x.id?"true":void 0},[e("i",{class:X(["fas",x.icon])},null,2),w(" "+p(x.label),1)],10,xa)),64))]),e("div",ba,[e("button",{onClick:P[0]||(P[0]=x=>u.value=!u.value),class:"relative flex items-center justify-center w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition active:scale-95","aria-label":u.value?"Masquer les filtres":"Afficher les filtres","aria-expanded":u.value},[P[7]||(P[7]=e("i",{class:"fas fa-filter text-sm"},null,-1)),l()>0?(t(),o("span",ya,p(l()),1)):C("",!0)],8,ha)]),N(he,{name:"slide-up"},{default:Q(()=>[u.value?(t(),o("div",_a,[e("form",{onSubmit:ae(y,["prevent"]),class:"grid grid-cols-2 gap-3 sm:flex sm:flex-row sm:gap-3"},[e("div",wa,[O(e("input",{"onUpdate:modelValue":P[1]||(P[1]=x=>i.value.search=x),id:"search",type:"text",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Rechercher...","aria-label":"Rechercher un produit"},null,512),[[G,i.value.search]])]),e("div",ka,[O(e("select",{"onUpdate:modelValue":P[2]||(P[2]=x=>i.value.category=x),id:"category",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[P[8]||(P[8]=e("option",{value:""},"Toutes les Catégories",-1)),(t(!0),o(W,null,K(f.value,x=>(t(),o("option",{key:x.id,value:x.id},p(x.nom),9,$a))),128))],512),[[we,i.value.category]])]),e("div",Ca,[O(e("input",{"onUpdate:modelValue":P[3]||(P[3]=x=>i.value.prix_min=x),id:"prix_min",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix min","aria-label":"Prix minimum"},null,512),[[G,i.value.prix_min]])]),e("div",Aa,[O(e("input",{"onUpdate:modelValue":P[4]||(P[4]=x=>i.value.prix_max=x),id:"prix_max",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix max","aria-label":"Prix maximum"},null,512),[[G,i.value.prix_max]])]),e("div",Pa,[O(e("select",{"onUpdate:modelValue":P[5]||(P[5]=x=>i.value.ville=x),id:"ville",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[P[9]||(P[9]=e("option",{value:""},"Tous les villes",-1)),(t(!0),o(W,null,K(v.value,x=>(t(),o("option",{key:x,value:x},p(x),9,Sa))),128))],512),[[we,i.value.ville]])]),e("div",ja,[O(e("select",{"onUpdate:modelValue":P[6]||(P[6]=x=>i.value.collaboratif=x),id:"collaboratif",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},P[10]||(P[10]=[e("option",{value:""},"Collaboratif",-1),e("option",{value:"true"},"Oui",-1),e("option",{value:"false"},"Non",-1)]),512),[[we,i.value.collaboratif]])]),e("div",{class:"flex gap-2 col-span-2 sm:col-span-1"},[P[12]||(P[12]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Appliquer les filtres"},[e("i",{class:"fas fa-check text-sm"})],-1)),e("button",{onClick:$,type:"button",class:"w-10 h-10 bg-[var(--espace-gris)] text-[var(--espace-blanc)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Réinitialiser les filtres"},P[11]||(P[11]=[e("i",{class:"fas fa-times text-sm"},null,-1)]))])],32)])):C("",!0)]),_:1}),N(Ge,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 pt-12"},{default:Q(()=>[(t(!0),o(W,null,K(z(a).products,x=>(t(),ce(Te,{key:x.id,produit:x,onMouseover:R=>h(x.id),onTouchstart:R=>M(x.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:r,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":z(a).isLoading},[z(a).hasMore?C("",!0):(t(),o("p",Ma," Aucun produit supplémentaire "))],8,Va)])]))}}),bu=te(za,[["__scopeId","data-v-8f4595ca"]]),Ea={class:"overflow-y-scroll bg-[var(--espace-blanc)] pt-16 pb-20 px-4 sm:px-6"},Ia={class:"container mx-auto max-w-5xl"},La={key:0,class:"text-center text-[var(--espace-gris)]"},Fa={key:1,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Ta={class:"flex flex-col lg:flex-row gap-4 sm:gap-6"},Ra={class:"w-full lg:w-1/2 relative"},Ua={class:"relative w-full h-64 sm:h-80 lg:h-96 overflow-hidden rounded-lg"},Da=["src","alt"],Na={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Oa={key:0,class:"absolute top-3 left-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},qa={key:1,class:"absolute top-3 right-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Ja={key:2,class:"absolute bottom-3 left-3 bg-[var(--espace-bleu)] text-[var(--espace-blanc)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Commerçant Pro"},Wa={class:"w-full lg:w-1/2"},Ba={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"},Ha={class:"text-sm text-[var(--espace-gris)] mb-3"},Xa={class:"text-lg sm:text-xl font-semibold text-[var(--espace-or)] mb-3"},Ga={class:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 text-xs text-[var(--espace-gris)]"},Ka={class:"flex items-center gap-3"},Qa={class:"flex items-center gap-1"},Za={class:"flex items-center gap-1"},Ya=["aria-label"],er={class:"border-t pt-3 mt-3"},tr={class:"text-xs text-[var(--espace-gris)] mb-1"},sr={key:0,class:"ml-1 text-[var(--espace-or)]","aria-label":"Commerçant vérifié",title:"Commerçant vérifié"},or={class:"text-xs text-[var(--espace-gris)] mb-1"},ar={class:"text-xs text-[var(--espace-gris)] mb-1"},rr={class:"text-xs text-[var(--espace-gris)] mb-2"},lr={class:"flex flex-col sm:flex-row gap-3 mt-4"},nr=["disabled","aria-label"],ir={key:2,class:"text-center text-[var(--espace-gris)] text-sm font-poppins"},ur={class:"bg-[var(--espace-blanc)] rounded-lg p-4 sm:p-6 w-full max-w-md mx-4 shadow-lg"},cr={class:"text-base sm:text-lg font-semibold text-[var(--espace-vert)] mb-3 font-poppins"},dr={class:"text-xs text-[var(--espace-gris)] mb-3"},pr=["aria-label"],vr={key:0,class:"text-xs text-[var(--espace-gris)] mt-1"},mr={class:"bg-[var(--espace-blanc)] rounded-lg p-6 w-full max-w-md mx-4 shadow-lg border border-[var(--espace-or)]"},fr={class:"text-xs text-[var(--espace-gris)] mt-1 text-center"},gr={class:"text-xs text-[var(--espace-gris)] mt-1 text-center"},xr={class:"text-sm text-[var(--espace-gris)]"},br={class:"text-[var(--espace-or)]"},hr={class:"flex gap-4"},yr={key:0,class:"mt-6"},_r=["aria-busy"],wr={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},kr=ee({__name:"Produit",setup(E){const a=Le(),_=$e(),f=de(),s=ne(),u=Ie(),i=oe();g([]);const v=g(!1),d=g(null),r=g(null),m=g(null),y=g(!1),$=g(1),b=g(0),l=g(5),h=[100,500,1e3,5e3,1e4],M=[5,15,25,50,75],J=V=>{if(V==null||isNaN(V)||V===0)return"0";const k=Math.abs(V);return k<1e3?V.toString():k<1e4?(V/1e3).toFixed(1).replace(/\.0$/,"")+"k":k<1e6?Math.floor(V/1e3)+"k":k<1e9?(V/1e6).toFixed(1).replace(/\.0$/,"")+"M":(V/1e9).toFixed(1).replace(/\.0$/,"")+"B"},j=async()=>{try{a.isLoading=!0,await a.viewProduct(_.params.id),a.isLoading=!1,a.product.photos&&!a.product.photo_url&&(a.product.photo_url=a.product.photos[0]),await a.fetchProducts({category:a.product.category_id,per_page:8},!0)}catch(V){i.error(V||"Erreur lors du chargement du produit"),f.push({name:"home"})}finally{a.isLoading=!1}},P=()=>{var U,H;if(!s.user){i.error("Veuillez vous connecter pour contacter le commerçant"),f.push({name:"login"});return}const V=(U=a.product.commercant)==null?void 0:U.telephone,k=encodeURIComponent(`Bonjour ${(H=a.product.commercant)==null?void 0:H.nom}, je suis intéressé par ${a.product.nom}. Pouvez-vous me contacter ?`);window.open(`https://wa.me/${V}?text=${k}`,"_blank")},x=()=>{var V;if(!s.user){i.error("Veuillez vous connecter pour collaborer"),f.push({name:"login"});return}if(((V=s.user.commercant)==null?void 0:V.id)===a.product.commercant_id){i.error("Vous ne pouvez pas collaborer sur votre propre produit");return}if(!a.product.collaboratif){i.error("Ce produit n’est pas ouvert à la collaboration");return}d.value=a.product.prix+(a.product.marge_min||500),v.value=!0},R=async()=>{if(!d.value||d.value<a.product.prix+(a.product.marge_min||0)){i.error(`Le prix de revente doit être supérieur ou égal à ${a.product.prix+(a.product.marge_min||0)} XAF`);return}await u.addCollaboration({produit_id:a.product.id,prix_revente:d.value})&&(i.success("Demande de collaboration envoyée",{timeout:3e3}),v.value=!1,d.value=null)},L=()=>{v.value=!1,d.value=null},F=()=>{f.push({path:`/commercant/produits/${a.product.id}/edit`})},se=async()=>{var V,k,U;if(!s.user||((V=s.user.commercant)==null?void 0:V.id)!==a.product.commercant_id){i.error("Seul le commerçant propriétaire peut booster ce produit");return}if(s.user.jetons<l.value){i.error(`Pas assez de Jetons. Il vous faut ${l.value} Jetons pour ce boost.`);return}try{const H=await D.post(`/produits/${a.product.id}/boost`,{duration_days:$.value,target_views:h[b.value]});s.user.jetons-=l.value,a.product.boosted_until=H.data.data.end_date,i.success(H.data.message||"Produit boosté avec succès !"),y.value=!1}catch(H){i.error(((U=(k=H.response)==null?void 0:k.data)==null?void 0:U.message)||"Erreur lors du boostage du produit")}},re=()=>{var V;if(!s.user||((V=s.user.commercant)==null?void 0:V.id)!==a.product.commercant_id){i.error("Seul le commerçant propriétaire peut booster ce produit");return}y.value=!0,S()},S=()=>{const V=$.value*5,k=M[b.value];l.value=Math.max(5,V+k)};ue([$,b],()=>{S()});const n=V=>{A(V)},c=V=>{A(V)},A=async V=>{var le,pe,me;const k=(le=s.user)==null?void 0:le.id;if(!k){i.error("Connexion requise pour enregistrer la vue.");return}const U=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),H=new Date().toISOString().split("T")[0],Y=localStorage.getItem("lastResetDate");if((!Y||Y!==H)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",H)),!U[V])try{setTimeout(async()=>{const be=await D.post("/record_view",{product_id:V,user_id:k})},1e3),U[V]=!0,localStorage.setItem("viewedProducts",JSON.stringify(U))}catch(be){console.error("Erreur lors de l'enregistrement de la vue:",be),i.error(((me=(pe=be.response)==null?void 0:pe.data)==null?void 0:me.message)||"Erreur lors de l'enregistrement de la vue.")}},I=async()=>{var V,k;try{await a.toggleFavorite(a.product.id)}catch(U){i.error(((k=(V=U.response)==null?void 0:V.data)==null?void 0:k.message)||"Erreur lors de la mise à jour des favoris.")}},B=(V,k,U)=>{var Y;if(!s.user){i.error("Veuillez vous connecter pour démarrer une conversation"),f.push({name:"login"});return}const H={id:V,name:k,commercant_id:a.product.commercant_id,name_user:((Y=s.user)==null?void 0:Y.nom)||"Inconnu"};localStorage.setItem("chatProduct",JSON.stringify(H)),f.push(`/messages/${U}`)},T=g(0),q=()=>{var k;const V=(((k=a.product.photos)==null?void 0:k.length)||1)-1;T.value=Math.min(T.value+1,V)},Z=()=>{T.value=Math.max(T.value-1,0)};return ie(()=>{j(),u.initializeState(),r.value=new IntersectionObserver(V=>{V[0].isIntersecting&&!a.isLoading&&a.hasMore&&a.fetchProducts({category:a.product.category_id,per_page:8},!1)},{threshold:.1}),m.value&&r.value.observe(m.value)}),Ce(()=>{r.value&&m.value&&r.value.unobserve(m.value)}),ue(()=>_.params.id,V=>{V&&(j(),T.value=0)}),ue(a.product,V=>{V&&(a.page=1,a.fetchProducts({category:V.category_id,per_page:4},!0),T.value=0)}),(V,k)=>{const U=xe("router-link");return t(),o(W,null,[N(Ae,{isLoading:z(a).isLoading},null,8,["isLoading"]),e("div",Ea,[e("div",Ia,[z(a).isLoading?(t(),o("div",La)):z(a).product?(t(),o("div",Fa,[N(he,{name:"slide-up"},{default:Q(()=>{var H,Y,le,pe,me,be,ye,ke,Pe,Se,je,Ve,Me,_e,Oe,qe,Je,We,Be;return[e("div",Ta,[e("div",Ra,[e("div",Ua,[e("div",{class:"flex w-full h-full slider-container",style:ge({transform:`translateX(-${T.value*100}%)`})},[(t(!0),o(W,null,K(z(a).product.photos||[z(a).product.photo_url||"https://via.placeholder.com/300"],(Re,ze)=>(t(),o("img",{key:ze,src:Re,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${z(a).product.nom} - ${ze+1}`},null,8,Da))),128))],4),z(a).product.photos&&z(a).product.photos.length>1?(t(),o("button",{key:0,onClick:Z,class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image précédente"},k[6]||(k[6]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))):C("",!0),z(a).product.photos&&z(a).product.photos.length>1?(t(),o("button",{key:1,onClick:q,class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image suivante"},k[7]||(k[7]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))):C("",!0),z(a).product.photos&&z(a).product.photos.length>1?(t(),o("div",Na,[(t(!0),o(W,null,K(z(a).product.photos,(Re,ze)=>(t(),o("span",{key:ze,class:X(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":ze===T.value}])},null,2))),128))])):C("",!0)]),z(a).product.boosted_until&&new Date(z(a).product.boosted_until)>new Date?(t(),o("span",Oa," Boosté ")):C("",!0),z(a).product.collaboratif?(t(),o("span",qa," Collaboratif ")):C("",!0),(H=z(s).user)!=null&&H.premium?(t(),o("span",Ja," Premium ")):C("",!0)]),e("div",Wa,[e("h1",Ba,p(z(a).product.nom),1),e("p",Ha,p(z(a).product.description||"Aucune description disponible"),1),e("p",Xa,p(z(a).product.prix)+" XAF ",1),e("div",Ga,[e("p",null,[k[8]||(k[8]=e("strong",null,"Catégorie :",-1)),w(" "+p(((Y=z(a).product.category)==null?void 0:Y.nom)||"Non spécifiée"),1)]),e("p",null,[k[9]||(k[9]=e("strong",null,"Quantité :",-1)),w(" "+p(z(a).product.quantite),1)]),e("p",null,[k[10]||(k[10]=e("strong",null,"Ville :",-1)),w(" "+p(z(a).product.ville||"Non spécifiée"),1)]),e("p",null,[k[11]||(k[11]=e("strong",null,"Ajouté le :",-1)),w(" "+p(new Date(z(a).product.created_at).toLocaleDateString("fr-FR")),1)]),e("div",Ka,[e("div",Qa,[k[12]||(k[12]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,p(J((le=z(a).product.counts)==null?void 0:le.views_count))+" vues",1)]),e("div",Za,[e("i",{class:X(["fas fa-heart text-[10px]",{"text-[var(--espace-or)]":z(a).product.is_favorited_by}])},null,2),e("span",null,p(J((pe=z(a).product.counts)==null?void 0:pe.favorites_count))+" favoris",1)])])]),e("button",{onClick:I,class:"w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm mb-3","aria-label":z(a).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:X(["fas fa-heart mr-2 text-sm",{"text-[var(--espace-or)]":z(a).product.is_favorited_by}])},null,2),w(" "+p(z(a).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"),1)],8,Ya),e("div",er,[k[17]||(k[17]=e("h2",{class:"text-base font-semibold text-[var(--espace-vert)] mb-2 font-poppins"}," À propos du commerçant ",-1)),e("p",tr,[e("strong",null,p((me=z(a).product.commercant)==null?void 0:me.nom),1),(be=z(a).product.commercant)!=null&&be.verified?(t(),o("span",sr,k[13]||(k[13]=[e("i",{class:"fas fa-check-circle text-[10px]"},null,-1)]))):C("",!0)]),e("p",or,p(((ye=z(a).product.commercant)==null?void 0:ye.description)||"Aucune description disponible"),1),e("p",ar,[k[14]||(k[14]=e("strong",null,"Ville :",-1)),w(" "+p(((ke=z(a).product.commercant)==null?void 0:ke.ville)||"Nonspécifiée"),1)]),e("p",rr,[k[15]||(k[15]=e("strong",null,"Note :",-1)),w(" "+p(Number((Pe=z(a).product.commercant)==null?void 0:Pe.rating).toFixed(1)||"Non évalué")+" / 5 ",1)]),N(U,{to:`/commercants/${z(a).product.commercant_id}`,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline text-xs font-poppins","aria-label":"Voir le profil du commerçant"},{default:Q(()=>k[16]||(k[16]=[w(" Voir le profil du commerçant ")])),_:1,__:[16]},8,["to"])]),e("div",lr,[((je=(Se=z(s).user)==null?void 0:Se.commercant)==null?void 0:je.id)!==z(a).product.commercant_id?(t(),o("button",{key:0,onClick:P,class:"flex-1 bg-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] text-white transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le commerçant"},k[18]||(k[18]=[e("i",{class:"fas fa-phone mr-2 text-sm"},null,-1),w(" Contacter le commerçant ")]))):C("",!0),z(a).product.collaboratif&&((Me=(Ve=z(s).user)==null?void 0:Ve.commercant)==null?void 0:Me.id)!==z(a).product.commercant_id?(t(),o("button",{key:1,onClick:x,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Collaborer sur ce produit"},k[19]||(k[19]=[e("i",{class:"fas fa-handshake mr-2 text-sm"},null,-1),w(" Collaborer ")]))):C("",!0),((Oe=(_e=z(s).user)==null?void 0:_e.commercant)==null?void 0:Oe.id)===z(a).product.commercant_id?(t(),o("button",{key:2,onClick:F,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Modifier le produit"},k[20]||(k[20]=[e("i",{class:"fas fa-edit mr-2 text-sm"},null,-1),w(" Modifier le produit ")]))):C("",!0),((Je=(qe=z(s).user)==null?void 0:qe.commercant)==null?void 0:Je.id)===z(a).product.commercant_id?(t(),o("button",{key:3,onClick:re,class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] flex items-center justify-center gap-1 font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm",disabled:!!z(a).product.boosted_until&&new Date(z(a).product.boosted_until)>new Date,"aria-label":z(a).product.boosted_until&&new Date(z(a).product.boosted_until)>new Date?"Boost déjà actif":"Personnaliser le boost"},k[21]||(k[21]=[e("span",{class:"md:flex"},"Boost",-1),e("i",{class:"fas fa-rocket mr-2 text-sm"},null,-1)]),8,nr)):C("",!0),((Be=(We=z(s).user)==null?void 0:We.commercant)==null?void 0:Be.id)!==z(a).product.commercant_id?(t(),o("button",{key:4,onClick:k[0]||(k[0]=Re=>B(z(a).product.id,z(a).product.nom,z(a).product.commercant.user.id)),class:"flex-1 bg-green-500 text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-green-600 transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le vendeur"},k[22]||(k[22]=[e("i",{class:"fas fa-comment mr-2 text-sm"},null,-1),w(" Contacter le vendeur ")]))):C("",!0)])])])]}),_:1})])):(t(),o("div",ir," Produit non trouvé. ")),N(he,{name:"fade"},{default:Q(()=>[v.value?(t(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ae(L,["self"]),role:"dialog","aria-modal":"true","aria-label":"Proposer un prix de revente"},[e("div",ur,[e("h2",cr," Collaborer sur "+p(z(a).product.nom),1),e("p",dr," Proposez un prix de revente (minimum : "+p(z(a).product.prix+(z(a).product.marge_min||0))+" XAF) ",1),e("form",{onSubmit:ae(R,["prevent"]),class:"space-y-3"},[e("div",null,[k[23]||(k[23]=e("label",{for:"prix_revente",class:"text-xs text-[var(--espace-vert)] font-medium"},"Prix de revente (XAF)",-1)),O(e("input",{id:"prix_revente","onUpdate:modelValue":k[1]||(k[1]=H=>d.value=H),type:"number",min:"0",class:"w-full h-10 p-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition","aria-label":`Prix de revente pour ${z(a).product.nom}`,required:""},null,8,pr),[[G,d.value,void 0,{number:!0}]]),d.value?(t(),o("p",vr," Marge potentielle : "+p(d.value-z(a).product.prix)+" XAF ",1)):C("",!0)]),e("div",{class:"flex gap-3"},[k[24]||(k[24]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-xs","aria-label":"Envoyer la demande de collaboration"}," Envoyer ",-1)),e("button",{type:"button",onClick:L,class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):C("",!0)]),_:1}),N(he,{name:"fade"},{default:Q(()=>[y.value?(t(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:k[5]||(k[5]=ae(H=>y.value=!1,["self"])),role:"dialog","aria-modal":"true","aria-label":"Personnaliser le boost du produit"},[e("div",mr,[k[30]||(k[30]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4 font-poppins"}," Personnaliser le Boost ",-1)),e("form",{onSubmit:ae(se,["prevent"]),class:"space-y-6"},[e("div",null,[k[25]||(k[25]=e("label",{class:"text-sm text-[var(--espace-vert)] font-medium mb-2 block"},"Durée (jours)",-1)),O(e("input",{type:"range","onUpdate:modelValue":k[2]||(k[2]=H=>$.value=H),min:"1",max:"20",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--espace-or)]",onInput:S},null,544),[[G,$.value,void 0,{number:!0}]]),e("p",fr,p($.value)+" jours ",1)]),e("div",null,[k[26]||(k[26]=e("label",{class:"text-sm text-[var(--espace-vert)] font-medium mb-2 block"},"Objectif de vues",-1)),O(e("input",{type:"range","onUpdate:modelValue":k[3]||(k[3]=H=>b.value=H),min:"0",max:"4",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--espace-or)]",onInput:S},null,544),[[G,b.value,void 0,{number:!0}]]),e("p",gr,p(h[b.value])+" vues ",1)]),e("p",xr,[k[27]||(k[27]=w("Coût estimé : ")),e("strong",br,p(l.value),1),k[28]||(k[28]=w(" Jetons"))]),e("div",hr,[k[29]||(k[29]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm"}," Confirmer ",-1)),e("button",{type:"button",onClick:k[4]||(k[4]=H=>y.value=!1),class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):C("",!0)]),_:1})]),z(a).products?(t(),o("div",yr,[k[31]||(k[31]=e("h2",{class:"text-lg sm:text-xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"}," Produits similaires ",-1)),N(Ge,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},{default:Q(()=>[(t(!0),o(W,null,K(z(a).products,H=>(t(),ce(Te,{key:H.id,produit:H,onMouseover:Y=>n(H.id),onTouchstart:Y=>c(H.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:m,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":z(a).isLoading},[z(a).hasMore?C("",!0):(t(),o("p",wr," Aucun produit supplémentaire "))],8,_r)])):C("",!0)])],64)}}}),hu=te(kr,[["__scopeId","data-v-4335b260"]]),$r={class:"relative bg-green-500"},Cr={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] fixed top-0 left-0 w-full z-50 shadow-md"},Ar={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},Pr={class:"flex items-center gap-1 sm:gap-3"},Sr={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},jr=["aria-label"],Vr={class:"flex items-center gap-2"},Mr=["src"],zr={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},Er={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},Ir={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},Lr={class:"flex justify-around items-center py-2"},Fr=["aria-label"],Tr=ee({__name:"AppHeader",setup(E){var P;const a=ne(),_=Ie(),f=de(),s=a.user;$e();const u=g(!1),i=g(!1),v=g(!1),d=g(""),r=Le(),m=g(!1),y=g(null),$=g(!1),b=fe(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...a.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...a.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:_.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),l=async()=>{if(a.user)try{const x=await D.get("/user/badges");_.saveCollaborationsToLocalStorage(x.data.collaborations_pending.map(R=>({produit_id:R.produit_id,prix_revente:R.prix_revente,status:R.status,created_at:R.created_at})))}catch(x){console.error("Erreur lors du chargement des badges:",x)}};ue(()=>a.user,x=>{x&&(l(),_.initializeState())},{immediate:!0}),ue(()=>_.collaborationsPending,()=>{_.collaborationsPending>0&&(i.value=!0,setTimeout(()=>i.value=!1,300))});const h=async()=>{if(d.value.trim())try{await r.fetchProducts({search:d.value.trim()},!0),d.value="",m.value=!1}catch(x){console.error("Erreur lors de la recherche:",x)}},M=x=>{if($.value){$.value=!1;return}y.value&&!y.value.contains(x.target)&&(m.value=!1)},J=async()=>{m.value=!m.value,m.value&&($.value=!0,await De())},j=()=>{f.push("/messages")};return console.log("📩 header e reçu :"),(P=a.user)!=null&&P.id&&window.Echo.channel(`chat.${a.user.id}`).listen("MessageSent",x=>{var R;console.log("📩 header e reçu :",x.message),((R=a.user)==null?void 0:R.id)===x.receiver_id&&(console.log("📩 header e reçu :",x.message),_.saveUnreadMessagesToLocalStorage(x.unread_messages))}),ie(()=>{a.user&&(l(),_.initializeState()),document.addEventListener("click",M)}),Ce(()=>{document.removeEventListener("click",M)}),(x,R)=>{const L=xe("RouterLink");return t(),o("div",$r,[e("header",Cr,[e("div",Ar,[e("div",Pr,[N(L,{to:"/","aria-label":"Retour à l'accueil"},{default:Q(()=>R[2]||(R[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Ke,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),R[3]||(R[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"},null,-1))]),e("nav",Sr,[(t(!0),o(W,null,K(b.value,F=>(t(),ce(L,{key:F.to,to:F.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:Q(()=>[e("i",{class:X(["fas",F.icon])},null,2),w(" "+p(F.label)+" ",1),F.badge>0?(t(),o("span",{key:0,class:X(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":F.to==="/panier"&&u.value||F.to==="/collaborations"&&i.value||F.to==="/commandes"&&v.value}]),"aria-label":F.to==="/panier"?"Nombre d'articles dans le panier":F.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},p(F.badge),11,jr)):C("",!0)]),_:2},1032,["to"]))),128))]),N(Qe),e("div",Vr,[e("button",{onClick:J,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},R[4]||(R[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)])),e("button",{onClick:j,class:"text-[var(--espace-white)] px-1 rounded hover:bg-white transition"},R[5]||(R[5]=[e("i",{class:"fas fa-comment-dots text-2xl"},null,-1)])),(t(!0),o(W,null,K(b.value.filter(F=>z(a).user?F.to==="/profil":["/login","/register"].includes(F.to)),F=>(t(),ce(L,{key:F.to,to:F.to,class:"relative flex items-center justify-center","aria-label":F.label},{default:Q(()=>{var se;return[(se=z(s))!=null&&se.photo?(t(),o("img",{key:0,src:`http://localhost:8000/storage/${z(s).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,Mr)):(t(),o("div",zr,[e("i",{class:X([`fas ${F.icon}`,"text-2xl text-gray-100"])},null,2)])),F.badge>0&&F.to==="/collaborations"?(t(),o("span",{key:2,class:X(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":F.to==="/collaborations"&&i.value}]),"aria-label":"Collaborations en attente"},p(F.badge),3)):C("",!0)]}),_:2},1032,["to","aria-label"]))),128))])]),m.value?(t(),o("div",{key:0,ref_key:"searchOverlayRef",ref:y,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",Er,[O(e("input",{"onUpdate:modelValue":R[0]||(R[0]=F=>d.value=F),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Ue(h,["enter"])},null,544),[[G,d.value]]),e("button",{onClick:h,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},R[6]||(R[6]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:R[1]||(R[1]=F=>m.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},R[7]||(R[7]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):C("",!0)]),N(he,{name:"slide-up"},{default:Q(()=>[e("nav",Ir,[e("div",Lr,[(t(!0),o(W,null,K(b.value,F=>(t(),ce(L,{key:F.to,to:F.to,"aria-label":F.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:Q(()=>[e("i",{class:X(["fas text-lg",F.icon])},null,2),F.badge>0?(t(),o("span",{key:0,class:X(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":F.to==="/panier"&&u.value||F.to==="/collaborations"&&i.value||F.to==="/commandes"&&v.value}]),"aria-label":F.to==="/panier"?"Nombre d'articles dans le panier":F.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},p(F.badge),11,Fr)):C("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),Ze=te(Tr,[["__scopeId","data-v-e17b2a25"]]),Rr={class:"min-h-screen bg-gray-100",style:{background:"url(/src/assets/images/bginsc.jpg) center/cover"}},Ur={class:"container mx-auto px-4 sm:px-6 py-6"},Dr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Nr={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Or={key:0,class:"text-sm sm:text-base text-[var(--espace-gris)]"},qr={key:1,class:"text-sm sm:text-base text-[var(--espace-gris)]"},Jr={key:2,class:"text-sm text-[var(--espace-gris)] italic"},Wr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Br=["value"],Hr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Xr=["value"],Gr={class:"flex items-center gap-2 text-sm col-span-2 sm:col-span-1"},Kr=["value"],Qr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 border border-gray-100"},Zr={key:0,class:"flex items-center gap-3 text-[var(--espace-vert)]"},Yr={key:1,class:"text-base text-[var(--espace-gris)] italic"},el={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},tl=["onClick"],sl=ee({__name:"CommercantDashboard",setup(E){const a=oe(),_=g([]),f=g([]),s=g(null),u=g(!1),i=g({nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}),v=g({nom:"",description:"",ville:""}),d=g(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),r=async()=>{u.value=!0;try{const[b,l,h]=await Promise.all([D.get("/commercant/produits"),D.get("/categories"),D.get("/commercant/profil")]);u.value=!1,_.value=b.data.produits.map(M=>{var J;return{...M,commercant_id:((J=s.value)==null?void 0:J.id)||""}}),f.value=l.data.categories,s.value=h.data.commercant,v.value={nom:s.value.nom,description:s.value.description||"",ville:s.value.ville||""}}catch{a.error("Erreur lors du chargement des données."),u.value=!1}},m=async()=>{try{const b=await D.post("/commercant/produits",i.value);a.success("Produit ajouté avec succès."),r(),i.value={nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}}catch{a.error("Erreur lors de l’ajout du produit.")}},y=async b=>{if(confirm("Voulez-vous supprimer ce produit ?"))try{await D.delete(`/commercant/produits/${b}`),a.success("Produit supprimé avec succès."),r()}catch{a.error("Erreur lors de la suppression du produit.")}},$=async()=>{try{await D.put("/commercant/profil",v.value),a.success("Profil mis à jour avec succès."),r()}catch{a.error("Erreur lors de la mise à jour du profil.")}};return ie(()=>{r()}),(b,l)=>(t(),o("div",Rr,[N(Ze),e("div",Ur,[l[26]||(l[26]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] flex items-center gap-3 mb-6"},[e("i",{class:"fas fa-store text-xl"}),w(" Espace Commerçant ")],-1)),e("div",Dr,[l[14]||(l[14]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-3"},"Statistiques",-1)),e("div",Nr,[s.value?(t(),o("p",Or,[l[12]||(l[12]=e("span",{class:"font-medium"},"Revenus :",-1)),w(" "+p(s.value.revenus)+" FCFA ",1)])):C("",!0),s.value?(t(),o("p",qr,[l[13]||(l[13]=e("span",{class:"font-medium"},"Produits vendus :",-1)),w(" "+p(s.value.produits_vendus),1)])):(t(),o("p",Jr,"Chargement..."))])]),e("div",Wr,[l[17]||(l[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Profil Commerçant",-1)),e("form",{onSubmit:ae($,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[O(e("input",{"onUpdate:modelValue":l[0]||(l[0]=h=>v.value.nom=h),type:"text",placeholder:"Nom du commerçant",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[G,v.value.nom]]),O(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=h=>v.value.description=h),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[G,v.value.description]]),O(e("select",{"onUpdate:modelValue":l[2]||(l[2]=h=>v.value.ville=h),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2 sm:col-span-1"},[l[15]||(l[15]=e("option",{value:""},"Ville",-1)),(t(!0),o(W,null,K(d.value,h=>(t(),o("option",{key:h,value:h},p(h),9,Br))),128))],512),[[we,v.value.ville]]),l[16]||(l[16]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-check"})],-1))],32)]),e("div",Hr,[l[22]||(l[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Ajouter un produit",-1)),e("form",{onSubmit:ae(m,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[O(e("input",{"onUpdate:modelValue":l[3]||(l[3]=h=>i.value.nom=h),type:"text",placeholder:"Nom du produit",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[G,i.value.nom]]),O(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=h=>i.value.description=h),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[G,i.value.description]]),O(e("input",{"onUpdate:modelValue":l[5]||(l[5]=h=>i.value.prix=h),type:"number",placeholder:"Prix",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[G,i.value.prix]]),O(e("input",{"onUpdate:modelValue":l[6]||(l[6]=h=>i.value.photo_url=h),type:"text",placeholder:"URL de la photo",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[G,i.value.photo_url]]),O(e("select",{"onUpdate:modelValue":l[7]||(l[7]=h=>i.value.category_id=h),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[l[18]||(l[18]=e("option",{value:""},"Catégorie",-1)),(t(!0),o(W,null,K(f.value,h=>(t(),o("option",{key:h.id,value:h.id},p(h.nom),9,Xr))),128))],512),[[we,i.value.category_id]]),e("label",Gr,[O(e("input",{"onUpdate:modelValue":l[8]||(l[8]=h=>i.value.collaboratif=h),type:"checkbox"},null,512),[[He,i.value.collaboratif]]),l[19]||(l[19]=w(" Collaboratif "))]),O(e("input",{"onUpdate:modelValue":l[9]||(l[9]=h=>i.value.marge_min=h),type:"number",placeholder:"Marge minimum",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[G,i.value.marge_min]]),O(e("input",{"onUpdate:modelValue":l[10]||(l[10]=h=>i.value.stock=h),type:"number",placeholder:"Stock",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[G,i.value.stock]]),O(e("select",{"onUpdate:modelValue":l[11]||(l[11]=h=>i.value.ville=h),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[l[20]||(l[20]=e("option",{value:""},"Ville",-1)),(t(!0),o(W,null,K(d.value,h=>(t(),o("option",{key:h,value:h},p(h),9,Kr))),128))],512),[[we,i.value.ville]]),l[21]||(l[21]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-plus"})],-1))],32)]),e("div",Qr,[l[25]||(l[25]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Produits",-1)),u.value?(t(),o("div",Zr,l[23]||(l[23]=[e("i",{class:"fas fa-spinner animate-spin text-xl"},null,-1),e("span",{class:"text-base font-poppins"},"Chargement...",-1)]))):_.value.length===0?(t(),o("div",Yr," Aucun produit disponible. ")):(t(),o("div",el,[(t(!0),o(W,null,K(_.value,h=>(t(),o("div",{key:h.id,class:"relative"},[N(Te,{produit:h},null,8,["produit"]),e("button",{onClick:M=>y(h.id),class:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition flex items-center justify-center","aria-label":"Supprimer le produit"},l[24]||(l[24]=[e("i",{class:"fas fa-trash text-sm"},null,-1)]),8,tl)]))),128))]))])])]))}}),yu=te(sl,[["__scopeId","data-v-98a2ca3d"]]),ol={class:"overflow-y-scroll bg-gray-100 pt-2 pb-12 px-4 sm:px-6"},al={class:"container mx-auto max-w-4xl"},rl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},ll={key:0,class:"ml-2"},nl={class:"w-full bg-gray-200 rounded-full h-4"},il={class:"text-[var(--espace-gris)] text-xs mt-2"},ul={key:0,class:"text-[var(--espace-gris)] text-xs mt-1"},cl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},dl={key:0,class:"mb-4"},pl={class:"text-sm text-[var(--espace-gris)]"},vl={class:"font-bold text-[var(--espace-or)]"},ml={class:"text-sm text-[var(--espace-gris)] truncate"},fl=["href"],gl={key:1,class:"mb-4"},xl=["placeholder"],bl={class:"flex flex-col sm:flex-row gap-2"},hl=["disabled"],yl={key:0},_l={key:1},wl=["disabled"],kl={key:0},$l={key:1},Cl={key:2,class:"mt-4 flex flex-col sm:flex-row gap-2"},Al={class:"bg-white rounded-lg shadow-md p-6 mb-6"},Pl={class:"mb-4"},Sl={key:0,class:"overflow-x-auto"},jl={class:"w-full text-sm text-left text-[var(--espace-gris)]"},Vl=["onClick"],Ml={class:"px-4 py-2"},zl={class:"px-4 py-2"},El={key:1,class:"text-center text-[var(--espace-gris)] py-4"},Il={class:"bg-white rounded-lg shadow-md p-6 text-center"},Ll={class:"text-2xl sm:text-3xl font-bold text-[var(--espace-or)]"},Fl={class:"text-[var(--espace-gris)] mt-2"},Tl=ee({__name:"Parrainage",setup(E){const a=ne(),_=de(),f=oe(),s=()=>{const S=window.location.hostname;return S==="localhost"||S==="127.0.0.1"?"http://localhost:4000/register":"https://espacecameroun.devfack.com/register"},u=g(""),i=g(""),v=g([]),d=g(0),r=g(""),m=g(""),y=g(!1),$=g(!1),b=g({}),l=g(null),h=g(0),M=g(0),J=g(0),j=g("all"),P=fe(()=>{var S;return((S=b.value)==null?void 0:S.couleur)||"#6b7280"}),x=fe(()=>j.value==="commercants"?v.value.filter(S=>S.est_commercant):j.value==="nonCommercants"?v.value.filter(S=>!S.est_commercant):v.value),R=async()=>{if(!a.user){f.error("Veuillez vous connecter pour accéder à cette page"),_.push("/login");return}try{const n=(await D.get("/parrainages/dashboard")).data;u.value=n.code||"",i.value=u.value?`${s()}/${u.value}`:"",v.value=n.parrainages||[],d.value=n.total_gains||0,b.value=n.niveau_actuel,l.value=n.niveau_suivant,h.value=n.progression,M.value=n.total_parrainages||0,J.value=n.total_parrainages_commercants||0}catch(S){f.error("Erreur lors de la récupération des données de parrainage"),console.error(S)}},L=async()=>{if(!a.user){f.error("Veuillez vous connecter");return}y.value=!0;try{const S=await D.post("/parrainages/generateCode");r.value=S.data.suggested_code,m.value=r.value,f.success("Nouveau code suggéré avec succès !"),u.value&&(i.value=`${s()}/${u.value}`)}catch(S){f.error("Erreur lors de la génération du code"),console.error(S)}finally{y.value=!1}},F=async()=>{var S,n;if(!a.user){f.error("Veuillez vous connecter");return}if(!m.value.trim()){f.error("Veuillez entrer un code valide");return}$.value=!0;try{const c=await D.post("/parrainages/createCode",{code:m.value.trim()});u.value=c.data.code,i.value=c.data.link||`${s()}/${c.data.code}`,f.success(c.data.message||"Code créé avec succès !"),await R()}catch(c){f.error(((n=(S=c.response)==null?void 0:S.data)==null?void 0:n.message)||"Erreur lors de la création du code"),console.error(c)}finally{$.value=!1}},se=S=>{if(!i.value){f.error("Aucun lien disponible pour le partage");return}let n="";const c=encodeURIComponent(`Rejoins-moi sur Espace Cameroun avec mon lien : ${i.value}`);switch(S){case"whatsapp":n=`https://api.whatsapp.com/send?text=${c}`;break;case"facebook":n=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(i.value)}`;break;default:f.error("Plateforme non prise en charge");return}window.open(n,"_blank")},re=S=>{S.est_commercant?_.push(`/commercants/${S.id}`):_.push({name:"public-profile",params:{id:S.id}})};return ie(()=>{R()}),(S,n)=>{var c,A,I,B,T;return t(),o("div",ol,[e("div",al,[e("div",rl,[e("h2",{class:"text-lg font-semibold mb-4",style:ge({color:P.value})},"Niveaux de Parrainage",4),e("p",{class:"text-[var(--espace-gris)] text-sm mb-2 flex justify-between",style:ge({color:P.value})},[e("div",null,[n[5]||(n[5]=w(" Votre niveau actuel : ")),e("strong",null,p(b.value?b.value.nom:"Pas de niveau")+" "+p((c=b.value)==null?void 0:c.emoji)+" ("+p(J.value)+"/"+p(l.value?l.value.filleuls_requis:(A=b.value)==null?void 0:A.filleuls_requis)+" commerçants)",1)]),((I=l.value)==null?void 0:I.jetons_bonus)>0?(t(),o("span",ll,"+"+p((B=l.value)==null?void 0:B.jetons_bonus)+" jetons ",1)):C("",!0)],4),e("div",nl,[e("div",{class:"h-4 rounded-full bg-[var(--espace-or)] transition-all duration-300",style:ge({width:`${h.value}%`,background:`${P.value}`})},null,4)]),e("p",il," Prochain niveau : "+p(l.value?l.value.nom:"Légende 🏆")+" à "+p(l.value?l.value.filleuls_requis:"1000+")+" commerçants ",1),(T=b.value.avantages)!=null&&T.length?(t(),o("p",ul," Avantages : "+p(b.value.avantages.join(", ")),1)):C("",!0),e("button",{onClick:n[0]||(n[0]=q=>z(_).push("/parrainage/info")),class:"mt-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},n[6]||(n[6]=[e("i",{class:"fas fa-info-circle mr-2"},null,-1),w(" En savoir plus ")]))]),n[24]||(n[24]=e("div",{class:"bg-white rounded-lg shadow-md p-6 mb-6"},[e("p",{class:"text-[var(--espace-gris)] text-sm sm:text-base"}," Invitez des amis avec votre lien ou code unique et gagnez des récompenses ! Atteignez des niveaux supérieurs pour débloquer des jetons et des avantages. ")],-1)),e("div",cl,[n[15]||(n[15]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Votre Code de Parrainage",-1)),u.value?(t(),o("div",dl,[e("p",pl,[n[7]||(n[7]=w(" Code : ")),e("span",vl,p(u.value),1)]),e("p",ml,[n[8]||(n[8]=w(" Lien : ")),e("a",{href:i.value,target:"_blank",class:"text-blue-500 underline hover:text-blue-700"},p(i.value),9,fl)])])):(t(),o("div",gl,[O(e("input",{"onUpdate:modelValue":n[1]||(n[1]=q=>m.value=q),type:"text",placeholder:r.value||"Entrez ou générez un code (ex: DOM2025)",class:"w-full p-2 border rounded mb-2 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",maxlength:"10"},null,8,xl),[[G,m.value]]),e("div",bl,[e("button",{onClick:L,disabled:y.value,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition flex-1 disabled:opacity-50"},[y.value?(t(),o("span",yl,n[9]||(n[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),w(" Génération... ")]))):(t(),o("span",_l,n[10]||(n[10]=[e("i",{class:"fas fa-magic mr-2"},null,-1),w(" Générer un code ")])))],8,hl),e("button",{onClick:F,disabled:$.value||!m.value.trim(),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1 disabled:opacity-50"},[$.value?(t(),o("span",kl,n[11]||(n[11]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),w(" Création... ")]))):(t(),o("span",$l,n[12]||(n[12]=[e("i",{class:"fas fa-check mr-2"},null,-1),w(" Créer le code ")])))],8,wl)])])),u.value?(t(),o("div",Cl,[e("button",{onClick:n[2]||(n[2]=q=>se("whatsapp")),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1"},n[13]||(n[13]=[e("i",{class:"fab fa-whatsapp mr-2"},null,-1),w(" Partager sur WhatsApp ")])),e("button",{onClick:n[3]||(n[3]=q=>se("facebook")),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition flex-1"},n[14]||(n[14]=[e("i",{class:"fab fa-facebook-f mr-2"},null,-1),w(" Partager sur Facebook ")]))])):C("",!0)]),e("div",Al,[n[18]||(n[18]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Utilisateurs Parrainés",-1)),e("div",Pl,[O(e("select",{"onUpdate:modelValue":n[4]||(n[4]=q=>j.value=q),class:"w-full sm:w-1/3 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},n[16]||(n[16]=[e("option",{value:"all"},"Tous",-1),e("option",{value:"commercants"},"Commerçants",-1),e("option",{value:"nonCommercants"},"Non Commerçants",-1)]),512),[[we,j.value]])]),x.value.length?(t(),o("div",Sl,[e("table",jl,[n[17]||(n[17]=e("thead",{class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)]"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Nom"),e("th",{class:"px-4 py-2"},"Date d'inscription"),e("th",{class:"px-4 py-2"},"Est commerçant")])],-1)),e("tbody",null,[(t(!0),o(W,null,K(x.value,q=>(t(),o("tr",{key:q.id,class:"border-b hover:bg-gray-50"},[e("td",{class:"px-4 py-2 cursor-pointer text-blue-500 hover:underline",onClick:Z=>re(q)},p(q.filleul_nom||"Anonyme"),9,Vl),e("td",Ml,p(new Date(q.date_inscription).toLocaleDateString("fr-FR")),1),e("td",zl,p(q.est_commercant?"Oui":"Non"),1)]))),128))])])])):(t(),o("p",El," Aucun utilisateur parrainé correspondant au filtre. Commencez à inviter dès maintenant ! "))]),e("div",Il,[n[22]||(n[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2"},"Vos Gains",-1)),e("p",Ll,p(d.value)+" jetons ",1),e("p",Fl,[n[19]||(n[19]=w(" 🎉 Vous avez invité ")),e("strong",null,p(M.value),1),n[20]||(n[20]=w(" utilisateurs, dont ")),e("strong",null,p(J.value),1),n[21]||(n[21]=w(" sont commerçants ! "))]),n[23]||(n[23]=e("p",{class:"text-[var(--espace-gris)] mt-2"}," Débloquez plus de jetons et d'avantages en atteignant les niveaux supérieurs. ",-1))])])])}}}),_u=te(Tl,[["__scopeId","data-v-fa541dd4"]]),Rl={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Ul={class:"container mx-auto max-w-4xl"},Dl={class:"flex border-b border-gray-300 mb-6"},Nl={key:0},Ol={key:0,class:"grid grid-cols-1 gap-4"},ql={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Jl=["onClick"],Wl={class:"text-sm text-[var(--espace-gris)]"},Bl={class:"text-sm text-[var(--espace-gris)]"},Hl=["onClick"],Xl={class:"flex flex gap-2"},Gl=["onClick"],Kl=["onClick"],Ql=["onClick"],Zl={key:1,class:"text-center text-[var(--espace-gris)]"},Yl={key:1},en={key:0,class:"grid grid-cols-1 gap-4"},tn={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},sn=["onClick"],on={class:"text-sm text-[var(--espace-gris)]"},an={class:"text-sm text-[var(--espace-gris)]"},rn=["onClick"],ln=["onClick"],nn={key:1,class:"text-center text-[var(--espace-gris)]"},un=ee({__name:"Collaborations",setup(E){const a=y=>{localStorage.setItem("pending_collaborations",JSON.stringify(y))},_=oe(),f=de(),s=g({sent_collaborations:[],received_collaborations:[]}),u=g(!0),i=g("received"),v=async()=>{try{const y=await D.get("/collaborations");console.log(y.data),s.value=y.data;const $=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");if($.length>0){const b=new Set(s.value.sent_collaborations.map(h=>h.produit_id)),l=$.filter(h=>!b.has(h.produit_id));l.length!==$.length&&(a(l),console.log("Collaborations en attente nettoyées dans localStorage"))}}catch{_.error("Erreur lors du chargement des collaborations")}finally{u.value=!1}},d=y=>{f.push({path:`/produits/${y}`})},r=y=>{var b,l,h;const $=((b=y.commercant)==null?void 0:b.id)||((h=(l=y.produit)==null?void 0:l.commercant)==null?void 0:h.id);$?f.push({path:`/commercants/${$}`}):_.error("Profil du commerçant non disponible")},m=async(y,$)=>{var b;try{const l=await D.post(`/collaborations/${y}`,{statut:$});_.success(l.data.message),await v()}catch(l){console.log(l.response.data.message),_.error(`Erreur lors de la mise à jour de la collaboration${(b=l.response)==null?void 0:b.data.message}`)}};return ie(()=>{u.value=!0,v()}),(y,$)=>(t(),o(W,null,[N(Ae,{isLoading:u.value},null,8,["isLoading"]),e("div",Rl,[e("div",Ul,[$[4]||($[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-handshake mr-2 text-[var(--espace-or)]"}),w(" Mes Collaborations ")],-1)),e("div",Dl,[e("button",{class:X(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":i.value==="received","text-[var(--espace-gris)]":i.value!=="received"}]),onClick:$[0]||($[0]=b=>i.value="received")}," Collaborations reçues ",2),e("button",{class:X(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":i.value==="sent","text-[var(--espace-gris)]":i.value!=="sent"}]),onClick:$[1]||($[1]=b=>i.value="sent")}," Collaborations envoyées ",2)]),i.value==="received"?(t(),o("div",Nl,[s.value.received_collaborations.length?(t(),o("div",Ol,[(t(!0),o(W,null,K(s.value.received_collaborations,b=>(t(),o("div",{key:b.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",ql,[e("div",null,[e("h2",{onClick:l=>d(b.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},p(b.produit.nom),9,Jl),e("p",Wl," Prix de revente proposé : "+p(b.prix_revente)+" FCFA ",1),e("p",Bl,[$[2]||($[2]=w(" Statut : ")),e("span",{class:X({"text-green-600":b.statut==="valider","text-yellow-600":b.statut==="en_attente","text-red-600":b.statut==="refuser"})},p(b.statut==="en_attente"?"En attente":b.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:l=>r(b),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,Hl)]),e("div",Xl,[b.statut==="en_attente"?(t(),o("button",{key:0,onClick:l=>m(b.id,"valider"),class:"bg-green-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-green-700 transition text-xs sm:text-sm"}," Valider ",8,Gl)):C("",!0),b.statut==="en_attente"?(t(),o("button",{key:1,onClick:l=>m(b.id,"refuser"),class:"bg-red-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-red-700 transition text-xs sm:text-sm"}," Rejeter ",8,Kl)):C("",!0),e("button",{onClick:l=>d(b.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,Ql)])])]))),128))])):(t(),o("p",Zl," Aucune collaboration reçue pour le moment. "))])):C("",!0),i.value==="sent"?(t(),o("div",Yl,[s.value.sent_collaborations.length?(t(),o("div",en,[(t(!0),o(W,null,K(s.value.sent_collaborations,b=>(t(),o("div",{key:b.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",tn,[e("div",null,[e("h2",{onClick:l=>d(b.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},p(b.produit.nom),9,sn),e("p",on," Prix de revente proposé : "+p(b.prix_revente)+" FCFA ",1),e("p",an,[$[3]||($[3]=w(" Statut : ")),e("span",{class:X({"text-green-600":b.statut==="valider","text-yellow-600":b.statut==="en_attente","text-red-600":b.statut==="refuser"})},p(b.statut==="en_attente"?"En attente":b.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:l=>r(b),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,rn)]),e("button",{onClick:l=>d(b.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,ln)])]))),128))])):(t(),o("p",nn," Aucune collaboration envoyée pour le moment. "))])):C("",!0)])])],64))}}),wu=te(un,[["__scopeId","data-v-61e28846"]]),cn={class:"overflow-y-scroll bg-gray-100"},dn={class:"container mx-auto px-4 sm:px-6 py-8"},pn={key:0,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mb-8 border border-gray-100 overflow-hidden"},vn={class:"flex flex-col sm:flex-row items-center gap-6"},mn={class:"w-24 h-24 bg-[var(--espace-or)] rounded-full flex items-center justify-center overflow-hidden"},fn=["src"],gn={key:1,class:"fas fa-user text-3xl text-[var(--espace-vert)]"},xn={class:"flex-1"},bn={class:"text-3xl font-bold text-[var(--espace-vert)] mb-2 text-center"},hn={class:"text-sm text-[var(--espace-gris)] mb-1"},yn={class:"text-sm text-[var(--espace-gris)] mb-1"},_n={class:"text-sm text-[var(--espace-gris)]"},wn={key:0,class:"text-sm text-[var(--espace-gris)]"},kn={class:"mt-2 flex space-x-2 flex-col"},$n={class:"text-sm text-[var(--espace-gris)]"},Cn={class:"text-xs text-[var(--espace-gris)]"},An={class:"mt-4 flex flex-col sm:flex-row gap-4"},Pn={class:"mt-4 flex flex-wrap gap-4"},Sn={class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},jn={key:0,class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},Vn={key:1,class:"text-base text-[var(--espace-gris)] italic"},Mn={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},zn={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},En={class:"flex items-center space-x-2"},In={key:3},Ln={key:4,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-4 border border-gray-100"},Fn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},Tn={key:5,class:"text-base text-[var(--espace-gris)] italic"},Rn={key:6,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-8 border border-gray-100"},Un={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Dn={class:"text-sm text-[var(--espace-gris)]"},Nn={class:"text-sm text-[var(--espace-gris)]"},On=ee({__name:"CommercantDetails",setup(E){const a=$e(),_=oe(),f=g(!1),s=g(null),u=g(null),i=g(0),v=g(0),d=g(!1),r=async()=>{f.value=!0;try{const b=await D.get(`/commercant/${a.params.commercantId}`);console.log(b.data),s.value=b.data.commercant,i.value=b.data.average_rating||0,v.value=b.data.vote_count||0,s.value.produits||console.warn("Aucun produit trouvé dans la réponse de l'API pour ce commerçant.")}catch{_.error("Erreur lors du chargement des détails du commerçant.")}finally{f.value=!1}},m=async()=>{var b,l;if(u.value===null||u.value<1||u.value>5){_.error("Veuillez sélectionner une note entre 1 et 5.");return}try{const h=await D.post(`/commercant/${a.params.commercantId}/rate`,{rating:u.value});i.value=h.data.average_rating||0,_.success("Merci pour votre note !"),u.value=null,d.value=!1,v.value=h.data.vote_count||v.value+1}catch(h){_.error(((l=(b=h.response)==null?void 0:b.data)==null?void 0:l.message)||"Erreur lors de la notation.")}},y=fe(()=>{var b;return((b=s.value)==null?void 0:b.produits)||[]}),$=()=>{d.value=!0};return ie(async()=>{r()}),(b,l)=>{const h=xe("router-link");return t(),o(W,null,[N(Ae,{isLoading:f.value},null,8,["isLoading"]),e("div",cn,[N(Ze),e("div",dn,[s.value?(t(),o("div",pn,[e("div",vn,[e("div",mn,[s.value.photo_url?(t(),o("img",{key:0,src:s.value.photo_url,alt:"Photo du commerçant",class:"w-full h-full object-cover"},null,8,fn)):(t(),o("i",gn))]),e("div",xn,[e("h1",bn," Commerçant : "+p(s.value.nom),1),e("p",hn,[l[2]||(l[2]=e("strong",null,"Ville :",-1)),w(" "+p(s.value.ville),1)]),e("p",yn,[l[3]||(l[3]=e("strong",null,"Inscrit depuis :",-1)),w(" "+p(new Date(s.value.created_at).toLocaleDateString()),1)]),e("p",_n,[l[4]||(l[4]=e("strong",null,"Contact :",-1)),w(" "+p(s.value.email||"Non disponible"),1)]),s.value.telephone?(t(),o("p",wn,[l[5]||(l[5]=e("strong",null,"Téléphone :",-1)),w(" "+p(s.value.telephone),1)])):C("",!0),e("div",kn,[e("div",{class:"flex items-center space-x-1 cursor-pointer",onClick:$},[(t(),o(W,null,K(5,M=>e("span",{key:M,class:"relative text-yellow-400 w-5 h-5"},[l[6]||(l[6]=e("i",{class:"far fa-star absolute left-0 top-0"},null,-1)),e("i",{class:"fas fa-star absolute left-0 top-0 overflow-hidden",style:ge({width:M<=Math.floor(i.value)?"100%":M===Math.ceil(i.value)&&i.value%1!==0?`${i.value%1*100}%`:"0%"})},null,4)])),64)),e("p",$n,p(Number(i.value).toFixed(1))+"/5 ",1)]),e("span",Cn,"("+p(v.value)+" votes)",1)])])]),e("div",An,[N(h,{to:`/chat/${s.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:Q(()=>l[7]||(l[7]=[e("i",{class:"fas fa-comment mr-2"},null,-1),w(" Envoyer un message ")])),_:1,__:[7]},8,["to"]),N(h,{to:`/public-profile/${s.value.user_id||s.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:Q(()=>l[8]||(l[8]=[e("i",{class:"fas fa-user mr-2"},null,-1),w(" Voir Profil Public ")])),_:1,__:[8]},8,["to"])]),e("div",Pn,[e("span",Sn,"Produits : "+p(y.value.length),1),s.value.revenus?(t(),o("span",jn,"Revenus : "+p(s.value.revenus)+" FCFA",1)):C("",!0)])])):f.value?C("",!0):(t(),o("div",Vn,"Commerçant non trouvé.")),d.value?(t(),o("div",Mn,[e("div",zn,[l[9]||(l[9]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Noter ce Commerçant",-1)),e("div",En,[O(e("input",{"onUpdate:modelValue":l[0]||(l[0]=M=>u.value=M),type:"number",min:"1",max:"5",step:"1",class:"w-16 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"1-5"},null,512),[[G,u.value,void 0,{number:!0}]]),e("button",{onClick:m,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Soumettre "),e("button",{onClick:l[1]||(l[1]=M=>d.value=!1),class:"bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors ml-2"}," Annuler ")])])])):C("",!0),f.value?(t(),o("div",In)):y.value.length>0?(t(),o("div",Ln,[l[10]||(l[10]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-6"},"Produits du Commerçant",-1)),e("div",Fn,[(t(!0),o(W,null,K(y.value,M=>(t(),ce(Te,{key:M.id,produit:M},null,8,["produit"]))),128))])])):s.value&&y.value.length===0?(t(),o("div",Tn,"Aucun produit disponible pour ce commerçant.")):C("",!0),s.value&&s.value.statistiques?(t(),o("div",Rn,[l[13]||(l[13]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Statistiques",-1)),e("div",Un,[e("p",Dn,[l[11]||(l[11]=e("strong",null,"Vues totales :",-1)),w(" "+p(s.value.statistiques.total_views),1)]),e("p",Nn,[l[12]||(l[12]=e("strong",null,"Produits populaires :",-1)),w(" "+p(s.value.statistiques.popular_products),1)])])])):C("",!0)])])],64)}}}),ku=te(On,[["__scopeId","data-v-e97faea3"]]),qn={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Jn={class:"container mx-auto max-w-2xl"},Wn={class:"bg-white rounded-lg shadow-md p-6"},Bn={key:0,class:"text-red-500 text-xs"},Hn={key:0,class:"text-red-500 text-xs"},Xn={key:0,class:"text-red-500 text-xs"},Gn={key:0,class:"text-red-500 text-xs"},Kn={key:0,class:"text-red-500 text-xs"},Qn=["disabled"],Zn={key:0},Yn={key:1},ei=ee({__name:"CommercantCreate",setup(E){const a=de(),_=oe(),f=g({nom:"",ville:"",email:"",telephone:"",photo:null}),s=g(!1),u=g({}),i=d=>{const r=d.target;r.files&&r.files[0]&&(f.value.photo=r.files[0])},v=async()=>{var d,r;s.value=!0,u.value={};try{const m=new FormData;m.append("nom",f.value.nom),m.append("ville",f.value.ville),m.append("email",f.value.email),m.append("telephone",f.value.telephone),f.value.photo&&m.append("photo",f.value.photo);const y=await D.post("/commercants",m,{headers:{"Content-Type":"multipart/form-data"}});console.log(y.data.message),_.success("Commerçant créé avec succès !"),a.push("/profil")}catch(m){(r=(d=m.response)==null?void 0:d.data)!=null&&r.errors?u.value=m.response.data.errors:_.error("Erreur lors de la création du commerçant"),console.error(m)}finally{s.value=!1}};return(d,r)=>(t(),o("div",qn,[e("div",Jn,[r[11]||(r[11]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-store mr-2 text-[var(--espace-or)]"}),w(" Créer un Commerçant ")],-1)),e("div",Wn,[e("form",{onSubmit:ae(v,["prevent"]),class:"space-y-6"},[e("div",null,[r[4]||(r[4]=e("label",{for:"nom",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom *",-1)),O(e("input",{"onUpdate:modelValue":r[0]||(r[0]=m=>f.value.nom=m),id:"nom",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerçant",required:""},null,512),[[G,f.value.nom]]),u.value.nom?(t(),o("span",Bn,p(u.value.nom),1)):C("",!0)]),e("div",null,[r[5]||(r[5]=e("label",{for:"ville",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Ville *",-1)),O(e("input",{"onUpdate:modelValue":r[1]||(r[1]=m=>f.value.ville=m),id:"ville",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville",required:""},null,512),[[G,f.value.ville]]),u.value.ville?(t(),o("span",Hn,p(u.value.ville),1)):C("",!0)]),e("div",null,[r[6]||(r[6]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),O(e("input",{"onUpdate:modelValue":r[2]||(r[2]=m=>f.value.email=m),id:"email",type:"email",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"email@exemple.com"},null,512),[[G,f.value.email]]),u.value.email?(t(),o("span",Xn,p(u.value.email),1)):C("",!0)]),e("div",null,[r[7]||(r[7]=e("label",{for:"telephone",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Téléphone",-1)),O(e("input",{"onUpdate:modelValue":r[3]||(r[3]=m=>f.value.telephone=m),id:"telephone",type:"tel",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"+237 6XX XX XX XX"},null,512),[[G,f.value.telephone]]),u.value.telephone?(t(),o("span",Gn,p(u.value.telephone),1)):C("",!0)]),e("div",null,[r[8]||(r[8]=e("label",{for:"photo",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Photo (optionnel)",-1)),e("input",{id:"photo",type:"file",onChange:i,class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",accept:"image/*"},null,32),u.value.photo?(t(),o("span",Kn,p(u.value.photo),1)):C("",!0)]),e("div",null,[e("button",{type:"submit",disabled:s.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition disabled:opacity-50"},[s.value?(t(),o("span",Zn,r[9]||(r[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),w(" Création en cours... ")]))):(t(),o("span",Yn,r[10]||(r[10]=[e("i",{class:"fas fa-plus mr-2"},null,-1),w(" Créer le commerçant ")])))],8,Qn)])],32)])])]))}}),$u=te(ei,[["__scopeId","data-v-0c50a6f0"]]),ti={class:"overflow-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},si={class:"container mx-auto max-w-4xl"},oi={class:"text-md font-semibold text-white flex items-center"},ai={class:"ml-2 text-sm text-white/80"},ri={class:"text-white/90 text-sm mt-2"},li={key:0,class:"text-white/90 text-sm mt-1"},ni={class:"list-disc list-inside ml-4"},ii=ee({__name:"ParrainageInfo",setup(E){const a=de(),_=oe(),f=g([]),s=async()=>{try{const i=await D.get("/parrainages/niveaux");f.value=i.data.niveaux}catch(i){_.error("Erreur lors de la récupération des niveaux de parrainage"),console.error(i)}},u=()=>{a.go(-1)};return ie(()=>{s()}),(i,v)=>(t(),o("div",ti,[e("div",si,[v[4]||(v[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-info-circle mr-2 text-[var(--espace-or)]"}),w(" Tout Savoir sur le Parrainage ")],-1)),e("button",{onClick:u,class:"mb-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},v[0]||(v[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),w(" Retour ")])),v[5]||(v[5]=Ee('<div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-9d89fe08><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-9d89fe08>Qu&#39;est-ce que le Parrainage ?</h2><p class="text-[var(--espace-gris)] text-sm sm:text-base" data-v-9d89fe08> Le système de parrainage d&#39;Espace Cameroun vous permet d&#39;inviter des amis avec votre code ou lien unique. Vos gains dépendent des <strong data-v-9d89fe08>niveaux de parrainage</strong>, débloqués par le nombre de commerçants parrainés, avec des bonus en jetons cumulatifs. Plus vous parrainez, plus vous montez de niveau ! Découvrez les détails ci-dessous. </p></div><div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-9d89fe08><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-9d89fe08>Comment ça fonctionne ?</h2><ol class="list-decimal list-inside text-[var(--espace-gris)] text-sm sm:text-base space-y-2" data-v-9d89fe08><li data-v-9d89fe08><strong data-v-9d89fe08>Obtenez votre code unique :</strong> Générez ou créez votre code de parrainage via la page &quot;Mon Parrainage&quot;.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Partagez avec vos amis :</strong> Diffusez votre lien ou code via WhatsApp, Facebook ou d&#39;autres moyens pour inviter des amis à s&#39;inscrire.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Attirez des commerçants :</strong> Encouragez vos filleuls à devenir des commerçants actifs sur la plateforme. Seuls les commerçants parrainés comptent pour débloquer les niveaux.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Montez de niveau :</strong> Chaque niveau nécessite un nombre spécifique de commerçants parrainés. Une fois le seuil atteint, vous débloquez un bonus en jetons correspondant à ce niveau, en plus des bonus des niveaux précédents.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Suivez vos progrès :</strong> Consultez votre niveau actuel, vos jetons bonus et vos avantages exclusifs sur la page &quot;Mon Parrainage&quot;.</li></ol><p class="text-[var(--espace-gris)] text-sm mt-4" data-v-9d89fe08><strong data-v-9d89fe08>Note importante :</strong> Les jetons bonus sont cumulatifs et attribués en fonction des niveaux atteints, pas directement par parrainage individuel. Par exemple, si vous atteignez le niveau 2 avec 5 commerçants, vous recevez les bonus des niveaux 1 et 2. </p></div>',2)),(t(!0),o(W,null,K(f.value,d=>(t(),o("div",{key:d.id,class:"mb-6 p-4 border rounded-lg",style:ge({backgroundColor:d.couleur||"#f0f0f0"})},[e("h3",oi,[w(p(d.nom)+" "+p(d.emoji)+" ",1),e("span",ai,"("+p(d.filleuls_requis)+" commerçants requis)",1)]),e("p",ri,[v[1]||(v[1]=e("strong",null,"Bonus en jetons :",-1)),w(" "+p(d.jetons_bonus)+" jetons ",1)]),d.avantages.length?(t(),o("p",li,[v[2]||(v[2]=e("strong",null,"Avantages exclusifs :",-1)),e("ul",ni,[(t(!0),o(W,null,K(d.avantages,r=>(t(),o("li",{key:r},p(r),1))),128))])])):C("",!0),v[3]||(v[3]=e("p",{class:"text-white/70 text-xs mt-1 italic"}," * Les jetons bonus sont crédités une fois le niveau atteint et cumulés avec les niveaux précédents. ",-1))],4))),128))])]))}}),Cu=te(ii,[["__scopeId","data-v-9d89fe08"]]),ui={class:"w-full flex relative px-0"},ci=["onClick"],di={class:"flex items-center"},pi=["onClick"],vi=["src"],mi={key:1,class:"fas fa-user-circle text-2xl text-gray-500"},fi={class:"min-w-0"},gi={class:"font-semibold text-[var(--espace-vert)] truncate"},xi={class:"text-xs text-[var(--espace-gris)] truncate"},bi={class:"flex items-center"},hi={key:0,class:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center mr-2"},yi={class:"text-xs text-[var(--espace-gris)] ml-2 whitespace-nowrap"},_i={class:"w-full grid grid-rows-[10%_86%]"},wi={class:"flex border-b"},ki={key:1,class:"text-xl h-[10%] font-semibold text-[var(--espace-vert)] p-4"},$i={key:0,class:"h-full flex flex-col"},Ci={class:"block text-[var(--espace-vert)]"},Ai={class:"text-gray-800"},Pi={class:"text-xs text-[var(--espace-gris)] text-right mr-2"},Si={key:0,class:"text-center text-[var(--espace-gris)]"},ji={class:"px-2 md:px-4 z-20"},Vi={class:"bg-white shadow-lg rounded-full flex items-center flex-wrap p-2 border max-w-3xl mx-auto gap-2"},Mi={key:0,class:"bg-yellow-200 text-yellow-800 text-xs px-3 py-1 rounded-full flex items-center gap-2 ml-4"},zi={key:1,class:"flex items-center justify-center h-full"},Ei=ee({__name:"Messages",setup(E){const a=()=>{const T=window.location.hostname;return T==="localhost"||T==="127.0.0.1"?"http://localhost:8000/storage/":"https://espacecameroun.devfack.com/storage/"},_=fe(()=>a()),f=de(),s=$e(),u=ne(),i=oe(),v=Ie(),d=g([]),r=g([]),m=g(null),y=g(""),$=g(!0),b=g(0),l=g(!1),h=g(!1),M=g(null),J=g(null),j=g(window.innerWidth<768);let P=null;const x=()=>{De(()=>{var T;(T=M.value)==null||T.scrollTo({top:M.value.scrollHeight,behavior:"smooth"})})},R=()=>{J.value=null,localStorage.removeItem("chatProduct")},L=async()=>{try{const T=await D.get("/conversations");d.value=T.data.conversations,console.log(T.data)}catch(T){i.error("Erreur lors de la récupération des conversations"),console.error(T)}},F=async(T,q=!0)=>{var Z,V,k;if(!h.value){h.value=!0;try{q&&(b.value=0,r.value=[]),$.value=!1;const U=await D.get(`/chat/${T}?offset=${b.value}`);r.value=[...U.data.messages],l.value=U.data.hasMore;const H=localStorage.getItem("chatProduct"),Y=d.value.find(me=>me.user_id===T);let le="",pe="/default-avatar.png";Y?(le=Y.is_commercant?Y.name:((Z=U.data.user)==null?void 0:Z.nom)||"",pe=Y.profile_photo||"/default-avatar.png"):H?(le=JSON.parse(H).commercant_name||((V=U.data.user)==null?void 0:V.nom)||"",pe=(Y==null?void 0:Y.profile_photo)||"/default-avatar.png"):le=((k=U.data.user)==null?void 0:k.nom)||"",m.value={user_id:T,name:le,is_commercant:(Y==null?void 0:Y.is_commercant)||!1,profile_photo:pe},H&&(J.value=JSON.parse(H)),await c(T),x()}catch(U){i.error("Erreur lors du chargement des messages"),console.error(U)}finally{h.value=!1}}},se=T=>{f.push({name:"messages",params:{receiverId:T}}),j.value&&($.value=!1)},re=async()=>{var Z,V,k,U,H,Y,le,pe,me,be;if(!y.value.trim()||!m.value){i.error("Veuillez sélectionner une conversation et écrire un message");return}const T=y.value.trim(),q={id:-Date.now(),sender_id:(Z=u.user)==null?void 0:Z.id,receiver_id:m.value.user_id,content:T,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_read:!1,product_id:((V=J.value)==null?void 0:V.id)||null,sender:{id:((k=u.user)==null?void 0:k.id)??0,nom:((U=u.user)==null?void 0:U.nom)??"",email:((H=u.user)==null?void 0:H.email)??"",telephone:((Y=u.user)==null?void 0:Y.telephone)??"",ville:((le=u.user)==null?void 0:le.ville)??"",premium:((pe=u.user)==null?void 0:pe.premium)??!1,parrain_id:((me=u.user)==null?void 0:me.parrain_id)??0},receiver:{id:m.value.user_id,nom:m.value.name,email:null,telephone:null,ville:null,premium:!1,parrain_id:null},product:J.value||null};r.value.push(q),y.value="",x();try{const ye=await D.post(`/chat/${m.value.user_id}`,{content:T,product_id:(be=J.value)==null?void 0:be.id});console.log(ye.data),J.value&&R()}catch(ye){i.error("Échec d'envoi"),console.error(ye),r.value=r.value.filter(ke=>ke.id!==q.id)}},S=()=>{!M.value||!l.value||h.value||M.value.scrollTop<=100&&(b.value+=30,F(m.value.user_id,!1))},n=()=>{j.value=window.innerWidth<768,$.value=window.innerWidth>=768},c=async T=>{try{const q=await D.put("/messages/mark-all-as-read");v.saveUnreadMessagesToLocalStorage(q.data.unread_messages)}catch(q){console.error("Erreur lors du marquage des messages comme lus:",q),i.error("Erreur lors de la mise à jour des messages lus")}},A=()=>{$.value=!$.value},I=(T,q)=>{const Z=q?`/commercants/${T}`:`/users/${T}`;f.push(Z)},B=T=>{var q;P&&(P.stopListening("MessageSent"),window.Echo.leave(`chat.${P.params.receiverId}`)),T&&((q=u.user)!=null&&q.id)&&(console.log("🔔 Abonnement au canal chat."+T),P=window.Echo.channel("public-channel").listen("message.sent",Z=>{var V,k;if(console.log("📩 Nouveau message reçu :",Z.message),((V=m.value)==null?void 0:V.user_id)===T&&Z.sender_id!==((k=u.user)==null?void 0:k.id)){const U={id:Z.message.id,sender_id:Z.sender_id,receiver_id:Z.receiver_id,content:Z.message.content,created_at:Z.message.created_at,updated_at:Z.message.updated_at,is_read:Z.message.is_read,product_id:Z.message.product_id||null,sender:Z.sender,receiver:Z.receiver,product:Z.message.product||null};r.value.push(U),x(),v.saveUnreadMessagesToLocalStorage(Z.unread_messages)}}),P.params={receiverId:T})};return ie(()=>{L(),s.params.receiverId&&F(parseInt(s.params.receiverId)),window.addEventListener("resize",n)}),Ce(()=>{P&&(P.stopListening("MessageSent"),window.Echo.leave(`chat.${P.params.receiverId}`)),window.removeEventListener("resize",n)}),ue(()=>{var T;return(T=m.value)==null?void 0:T.user_id},T=>{T&&B(T)}),ue(()=>s.params.receiverId,async T=>{T&&await F(parseInt(T))}),(T,q)=>{var V,k;const Z=xe("router-link");return t(),o("div",ui,[N(he,{name:"slide-fade"},{default:Q(()=>[$.value||!j.value?(t(),o("div",{key:0,class:X(["bg-white pt-8 shadow-md p-4 overflow-y-auto transition-all",j.value?"absolute top-0 left-0 h-full z-30 w-full":"w-[400px]"])},[q[1]||(q[1]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Conversations",-1)),(t(!0),o(W,null,K(d.value,U=>(t(),o("div",{key:U.user_id,onClick:H=>se(U.user_id),class:"p-2 hover:bg-gray-100 cursor-pointer rounded flex items-center justify-between transition-colors"},[e("div",di,[e("div",{onClick:ae(H=>I(U.user_id,U.is_commercant),["stop"]),class:"w-10 h-10 bg-[var(--espace-or)] rounded-full mr-2 flex items-center justify-center overflow-hidden cursor-pointer"},[U.profile_photo?(t(),o("img",{key:0,src:_.value+U.profile_photo,alt:"Photo de profil",class:"w-full h-full object-cover"},null,8,vi)):(t(),o("i",mi))],8,pi),e("div",fi,[e("p",gi,p(U.name),1),e("p",xi,p(U.last_message),1)])]),e("div",bi,[U.unread_count>0?(t(),o("div",hi,p(U.unread_count),1)):C("",!0),e("div",yi,p(new Date(U.updated_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)])],8,ci))),128))],2)):C("",!0)]),_:1}),e("div",_i,[e("div",wi,[!$.value&&j.value&&m.value?(t(),o("button",{key:0,onClick:A,class:"text-green-900 p-2 rounded-full hover:bg-[var(--espace-or)] transition text-start"},q[2]||(q[2]=[e("i",{class:"fas fa-arrow-left text-2xl"},null,-1)]))):C("",!0),m.value?(t(),o("h2",ki,p(m.value.name),1)):C("",!0)]),e("div",{class:X(["bg-white shadow-md transition-all duration-300 flex flex-col flex-1 h-full overflow-hidden w-full",$.value&&!j.value?"":"rounded-r-lg"]),onScroll:S},[m.value?(t(),o("div",$i,[e("div",{ref_key:"messagesContainer",ref:M,class:"h-full flex-1 overflow-y-auto p-2 md:p-4 space-y-3 bg-gray-50 messages-container"},[(t(!0),o(W,null,K(r.value,U=>{var H,Y,le;return t(),o("div",{key:U.id,class:X(["p-3 rounded-full break-words",{"bg-blue-200 ml-auto max-w-[85%] md:max-w-[70%]":U.sender_id===((H=z(u).user)==null?void 0:H.id),"bg-gray-200 max-w-[85%] md:max-w-[70%]":U.sender_id!==((Y=z(u).user)==null?void 0:Y.id)}])},[e("strong",Ci,p(U.sender.nom)+" :",1),e("p",Ai,[(le=U.product)!=null&&le.id?(t(),ce(Z,{key:0,to:{name:"produit",params:{id:U.product.id}},class:"text-blue-500 underline hover:text-blue-700 ml-1"},{default:Q(()=>[w("[Produit "+p(U.product.nom)+"]",1)]),_:2},1032,["to"])):C("",!0),w(" "+p(U.content),1)]),e("p",Pi,p(new Date(U.created_at).toLocaleTimeString()),1)],2)}),128)),h.value?(t(),o("div",Si,"Chargement...")):C("",!0)],512),e("div",ji,[e("div",Vi,[(V=J.value)!=null&&V.id?(t(),o("span",Mi,[w(" Produit "+p((k=J.value)==null?void 0:k.nom)+" ",1),e("button",{onClick:R,class:"ml-2 text-yellow-800 hover:text-red-600 font-bold",title:"Retirer le tag"}," × ")])):C("",!0),O(e("input",{"onUpdate:modelValue":q[0]||(q[0]=U=>y.value=U),onKeyup:Ue(re,["enter"]),type:"text",placeholder:"Écrivez votre message...",class:"flex-1 px-4 py-2 rounded-full focus:outline-none text-gray-700 text-sm placeholder-gray-400 min-w-[100px] md:min-w[200px]"},null,544),[[G,y.value]]),e("button",{onClick:re,class:"ml-2 p-3 rounded-full bg-[var(--espace-vert)] text-white hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},q[3]||(q[3]=[e("i",{class:"fas fa-location-arrow text-lg"},null,-1)]))])])])):(t(),o("div",zi,q[4]||(q[4]=[e("p",{class:"text-[var(--espace-gris)] text-lg"},"Sélectionnez une conversation pour commencer.",-1)])))],34)])])}}}),Au=te(Ei,[["__scopeId","data-v-81cfc639"]]),Ii={class:"mx-auto max-w-4xl py-5 px-4 flex flex-col gap-3"},Li={key:0,class:"overflow-y-scroll space-y-4"},Fi={class:"flex justify-between items-center"},Ti={class:"text-lg font-semibold"},Ri={class:"text-gray-600"},Ui={class:"text-gray-600"},Di={class:"text-gray-600"},Ni={class:"text-gray-600"},Oi={class:"text-gray-600"},qi={key:0,class:"text-gray-600"},Ji={class:"text-right"},Wi=["onClick"],Bi={key:1,class:"text-gray-500"},Hi={class:"mt-6 flex gap-4"},Xi={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Gi=ee({__name:"JetonHistory",setup(E){const _=ne().user,f=g([]),s=g(!1),u=oe(),i=async()=>{try{const r=await D.get(`/jeton-transactions/${_==null?void 0:_.id}`);console.log(r.data),f.value=r.data}catch(r){console.error("Erreur lors du chargement des transactions:",r)}},v=r=>new Date(r).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),d=async r=>{var m,y;if(console.log("Refaire la transaction:",r),!!confirm(`Refaire l'achat de ${r.nombre_jetons} jetons avec le même service (${r.methode_paiement}) ?`)){s.value=!0;try{const $=await D.post("/acheter-jetons",{nombre_jetons:r.nombre_jetons,payment_service:r.methode_paiement,phone_number:r.phone_number});u.success($.data.message),i()}catch($){u.error(((y=(m=$.response)==null?void 0:m.data)==null?void 0:y.message)||"Erreur lors de l'achat."),console.error($)}finally{s.value=!1}}};return ie(()=>{_&&i()}),(r,m)=>{const y=xe("router-link");return t(),o("div",Ii,[m[4]||(m[4]=e("h1",{class:"text-3xl font-bold text-[var(--espace-vert)]"},"Historique des Transactions de Jetons",-1)),f.value.length>0?(t(),o("div",Li,[(t(!0),o(W,null,K(f.value,$=>(t(),o("div",{key:$.id,class:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow"},[e("div",Fi,[e("div",null,[e("p",Ti,"Achat de "+p($.nombre_jetons)+" jetons",1),e("p",Ri,"Montant: "+p($.montant)+" FCFA",1),e("p",Ui,"Méthode: "+p($.methode_paiement),1),e("p",Di,"Numéro: "+p($.phone_number),1),e("p",Ni,"Statut: "+p($.statut),1),e("p",Oi,"Date: "+p(v($.date_transaction)),1),$.transaction_id_mesomb?(t(),o("p",qi," ID Transaction: "+p($.transaction_id_mesomb),1)):C("",!0)]),e("div",Ji,[e("button",{onClick:b=>d($),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] mr-2"},m[0]||(m[0]=[e("i",{class:"fas fa-redo"},null,-1),w(" Refaire ")]),8,Wi)])])]))),128))])):(t(),o("p",Bi,"Aucune transaction trouvée.")),e("div",Hi,[N(y,{to:"/acheter-jetons",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:Q(()=>m[1]||(m[1]=[w(" Acheter des Jetons ")])),_:1,__:[1]}),N(y,{to:"/commercant/produits",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:Q(()=>m[2]||(m[2]=[w(" Booster un Produit ")])),_:1,__:[2]})]),s.value?(t(),o("div",Xi,m[3]||(m[3]=[Ee('<div class="bg-white p-6 rounded-lg shadow-lg text-center" data-v-4d0a432e><p class="text-lg text-[var(--espace-vert)]" data-v-4d0a432e>Veuillez patienter...</p><svg class="animate-spin h-8 w-8 text-[var(--espace-vert)] mx-auto mt-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-4d0a432e><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-4d0a432e></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" data-v-4d0a432e></path></svg></div>',1)]))):C("",!0)])}}}),Pu=te(Gi,[["__scopeId","data-v-4d0a432e"]]),Ki={class:"min-h-screen bg-gray-100 py-8 sm:px-6"},Qi={class:"container mx-auto max-w-3xl bg-white rounded-lg shadow-md p-6"},Zi={class:"flex flex-col sm:flex-row items-center gap-6 mb-6"},Yi={class:"relative"},eu=["src"],tu={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-xl p-1 rounded-full"},su={class:"flex-1"},ou={class:"text-gray-600"},au={key:0,class:"text-sm text-gray-500"},ru={class:"text-gray-600"},lu={class:"text-gray-600"},nu=ee({__name:"ProfilePublic",setup(E){const a=$e(),_=de(),f=oe(),s=g(null),u=async()=>{try{const v=await D.get(`/profile/public/${a.params.id}`);s.value=v.data}catch(v){f.error("Erreur lors de la récupération du profil."),console.error(v)}},i=()=>{var v;(v=s.value)!=null&&v.id?_.push({name:"messages",params:{receiverId:s.value.id}}):f.error("Impossible d'accéder au chat. Profil invalide.")};return ie(()=>{u()}),(v,d)=>{var r,m,y,$,b,l,h,M,J,j,P,x,R,L,F,se,re,S,n,c,A,I;return t(),o("div",Ki,[e("div",Qi,[e("div",Zi,[e("div",Yi,[(r=s.value)!=null&&r.photo?(t(),o("img",{key:0,src:`http://localhost:8000/storage/${(m=s.value)==null?void 0:m.photo}`,alt:"Photo de profil",class:"w-24 h-24 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,eu)):(t(),o("div",{key:1,class:"w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:ge({background:`${((l=(b=($=(y=s.value)==null?void 0:y.niveaux_users)==null?void 0:$.at(-1))==null?void 0:b.parrainage_niveau)==null?void 0:l.couleur)||"#0af"}`})},d[0]||(d[0]=[e("i",{class:"fas fa-user-circle text-5xl"},null,-1)]),4)),(h=s.value)!=null&&h.premium?(t(),o("i",tu)):C("",!0)]),e("div",su,[e("h1",{class:"text-3xl font-bold flex items-center gap-2",style:ge({color:`${((P=(j=(J=(M=s.value)==null?void 0:M.niveaux_users)==null?void 0:J.at(-1))==null?void 0:j.parrainage_niveau)==null?void 0:P.couleur)||"#0af"}`})},[w(p((x=s.value)==null?void 0:x.nom)+" ",1),(R=s.value)!=null&&R.premium?(t(),o("span",{key:0,class:"text-white text-sm px-2 py-1 rounded-full uppercase font-semibold",style:ge({background:`${((re=(se=(F=(L=s.value)==null?void 0:L.niveaux_users)==null?void 0:F.at(-1))==null?void 0:se.parrainage_niveau)==null?void 0:re.couleur)||"#0af"}`})}," Premium ",4)):C("",!0)],4),e("p",ou,"Statut : "+p((S=s.value)!=null&&S.commercant?"Commerçant":"Utilisateur"),1),(n=s.value)!=null&&n.subscription_ends_at?(t(),o("p",au," Abonnement Premium jusqu'au "+p(new Date((c=s.value)==null?void 0:c.subscription_ends_at).toLocaleDateString()),1)):C("",!0),e("p",ru,"Ville : "+p((A=s.value)==null?void 0:A.ville),1),e("p",lu,"Téléphone : "+p((I=s.value)==null?void 0:I.telephone),1)]),e("div",{class:"mt-6 flex justify-center"},[e("button",{onClick:i,class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},d[1]||(d[1]=[e("i",{class:"fas fa-comments mr-2"},null,-1),w(" Discuter ")]))])]),d[2]||(d[2]=e("div",{class:"mt-6 text-center"},[e("p",{class:"text-gray-700"},"Ce profil affiche les informations publiques de l'utilisateur.")],-1))])])}}}),Su=te(nu,[["__scopeId","data-v-eef19e07"]]);export{Ks as A,mu as C,pu as F,du as H,Pu as J,vu as L,Au as M,gu as P,fu as R,bu as a,ku as b,$u as c,yu as d,xu as e,_u as f,Cu as g,hu as h,wu as i,Su as j,ne as u};
