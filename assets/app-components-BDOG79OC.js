import{u as ue,r as m,a as de,d as ae,w as xe,o as be,b as ge,c as s,e as C,f as I,g as t,h as e,i as N,j as X,k as w,t as v,l as me,m as je,n as Se,p as pe,F as H,q as Z,s as G,T as ye,v as ne,x as we,y as R,z as Y,A as ke,B as Je,C as Ae,D as Be,E as Ye,G as Ze,H as et,I as Oe,J as He,K as Ge}from"./vue-D8sETJ_c.js";import{d as Ne}from"./pinia-BwnFEm41.js";import{a as Fe}from"./axios-Dq7h7Pqt.js";const Xe="/assets/logoOrangeweb-C9Cko1mf.webp",tt=()=>{const U=window.location.hostname;return U==="localhost"||U==="127.0.0.1"?"http://localhost:8000/v1":"https://api.espacecameroun.com/v1"};Fe.defaults.withCredentials=!0;Fe.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";Fe.defaults.withXSRFToken=!0;const D=Fe.create({withCredentials:!0,baseURL:tt(),headers:{Accept:"application/json","Content-Type":"application/json"}}),he=Ne("auth",{state:()=>({user:null,token:localStorage.getItem("token")||null}),actions:{async login(U){const i=await D.post("/login",U);this.user=i.data.user,this.token=i.data.token,localStorage.setItem("token",this.token??""),D.defaults.headers.common.Authorization=`Bearer ${this.token}`},async register(U){const i=await D.post("/register",U);this.user=i.data.user,this.token=i.data.token,localStorage.setItem("token",this.token??""),D.defaults.headers.common.Authorization=`Bearer ${this.token}`},async checkAuth(){if(!this.token)return!1;try{D.defaults.headers.common.Authorization=`Bearer ${this.token}`;const U=await D.get("/user");return this.user=U.data.user,!0}catch(U){return console.error("utilisateur non:",U),this.user=null,this.token=null,localStorage.removeItem("token"),!1}},async logout(){try{this.token&&await D.post("/logout")}catch{}this.user=null,this.token=null,localStorage.removeItem("token"),delete D.defaults.headers.common.Authorization}}}),De=ue(),Ie=Ne("userState",()=>{const U=m(0),i=m(0),b=de(),f=()=>{const n=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");U.value=n.length;const d=localStorage.getItem("unread_messages");i.value=d?parseInt(d,10):0},c=n=>{localStorage.setItem("pending_collaborations",JSON.stringify(n)),U.value=n.length},r=n=>{localStorage.setItem("unread_messages",n.toString()),i.value=n},a=async n=>{var P,$,A;const d=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");d.push({produit_id:n.produit_id,prix_revente:n.prix_revente,status:"pending",created_at:new Date().toISOString()}),c(d);try{return await D.post("/collaborations",{produit_id:n.produit_id,prix_revente:n.prix_revente}),await l(),b.success("Demande de collaboration envoyée !"),!0}catch(h){(($=(P=h.response)==null?void 0:P.data)==null?void 0:$.message)=="Unauthenticated."&&De.push("login");const o=d.filter(u=>!(u.produit_id===n.produit_id&&u.prix_revente===n.prix_revente));return c(o),b.error(((A=h.response)==null?void 0:A.data.message)||"Erreur lors de la demande de collaboration"),!1}},l=async()=>{var n,d;try{const P=await D.get("/user/badges");U.value=P.data.collaborations_pending,r(P.data.unread_messages||0)}catch(P){((d=(n=P.response)==null?void 0:n.data)==null?void 0:d.message)=="Unauthenticated."&&De.push("login"),console.error("Erreur lors de la synchronisation des badges:",P)}};return{collaborationsPending:U,unreadMessages:i,initializeState:f,addCollaboration:a,syncCollaborationsWithBackend:l,clearState:()=>{localStorage.removeItem("pending_collaborations"),localStorage.removeItem("unread_messages"),U.value=0,i.value=0},saveCollaborationsToLocalStorage:c,saveUnreadMessagesToLocalStorage:r}}),qe=ue(),Ve=Ne("product",{state:()=>({product:{},products:[],isLoading:!1,hasMore:!0,page:1,sort:"random",userId:null,relatedProperties:[]}),getters:{user:U=>he().user},actions:{async fetchProducts(U={},i=!1,b=!1){var f,c,r,a;if(!(this.isLoading||!i&&!this.hasMore&&!b)){this.isLoading=!0,(i||b)&&(this.products=[],this.page=1,this.hasMore=!0);try{const l=await D.get("/produits",{params:{...U,page:this.page,sort:this.sort}});if(console.log("Réponse API:",l.data),!l.data||typeof l.data!="object")throw new Error("Réponse API invalide");if(U.per_page==="all"||b)this.products=i?l.data:[...this.products,...l.data];else{const p=l.data.data||[];if(!Array.isArray(p))throw new Error("Les données des produits ne sont pas un tableau");this.products=i?p:[...this.products,...p],this.hasMore=l.data.current_page<(l.data.last_page||1),this.page=l.data.current_page+1}}catch(l){if(console.error("Erreur lors du fetch:",l),((c=(f=l.response)==null?void 0:f.data)==null?void 0:c.message)==="Unauthenticated.")qe.push("login");else throw((a=(r=l.response)==null?void 0:r.data)==null?void 0:a.message)||"Erreur lors du chargement des produits"}finally{this.isLoading=!1}}},async toggleFavorite(U){var c,r;const i=he();if(!i.user&&(await i.checkAuth(),!i.user)){console.warn("Utilisateur non connecté, redirection ou action nécessaire");return}const b=this.products.find(a=>a.id===U);let f=!1;b&&(b.is_favorited_by=!b.is_favorited_by,b.counts.favorites_count=b.is_favorited_by?b.counts.favorites_count+1:b.counts.favorites_count-1,f=!0),this.product&&this.product.id===U&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count+1:this.product.counts.favorites_count-1,f=!0);try{const a=await D.post(`/produits/${U}/favorite`),l=a.data.produit;if(f){const p=this.products.findIndex(n=>n.id===U);p!==-1&&(this.products[p]={...this.products[p],...l}),this.product&&this.product.id===U&&(this.product={...this.product,...l})}return a.data.message}catch(a){if(((r=(c=a.response)==null?void 0:c.data)==null?void 0:r.message)==="Unauthenticated."&&qe.push("login"),console.error("Erreur toggleFavorite:",a),f){const l=this.products.find(p=>p.id===U);l&&(l.is_favorited_by=!l.is_favorited_by,l.counts.favorites_count=l.is_favorited_by?l.counts.favorites_count-1:l.counts.favorites_count+1),this.product&&this.product.id===U&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count-1:this.product.counts.favorites_count+1)}}},async viewProduct(U){var i,b,f,c;try{const r=await D.get(`/produits/${U}`);this.product=r.data.produit;const a=this.products.findIndex(l=>l.id===U);a!==-1?this.products[a]={...this.products[a],...this.product}:this.products.push(this.product)}catch(r){throw((b=(i=r.response)==null?void 0:i.data)==null?void 0:b.message)==="Unauthenticated."&&qe.push("login"),((c=(f=r.response)==null?void 0:f.data)==null?void 0:c.message)||"Erreur lors du chargement du produit"}},setSort(U){this.sort=U,this.page=1,this.products=[],this.hasMore=!0,this.fetchProducts({},!0)},setUserId(U){this.userId=U}}}),st={key:0,class:"fixed top-16 right-4 z-50 flex items-center gap-2 rounded-full px-4 py-2"},ot={class:"text-sm font-semibold text-[var(--espace-vert)]"},at={class:"text-gray-800"},rt=ae({__name:"SoldeUser",setup(U){ue();const i=he(),b=m(0),f=async()=>{if(i.user)try{b.value=i.user.jetons}catch(c){console.error("Erreur lors de la récupération des jetons:",c)}};return xe(()=>i.user,()=>{f()}),be(()=>{f()}),(c,r)=>{const a=ge("router-link");return I(i).user?(t(),s("div",st,[r[1]||(r[1]=e("i",{class:"fas fa-coins text-[var(--espace-or)] text-lg"},null,-1)),e("span",ot,[N(a,{to:"/jeton-history"},{default:X(()=>[r[0]||(r[0]=w(" Jetons : ")),e("span",at,v(b.value),1)]),_:1,__:[0]})])])):C("",!0)}}}),re=(U,i)=>{const b=U.__vccOpts||U;for(const[f,c]of i)b[f]=c;return b},Ke=re(rt,[["__scopeId","data-v-a9413d7d"]]),lt={class:"relative bg-[var(--espace-vert)] w-full"},nt={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] top-0 left-0 z-50 shadow-md h-full"},it={class:"px-2 w-full sm:px-3 py-2 flex justify-between items-center gap-4 mb-4"},ut={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},dt=["aria-label"],ct={class:"flex items-center gap-2"},pt=["src"],vt={key:1,class:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-[var(--espace-gris)]"},mt={class:"fixed bottom-33 right-6 z-50 bg-blue-300 w-10 h-10 rounded-full flex items-center justify-center hover:bg-blue-400 active:scale-95 transition-all shadow-lg"},ft=ae({__name:"HeaderBar",setup(U){const i=()=>{const o=window.location.hostname;return o==="localhost"||o==="127.0.0.1"?"http://localhost:8000/storage/":"https://api.espacecameroun.com/storage/"},b=me(()=>i()),f=he(),c=Ie();ue();const r=me(()=>f.user);je();const a=m(!1),l=m(!1);m(""),Ve();const p=m(!1),n=m(null),d=m(!1),P=me(()=>[...r.value?[{to:"/",label:"Accueil",icon:"fa-home",badge:0},{to:"/messages",label:"Chat",icon:"fa-comment-dots",badge:c.unreadMessages},...r.value.commercant?[{to:"/commercant/produits",label:"Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:c.collaborationsPending},{to:"/parrainage",label:"equipe",icon:"fa-users",badge:0},{to:"/parametres",label:"Parametres",icon:"fa-cog"}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),$=async()=>{if(r.value)try{await c.syncCollaborationsWithBackend()}catch(o){console.error("Erreur lors du chargement des badges:",o)}},A=async()=>{if(!r.value&&f.token)try{await f.checkAuth()}catch(o){console.error("Erreur lors de la récupération de l'utilisateur:",o),f.logout()}r.value&&await $()};xe(()=>c.collaborationsPending,o=>{o>-1&&(a.value=!0,setTimeout(()=>a.value=!1,300))}),xe(()=>c.unreadMessages,o=>{o>-1&&(l.value=!0,setTimeout(()=>l.value=!1,300))});const h=o=>{if(d.value){d.value=!1;return}n.value&&!n.value.contains(o.target)&&(p.value=!1)};return be(async()=>{var o;await A(),document.addEventListener("click",h),(o=f.user)!=null&&o.id&&window.Echo.channel(`chat.${f.user.id}`).listen("MessageSent",u=>{var y;((y=f.user)==null?void 0:y.id)===u.receiver_id&&c.saveUnreadMessagesToLocalStorage(u.unread_messages)})}),Se(()=>{var o;document.removeEventListener("click",h),(o=f.user)!=null&&o.id&&window.Echo.leave(`chat.${f.user.id}`)}),(o,u)=>{const y=ge("RouterLink"),S=ge("router-link");return t(),s("div",lt,[e("header",nt,[e("div",it,[N(y,{to:"/","aria-label":"Retour à l'accueil"},{default:X(()=>u[0]||(u[0]=[e("div",{class:"flex items-center gap-1 sm:gap-3"},[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Xe,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})]),e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ")],-1)])),_:1,__:[0]}),e("nav",ut,[(t(!0),s(H,null,Z(P.value,T=>(t(),pe(y,{key:T.to,to:T.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:X(()=>[e("i",{class:G(["fas",T.icon])},null,2),w(" "+v(T.label)+" ",1),T!=null&&T.badge&&T.badge>-1?(t(),s("span",{key:0,class:G(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":T.to==="/collaborations"&&a.value||T.to==="/messages"&&l.value}]),"aria-label":T.to==="/collaborations"?"Collaborations en attente":T.to==="/messages"?"Messages non lus":""},v(T.badge),11,dt)):C("",!0)]),_:2},1032,["to"]))),128))]),N(Ke),e("div",ct,[r.value?(t(),pe(y,{key:0,to:"/messages",class:"relative flex items-center justify-center","aria-label":"Messages"},{default:X(()=>[u[1]||(u[1]=e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},[e("i",{class:"fas fa-comment-dots text-2xl text-white"})],-1)),I(c).unreadMessages>-1?(t(),s("span",{key:0,class:G(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":l.value}]),"aria-label":"Messages non lus"},v(I(c).unreadMessages),3)):C("",!0)]),_:1,__:[1]})):C("",!0),r.value?(t(),pe(y,{key:1,to:"/profil",class:"relative flex items-center justify-center","aria-label":"Profil"},{default:X(()=>{var T;return[(T=r.value)!=null&&T.photo?(t(),s("img",{key:0,src:b.value+r.value.photo,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,pt)):(t(),s("div",vt,u[2]||(u[2]=[e("i",{class:"fas fa-user-circle text-2xl text-gray-500"},null,-1)])))]}),_:1})):C("",!0)]),r.value?(t(),pe(S,{key:0,to:"/jetonMarket","aria-label":"Aller au marché",class:"fixed bottom-17 z-10 right-5 w-12 h-12 rounded-full flex items-center justify-center bg-[var(--espace-vert)] text-yellow-300 shadow-lg hover:scale-110 active:scale-95 transition-all ring-2 ring-yellow-400/60"},{default:X(()=>u[3]||(u[3]=[e("i",{class:"fas fa-coins text-xl"},null,-1)])),_:1,__:[3]})):C("",!0),e("div",mt,[N(S,{to:"/doc",class:"text-[var(--espace-vert)] text-3xl hover:text-[var(--espace-or)] transition-transform transform hover:scale-110"},{default:X(()=>u[4]||(u[4]=[w(" ? ")])),_:1,__:[4]})])])])])}}}),mc=re(ft,[["__scopeId","data-v-56652892"]]),gt={class:"relative"},bt={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},xt={class:"flex justify-around items-center py-2"},ht=["aria-label"],yt=ae({__name:"FooterBar",setup(U){const i=he(),b=Ie();ue();const f=m(!1),c=m(!1),r=me(()=>[...i.user?[{to:"/",label:"Accueil",icon:"fa-home"},...i.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open"},{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:b.collaborationsPending}]:[],{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users"},{to:"/parametres",label:"Parametres",icon:"fa-cog"}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt"},{to:"/register",label:"Inscription",icon:"fa-user-plus"}]]);return xe(()=>b.collaborationsPending,a=>{a>0&&(f.value=!0,setTimeout(()=>f.value=!1,300))}),xe(()=>b.unreadMessages,a=>{a>0&&(c.value=!0,setTimeout(()=>c.value=!1,300))}),(a,l)=>{const p=ge("RouterLink");return t(),s("div",gt,[N(ye,{name:"slide-up"},{default:X(()=>[e("nav",bt,[e("div",xt,[(t(!0),s(H,null,Z(r.value,n=>(t(),pe(p,{key:n.to,to:n.to,"aria-label":n.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:X(()=>[e("i",{class:G(["fas text-lg",n.icon])},null,2),n!=null&&n.badge&&n.badge>-1?(t(),s("span",{key:0,class:G(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":n.to==="/collaborations"&&f.value||n.to==="/messages"&&c.value}]),"aria-label":n.to==="/collaborations"?"Collaborations en attente":n.to==="/messages"?"Messages non lus":""},v(n.badge),11,ht)):C("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),fc=re(yt,[["__scopeId","data-v-8779b672"]]),_t={class:"mb-4"},wt={class:"block text-sm sm:text-base font-medium mb-1 text-[var(--espace-gris)]"},kt={class:"relative"},$t={class:"absolute inset-y-0 left-3 flex items-center text-[var(--espace-or)]"},Ct=["type","value","required","placeholder"],At={key:0,class:"text-red-500 text-sm mt-1"},_e=ae({__name:"Form",props:{label:String,icon:String,type:{type:String,default:"text"},modelValue:[String,Number],required:Boolean,placeholder:String,error:String},emits:["update:modelValue"],setup(U){return(i,b)=>(t(),s("div",_t,[e("label",wt,v(U.label),1),e("div",kt,[e("span",$t,[e("i",{class:G(`fas ${U.icon}`)},null,2)]),e("input",{type:U.type,value:U.modelValue,onInput:b[0]||(b[0]=f=>i.$emit("update:modelValue",f.target.value)),required:U.required,placeholder:U.placeholder,class:G(["w-full pl-10 pr-4 py-3 rounded-xl border text-sm sm:text-base transition","focus:outline-none focus:ring-2",U.error?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-[var(--espace-or)]"])},null,42,Ct)]),U.error?(t(),s("p",At,v(U.error),1)):C("",!0)]))}}),Pt={class:"overflow-y-scroll flex items-center justify-center px-4 py-4"},jt={class:"w-full max-w-lg bg-gray-30 rounded-2xl shadow-xl p-6 sm:p-10"},St=["disabled"],Mt={key:0,class:"fas fa-spinner fa-spin mr-2"},Vt={key:1,class:"fas fa-sign-in-alt mr-2"},Et={class:"text-center text-sm text-gray-600 mt-6"},zt=ae({__name:"Login",setup(U){const i=m({login:"",mot_de_passe:""}),b=m({}),f=ue(),c=de(),r=he(),a=m(!1),l=async()=>{var p;try{a.value=!0,await r.login({login:i.value.login,mot_de_passe:i.value.mot_de_passe}),c.success("Connexion réussie !"),f.push({name:"home"})}catch(n){console.error("Erreur lors de la connexion:",n);const d=n.message||"Erreur lors de la connexion. Veuillez vérifier vos informations.";c.error(d),((p=n.response)==null?void 0:p.status)===422&&(b.value=n.response.data.errors||{})}finally{a.value=!1}};return(p,n)=>{const d=ge("router-link");return t(),s("div",Pt,[e("div",jt,[n[4]||(n[4]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-sign-in-alt mr-2 text-[var(--espace-or)]"}),w(" Connexion ")],-1)),n[5]||(n[5]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[w(" Connectez-vous à "),e("strong",null,"Espace Cameroun"),w(" pour accéder à vos achats et votre espace commerçant. ")],-1)),e("form",{onSubmit:ne(l,["prevent"]),class:"space-y-5"},[N(_e,{label:"Email ou Téléphone",icon:"fa-envelope",modelValue:i.value.login,"onUpdate:modelValue":n[0]||(n[0]=P=>i.value.login=P),type:"text",required:"",error:b.value.login},null,8,["modelValue","error"]),N(_e,{label:"Mot de passe",icon:"fa-lock",modelValue:i.value.mot_de_passe,"onUpdate:modelValue":n[1]||(n[1]=P=>i.value.mot_de_passe=P),type:"password",required:"",error:b.value.mot_de_passe},null,8,["modelValue","error"]),e("button",{type:"submit",disabled:a.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center shadow-md disabled:opacity-60 disabled:cursor-not-allowed"},[a.value?(t(),s("i",Mt)):(t(),s("i",Vt)),e("span",null,v(a.value?"Connexion...":"Se connecter"),1)],8,St)],32),e("p",Et,[n[3]||(n[3]=w(" Pas de compte ? ")),N(d,{to:"/register",class:"text-[var(--espace-vert)] font-medium hover:text-[var(--espace-or)] hover:underline"},{default:X(()=>n[2]||(n[2]=[w(" Inscrivez-vous ici ")])),_:1,__:[2]})])])])}}}),gc=re(zt,[["__scopeId","data-v-cc090487"]]),Ut="/assets/logo-ba4eAQQi.png",It={key:0,class:"fixed inset-0 bg-[var(--espace-white)] bg-opacity-50 flex items-center justify-center z-50","aria-label":"Chargement en cours",role:"status"},Ft=ae({__name:"Loader",props:{isLoading:{type:Boolean}},setup(U){return(i,b)=>(t(),pe(ye,{name:"fade"},{default:X(()=>[i.isLoading?(t(),s("div",It,b[0]||(b[0]=[e("div",{class:"relative p-6"},[e("img",{src:Ut,alt:"Logo Espace Cameroun",class:"h-12 w-12 object-contain animate-spin-pulse"}),e("div",{class:"absolute inset-0 rounded-full border-4 border-[var(--espace-or)] border-t-transparent animate-spin"})],-1)]))):C("",!0)]),_:1}))}}),Me=re(Ft,[["__scopeId","data-v-f60cc94a"]]),Lt={class:"h-full bg-gray-100 pt-5 px-4 sm:px-2 pb-16"},Tt={class:"h-full w-full overflow-y-scroll"},qt={key:0},Ot={key:1,class:"grid grid-cols-1 pt-4 pb-2 lg:pb-12 md:grid-cols-3 sm:grid-cols-2 lg:grid-cols-4 gap-6"},Nt={class:"relative w-full h-40 overflow-hidden rounded-t-lg mb-2"},Rt={key:0,class:"absolute z-12 top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Dt=["src"],Wt=["onClick"],Jt=["onClick"],Bt={key:3,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Ht={class:"p-2"},Gt={class:"text-lg font-semibold flex justify-between text-[var(--espace-vert)]"},Xt=["onClick"],Kt={class:"text-sm text-[var(--espace-gris)] line-clamp-2"},Qt={class:"text-md font-bold text-[var(--espace-or)] mt-2"},Yt={class:"text-sm text-[var(--espace-gris)]"},Zt={class:"text-sm text-[var(--espace-gris)] mt-2"},es={class:"ml-4"},ts={key:2,class:"text-center text-[var(--espace-gris)]"},ss={class:"bg-white rounded-lg p-6 sm:p-8 w-full max-w-md mx-4 shadow-lg"},os={class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},as={class:"mt-2 p-4 bg-gray-50 rounded-lg border border-gray-200"},rs={key:0,class:"grid grid-cols-3 gap-2 mb-2"},ls=["src"],ns=["onClick"],is=["value"],us={key:0,class:"flex items-center gap-2"},ds={class:"flex gap-4 pt-2"},cs=["disabled"],ps={key:0,class:"fas fa-spinner fa-spin mr-2"},vs=ae({__name:"CommercantProduits",setup(U){const i=Ve(),b=he(),f=ue(),c=de(),r=m(!1),a=m(!1),l=m([]),p=m([]),n=m(!1),d=m(!1),P=m(null),$=m({}),A=m({nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0}),h=m([]),o=m([]),u=m(null),y=me(()=>[...h.value,...o.value.map(V=>URL.createObjectURL(V))]),S=async()=>{r.value=!0;try{const V=await D.get("/commercant/produits");r.value=!1,l.value=V.data.produits.map(g=>({...g,photo_url:g.photos&&g.photos.length>0?g.photos[0]:"https://via.placeholder.com/150"})),l.value.forEach(g=>{$.value[g.id]||($.value[g.id]=0)})}catch{c.error("Erreur lors du chargement des produits")}finally{r.value=!1}},T=async()=>{try{const V=await D.get("/categories");p.value=V.data.categories}catch{c.error("Erreur lors du chargement des catégories")}finally{}},L=()=>{A.value={nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0},h.value=[],o.value=[],n.value=!0},O=V=>{P.value=V,A.value={nom:V.nom,description:V.description||"",prix:V.prix,stock:V.quantite,category_id:V.category_id,collaboratif:!!V.collaboratif,marge_min:V.marge_min||0},h.value=V.photos?[...V.photos]:[],o.value=[],$.value[V.id]||($.value[V.id]=0),d.value=!0},F=V=>{const g=V.target;if(g.files){const j=Array.from(g.files);o.value.push(...j),u.value&&(u.value.value="")}},M=V=>{if(V<h.value.length)h.value.splice(V,1);else{const g=V-h.value.length;o.value.splice(g,1)}},oe=async()=>{var g,j,E,_;a.value=!0;const V=new FormData;V.append("nom",A.value.nom),V.append("description",A.value.description),V.append("prix",A.value.prix.toString()),V.append("stock",A.value.stock.toString()),V.append("category_id",A.value.category_id),V.append("collaboratif",A.value.collaboratif?"1":"0"),V.append("marge_min",A.value.marge_min.toString()),h.value.forEach(x=>V.append("old_photos[]",x)),o.value.forEach(x=>V.append("photos[]",x));try{if(n.value)await D.post("/commercant/produits",V,{headers:{"Content-Type":"multipart/form-data"}}),c.success("Produit ajouté avec succès");else{const x=await D.post(`/commercant/produits/${(g=P.value)==null?void 0:g.id}`,V,{headers:{"Content-Type":"multipart/form-data"}});console.log(x.data),c.success("Produit modifié avec succès")}await S(),i.fetchProducts(),le()}catch(x){((E=(j=x.response)==null?void 0:j.data)==null?void 0:E.message)=="Unauthenticated."&&f.push("login"),c.error(((_=x.response)==null?void 0:_.data.message)||"Erreur lors de la sauvegarde du produit")}finally{a.value=!1}},le=()=>{n.value=!1,d.value=!1,P.value=null,h.value=[],o.value=[]},Q=me(()=>V=>$.value[V]||0),z=V=>{var E;const g=l.value.find(_=>_.id===V),j=(E=g==null?void 0:g.photos)!=null&&E.length?g.photos.length-1:0;$.value[V]=Math.min(($.value[V]||0)+1,j)},J=V=>{$.value[V]=Math.max(($.value[V]||0)-1,0)};return be(async()=>{await S(),T(),setTimeout(()=>{var V;if(!((V=b.user)!=null&&V.commercant)){c.error("Accès réservé aux commerçants"),f.push("/");return}},2e3)}),(V,g)=>{const j=ge("router-link");return t(),s(H,null,[N(Me,{isLoading:r.value},null,8,["isLoading"]),e("div",Lt,[e("div",Tt,[e("div",{class:"flex justify-between items-center"},[g[9]||(g[9]=e("h1",{class:"text-1xl md:text-2xl font-bold text-[var(--espace-vert)] text-md mb-2 font-poppins"},[e("i",{class:"fas fa-box-open mr-1 text-[var(--espace-or)] text-md!important"}),w(" Mes Produits ")],-1)),e("button",{onClick:L,class:"mb-2 md:text-xl text-[var(--espace-vert)] font-semibold px-2 py-1 rounded hover:bg-[var(--espace-vert)] hover:text-white transition inline-flex items-center"},g[8]||(g[8]=[e("i",{class:"fas fa-plus mr-2"},null,-1),w(" Ajouter un produit ")]))]),r.value?(t(),s("div",qt,g[10]||(g[10]=[e("div",{class:"flex items-center justify-center py-10"},[e("i",{class:"fas fa-spinner animate-spin text-2xl text-[var(--espace-vert)]"})],-1)]))):l.value.length?(t(),s("div",Ot,[(t(!0),s(H,null,Z(l.value,E=>(t(),s("div",{key:E.id,class:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition relative"},[e("div",Nt,[E.collaboratif?(t(),s("span",Rt," Collaboratif ")):C("",!0),N(j,{to:`/produits/${E.id}`,class:"block relative"},{default:X(()=>[e("div",{class:"flex w-full h-full slider-container",style:we({transform:`translateX(-${Q.value(E.id)*100}%)`})},[(t(!0),s(H,null,Z(E.photos,(_,x)=>(t(),s("img",{key:x,src:_,class:"h-40 object-contain flex-shrink-0 mx-auto w-full",alt:"Photo du produit"},null,8,Dt))),128))],4)]),_:2},1032,["to"]),E.photos&&E.photos.length>1?(t(),s("button",{key:1,onClick:_=>J(E.id),class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},g[11]||(g[11]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,Wt)):C("",!0),E.photos&&E.photos.length>1?(t(),s("button",{key:2,onClick:_=>z(E.id),class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},g[12]||(g[12]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,Jt)):C("",!0),E.photos&&E.photos.length>1?(t(),s("div",Bt,[(t(!0),s(H,null,Z(E.photos,(_,x)=>(t(),s("span",{key:x,class:G(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":x===Q.value(E.id)}])},null,2))),128))])):C("",!0)]),e("div",Ht,[e("h2",Gt,[N(j,{to:`/produits/${E.id}`,class:"block relative"},{default:X(()=>[w(v(E.nom),1)]),_:2},1032,["to"]),e("button",{onClick:_=>O(E),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},g[13]||(g[13]=[e("i",{class:"fas fa-pencil text-sm"},null,-1)]),8,Xt)]),e("p",Kt,v(E.description||"Aucune"),1),e("p",Qt,v(E.prix)+" FCFA",1),e("p",Yt,"Stock: "+v(E.quantite),1),e("div",Zt,[e("span",null,[g[14]||(g[14]=e("i",{class:"fas fa-eye mr-1"},null,-1)),w(" "+v(E.raw_views_count||0)+" vues",1)]),e("span",es,[g[15]||(g[15]=e("i",{class:"fas fa-heart mr-1"},null,-1)),w(" "+v(E.favorites_count||0)+" favoris",1)])])])]))),128))])):(t(),s("p",ts,"Aucun produit pour le moment."))]),N(ye,{name:"fade"},{default:X(()=>{var E;return[n.value||d.value?(t(),s("div",{key:0,class:"overflow-y-scroll fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ne(le,["self"])},[e("div",ss,[e("h2",os,v(n.value?"Ajouter un produit":"Modifier le produit"),1),e("form",{onSubmit:ne(oe,["prevent"]),class:"space-y-4 pt-12"},[e("div",null,[g[19]||(g[19]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Photos du produit",-1)),e("div",as,[y.value.length?(t(),s("div",rs,[(t(!0),s(H,null,Z(y.value,(_,x)=>(t(),s("div",{key:x,class:"relative w-full h-20"},[e("img",{src:_,class:"w-full h-full object-cover rounded-lg",alt:"Prévisualisation"},null,8,ls),e("button",{onClick:ne(K=>M(x),["prevent"]),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs"},g[16]||(g[16]=[e("i",{class:"fas fa-times"},null,-1)]),8,ns)]))),128))])):C("",!0),e("input",{ref_key:"fileInput",ref:u,type:"file",multiple:"",onChange:F,class:"hidden",accept:"image/*"},null,544),y.value.length?(t(),s("button",{key:2,type:"button",onClick:g[1]||(g[1]=_=>{var x;return(x=u.value)==null?void 0:x.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},g[18]||(g[18]=[e("i",{class:"fas fa-plus mr-2"},null,-1),w(" Ajouter une autre photo ")]))):(t(),s("button",{key:1,type:"button",onClick:g[0]||(g[0]=_=>{var x;return(x=u.value)==null?void 0:x.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},g[17]||(g[17]=[e("i",{class:"fas fa-camera mr-2"},null,-1),w(" Ajouter une photo ")])))])]),e("div",null,[g[20]||(g[20]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Nom",-1)),R(e("input",{"onUpdate:modelValue":g[2]||(g[2]=_=>A.value.nom=_),type:"text",required:"",class:"input-style"},null,512),[[Y,A.value.nom]])]),e("div",null,[g[21]||(g[21]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Description",-1)),R(e("textarea",{"onUpdate:modelValue":g[3]||(g[3]=_=>A.value.description=_),rows:"3",class:"input-style"},null,512),[[Y,A.value.description]])]),e("div",null,[g[22]||(g[22]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Prix (FCFA)",-1)),R(e("input",{"onUpdate:modelValue":g[4]||(g[4]=_=>A.value.prix=_),type:"number",min:"0",required:"",class:"input-style"},null,512),[[Y,A.value.prix,void 0,{number:!0}]])]),e("div",null,[g[23]||(g[23]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Stock",-1)),R(e("input",{"onUpdate:modelValue":g[5]||(g[5]=_=>A.value.stock=_),type:"number",min:"0",required:"",class:"input-style"},null,512),[[Y,A.value.stock,void 0,{number:!0}]])]),e("div",null,[g[25]||(g[25]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Catégorie",-1)),R(e("select",{"onUpdate:modelValue":g[6]||(g[6]=_=>A.value.category_id=_),required:"",class:"input-style"},[g[24]||(g[24]=e("option",{value:""},"Sélectionner une catégorie",-1)),(t(!0),s(H,null,Z(p.value,_=>(t(),s("option",{key:_.id,value:_.id},v(_.nom),9,is))),128))],512),[[ke,A.value.category_id]])]),n.value||!((E=P.value)!=null&&E.collaboratif)?(t(),s("div",us,[R(e("input",{id:"collaboratif",type:"checkbox","onUpdate:modelValue":g[7]||(g[7]=_=>A.value.collaboratif=_)},null,512),[[Je,A.value.collaboratif]]),g[26]||(g[26]=e("label",{for:"collaboratif",class:"text-sm text-[var(--espace-vert)]"},"Collaboratif",-1))])):C("",!0),e("div",ds,[e("button",{type:"submit",disabled:a.value,class:G(["flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded transition-colors",a.value?"opacity-50 cursor-not-allowed":"hover:bg-[var(--espace-vert)] hover:text-white"])},[a.value?(t(),s("i",ps)):C("",!0),w(" "+v(n.value?"Ajouter":"Modifier"),1)],10,cs),e("button",{type:"button",onClick:le,class:"flex-1 bg-[var(--espace-gris)] text-white font-semibold px-4 py-2 rounded hover:bg-gray-700 transition"}," Annuler ")])],32)])])):C("",!0)]}),_:1})])],64)}}}),bc=re(vs,[["__scopeId","data-v-3b812be9"]]),ms={class:"overflow-y-scroll bg-white flex justify-center px-4 pt-8"},fs={class:"flex flex-col w-full max-w-lg rounded-2xl sm:p-10"},gs=["disabled"],bs={class:"text-center text-sm text-gray-600 mt-6"},xs=ae({__name:"Register",setup(U){const i=m({nom:"",telephone:"",email:"",ville:"",mot_de_passe:"",parrain_code:""}),b=m({}),f=ue(),c=je(),r=de(),a=he();be(()=>{const n=c.params.code;n&&(i.value.parrain_code=n)});const l=m(!1),p=async()=>{var n,d,P;try{l.value=!0,await a.register(i.value),r.success("Inscription réussie !"),f.push({name:"home"})}catch($){console.error("Erreur lors de l'inscription:",$);const A=((d=(n=$.response)==null?void 0:n.data)==null?void 0:d.message)||"Erreur lors de l'inscription. Veuillez vérifier vos informations.";r.error(A),((P=$.response)==null?void 0:P.status)===422&&(b.value=$.response.data.errors)}finally{l.value=!1}};return(n,d)=>{const P=ge("router-link");return t(),s("div",ms,[e("div",fs,[d[8]||(d[8]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-user-plus mr-2 text-[var(--espace-or)]"}),w(" Créez votre compte ")],-1)),d[9]||(d[9]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[w(" Rejoignez "),e("strong",null,"Espace Cameroun"),w(" et profitez d’une expérience d’achat unique. Vos informations resteront confidentielles. ")],-1)),e("form",{onSubmit:ne(p,["prevent"]),class:"space-y-5"},[N(_e,{label:"Nom",icon:"fa-user",modelValue:i.value.nom,"onUpdate:modelValue":d[0]||(d[0]=$=>i.value.nom=$),type:"text",required:"",error:b.value.nom},null,8,["modelValue","error"]),N(_e,{label:"Téléphone",icon:"fa-phone",modelValue:i.value.telephone,"onUpdate:modelValue":d[1]||(d[1]=$=>i.value.telephone=$),type:"tel",required:"",error:b.value.telephone},null,8,["modelValue","error"]),N(_e,{label:"Email (optionnel)",icon:"fa-envelope",modelValue:i.value.email,"onUpdate:modelValue":d[2]||(d[2]=$=>i.value.email=$),type:"email",error:b.value.email},null,8,["modelValue","error"]),N(_e,{label:"Ville",icon:"fa-city",modelValue:i.value.ville,"onUpdate:modelValue":d[3]||(d[3]=$=>i.value.ville=$),type:"text",required:"",error:b.value.ville},null,8,["modelValue","error"]),N(_e,{label:"Mot de passe",icon:"fa-lock",modelValue:i.value.mot_de_passe,"onUpdate:modelValue":d[4]||(d[4]=$=>i.value.mot_de_passe=$),type:"password",required:"",error:b.value.mot_de_passe},null,8,["modelValue","error"]),N(_e,{label:"Code de parrainage (optionnel)",icon:"fa-users",modelValue:i.value.parrain_code,"onUpdate:modelValue":d[5]||(d[5]=$=>i.value.parrain_code=$),type:"text",error:b.value.parrain_code},null,8,["modelValue","error"]),e("button",{type:"submit",disabled:l.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center shadow-md disabled:opacity-60 disabled:cursor-not-allowed"},[e("i",{class:G([l.value?"fas fa-spinner fa-spin":"fas fa-user-plus","mr-2"])},null,2),e("span",null,v(l.value?"Inscription...":"S'inscrire"),1)],8,gs)],32),e("p",bs,[d[7]||(d[7]=w(" Vous avez déjà un compte ? ")),N(P,{to:"/login",class:"text-[var(--espace-vert)] font-medium hover:underline"},{default:X(()=>d[6]||(d[6]=[w(" Connectez-vous ici ")])),_:1,__:[6]})]),d[10]||(d[10]=e("p",{class:"text-center text-xs text-gray-400 mt-2 pb-24"},[w(" En vous inscrivant, vous acceptez notre "),e("a",{href:"/politique",class:"hover:underline text-[var(--espace-vert)]"},"politique de confidentialité"),w(". ")],-1))])])}}}),xc=re(xs,[["__scopeId","data-v-845ed51e"]]),hs={key:0,class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-4"},ys={class:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-y-auto animate-fade-in max-h-[90vh]"},_s={class:"p-6"},ws={key:0,class:"grid md:grid-cols-3 gap-6"},ks={key:1,class:"flex flex-col md:flex-row max-w-3xl mx-auto p-8 bg-white rounded-xl shadow-lg"},$s={class:"md:w-1/3 mb-6 md:mb-0 pr-6 border-r border-gray-200"},Cs={class:"font-extrabold text-lg mb-2"},As={class:"mb-2 text-sm opacity-90"},Ps={class:"text-3xl font-extrabold"},js={class:"flex flex-col text-sm font-medium text-gray-700"},Ss={key:0,class:"text-xs text-red-600 mt-1"},Ms={class:"flex gap-4"},Vs=["value"],Es=["src"],zs={key:0,class:"text-xs text-red-600 mt-1 block"},Us=["disabled"],Is={class:"text-xs text-gray-400 mt-4 text-center"},Fs=ae({__name:"SubscriptionModal",props:{isOpen:{type:Boolean}},emits:["close","upgraded"],setup(U,{emit:i}){const b=ue(),f=i,c=de(),r=m(""),a=m(""),l=m(""),p=m(!1),n=m(!1),d=m(!1),P=h=>{r.value=h,p.value=!1,n.value=!1,a.value="",l.value=""},$=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],A=async()=>{var h,o;if(p.value=!l.value,n.value=!a.value,p.value||n.value){c.error("Veuillez remplir tous les champs correctement.");return}d.value=!0;try{const u=await D.post("/upgrade-to-premium",{subscription_type:r.value,payment_service:a.value,phone_number:l.value});d.value=!1,c.success(u.data.message),f("upgraded"),f("close")}catch(u){if(((o=(h=u.response)==null?void 0:h.data)==null?void 0:o.message)=="Unauthenticated."&&b.push("login"),u.response&&u.response.data){const y=u.response.data;c.error(`Paiement échoué :Verifiez vos informations et réessayer${y.message}`)}else c.error("Verifiez vos informations et réessayer.");console.error(u)}finally{d.value=!1}};return(h,o)=>{const u=ge("router-link");return h.isOpen?(t(),s("div",hs,[e("div",ys,[o[18]||(o[18]=e("div",{class:"bg-gradient-to-r from-[var(--espace-vert)] to-[var(--espace-or)] p-6 text-center"},[e("h2",{class:"text-3xl font-bold text-white"},"🚀 Passez à Premium"),e("p",{class:"text-white/90 mt-1"}," Comparez et choisissez le plan qui boostera votre business ")],-1)),e("div",_s,[r.value?(t(),s("div",ks,[e("div",$s,[o[12]||(o[12]=e("h3",{class:"text-xl font-bold mb-4"},"Votre abonnement",-1)),e("div",{class:G([{"bg-green-600 text-white":r.value==="monthly","bg-yellow-400 text-gray-900":r.value==="yearly"},"rounded-lg p-4"])},[e("h4",Cs,v(r.value==="monthly"?"Premium Mensuel":"Premium Annuel"),1),e("p",As,v(r.value==="monthly"?"Accès complet à toutes les fonctionnalités.":"Payez moins, profitez plus avec 16% d’économie !"),1),e("div",Ps,v(r.value==="monthly"?"5 000 FCFA":"50 000 FCFA"),1)],2)]),e("form",{onSubmit:ne(A,["prevent"]),class:"md:w-2/3 flex flex-col gap-6",novalidate:""},[o[16]||(o[16]=e("h3",{class:"text-xl font-bold mb-2"},"Détails du paiement",-1)),e("label",js,[o[13]||(o[13]=w(" Numéro de téléphone ")),R(e("input",{"onUpdate:modelValue":o[4]||(o[4]=y=>l.value=y),type:"tel",placeholder:"Ex: 696428651",class:G(["mt-1 rounded-lg border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",{"border-red-500":p.value}]),onInput:o[5]||(o[5]=y=>p.value=!l.value),required:""},null,34),[[Y,l.value]]),p.value?(t(),s("span",Ss,"Veuillez entrer un numéro valide.")):C("",!0)]),o[17]||(o[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Service de paiement ",-1)),e("div",Ms,[(t(),s(H,null,Z($,y=>e("label",{key:y.value,class:G(["flex items-center gap-2 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":a.value===y.value,"border-gray-300 bg-white":a.value!==y.value,"border-red-500":n.value&&!a.value}])},[R(e("input",{type:"radio",value:y.value,"onUpdate:modelValue":o[6]||(o[6]=S=>a.value=S),class:"hidden"},null,8,Vs),[[Be,a.value]]),e("img",{src:y.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Es),e("span",{class:G([{"text-[var(--espace-vert)]":a.value===y.value,"text-gray-700":a.value!==y.value},"font-semibold select-none"])},v(y.label),3)],2)),64))]),n.value&&!a.value?(t(),s("span",zs," Veuillez sélectionner un service. ")):C("",!0),e("button",{type:"submit",disabled:d.value||!l.value||!a.value,class:"w-full py-3 rounded-lg bg-[var(--espace-vert)] text-white font-bold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[d.value?(t(),s(H,{key:0},[o[14]||(o[14]=e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1)),o[15]||(o[15]=w(" Veuillez patienter... "))],64)):(t(),s(H,{key:1},[w(" Payer & Souscrire ")],64))],8,Us),e("button",{type:"button",onClick:o[7]||(o[7]=y=>r.value=""),class:"w-full text-center text-gray-500 hover:text-[var(--espace-vert)] transition"}," ← Retour aux plans "),e("p",Is," 🔒 Paiement sécurisé via "+v(a.value||"votre service"),1)],32)])):(t(),s("div",ws,[o[11]||(o[11]=Ae('<div class="border border-gray-200 bg-gray-50 rounded-xl p-6 flex flex-col justify-between" data-v-2646b13d><div data-v-2646b13d><h3 class="text-xl font-bold text-gray-800" data-v-2646b13d>Gratuit (Base)</h3><p class="text-sm text-gray-500 mb-4" data-v-2646b13d>Pour débuter sans frais</p><ul class="space-y-2 text-sm" data-v-2646b13d><li class="flex items-center gap-2 text-gray-700" data-v-2646b13d><span data-v-2646b13d>✔</span> 10 produits max </li><li class="flex items-center gap-2 text-gray-700" data-v-2646b13d><span data-v-2646b13d>✔</span> 5 collaborations max </li><li class="flex items-center gap-2 text-gray-400" data-v-2646b13d><span data-v-2646b13d>❌</span> Pas de statistiques détaillées </li><li class="flex items-center gap-2 text-gray-400" data-v-2646b13d><span data-v-2646b13d>❌</span> Pas de badge Premium </li><li class="flex items-center gap-2 text-gray-400" data-v-2646b13d><span data-v-2646b13d>❌</span> Position prioritaire </li></ul></div><button disabled class="mt-6 w-full py-2 rounded-lg bg-gray-300 text-gray-600 font-semibold cursor-not-allowed" data-v-2646b13d> Actuel </button></div>',1)),e("div",{class:"relative bg-gradient-to-br from-[var(--espace-vert)] to-green-500 rounded-xl text-white p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 scale-103 transition cursor-pointer",onClick:o[1]||(o[1]=y=>P("monthly"))},[o[8]||(o[8]=Ae('<span class="absolute top-1 right-3 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full shadow" data-v-2646b13d>⭐ Populaire</span><div data-v-2646b13d><h3 class="text-xl font-bold" data-v-2646b13d>Premium - Mensuel</h3><p class="text-sm opacity-90 mb-4" data-v-2646b13d> Accès complet à toutes les fonctionnalités </p><div class="text-3xl font-extrabold mb-2" data-v-2646b13d>5000 FCFA / mois </div><ul class="space-y-2 text-sm" data-v-2646b13d><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:o[0]||(o[0]=ne(y=>P("monthly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-vert)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")]),e("div",{class:"relative bg-gradient-to-br from-yellow-400 to-[var(--espace-or)] rounded-xl text-gray-900 p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 transition cursor-pointer",onClick:o[3]||(o[3]=y=>P("yearly"))},[o[9]||(o[9]=Ae('<span class="absolute top-1 right-3 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow" data-v-2646b13d>-16% Économie</span><div data-v-2646b13d><h3 class="text-xl font-bold" data-v-2646b13d>Premium - Annuel</h3><p class="text-sm opacity-90 mb-4" data-v-2646b13d>Payez moins, profitez plus</p><div class="text-3xl font-extrabold mb-2" data-v-2646b13d>50 000 FCFA / an</div><ul class="space-y-2 text-sm" data-v-2646b13d><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-2646b13d><span data-v-2646b13d>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:o[2]||(o[2]=ne(y=>P("yearly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-or)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")]),N(u,{to:"home",class:"w-full text-center text-gray-500 hover:text-[var(--espace-vert)] text-bold transition"},{default:X(()=>o[10]||(o[10]=[w(" ← Retour ")])),_:1,__:[10]})]))])])])):C("",!0)}}}),Ls=re(Fs,[["__scopeId","data-v-2646b13d"]]),Ts={class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},qs={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 space-y-6 animate-fade-in max-h-[90vh] overflow-auto"},Os={class:"flex justify-center gap-3 mb-4"},Ns=["onClick"],Rs={key:0,class:"text-xs text-red-600 mt-1"},Ds={class:"flex gap-4"},Ws=["value"],Js=["src"],Bs={key:1,class:"text-xs text-red-600 mt-1"},Hs={class:"text-center text-lg font-bold mt-6"},Gs={class:"text-[var(--espace-vert)]"},Xs=["disabled"],Ks={key:0},Qs={key:1},Ys={key:2,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Zs={class:"w-full mt-2 text-center text-gray-500 hover:text-[var(--espace-vert)] transition"},eo=ae({__name:"AchatJetonModal",props:{isOpen:{type:Boolean}},emits:["close","purchased"],setup(U,{emit:i}){const b=i,f=de(),c=m(10),r=m(""),a=m(""),l=m(c.value*100),p=m(!1),n=m(!1),d=m(!1),P=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],$=[10,20,50,100],A=me(()=>c.value>=10&&r.value.trim().length===9&&/^6\d{8}$/.test(r.value)&&a.value!==""),h=()=>{l.value=c.value*100},o=T=>{c.value=T,h()},u=()=>{h()},y=()=>{d.value=!(r.value.trim().length===9&&/^6\d{8}$/.test(r.value))},S=async()=>{if(n.value=!a.value,!A.value){f.error("Veuillez remplir tous les champs correctement.");return}p.value=!0;try{const T=await D.post("/acheter-jetons",{nombre_jetons:c.value,payment_service:a.value,phone_number:r.value});f.success(T.data.message),b("purchased",c.value),b("close")}catch(T){if(T.response&&T.response.data){const L=T.response.data;f.error(`Erreur: ${L.error_message||"Achat échoué"}. Détails: ${L.details||"Aucun détail."}`)}else f.error("Erreur lors de l'achat. Veuillez réessayer.");console.error(T)}finally{p.value=!1}};return xe(r,()=>{y()}),(T,L)=>{const O=ge("router-link");return t(),s("div",Ts,[e("div",qs,[L[7]||(L[7]=e("h2",{class:"text-3xl font-extrabold text-[var(--espace-vert)] text-center"}," 🎫 Acheter des Jetons ",-1)),L[8]||(L[8]=e("p",{class:"text-center text-gray-600 text-sm mb-6"},"1 jeton = 100 FCFA",-1)),e("div",Os,[(t(),s(H,null,Z($,F=>e("button",{key:F,type:"button",onClick:M=>o(F),class:G(["rounded-full px-4 py-2 border font-semibold transition",c.value===F?"bg-[var(--espace-vert)] text-white border-[var(--espace-vert)]":"bg-white text-gray-700 border-gray-300 hover:bg-[var(--espace-vert)] hover:text-white"])},v(F),11,Ns)),64))]),L[9]||(L[9]=e("label",{class:"block text-gray-700 font-semibold mb-1",for:"jetonQuantity"},[w(" Nombre de jetons "),e("span",{class:"text-sm text-gray-500"},"(min 10)")],-1)),R(e("input",{id:"jetonQuantity","onUpdate:modelValue":L[0]||(L[0]=F=>c.value=F),type:"number",min:"10",placeholder:"Ex: 10",onInput:u,class:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition"},null,544),[[Y,c.value,void 0,{number:!0}]]),L[10]||(L[10]=e("label",{class:"block text-gray-700 font-semibold mb-1 mt-4",for:"phoneNumber"},[w(" Numéro de téléphone "),e("span",{class:"text-sm text-red-500"},"*")],-1)),R(e("input",{id:"phoneNumber","onUpdate:modelValue":L[1]||(L[1]=F=>r.value=F),type:"tel",placeholder:"Ex: 696428651",onInput:y,class:G(["w-full rounded-lg border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",d.value?"border-red-500":"border-gray-300"])},null,34),[[Y,r.value]]),d.value?(t(),s("p",Rs," Veuillez entrer un numéro valide (9 chiffres, commençant par 6). ")):C("",!0),L[11]||(L[11]=e("label",{class:"block text-gray-700 font-semibold mb-2 mt-4",for:"paymentService"}," Service de paiement ",-1)),e("div",Ds,[(t(),s(H,null,Z(P,F=>e("label",{key:F.value,class:G(["flex items-center gap-3 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":a.value===F.value,"border-gray-300 bg-white":a.value!==F.value}])},[R(e("input",{type:"radio",value:F.value,"onUpdate:modelValue":L[2]||(L[2]=M=>a.value=M),class:"hidden"},null,8,Ws),[[Be,a.value]]),e("img",{src:F.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Js),e("span",{class:G({"text-[var(--espace-vert)] font-bold":a.value===F.value,"text-gray-700":a.value!==F.value})},v(F.label),3)],2)),64))]),n.value&&!a.value?(t(),s("p",Bs," Veuillez sélectionner un service. ")):C("",!0),e("div",Hs,[L[4]||(L[4]=w(" Montant total : ")),e("span",Gs,v(l.value)+" FCFA",1)]),e("button",{onClick:S,disabled:!A.value||p.value,class:"w-full mt-4 bg-[var(--espace-vert)] text-white py-3 rounded-lg font-semibold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-3"},[p.value?(t(),s("span",Qs,"veuillez patientez")):(t(),s("span",Ks,"Acheter")),p.value?(t(),s("svg",Ys,L[5]||(L[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))):C("",!0)],8,Xs),e("button",Zs,[N(O,{to:"/jeton-history",onClick:L[3]||(L[3]=F=>b("close"))},{default:X(()=>L[6]||(L[6]=[w("Annuler")])),_:1,__:[6]})])])])}}}),to=re(eo,[["__scopeId","data-v-6e3c9a27"]]),so={class:"space-y-6 pb-16"},oo={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},ao={key:0,class:"space-y-2 text-[var(--espace-gris)]"},ro={class:"flex gap-2"},lo=["disabled"],no={key:0,class:"fas fa-spinner fa-spin mr-2"},io={key:0,class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},uo={key:0,class:"space-y-2 text-[var(--espace-gris)]"},co={key:0,class:"w-24 h-24"},po=["src"],vo={key:0,class:"mt-2 w-24 h-24"},mo=["src"],fo={class:"flex gap-2"},go=["disabled"],bo={key:0,class:"fas fa-spinner fa-spin mr-2"},xo=ae({__name:"userProfile",props:{user:Object},setup(U){var h,o,u,y,S,T,L,O,F,M,oe,le,Q,z,J,V;const i=ue(),b=he(),f=de(),c=m(!1),r=m(b.user),a=m(!1),l=m(!1),p=m({nom:((h=r.value)==null?void 0:h.nom)||"",telephone:((o=r.value)==null?void 0:o.telephone)||"",email:((u=r.value)==null?void 0:u.email)||"",ville:((y=r.value)==null?void 0:y.ville)||""}),n=m(!1),d=m({nom:((T=(S=r.value)==null?void 0:S.commercant)==null?void 0:T.nom)||"",description:((O=(L=r.value)==null?void 0:L.commercant)==null?void 0:O.description)||"",email:((M=(F=r.value)==null?void 0:F.commercant)==null?void 0:M.email)||"",telephone:((le=(oe=r.value)==null?void 0:oe.commercant)==null?void 0:le.telephone)||"",ville:((z=(Q=r.value)==null?void 0:Q.commercant)==null?void 0:z.ville)||"",logo:null,logoPreview:(V=(J=r.value)==null?void 0:J.commercant)!=null&&V.logo?`http://localhost:8000/storage/${r.value.commercant.logo}`:null}),P=g=>{var E;const j=(E=g.target.files)==null?void 0:E[0];if(j){if(!j.type.startsWith("image/")){f.error("Veuillez sélectionner une image.");return}if(j.size>2*1024*1024){f.error("Image trop volumineuse (max 2Mo).");return}d.value.logo=j,d.value.logoPreview=URL.createObjectURL(j)}},$=async()=>{var g,j,E;a.value=!0;try{const _=await D.post("/updateProfile",p.value);r.value&&(r.value.nom=_.data.user.nom||"",r.value.telephone=_.data.user.telephone||"",r.value.email=_.data.user.email||"",r.value.ville=_.data.user.ville||""),b.user=_.data.user,c.value=!1,f.success("Profil mis à jour avec succès.")}catch(_){((j=(g=_.response)==null?void 0:g.data)==null?void 0:j.message)=="Unauthenticated."&&i.push("login"),f.error(((E=_.response)==null?void 0:E.data.message)||"Erreur lors de la mise à jour.")}finally{a.value=!1}},A=async()=>{var g,j,E,_,x;l.value=!0;try{const K=new FormData;K.append("nom",d.value.nom),K.append("description",d.value.description),K.append("email",d.value.email),K.append("telephone",d.value.telephone),K.append("ville",d.value.ville),d.value.logo&&K.append("logo",d.value.logo);const W=await D.post("/commercant/update",K,{headers:{"Content-Type":"multipart/form-data"}});(g=r.value)!=null&&g.commercant&&(r.value.commercant.nom=W.data.commercant.nom,r.value.commercant.description=W.data.commercant.description,r.value.commercant.email=W.data.commercant.email,r.value.commercant.telephone=W.data.commercant.telephone,r.value.commercant.ville=W.data.commercant.ville,r.value.commercant.logo=W.data.commercant.logo),b.user=r.value,d.value.logoPreview=W.data.commercant.logo?`http://localhost:8000/storage/${W.data.commercant.logo}`:null,n.value=!1,f.success("Commerce mis à jour avec succès.")}catch(K){((E=(j=K.response)==null?void 0:j.data)==null?void 0:E.message)=="Unauthenticated."&&i.push("login"),f.error(((x=(_=K.response)==null?void 0:_.data)==null?void 0:x.message)||"Erreur lors de la mise à jour du commerce.")}finally{l.value=!1}};return xe(()=>b.user,g=>{var j,E,_,x,K,W;r.value=g||null,p.value={nom:(g==null?void 0:g.nom)||"",telephone:(g==null?void 0:g.telephone)||"",email:(g==null?void 0:g.email)||"",ville:(g==null?void 0:g.ville)||""},d.value={nom:((j=g==null?void 0:g.commercant)==null?void 0:j.nom)||"",description:((E=g==null?void 0:g.commercant)==null?void 0:E.description)||"",email:((_=g==null?void 0:g.commercant)==null?void 0:_.email)||"",telephone:((x=g==null?void 0:g.commercant)==null?void 0:x.telephone)||"",ville:((K=g==null?void 0:g.commercant)==null?void 0:K.ville)||"",logo:null,logoPreview:(W=g==null?void 0:g.commercant)!=null&&W.logo?`http://localhost:8000/storage/${g.commercant.logo}`:null}},{immediate:!0}),(g,j)=>{var E,_,x,K,W,B;return t(),s("div",so,[e("section",oo,[j[23]||(j[23]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations personnelles",-1)),c.value?(t(),s("form",{key:1,onSubmit:ne($,["prevent"]),class:"space-y-4"},[e("div",null,[j[18]||(j[18]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom"},"Nom",-1)),R(e("input",{"onUpdate:modelValue":j[1]||(j[1]=te=>p.value.nom=te),id:"nom",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre nom"},null,512),[[Y,p.value.nom]])]),e("div",null,[j[19]||(j[19]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone"},"Téléphone",-1)),R(e("input",{"onUpdate:modelValue":j[2]||(j[2]=te=>p.value.telephone=te),id:"telephone",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre téléphone"},null,512),[[Y,p.value.telephone]])]),e("div",null,[j[20]||(j[20]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email"},"Email",-1)),R(e("input",{"onUpdate:modelValue":j[3]||(j[3]=te=>p.value.email=te),id:"email",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre email (optionnel)"},null,512),[[Y,p.value.email]])]),e("div",null,[j[21]||(j[21]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville"},"Ville",-1)),R(e("input",{"onUpdate:modelValue":j[4]||(j[4]=te=>p.value.ville=te),id:"ville",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre ville"},null,512),[[Y,p.value.ville]])]),e("div",ro,[e("button",{type:"submit",disabled:a.value,class:G(["w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md transition-colors",a.value?"opacity-50 cursor-not-allowed":"hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)]"]),"aria-label":"Enregistrer les modifications"},[a.value?(t(),s("i",no)):C("",!0),j[22]||(j[22]=w(" Enregistrer "))],10,lo),e("button",{onClick:j[5]||(j[5]=te=>c.value=!1),class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Annuler"}," Annuler ")])],32)):(t(),s("div",ao,[e("p",null,[j[13]||(j[13]=e("strong",null,"Nom :",-1)),w(" "+v((E=r.value)==null?void 0:E.nom),1)]),e("p",null,[j[14]||(j[14]=e("strong",null,"Téléphone :",-1)),w(" "+v((_=r.value)==null?void 0:_.telephone),1)]),e("p",null,[j[15]||(j[15]=e("strong",null,"Email :",-1)),w(" "+v(((x=r.value)==null?void 0:x.email)||"Non défini"),1)]),e("p",null,[j[16]||(j[16]=e("strong",null,"Ville :",-1)),w(" "+v((K=r.value)==null?void 0:K.ville),1)]),e("p",null,[j[17]||(j[17]=e("strong",null,"Statut Premium :",-1)),w(" "+v((W=r.value)!=null&&W.premium?"Actif":"Inactif"),1)]),e("button",{onClick:j[0]||(j[0]=te=>c.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Modifier le profil"}," Modifier ")]))]),(B=r.value)!=null&&B.commercant?(t(),s("section",io,[j[36]||(j[36]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations du Commerce",-1)),n.value?(t(),s("form",{key:1,onSubmit:ne(A,["prevent"]),class:"space-y-4"},[e("div",null,[j[29]||(j[29]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom_commerce"},"Nom du commerce",-1)),R(e("input",{"onUpdate:modelValue":j[7]||(j[7]=te=>d.value.nom=te),id:"nom_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerce"},null,512),[[Y,d.value.nom]])]),e("div",null,[j[30]||(j[30]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"description_commerce"},"Description",-1)),R(e("textarea",{"onUpdate:modelValue":j[8]||(j[8]=te=>d.value.description=te),id:"description_commerce",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Description du commerce",rows:"3"},null,512),[[Y,d.value.description]])]),e("div",null,[j[31]||(j[31]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email_commerce"},"Email",-1)),R(e("input",{"onUpdate:modelValue":j[9]||(j[9]=te=>d.value.email=te),id:"email_commerce",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Email du commerce (optionnel)"},null,512),[[Y,d.value.email]])]),e("div",null,[j[32]||(j[32]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone_commerce"},"Téléphone",-1)),R(e("input",{"onUpdate:modelValue":j[10]||(j[10]=te=>d.value.telephone=te),id:"telephone_commerce",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Téléphone du commerce"},null,512),[[Y,d.value.telephone]])]),e("div",null,[j[33]||(j[33]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville_commerce"},"Ville",-1)),R(e("input",{"onUpdate:modelValue":j[11]||(j[11]=te=>d.value.ville=te),id:"ville_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville du commerce"},null,512),[[Y,d.value.ville]])]),e("div",null,[j[34]||(j[34]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"logo_commerce"},"Logo",-1)),e("input",{id:"logo_commerce",type:"file",accept:"image/*",onChange:P,class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},null,32),d.value.logoPreview?(t(),s("div",vo,[e("img",{src:d.value.logoPreview,alt:"Aperçu logo",class:"w-full h-full object-cover rounded-md shadow"},null,8,mo)])):C("",!0)]),e("div",fo,[e("button",{type:"submit",disabled:l.value,class:G(["w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md transition-colors",l.value?"opacity-50 cursor-not-allowed":"hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)]"]),"aria-label":"Enregistrer les modifications"},[l.value?(t(),s("i",bo)):C("",!0),j[35]||(j[35]=w(" Enregistrer "))],10,go),e("button",{onClick:j[12]||(j[12]=te=>n.value=!1),type:"button",class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Annuler"}," Annuler ")])],32)):(t(),s("div",uo,[r.value.commercant.logo?(t(),s("div",co,[e("img",{src:`http://localhost:8000/storage/${r.value.commercant.logo}`,alt:"Logo du commerce",class:"w-full h-full object-cover rounded-md shadow"},null,8,po)])):C("",!0),e("p",null,[j[24]||(j[24]=e("strong",null,"Nom du commerce :",-1)),w(" "+v(r.value.commercant.nom),1)]),e("p",null,[j[25]||(j[25]=e("strong",null,"Description :",-1)),w(" "+v(r.value.commercant.description||"Non définie"),1)]),e("p",null,[j[26]||(j[26]=e("strong",null,"Email :",-1)),w(" "+v(r.value.commercant.email||"Non défini"),1)]),e("p",null,[j[27]||(j[27]=e("strong",null,"Téléphone :",-1)),w(" "+v(r.value.commercant.telephone),1)]),e("p",null,[j[28]||(j[28]=e("strong",null,"Ville :",-1)),w(" "+v(r.value.commercant.ville),1)]),e("button",{onClick:j[6]||(j[6]=te=>n.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Modifier ")]))])):C("",!0)])}}}),ho=re(xo,[["__scopeId","data-v-d704430c"]]),yo=ae({__name:"MerchantProfile",props:{user:Object},setup(U){const i=de(),b=m(null),f=m([]);return be(async()=>{try{const c=await D.get("/commercant/profil");b.value=c.data.commercant,f.value=c.data.produits||[]}catch(c){i.error("Erreur lors du chargement des données du commerçant: "+(c.message||c))}}),(c,r)=>null}}),_o=re(yo,[["__scopeId","data-v-ce205108"]]),wo={class:"overflow-y-scroll pb-8 relative bg-gray-100 py-8 sm:px-6"},ko={class:"flex flex-col sm:flex-row items-center justify-between mb-8 gap-4"},$o={class:"flex flex-col space-x-4 relative w-full gap-1 px-3"},Co={class:"flex items-center space-x-4 relative w-full gap-1 px-3"},Ao={class:"relative"},Po=["src"],jo={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-lg p-1 rounded-full",style:{}},So={key:3,class:"absolute top-full left-0 transform -ranslate-x-1/2 mt-2 w-42 bg-white border rounded-md shadow z-10"},Mo={class:"space-y-1"},Vo={key:0,class:"text-sm text-gray-500"},Eo={key:0,class:"ml-4 flex items-center gap-2"},zo=["src"],Uo=["disabled"],Io={class:"flex flex-col sm:flex-row gap-2 items-center"},Fo={class:"container mx-auto max-w-4xl"},Lo={key:2,class:"fixed inset-0 bg-black bg-opacity-0 flex items-center justify-center z-50"},To={class:"bg-white rounded-lg p-4 relative w-full max-w-md"},qo=ae({__name:"Profile",setup(U){const i=()=>{const J=window.location.hostname;return J==="localhost"||J==="127.0.0.1"?"http://localhost:8000/storage/":"https://api.espacecameroun.com/storage/"},b=me(()=>i()),f=ue(),c=de(),r=he();r.checkAuth();const a=m(r.user),l=m(!1),p=m(!1),n=m(null),d=m(null),P=m(!1),$=m(!1),A=m(!1),h=me(()=>$.value?_o:ho),o=m(null),u=m(null),y=m(!1);let S=null;const T=()=>{var J;(J=o.value)==null||J.click(),l.value=!1},L=J=>{const V=J.target;if(V.files&&V.files[0]){const g=V.files[0];if(!g.type.startsWith("image/")){c.error("Veuillez sélectionner une image.");return}if(g.size>2*1024*1024){c.error("Image trop volumineuse (max 2Mo).");return}d.value=g,n.value=URL.createObjectURL(g)}},O=async()=>{try{S=await navigator.mediaDevices.getUserMedia({video:!0}),y.value=!0,l.value=!1,setTimeout(()=>{u.value&&(u.value.srcObject=S)},100)}catch(J){c.error("Impossible d'accéder à la caméra."),console.error(J)}},F=()=>{if(!u.value)return;const J=u.value,V=document.createElement("canvas");V.width=J.videoWidth,V.height=J.videoHeight;const g=V.getContext("2d");g&&(g.drawImage(J,0,0,V.width,V.height),V.toBlob(j=>{j&&(d.value=new File([j],"photo.jpg",{type:"image/jpeg"}),n.value=URL.createObjectURL(d.value),M())},"image/jpeg"))},M=()=>{S&&(S.getTracks().forEach(J=>J.stop()),S=null),y.value=!1},oe=()=>{d.value=null,n.value=null},le=async()=>{var J,V,g,j;if(d.value){p.value=!0;try{const E=new FormData;E.append("photo",d.value);const _=await D.post("/profile/photo",E,{headers:{"Content-Type":"multipart/form-data"}});_.data.photo&&(a.value&&(a.value.photo=_.data.photo,r.user=a.value),c.success("Photo mise à jour."),oe())}catch(E){((V=(J=E.response)==null?void 0:J.data)==null?void 0:V.message)=="Unauthenticated."&&f.push("login"),c.error(((j=(g=E.response)==null?void 0:g.data)==null?void 0:j.message)||"Erreur lors de l'envoi.")}finally{p.value=!1}}},Q=async()=>{P.value=!1},z=J=>{c.success(`Vous avez acheté ${J} jetons !`)};return xe(()=>r.user,J=>{a.value=J||null},{immediate:!0}),be(()=>{}),Se(()=>{n.value&&URL.revokeObjectURL(n.value),S&&S.getTracks().forEach(J=>J.stop())}),(J,V)=>{var g,j,E,_,x,K,W,B,te,ie,ce,ve,ee,k,se,q,fe,$e,Ce,Ee,ze;return t(),s("div",wo,[e("div",ko,[e("div",$o,[e("div",Co,[e("div",Ao,[(g=a.value)!=null&&g.photo?(t(),s("img",{key:0,src:b.value+((j=a.value)==null?void 0:j.photo),alt:"Photo de profil",class:"w-16 h-16 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,Po)):(t(),s("div",{key:1,class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:we({background:`${((K=(x=(_=(E=a.value)==null?void 0:E.niveaux_users)==null?void 0:_.at(-1))==null?void 0:x.parrainage_niveau)==null?void 0:K.couleur)||"#0af"}`})},V[5]||(V[5]=[e("i",{class:"fas fa-user-circle text-4xl"},null,-1)]),4)),(W=a.value)!=null&&W.premium?(t(),s("i",jo)):C("",!0),e("button",{onClick:V[0]||(V[0]=Pe=>l.value=!l.value),class:"absolute bottom-0 right-0 w-6 h-6 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full flex items-center justify-center hover:bg-[var(--espace-vert)] hover:text-white",style:{}},V[6]||(V[6]=[e("i",{class:"fas fa-pencil-alt text-xs"},null,-1)])),l.value?(t(),s("div",So,[e("button",{onClick:O,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Caméra "),e("button",{onClick:T,class:"w-full text-left px-4 py-2 hover:bg-gray-200"}," Galerie ")])):C("",!0)]),e("input",{ref_key:"galleryInput",ref:o,type:"file",accept:"image/*",class:"hidden",onChange:L},null,544),e("div",Mo,[e("h1",{class:"text-2xl sm:text-3xl font-bold flex items-center gap-2 text-blue-500",style:we({color:`${((ce=(ie=(te=(B=a.value)==null?void 0:B.niveaux_users)==null?void 0:te.at(-1))==null?void 0:ie.parrainage_niveau)==null?void 0:ce.couleur)||"#0af"}`})},[w(v((ve=a.value)==null?void 0:ve.nom)+" ",1),(ee=a.value)!=null&&ee.premium?(t(),s("span",{key:0,class:"text-black text-xs px-3 py-1 rounded-full uppercase font-bold",style:we({background:`${((fe=(q=(se=(k=a.value)==null?void 0:k.niveaux_users)==null?void 0:se.at(-1))==null?void 0:q.parrainage_niveau)==null?void 0:fe.couleur)||"#0af"}`})}," Premium ",4)):C("",!0)],4),($e=a.value)!=null&&$e.subscription_ends_at?(t(),s("span",Vo," Jusqu'au "+v(new Date((Ce=a.value)==null?void 0:Ce.subscription_ends_at).toLocaleDateString()),1)):C("",!0)])]),n.value?(t(),s("div",Eo,[e("img",{src:n.value,alt:"Preview",class:"w-12 h-12 rounded-full object-cover"},null,8,zo),e("button",{onClick:le,disabled:p.value,class:G(["bg-[var(--espace-vert)] text-white px-3 py-1 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]",{"opacity-50 cursor-not-allowed":p.value}])},v(p.value?"Upload...":"Confirmer"),11,Uo),e("button",{onClick:oe,class:"text-red-500 hover:text-red-700"}," Annuler ")])):C("",!0)]),e("div",Io,[(Ee=a.value)!=null&&Ee.commercant?C("",!0):(t(),s("button",{key:0,onClick:V[1]||(V[1]=Pe=>I(f).push("/commercant/create")),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-vert)] hover:text-white"}," Devenir commerçant ")),(ze=a.value)!=null&&ze.premium?C("",!0):(t(),s("button",{key:1,onClick:V[2]||(V[2]=Pe=>P.value=!0),class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"}," Passer Premium "))])]),e("div",Fo,[(t(),pe(Ye(h.value)))]),P.value?(t(),pe(Ls,{key:0,"is-open":P.value,onClose:V[3]||(V[3]=Pe=>P.value=!1),onUpgraded:Q},null,8,["is-open"])):C("",!0),A.value?(t(),pe(to,{key:1,"is-open":A.value,onClose:V[4]||(V[4]=Pe=>A.value=!1),onPurchased:z},null,8,["is-open"])):C("",!0),y.value?(t(),s("div",Lo,[e("div",To,[e("video",{ref_key:"videoRef",ref:u,autoplay:"",playsinline:"",class:"rounded w-full"},null,512),e("div",{class:"mt-2 flex justify-between"},[e("button",{onClick:F,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Capturer "),e("button",{onClick:M,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Annuler ")])])])):C("",!0)])}}}),hc=re(qo,[["__scopeId","data-v-d3d7ca02"]]),Oo={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6 flex flex-col lg:flex-row gap-4"},No={class:"hidden lg:block w-full max-w-xs bg-[var(--espace-blanc)] rounded-lg shadow-md p-4"},Ro={class:"space-y-2"},Do=["onClick"],Wo={class:"font-poppins"},Jo={class:"flex-1 bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Bo={class:"lg:hidden mb-4"},Ho={class:"flex overflow-x-auto space-x-2 border-b border-[var(--espace-gris)]"},Go=["onClick"],Xo={key:0,class:"space-y-6"},Ko={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Qo={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Yo={class:"flex items-center gap-4 mb-4"},Zo=["src"],ea={class:"text-[var(--espace-vert)] font-semibold"},ta={class:"text-sm text-[var(--espace-gris)]"},sa={class:"text-sm text-[var(--espace-gris)]"},oa={class:"text-sm text-[var(--espace-gris)]"},aa={key:0,class:"space-y-6"},ra={key:0,class:"space-y-6"},la={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},na={class:"text-base font-medium font-poppins"},ia={class:"text-sm text-[var(--espace-gris)]"},ua=ae({__name:"Parametres",setup(U){const i=m(!1),b=he(),f=ue(),c=de(),r=b.user,a=m("profile"),l=m({id:(r==null?void 0:r.id)??0,nom:(r==null?void 0:r.nom)??"",email:(r==null?void 0:r.email)??"",telephone:(r==null?void 0:r.telephone)??"",ville:(r==null?void 0:r.ville)??""});b.user={...b.user,...l.value};const p=m({current_password:"",new_password:"",confirm_new_password:""});m({});const n=m(""),d=me(()=>[...r!=null&&r.commercant?[{to:"/commercant/produits",label:"Espace Commerçant",icon:"fa-store-alt",description:"Gérez votre boutique et vos produits"}]:[],{to:"/parrainages",label:"Parrainage",icon:"fa-users",description:"Invitez des amis et gagnez des récompenses"},{to:"/profile",label:"Abonnements",icon:"fa-star",description:"Gérez vos abonnements premium"},{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",description:"Gérez vos collaborations sur des produits"}]),P=async()=>{var o,u,y,S;i.value=!0;try{await D.post("/updateProfile",l.value),localStorage.setItem("user",JSON.stringify(b.user)),c.success("Profil mis à jour avec succès",{timeout:3e3})}catch(T){((u=(o=T.response)==null?void 0:o.data)==null?void 0:u.message)=="Unauthenticated."&&f.push("login"),c.error(((S=(y=T.response)==null?void 0:y.data)==null?void 0:S.message)||"Erreur lors de la mise à jour du profil")}finally{i.value=!1}},$=async()=>{var o,u,y,S;i.value=!0;try{if(p.value.new_password!==p.value.confirm_new_password){c.error("Les mots de passe ne correspondent pas");return}await D.post("/updatePassword",p.value),c.success("Mot de passe mis à jour avec succès",{timeout:3e3}),p.value={current_password:"",new_password:"",confirm_new_password:""},n.value=""}catch(T){((u=(o=T.response)==null?void 0:o.data)==null?void 0:u.message)=="Unauthenticated."&&f.push("login"),c.error(((S=(y=T.response)==null?void 0:y.data)==null?void 0:S.message)||"Erreur lors de la mise à jour du mot de passe")}finally{i.value=!1}},A=()=>{b.logout(),f.push({name:"login"})},h=()=>{const o=p.value.new_password;o.length===0?n.value="":o.length<8||!/[A-Za-z]/.test(o)||!/[0-9]/.test(o)?n.value="weak":/[!@#$%^&*]/.test(o)?n.value="strong":n.value="medium"};return xe(()=>p.value.new_password,h),(o,u)=>{const y=ge("RouterLink");return t(),s(H,null,[N(Me,{isLoading:i.value},null,8,["isLoading"]),e("div",Oo,[e("aside",No,[u[7]||(u[7]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4 font-poppins"},"Paramètres",-1)),e("nav",Ro,[(t(),s(H,null,Z([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"links",label:"Autres options",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],S=>e("button",{key:S.id,onClick:T=>S.id==="logout"?A():a.value=S.id,class:G(["w-full flex items-center gap-3 p-3 rounded-lg transition-colors duration-300",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":a.value===S.id,"text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":a.value!==S.id}])},[e("i",{class:G(["fas",S.icon])},null,2),e("span",Wo,v(S.label),1)],10,Do)),64))])]),e("main",Jo,[e("div",Bo,[e("div",Ho,[(t(),s(H,null,Z([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],S=>e("button",{key:S.id,onClick:T=>S.id==="logout"?A():a.value=S.id,class:G(["flex items-center gap-2 px-4 py-2 text-sm font-medium font-poppins transition-colors duration-300",{"border-b-2 border-[var(--espace-or)] text-[var(--espace-vert)]":a.value===S.id,"text-[var(--espace-gris)] hover:text-[var(--espace-vert)]":a.value!==S.id}])},[e("i",{class:G(["fas",S.icon])},null,2),w(" "+v(S.label),1)],10,Go)),64))])]),N(ye,{name:"slide"},{default:X(()=>{var S,T;return[a.value==="profile"?(t(),s("section",Xo,[u[10]||(u[10]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Profil",-1)),e("div",Ko,[e("form",{onSubmit:ne(P,["prevent"]),class:"space-y-4"},[N(_e,{label:"Nom",icon:"fa-user",modelValue:l.value.nom,"onUpdate:modelValue":u[0]||(u[0]=L=>l.value.nom=L),type:"text",required:"",placeholder:"Votre nom"},null,8,["modelValue"]),N(_e,{label:"Email",icon:"fa-envelope",modelValue:l.value.email,"onUpdate:modelValue":u[1]||(u[1]=L=>l.value.email=L),type:"email",placeholder:"Votre email"},null,8,["modelValue"]),N(_e,{label:"Téléphone",icon:"fa-phone",modelValue:l.value.telephone,"onUpdate:modelValue":u[2]||(u[2]=L=>l.value.telephone=L),type:"tel",required:"",placeholder:"Votre numéro de téléphone"},null,8,["modelValue"]),N(_e,{label:"Ville",icon:"fa-city",modelValue:l.value.ville,"onUpdate:modelValue":u[3]||(u[3]=L=>l.value.ville=L),type:"text",required:"",placeholder:"Votre ville"},null,8,["modelValue"]),u[8]||(u[8]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Mettre à jour ",-1))],32),e("div",Qo,[u[9]||(u[9]=e("h3",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2 font-poppins"},"Aperçu",-1)),e("div",Yo,[e("img",{src:((T=(S=I(r))==null?void 0:S.commercant)==null?void 0:T.logo)||"https://via.placeholder.com/50",alt:"Photo de profil",class:"w-12 h-12 rounded-full object-cover"},null,8,Zo),e("div",null,[e("p",ea,v(l.value.nom||"Nonni"),1),e("p",ta,v(l.value.email||"Non défini"),1)])]),e("p",sa,"Téléphone: "+v(l.value.telephone||"Nonni"),1),e("p",oa,"Ville: "+v(l.value.ville||"Non défini"),1)])])])):C("",!0)]}),_:1}),N(ye,{name:"slide"},{default:X(()=>[a.value==="security"?(t(),s("section",aa,[u[12]||(u[12]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Sécurité",-1)),e("form",{onSubmit:ne($,["prevent"]),class:"space-y-4"},[N(_e,{label:"Mot de passe actuel",icon:"fa-lock",modelValue:p.value.current_password,"onUpdate:modelValue":u[4]||(u[4]=S=>p.value.current_password=S),type:"password",required:"",placeholder:"Mot de passe actuel"},null,8,["modelValue"]),N(_e,{label:"Nouveau mot de passe",icon:"fa-lock",modelValue:p.value.new_password,"onUpdate:modelValue":u[5]||(u[5]=S=>p.value.new_password=S),type:"password",required:"",placeholder:"Nouveau mot de passe",onInput:h},null,8,["modelValue"]),n.value?(t(),s("div",{key:0,class:G(["text-sm",{"text-red-500":n.value==="weak","text-yellow-500":n.value==="medium","text-green-500":n.value==="strong"}])}," Force du mot de passe : "+v(n.value==="weak"?"Faible":n.value==="medium"?"Moyen":"Fort"),3)):C("",!0),N(_e,{label:"Confirmer le nouveau mot de passe",icon:"fa-lock",modelValue:p.value.confirm_new_password,"onUpdate:modelValue":u[6]||(u[6]=S=>p.value.confirm_new_password=S),type:"password",required:"",placeholder:"Confirmer le mot de passe"},null,8,["modelValue"]),u[11]||(u[11]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Changer le mot de passe ",-1))],32)])):C("",!0)]),_:1}),N(ye,{name:"slide"},{default:X(()=>[a.value==="links"?(t(),s("section",ra,[u[13]||(u[13]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Autres options",-1)),e("div",la,[(t(!0),s(H,null,Z(d.value,S=>(t(),pe(y,{key:S.to,to:S.to,class:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"},{default:X(()=>[e("i",{class:G(["fas",S.icon])},null,2),e("div",null,[e("h3",na,v(S.label),1),e("p",ia,v(S.description),1)])]),_:2},1032,["to"]))),128))])])):C("",!0)]),_:1})])])],64)}}}),yc=re(ua,[["__scopeId","data-v-ce56f428"]]),da={class:"bg-[var(--espace-blanc)] border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200"},ca={class:"relative w-full h-32 overflow-hidden rounded-lg mb-2"},pa=["src","alt"],va={key:0,class:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex space-x-1"},ma={key:0,class:"absolute top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},fa={key:1,class:"absolute top-2 right-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},ga={class:"text-sm font-semibold text-[var(--espace-vert)] font-poppins truncate"},ba={class:"text-xs text-[var(--espace-gris)] truncate"},xa={class:"text-sm font-medium text-[var(--espace-or)]"},ha={class:"flex items-center justify-between mt-2 text-xs text-[var(--espace-gris)]"},ya={class:"flex items-center gap-1"},_a={class:"flex items-center gap-1"},wa=["aria-label"],ka=ae({__name:"ProductCard",props:{produit:{}},emits:["toggle-favorite","handleToggleFavorite"],setup(U,{emit:i}){const b=U,f=i,c=de(),r=Ve(),a=n=>{if(n==null||isNaN(n)||n===0)return"0";const d=Math.abs(n);return d<1e3?n.toString():d<1e4?(n/1e3).toFixed(1).replace(/\.0$/,"")+"k":d<1e6?Math.floor(n/1e3)+"k":d<1e9?(n/1e6).toFixed(1).replace(/\.0$/,"")+"M":(n/1e9).toFixed(1).replace(/\.0$/,"")+"B"},l=m(0),p=async()=>{var n,d;try{await r.toggleFavorite(b.produit.id),f("toggle-favorite",b.produit.id)}catch(P){c.error(((d=(n=P.response)==null?void 0:n.data)==null?void 0:d.message)||"Erreur lors de la mise à jour des favori.")}};return(n,d)=>{var $,A;const P=ge("router-link");return t(),s("div",da,[N(P,{to:`/produits/${n.produit.id}`,class:"block relative"},{default:X(()=>[e("div",ca,[e("div",{class:"flex w-full h-full slider-container",style:we({transform:`translateX(-${l.value*100}%)`})},[(t(!0),s(H,null,Z(n.produit.photos||[n.produit.photo_url||"https://via.placeholder.com/150"],(h,o)=>(t(),s("img",{key:o,src:h,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${n.produit.nom} - ${o+1}`},null,8,pa))),128))],4),n.produit.photos&&n.produit.photos.length>1?(t(),s("div",va,[(t(!0),s(H,null,Z(n.produit.photos,(h,o)=>(t(),s("span",{key:o,class:G(["w-1.5 h-1.5 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":o===l.value}])},null,2))),128))])):C("",!0)]),n.produit.collaboratif?(t(),s("span",ma," Collaboratif ")):C("",!0),n.produit.boosted_until&&new Date(n.produit.boosted_until)>new Date?(t(),s("span",fa," Boosté ")):C("",!0),e("h3",ga,v(n.produit.nom),1),e("p",ba,v(n.produit.description||"Aucune description"),1),e("p",xa,v(n.produit.prix)+" XAF",1)]),_:1},8,["to"]),e("div",ha,[e("div",ya,[d[0]||(d[0]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(a(($=n.produit.counts)==null?void 0:$.views_count)),1)]),e("div",_a,[e("button",{onClick:p,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] transition active:scale-95 focus:outline-none","aria-label":n.produit.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:G(["fas fa-bookmark text-sm",{"text-[var(--espace-or)]":n.produit.is_favorited_by}])},null,2)],8,wa),e("span",null,v(a((A=n.produit.counts)==null?void 0:A.favorites_count)),1)])])])}}}),Le=re(ka,[["__scopeId","data-v-cd62888d"]]),$a={},Ca={class:"bg-[var(--espace-blanc)] border border-gray-200 rounded-lg p-3 shadow-sm animate-pulse"};function Aa(U,i){return t(),s("div",Ca,i[0]||(i[0]=[Ae('<div class="w-full h-32 bg-gray-300 rounded-lg mb-2" data-v-4ed20fce></div><div class="h-4 bg-gray-300 rounded w-3/4 mb-2" data-v-4ed20fce></div><div class="h-3 bg-gray-300 rounded w-1/2 mb-2" data-v-4ed20fce></div><div class="h-4 bg-gray-300 rounded w-1/3 mb-2" data-v-4ed20fce></div><div class="flex justify-between mt-2" data-v-4ed20fce><div class="h-3 bg-gray-300 rounded w-1/4" data-v-4ed20fce></div><div class="h-3 bg-gray-300 rounded w-1/4" data-v-4ed20fce></div></div>',5)]))}const We=re($a,[["render",Aa],["__scopeId","data-v-4ed20fce"]]),Pa={class:"pt-4 bg-[var(--espace-blanc)] max-h-full relative"},ja={class:"relative overflow-y-scroll mx-auto px-4 sm:px-6 py-4 max-h-full"},Sa={class:"fixed flex items-center overflow-x-auto space-x-2 mb-3 snap-x snap-mandatory z-5"},Ma=["onClick","aria-label","aria-current"],Va=["aria-label","aria-expanded"],Ea={key:0,class:"absolute -top-1 -right-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] text-[10px] rounded-full h-5 w-5 flex items-center justify-center"},za={key:0,class:"bg-[var(--espace-blanc)] rounded-xl shadow-md p-4 mb-4 fixed top-0 left-0 right-0 z-50 sm:static sm:flex sm:items-center sm:gap-3 sm:flex-wrap"},Ua={class:"flex-1 min-w-[120px]"},Ia={class:"flex-1 min-w-[120px]"},Fa=["value"],La={class:"flex-1 min-w-[100px]"},Ta={class:"flex-1 min-w-[100px]"},qa={class:"flex-1 min-w-[120px]"},Oa=["value"],Na={class:"flex-1 min-w-[100px]"},Ra=["aria-busy"],Da={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},Wa=ae({__name:"Home",setup(U){const i=ue(),b=Ve(),f=he(),c=m([]),r=de(),a=m(!1),l=m({search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""}),p=m(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),n=m(null),d=m(null),P=m(!1);let $=0;const A=async()=>{try{const O=await D.get("/categories");c.value=O.data.categories}catch(O){console.error("Erreur lors du chargement des catégories:",O),r.error("Erreur lors du chargement des catégories.")}},h=()=>{if(l.value.prix_min&&l.value.prix_max&&parseFloat(l.value.prix_min)>parseFloat(l.value.prix_max)){r.error("Le prix minimum doit être inférieur au prix maximum.");return}b.fetchProducts(l.value,!0),a.value=!1},o=()=>{l.value={search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""},a.value=!1},u=O=>{b.setSort(O)},y=()=>Object.values(l.value).filter(O=>O!=="").length,S=O=>{L(O)},T=O=>{L(O)},L=async O=>{var Q,z,J;const F=(Q=f.user)==null?void 0:Q.id,M=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),oe=new Date().toISOString().split("T")[0],le=localStorage.getItem("lastResetDate");if((!le||le!==oe)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",oe)),!M[O])try{setTimeout(async()=>{const V=await D.post("/record_view",{product_id:O,user_id:F??null})},1e3),M[O]=!0,localStorage.setItem("viewedProducts",JSON.stringify(M))}catch(V){console.error("Erreur lors de l'enregistrement de la vue:",V),r.error(((J=(z=V.response)==null?void 0:z.data)==null?void 0:J.message)||"Erreur lors de l'enregistrement de la vue.")}};return be(async()=>{try{if(console.log("Produits au montage:",b.products),await b.fetchProducts({},!0,!0),console.log("Produits chargés:",b.products,"isLoading:",b.isLoading),await A(),!f.user){i.push("/login");return}}catch(O){console.error("Erreur lors du chargement des produits ou catégories:",O),O==="Unauthenticated."&&i.push("login"),r.error("Erreur lors du chargement des produits. Veuillez réessayer.")}n.value=new IntersectionObserver(O=>{console.log("Observer déclenché, isLoadingMore:",P.value,"hasMore:",b.hasMore),O[0].isIntersecting&&!P.value&&b.hasMore&&(P.value=!0,Ze(()=>{$=window.scrollY}),b.fetchProducts(l.value).finally(()=>{P.value=!1}))},{threshold:.1}),d.value&&n.value.observe(d.value)}),+et(()=>{window.scrollTo(0,$)}),Se(()=>{n.value&&d.value&&n.value.unobserve(d.value)}),(O,F)=>(t(),s("div",Pa,[N(Me,{isLoading:I(b).isLoading},null,8,["isLoading"]),e("div",ja,[e("div",Sa,[(t(),s(H,null,Z([{id:"popular",label:"Populaire",icon:"fa-fire"},{id:"favorites",label:"Favoris",icon:"fa-heart"}],M=>e("button",{key:M.id,onClick:oe=>u(M.id),class:G(["flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium font-poppins snap-center shrink-0 transition-all duration-200",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":I(b).sort===M.id,"bg-gray-100 text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":I(b).sort!==M.id}]),"aria-label":`Trier par ${M.label}`,"aria-current":I(b).sort===M.id?"true":void 0},[e("i",{class:G(["fas",M.icon])},null,2),w(" "+v(M.label),1)],10,Ma)),64)),e("button",{onClick:F[0]||(F[0]=M=>a.value=!a.value),class:"relative flex items-center justify-center w-10 h-10 bg-[var(--espace-o)] text-[var(--espace-vert)] rounded-full hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition active:scale-95","aria-label":a.value?"Masquer les filtres":"Afficher les filtres","aria-expanded":a.value},[F[7]||(F[7]=e("i",{class:"fas fa-filter text-sm"},null,-1)),y()>0?(t(),s("span",Ea,v(y()),1)):C("",!0)],8,Va)]),N(ye,{name:"slide-up"},{default:X(()=>[a.value?(t(),s("div",za,[e("form",{onSubmit:ne(h,["prevent"]),class:"grid grid-cols-2 gap-3 sm:flex sm:flex-row sm:gap-3"},[e("div",Ua,[R(e("input",{"onUpdate:modelValue":F[1]||(F[1]=M=>l.value.search=M),id:"search",type:"text",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Rechercher...","aria-label":"Rechercher un produit"},null,512),[[Y,l.value.search]])]),e("div",Ia,[R(e("select",{"onUpdate:modelValue":F[2]||(F[2]=M=>l.value.category=M),id:"category",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[F[8]||(F[8]=e("option",{value:""},"Toutes les Catégories",-1)),(t(!0),s(H,null,Z(c.value,M=>(t(),s("option",{key:M.id,value:M.id},v(M.nom),9,Fa))),128))],512),[[ke,l.value.category]])]),e("div",La,[R(e("input",{"onUpdate:modelValue":F[3]||(F[3]=M=>l.value.prix_min=M),id:"prix_min",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix min","aria-label":"Prix minimum"},null,512),[[Y,l.value.prix_min]])]),e("div",Ta,[R(e("input",{"onUpdate:modelValue":F[4]||(F[4]=M=>l.value.prix_max=M),id:"prix_max",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix max","aria-label":"Prix maximum"},null,512),[[Y,l.value.prix_max]])]),e("div",qa,[R(e("select",{"onUpdate:modelValue":F[5]||(F[5]=M=>l.value.ville=M),id:"ville",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[F[9]||(F[9]=e("option",{value:""},"Tous les villes",-1)),(t(!0),s(H,null,Z(p.value,M=>(t(),s("option",{key:M,value:M},v(M),9,Oa))),128))],512),[[ke,l.value.ville]])]),e("div",Na,[R(e("select",{"onUpdate:modelValue":F[6]||(F[6]=M=>l.value.collaboratif=M),id:"collaboratif",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},F[10]||(F[10]=[e("option",{value:""},"Collaboratif",-1),e("option",{value:"true"},"Oui",-1),e("option",{value:"false"},"Non",-1)]),512),[[ke,l.value.collaboratif]])]),e("div",{class:"flex gap-2 col-span-2 sm:col-span-1"},[F[12]||(F[12]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Appliquer les filtres"},[e("i",{class:"fas fa-check text-sm"})],-1)),e("button",{onClick:o,type:"button",class:"w-10 h-10 bg-[var(--espace-gris)] text-[var(--espace-blanc)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Réinitialiser les filtres"},F[11]||(F[11]=[e("i",{class:"fas fa-times text-sm"},null,-1)]))])],32)])):C("",!0)]),_:1}),N(Oe,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 pt-12"},{default:X(()=>[I(b).isLoading&&I(b).products.length===0?(t(!0),s(H,{key:0},Z(I(b).isLoading?8:0,M=>(t(),pe(We,{key:"skeleton-init-"+M}))),128)):C("",!0),(t(!0),s(H,null,Z(I(b).products,M=>(t(),pe(Le,{key:M.id,produit:M,onMouseover:oe=>S(M.id),onTouchstart:oe=>T(M.id)},null,8,["produit","onMouseover","onTouchstart"]))),128)),P.value?(t(!0),s(H,{key:1},Z(P.value?4:0,M=>(t(),pe(We,{key:"skeleton-more-"+M}))),128)):C("",!0)]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:d,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":P.value},[I(b).hasMore?C("",!0):(t(),s("p",Da,"Aucun produit supplémentaire"))],8,Ra)])]))}}),_c=re(Wa,[["__scopeId","data-v-23e4f82b"]]),Ja={class:"relative h-full overflow-y-scroll bg-[var(--espace-blanc)] pt-16 pb-0 px-4 sm:px-6"},Ba={class:"container mx-auto max-w-5xl"},Ha={key:0,class:"text-center text-[var(--espace-gris)]"},Ga={key:1,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Xa={class:"flex flex-col lg:flex-row gap-4 sm:gap-6"},Ka={class:"w-full lg:w-1/2 relative"},Qa={class:"relative w-full h-64 sm:h-80 lg:h-96 overflow-hidden rounded-lg"},Ya=["src","alt"],Za={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},er={key:0,class:"absolute top-3 left-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},tr={key:1,class:"absolute top-3 right-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},sr={key:2,class:"absolute bottom-3 left-3 bg-[var(--espace-bleu)] text-[var(--espace-blanc)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Commerçant Pro"},or={class:"w-full lg:w-1/2"},ar={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"},rr={class:"text-sm text-[var(--espace-gris)] mb-3"},lr={class:"text-lg sm:text-xl font-semibold text-[var(--espace-or)] mb-3"},nr={class:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 text-xs text-[var(--espace-gris)]"},ir={class:"flex items-center gap-3"},ur={class:"flex items-center gap-1"},dr={class:"flex items-center gap-1"},cr=["aria-label"],pr={class:"border-t pt-3 mt-3"},vr={class:"text-xs text-[var(--espace-gris)] mb-1"},mr={key:0,class:"ml-1 text-[var(--espace-or)]","aria-label":"Commerçant vérifié",title:"Commerçant vérifié"},fr={class:"text-xs text-[var(--espace-gris)] mb-1"},gr={class:"text-xs text-[var(--espace-gris)] mb-1"},br={class:"text-xs text-[var(--espace-gris)] mb-2"},xr={class:"flex flex-col sm:flex-row gap-3 mt-4"},hr=["disabled","aria-label"],yr={key:2,class:"text-center text-[var(--espace-gris)] text-sm font-poppins"},_r={class:"bg-[var(--espace-blanc)] rounded-lg p-4 sm:p-6 w-full max-w-md mx-4 shadow-lg"},wr={class:"text-base sm:text-lg font-semibold text-[var(--espace-vert)] mb-3 font-poppins"},kr={class:"text-xs text-[var(--espace-gris)] mb-3"},$r=["aria-label"],Cr={key:0,class:"text-xs text-[var(--espace-gris)] mt-1"},Ar={class:"bg-[var(--espace-blanc)] rounded-lg p-6 w-full max-w-md mx-4 shadow-lg border border-[var(--espace-or)]"},Pr={class:"text-xs text-[var(--espace-gris)] mt-1 text-center"},jr={class:"text-sm text-[var(--espace-gris)]"},Sr={class:"text-[var(--espace-or)]"},Mr={class:"flex gap-4"},Vr={key:0,class:"mt-6"},Er=["aria-busy"],zr={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},Ur=ae({__name:"Produit",setup(U){const i=Ve(),b=je(),f=ue(),c=he(),r=Ie(),a=de();m([]);const l=m(!1),p=m(null),n=m(null),d=m(null),P=m(!1),$=m(0),A=m(0),h=[0,500,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6e3,6500,7e3,7500,8e3,8500,9e3,9500,1e4],o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],u=_=>{if(_==null||isNaN(_)||_===0)return"0";const x=Math.abs(_);return x<1e3?_.toString():x<1e4?(_/1e3).toFixed(1).replace(/\.0$/,"")+"k":x<1e6?Math.floor(_/1e3)+"k":x<1e9?(_/1e6).toFixed(1).replace(/\.0$/,"")+"M":(_/1e9).toFixed(1).replace(/\.0$/,"")+"B"},y=async()=>{try{i.isLoading=!0,await i.viewProduct(b.params.id),i.isLoading=!1,i.product.photos&&!i.product.photo_url&&(i.product.photo_url=i.product.photos[0]),await i.fetchProducts({category:i.product.category_id,per_page:8},!0)}catch(_){a.error(_||"Erreur lors du chargement du produit"),f.push({name:"home"})}finally{i.isLoading=!1}},S=()=>{var _;if(!c.user){a.error("Veuillez vous connecter pour collaborer"),f.push({name:"login"});return}if(((_=c.user.commercant)==null?void 0:_.id)===i.product.commercant_id){a.error("Vous ne pouvez pas collaborer sur votre propre produit");return}if(!i.product.collaboratif){a.error("Ce produit n’est pas ouvert à la collaboration");return}p.value=i.product.prix+(i.product.marge_min||500),l.value=!0},T=async()=>{if(!p.value||p.value<i.product.prix+(i.product.marge_min||0)){a.error(`Le prix de revente doit être supérieur ou égal à ${i.product.prix+(i.product.marge_min||0)} XAF`);return}await r.addCollaboration({produit_id:i.product.id,prix_revente:p.value})&&(a.success("Demande de collaboration envoyée",{timeout:3e3}),l.value=!1,p.value=null)},L=()=>{l.value=!1,p.value=null},O=()=>{f.push({path:`/commercant/produits/${i.product.id}/edit`})},F=async()=>{var _,x,K;if(!c.user||((_=c.user.commercant)==null?void 0:_.id)!==i.product.commercant_id){a.error("Seul le commerçant propriétaire peut booster ce produit");return}if(c.user.jetons<A.value){a.error(`Pas assez de Jetons. Il vous faut ${A.value} Jetons pour ce boost.`);return}try{const W=await D.post(`/produits/${i.product.id}/boost`,{target_views:$.value});c.user.jetons-=A.value,i.product.boosted_until=W.data.data.end_date,a.success(W.data.message||"Produit boosté avec succès !"),P.value=!1}catch(W){a.error(((K=(x=W.response)==null?void 0:x.data)==null?void 0:K.message)||"Erreur lors du boostage du produit")}},M=()=>{var _;if(!c.user||((_=c.user.commercant)==null?void 0:_.id)!==i.product.commercant_id){a.error("Seul le commerçant propriétaire peut booster ce produit");return}P.value=!0,oe()},oe=()=>{const _=h.indexOf($.value);A.value=_!==-1?Math.max(5,o[_]):5};xe($,()=>{oe()});const le=_=>{z(_)},Q=_=>{z(_)},z=async _=>{var te,ie,ce;const x=(te=c.user)==null?void 0:te.id;if(!x){a.error("Connexion requise pour enregistrer la vue.");return}const K=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),W=new Date().toISOString().split("T")[0],B=localStorage.getItem("lastResetDate");if((!B||B!==W)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",W)),!K[_])try{setTimeout(async()=>{const ve=await D.post("/record_view",{product_id:_,user_id:x})},1e3),K[_]=!0,localStorage.setItem("viewedProducts",JSON.stringify(K))}catch(ve){console.error("Erreur lors de l'enregistrement de la vue:",ve),a.error(((ce=(ie=ve.response)==null?void 0:ie.data)==null?void 0:ce.message)||"Erreur lors de l'enregistrement de la vue.")}},J=async()=>{var _,x;try{await i.toggleFavorite(i.product.id)}catch(K){a.error(((x=(_=K.response)==null?void 0:_.data)==null?void 0:x.message)||"Erreur lors de la mise à jour des favoris.")}},V=(_,x,K)=>{var B;if(!c.user){a.error("Veuillez vous connecter pour démarrer une conversation"),f.push({name:"login"});return}const W={id:_,name:x,commercant_id:i.product.commercant_id,name_user:((B=c.user)==null?void 0:B.nom)||"Inconnu"};localStorage.setItem("chatProduct",JSON.stringify(W)),f.push(`/messages/${K}`)},g=m(0),j=()=>{var x;const _=(((x=i.product.photos)==null?void 0:x.length)||1)-1;g.value=Math.min(g.value+1,_)},E=()=>{g.value=Math.max(g.value-1,0)};return be(()=>{y(),r.initializeState(),n.value=new IntersectionObserver(_=>{_[0].isIntersecting&&!i.isLoading&&i.hasMore&&i.fetchProducts({category:i.product.category_id,per_page:8},!1)},{threshold:.1}),d.value&&n.value.observe(d.value)}),Se(()=>{n.value&&d.value&&n.value.unobserve(d.value)}),xe(()=>b.params.id,_=>{_&&(y(),g.value=0)}),xe(i.product,_=>{_&&(i.page=1,i.fetchProducts({category:_.category_id,per_page:4},!0),g.value=0)}),(_,x)=>{const K=ge("router-link");return t(),s(H,null,[N(Me,{isLoading:I(i).isLoading},null,8,["isLoading"]),e("div",Ja,[e("div",Ba,[I(i).isLoading?(t(),s("div",Ha)):I(i).product?(t(),s("div",Ga,[N(ye,{name:"slide-up"},{default:X(()=>{var W,B,te,ie,ce,ve,ee,k,se,q,fe,$e,Ce,Ee,ze,Pe,Re;return[e("div",Xa,[e("div",Ka,[e("div",Qa,[e("div",{class:"flex w-full h-full slider-container",style:we({transform:`translateX(-${g.value*100}%)`})},[(t(!0),s(H,null,Z(I(i).product.photos||[I(i).product.photo_url||"https://via.placeholder.com/300"],(Te,Ue)=>(t(),s("img",{key:Ue,src:Te,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${I(i).product.nom} - ${Ue+1}`},null,8,Ya))),128))],4),I(i).product.photos&&I(i).product.photos.length>1?(t(),s("button",{key:0,onClick:E,class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image précédente"},x[5]||(x[5]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))):C("",!0),I(i).product.photos&&I(i).product.photos.length>1?(t(),s("button",{key:1,onClick:j,class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image suivante"},x[6]||(x[6]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))):C("",!0),I(i).product.photos&&I(i).product.photos.length>1?(t(),s("div",Za,[(t(!0),s(H,null,Z(I(i).product.photos,(Te,Ue)=>(t(),s("span",{key:Ue,class:G(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":Ue===g.value}])},null,2))),128))])):C("",!0)]),I(i).product.boosted_until&&new Date(I(i).product.boosted_until)>new Date?(t(),s("span",er," Boosté ")):C("",!0),I(i).product.collaboratif?(t(),s("span",tr," Collaboratif ")):C("",!0),(W=I(c).user)!=null&&W.premium?(t(),s("span",sr," Premium ")):C("",!0)]),e("div",or,[e("h1",ar,v(I(i).product.nom),1),e("p",rr,v(I(i).product.description||"Aucune description disponible"),1),e("p",lr,v(I(i).product.prix)+" XAF ",1),e("div",nr,[e("p",null,[x[7]||(x[7]=e("strong",null,"Catégorie :",-1)),w(" "+v(((B=I(i).product.category)==null?void 0:B.nom)||"Non spécifiée"),1)]),e("p",null,[x[8]||(x[8]=e("strong",null,"Quantité :",-1)),w(" "+v(I(i).product.quantite),1)]),e("p",null,[x[9]||(x[9]=e("strong",null,"Ville :",-1)),w(" "+v(I(i).product.ville||"Non spécifiée"),1)]),e("p",null,[x[10]||(x[10]=e("strong",null,"Ajouté le :",-1)),w(" "+v(new Date(I(i).product.created_at).toLocaleDateString("fr-FR")),1)]),e("div",ir,[e("div",ur,[x[11]||(x[11]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(u((te=I(i).product.counts)==null?void 0:te.views_count))+" vues",1)]),e("div",dr,[e("i",{class:G(["fas fa-heart text-[10px]",{"text-[var(--espace-or)]":I(i).product.is_favorited_by}])},null,2),e("span",null,v(u((ie=I(i).product.counts)==null?void 0:ie.favorites_count))+" favoris",1)])])]),e("button",{onClick:J,class:"w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm mb-3","aria-label":I(i).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:G(["fas fa-heart mr-2 text-sm",{"text-[var(--espace-or)]":I(i).product.is_favorited_by}])},null,2),w(" "+v(I(i).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"),1)],8,cr),e("div",pr,[x[16]||(x[16]=e("h2",{class:"text-base font-semibold text-[var(--espace-vert)] mb-2 font-poppins"}," À propos du commerçant ",-1)),e("p",vr,[e("strong",null,v((ce=I(i).product.commercant)==null?void 0:ce.nom),1),(ve=I(i).product.commercant)!=null&&ve.verified?(t(),s("span",mr,x[12]||(x[12]=[e("i",{class:"fas fa-check-circle text-[10px]"},null,-1)]))):C("",!0)]),e("p",fr,v(((ee=I(i).product.commercant)==null?void 0:ee.description)||"Aucune description disponible"),1),e("p",gr,[x[13]||(x[13]=e("strong",null,"Ville :",-1)),w(" "+v(((k=I(i).product.commercant)==null?void 0:k.ville)||"Nonspécifiée"),1)]),e("p",br,[x[14]||(x[14]=e("strong",null,"Note :",-1)),w(" "+v(Number((se=I(i).product.commercant)==null?void 0:se.rating).toFixed(1)||"Non évalué")+" / 5 ",1)]),N(K,{to:`/commercants/${I(i).product.commercant_id}`,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline text-xs font-poppins","aria-label":"Voir le profil du commerçant"},{default:X(()=>x[15]||(x[15]=[w(" Voir le profil du commerçant ")])),_:1,__:[15]},8,["to"])]),e("div",xr,[I(i).product.collaboratif&&((fe=(q=I(c).user)==null?void 0:q.commercant)==null?void 0:fe.id)!==I(i).product.commercant_id?(t(),s("button",{key:0,onClick:S,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Collaborer sur ce produit"},x[17]||(x[17]=[e("i",{class:"fas fa-handshake mr-2 text-sm"},null,-1),w(" Collaborer ")]))):C("",!0),((Ce=($e=I(c).user)==null?void 0:$e.commercant)==null?void 0:Ce.id)===I(i).product.commercant_id?(t(),s("button",{key:1,onClick:O,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Modifier le produit"},x[18]||(x[18]=[e("i",{class:"fas fa-edit mr-2 text-sm"},null,-1),w(" Modifier le produit ")]))):C("",!0),((ze=(Ee=I(c).user)==null?void 0:Ee.commercant)==null?void 0:ze.id)===I(i).product.commercant_id?(t(),s("button",{key:2,onClick:M,class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] flex items-center justify-center gap-1 font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm",disabled:!!I(i).product.boosted_until&&new Date(I(i).product.boosted_until)>new Date,"aria-label":I(i).product.boosted_until&&new Date(I(i).product.boosted_until)>new Date?"Boost déjà actif":"Personnaliser le boost"},x[19]||(x[19]=[e("span",{class:"md:flex"},"Boost",-1),e("i",{class:"fas fa-rocket mr-2 text-sm"},null,-1)]),8,hr)):C("",!0),((Re=(Pe=I(c).user)==null?void 0:Pe.commercant)==null?void 0:Re.id)!==I(i).product.commercant_id?(t(),s("button",{key:3,onClick:x[0]||(x[0]=Te=>V(I(i).product.id,I(i).product.nom,I(i).product.commercant.user.id)),class:"flex-1 bg-green-500 text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-green-600 transition-all duration-200 active:scale-95 text-sm","aria-label":"Envoyer un message "},x[20]||(x[20]=[e("i",{class:"fas fa-comment mr-2 text-sm"},null,-1),w(" Envoyer un message ")]))):C("",!0)])])])]}),_:1})])):(t(),s("div",yr," Produit non trouvé. ")),N(ye,{name:"fade"},{default:X(()=>[l.value?(t(),s("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ne(L,["self"]),role:"dialog","aria-modal":"true","aria-label":"Proposer un prix de revente"},[e("div",_r,[e("h2",wr," Collaborer sur "+v(I(i).product.nom),1),e("p",kr," Proposez un prix de revente (minimum : "+v(I(i).product.prix+(I(i).product.marge_min||0))+" XAF) ",1),e("form",{onSubmit:ne(T,["prevent"]),class:"space-y-3"},[e("div",null,[x[21]||(x[21]=e("label",{for:"prix_revente",class:"text-xs text-[var(--espace-vert)] font-medium"},"Prix de revente (XAF)",-1)),R(e("input",{id:"prix_revente","onUpdate:modelValue":x[1]||(x[1]=W=>p.value=W),type:"number",min:"0",class:"w-full h-10 p-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition","aria-label":`Prix de revente pour ${I(i).product.nom}`,required:""},null,8,$r),[[Y,p.value,void 0,{number:!0}]]),p.value?(t(),s("p",Cr," Marge potentielle : "+v(p.value-I(i).product.prix)+" XAF ",1)):C("",!0)]),e("div",{class:"flex gap-3"},[x[22]||(x[22]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-xs","aria-label":"Envoyer la demande de collaboration"}," Envoyer ",-1)),e("button",{type:"button",onClick:L,class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):C("",!0)]),_:1}),N(ye,{name:"fade"},{default:X(()=>[P.value?(t(),s("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:x[4]||(x[4]=ne(W=>P.value=!1,["self"])),role:"dialog","aria-modal":"true","aria-label":"Personnaliser le boost du produit"},[e("div",Ar,[x[27]||(x[27]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4 font-poppins"}," Personnaliser le Boost ",-1)),e("form",{onSubmit:ne(F,["prevent"]),class:"space-y-6"},[e("div",null,[x[23]||(x[23]=e("label",{class:"text-sm text-[var(--espace-vert)] font-medium mb-2 block"},"Objectif de vues",-1)),R(e("input",{type:"range","onUpdate:modelValue":x[2]||(x[2]=W=>$.value=W),min:"0",max:"10000",step:"500",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--espace-or)]",onInput:oe},null,544),[[Y,$.value,void 0,{number:!0}]]),e("p",Pr,v($.value)+" vues ",1)]),e("p",jr,[x[24]||(x[24]=w("Coût estimé : ")),e("strong",Sr,v(A.value),1),x[25]||(x[25]=w(" Jetons"))]),e("div",Mr,[x[26]||(x[26]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm"}," Confirmer ",-1)),e("button",{type:"button",onClick:x[3]||(x[3]=W=>P.value=!1),class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):C("",!0)]),_:1})]),I(i).products?(t(),s("div",Vr,[x[28]||(x[28]=e("h2",{class:"text-lg sm:text-xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"}," Produits similaires ",-1)),N(Oe,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},{default:X(()=>[(t(!0),s(H,null,Z(I(i).products,W=>(t(),pe(Le,{key:W.id,produit:W,onMouseover:B=>le(W.id),onTouchstart:B=>Q(W.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:d,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":I(i).isLoading},[I(i).hasMore?C("",!0):(t(),s("p",zr," Aucun produit supplémentaire "))],8,Er)])):C("",!0)])],64)}}}),wc=re(Ur,[["__scopeId","data-v-209407fe"]]),Ir={class:"relative bg-green-500"},Fr={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] fixed top-0 left-0 w-full z-50 shadow-md"},Lr={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},Tr={class:"flex items-center gap-1 sm:gap-3"},qr={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},Or=["aria-label"],Nr={class:"flex items-center gap-2"},Rr=["src"],Dr={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},Wr={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},Jr={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},Br={class:"flex justify-around items-center py-2"},Hr=["aria-label"],Gr=ae({__name:"AppHeader",setup(U){var T;const i=he(),b=Ie(),f=ue(),c=i.user;je();const r=m(!1),a=m(!1),l=m(!1),p=m(""),n=Ve(),d=m(!1),P=m(null),$=m(!1),A=me(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...i.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...i.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:b.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),h=async()=>{var L,O;if(i.user)try{const F=await D.get("/user/badges");b.saveCollaborationsToLocalStorage(F.data.collaborations_pending.map(M=>({produit_id:M.produit_id,prix_revente:M.prix_revente,status:M.status,created_at:M.created_at})))}catch(F){((O=(L=F.response)==null?void 0:L.data)==null?void 0:O.message)=="Unauthenticated."&&f.push("login"),console.error("Erreur lors du chargement des badges:",F)}};xe(()=>i.user,L=>{L&&(h(),b.initializeState())},{immediate:!0}),xe(()=>b.collaborationsPending,()=>{b.collaborationsPending>0&&(a.value=!0,setTimeout(()=>a.value=!1,300))});const o=async()=>{if(p.value.trim())try{await n.fetchProducts({search:p.value.trim()},!0),p.value="",d.value=!1}catch(L){console.error("Erreur lors de la recherche:",L)}},u=L=>{if($.value){$.value=!1;return}P.value&&!P.value.contains(L.target)&&(d.value=!1)},y=async()=>{d.value=!d.value,d.value&&($.value=!0,await Ge())},S=()=>{f.push("/messages")};return(T=i.user)!=null&&T.id&&window.Echo.channel(`chat.${i.user.id}`).listen("MessageSent",L=>{var O;((O=i.user)==null?void 0:O.id)===L.receiver_id&&b.saveUnreadMessagesToLocalStorage(L.unread_messages)}),be(()=>{i.user&&(h(),b.initializeState()),document.addEventListener("click",u)}),Se(()=>{document.removeEventListener("click",u)}),(L,O)=>{const F=ge("RouterLink");return t(),s("div",Ir,[e("header",Fr,[e("div",Lr,[e("div",Tr,[N(F,{to:"/","aria-label":"Retour à l'accueil"},{default:X(()=>O[2]||(O[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Xe,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),O[3]||(O[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"},null,-1))]),e("nav",qr,[(t(!0),s(H,null,Z(A.value,M=>(t(),pe(F,{key:M.to,to:M.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:X(()=>[e("i",{class:G(["fas",M.icon])},null,2),w(" "+v(M.label)+" ",1),M.badge>0?(t(),s("span",{key:0,class:G(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":M.to==="/panier"&&r.value||M.to==="/collaborations"&&a.value||M.to==="/commandes"&&l.value}]),"aria-label":M.to==="/panier"?"Nombre d'articles dans le panier":M.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(M.badge),11,Or)):C("",!0)]),_:2},1032,["to"]))),128))]),N(Ke),e("div",Nr,[e("button",{onClick:y,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},O[4]||(O[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)])),e("button",{onClick:S,class:"text-[var(--espace-white)] px-1 rounded hover:bg-white transition"},O[5]||(O[5]=[e("i",{class:"fas fa-comment-dots text-2xl"},null,-1)])),(t(!0),s(H,null,Z(A.value.filter(M=>I(i).user?M.to==="/profil":["/login","/register"].includes(M.to)),M=>(t(),pe(F,{key:M.to,to:M.to,class:"relative flex items-center justify-center","aria-label":M.label},{default:X(()=>{var oe;return[(oe=I(c))!=null&&oe.photo?(t(),s("img",{key:0,src:`http://localhost:8000/storage/${I(c).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,Rr)):(t(),s("div",Dr,[e("i",{class:G([`fas ${M.icon}`,"text-2xl text-gray-100"])},null,2)])),M.badge>0&&M.to==="/collaborations"?(t(),s("span",{key:2,class:G(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":M.to==="/collaborations"&&a.value}]),"aria-label":"Collaborations en attente"},v(M.badge),3)):C("",!0)]}),_:2},1032,["to","aria-label"]))),128))])]),d.value?(t(),s("div",{key:0,ref_key:"searchOverlayRef",ref:P,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",Wr,[R(e("input",{"onUpdate:modelValue":O[0]||(O[0]=M=>p.value=M),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:He(o,["enter"])},null,544),[[Y,p.value]]),e("button",{onClick:o,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},O[6]||(O[6]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:O[1]||(O[1]=M=>d.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},O[7]||(O[7]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):C("",!0)]),N(ye,{name:"slide-up"},{default:X(()=>[e("nav",Jr,[e("div",Br,[(t(!0),s(H,null,Z(A.value,M=>(t(),pe(F,{key:M.to,to:M.to,"aria-label":M.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:X(()=>[e("i",{class:G(["fas text-lg",M.icon])},null,2),M.badge>0?(t(),s("span",{key:0,class:G(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":M.to==="/panier"&&r.value||M.to==="/collaborations"&&a.value||M.to==="/commandes"&&l.value}]),"aria-label":M.to==="/panier"?"Nombre d'articles dans le panier":M.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(M.badge),11,Hr)):C("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),Qe=re(Gr,[["__scopeId","data-v-c232437a"]]),Xr={class:"min-h-screen bg-gray-100",style:{background:"url(/src/assets/images/bginsc.jpg) center/cover"}},Kr={class:"container mx-auto px-4 sm:px-6 py-6"},Qr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Yr={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Zr={key:0,class:"text-sm sm:text-base text-[var(--espace-gris)]"},el={key:1,class:"text-sm sm:text-base text-[var(--espace-gris)]"},tl={key:2,class:"text-sm text-[var(--espace-gris)] italic"},sl={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},ol=["value"],al={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},rl=["value"],ll={class:"flex items-center gap-2 text-sm col-span-2 sm:col-span-1"},nl=["value"],il={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 border border-gray-100"},ul={key:0,class:"flex items-center gap-3 text-[var(--espace-vert)]"},dl={key:1,class:"text-base text-[var(--espace-gris)] italic"},cl={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},pl=["onClick"],vl=ae({__name:"CommercantDashboard",setup(U){const i=ue(),b=de(),f=m([]),c=m([]),r=m(null),a=m(!1),l=m({nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}),p=m({nom:"",description:"",ville:""}),n=m(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),d=async()=>{a.value=!0;try{const[h,o,u]=await Promise.all([D.get("/commercant/produits"),D.get("/categories"),D.get("/commercant/profil")]);a.value=!1,f.value=h.data.produits.map(y=>{var S;return{...y,commercant_id:((S=r.value)==null?void 0:S.id)||""}}),c.value=o.data.categories,r.value=u.data.commercant,p.value={nom:r.value.nom,description:r.value.description||"",ville:r.value.ville||""}}catch{b.error("Erreur lors du chargement des données."),a.value=!1}},P=async()=>{try{const h=await D.post("/commercant/produits",l.value);b.success("Produit ajouté avec succès."),d(),l.value={nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}}catch{b.error("Erreur lors de l’ajout du produit.")}},$=async h=>{if(confirm("Voulez-vous supprimer ce produit ?"))try{await D.delete(`/commercant/produits/${h}`),b.success("Produit supprimé avec succès."),d()}catch{b.error("Erreur lors de la suppression du produit.")}},A=async()=>{var h,o;try{await D.put("/commercant/profil",p.value),b.success("Profil mis à jour avec succès."),d()}catch(u){((o=(h=u.response)==null?void 0:h.data)==null?void 0:o.message)=="Unauthenticated."&&i.push("login"),b.error("Erreur lors de la mise à jour du profil.")}};return be(()=>{d()}),(h,o)=>(t(),s("div",Xr,[N(Qe),e("div",Kr,[o[26]||(o[26]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] flex items-center gap-3 mb-6"},[e("i",{class:"fas fa-store text-xl"}),w(" Espace Commerçant ")],-1)),e("div",Qr,[o[14]||(o[14]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-3"},"Statistiques",-1)),e("div",Yr,[r.value?(t(),s("p",Zr,[o[12]||(o[12]=e("span",{class:"font-medium"},"Revenus :",-1)),w(" "+v(r.value.revenus)+" FCFA ",1)])):C("",!0),r.value?(t(),s("p",el,[o[13]||(o[13]=e("span",{class:"font-medium"},"Produits vendus :",-1)),w(" "+v(r.value.produits_vendus),1)])):(t(),s("p",tl,"Chargement..."))])]),e("div",sl,[o[17]||(o[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Profil Commerçant",-1)),e("form",{onSubmit:ne(A,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[R(e("input",{"onUpdate:modelValue":o[0]||(o[0]=u=>p.value.nom=u),type:"text",placeholder:"Nom du commerçant",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[Y,p.value.nom]]),R(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=u=>p.value.description=u),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[Y,p.value.description]]),R(e("select",{"onUpdate:modelValue":o[2]||(o[2]=u=>p.value.ville=u),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2 sm:col-span-1"},[o[15]||(o[15]=e("option",{value:""},"Ville",-1)),(t(!0),s(H,null,Z(n.value,u=>(t(),s("option",{key:u,value:u},v(u),9,ol))),128))],512),[[ke,p.value.ville]]),o[16]||(o[16]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-check"})],-1))],32)]),e("div",al,[o[22]||(o[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Ajouter un produit",-1)),e("form",{onSubmit:ne(P,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[R(e("input",{"onUpdate:modelValue":o[3]||(o[3]=u=>l.value.nom=u),type:"text",placeholder:"Nom du produit",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[Y,l.value.nom]]),R(e("textarea",{"onUpdate:modelValue":o[4]||(o[4]=u=>l.value.description=u),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[Y,l.value.description]]),R(e("input",{"onUpdate:modelValue":o[5]||(o[5]=u=>l.value.prix=u),type:"number",placeholder:"Prix",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[Y,l.value.prix]]),R(e("input",{"onUpdate:modelValue":o[6]||(o[6]=u=>l.value.photo_url=u),type:"text",placeholder:"URL de la photo",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[Y,l.value.photo_url]]),R(e("select",{"onUpdate:modelValue":o[7]||(o[7]=u=>l.value.category_id=u),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[o[18]||(o[18]=e("option",{value:""},"Catégorie",-1)),(t(!0),s(H,null,Z(c.value,u=>(t(),s("option",{key:u.id,value:u.id},v(u.nom),9,rl))),128))],512),[[ke,l.value.category_id]]),e("label",ll,[R(e("input",{"onUpdate:modelValue":o[8]||(o[8]=u=>l.value.collaboratif=u),type:"checkbox"},null,512),[[Je,l.value.collaboratif]]),o[19]||(o[19]=w(" Collaboratif "))]),R(e("input",{"onUpdate:modelValue":o[9]||(o[9]=u=>l.value.marge_min=u),type:"number",placeholder:"Marge minimum",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[Y,l.value.marge_min]]),R(e("input",{"onUpdate:modelValue":o[10]||(o[10]=u=>l.value.stock=u),type:"number",placeholder:"Stock",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[Y,l.value.stock]]),R(e("select",{"onUpdate:modelValue":o[11]||(o[11]=u=>l.value.ville=u),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[o[20]||(o[20]=e("option",{value:""},"Ville",-1)),(t(!0),s(H,null,Z(n.value,u=>(t(),s("option",{key:u,value:u},v(u),9,nl))),128))],512),[[ke,l.value.ville]]),o[21]||(o[21]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-plus"})],-1))],32)]),e("div",il,[o[25]||(o[25]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Produits",-1)),a.value?(t(),s("div",ul,o[23]||(o[23]=[e("i",{class:"fas fa-spinner animate-spin text-xl"},null,-1),e("span",{class:"text-base font-poppins"},"Chargement...",-1)]))):f.value.length===0?(t(),s("div",dl," Aucun produit disponible. ")):(t(),s("div",cl,[(t(!0),s(H,null,Z(f.value,u=>(t(),s("div",{key:u.id,class:"relative"},[N(Le,{produit:u},null,8,["produit"]),e("button",{onClick:y=>$(u.id),class:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition flex items-center justify-center","aria-label":"Supprimer le produit"},o[24]||(o[24]=[e("i",{class:"fas fa-trash text-sm"},null,-1)]),8,pl)]))),128))]))])])]))}}),kc=re(vl,[["__scopeId","data-v-62cb30a8"]]),ml={class:"overflow-y-scroll bg-gray-100 pt-2 pb-12 px-4 sm:px-6"},fl={class:"container mx-auto max-w-4xl"},gl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},bl={key:0,class:"ml-2"},xl={class:"w-full bg-gray-200 rounded-full h-4"},hl={class:"text-[var(--espace-gris)] text-xs mt-2"},yl={key:0,class:"text-[var(--espace-gris)] text-xs mt-1"},_l={class:"bg-white rounded-lg shadow-md p-6 mb-6"},wl={key:0,class:"mb-4"},kl={class:"text-sm text-[var(--espace-gris)]"},$l={class:"font-bold text-[var(--espace-or)]"},Cl={class:"text-sm text-[var(--espace-gris)] truncate"},Al=["href"],Pl={key:1,class:"mb-4"},jl=["placeholder"],Sl={class:"flex flex-col sm:flex-row gap-2"},Ml=["disabled"],Vl={key:0},El={key:1},zl=["disabled"],Ul={key:0},Il={key:1},Fl={key:2,class:"mt-4 flex flex-col sm:flex-row gap-2"},Ll={class:"bg-white rounded-lg shadow-md p-6 mb-6"},Tl={class:"mb-4"},ql={key:0,class:"overflow-x-auto"},Ol={class:"w-full text-sm text-left text-[var(--espace-gris)]"},Nl=["onClick"],Rl={class:"px-4 py-2"},Dl={class:"px-4 py-2"},Wl={key:1,class:"text-center text-[var(--espace-gris)] py-4"},Jl={class:"bg-white rounded-lg shadow-md p-6 text-center"},Bl={class:"text-2xl sm:text-3xl font-bold text-[var(--espace-or)]"},Hl={class:"text-[var(--espace-gris)] mt-2"},Gl=ae({__name:"Parrainage",setup(U){const i=he(),b=ue(),f=de(),c=()=>{const Q=window.location.hostname;return Q==="localhost"||Q==="127.0.0.1"?"http://localhost:4000/register":"https://api.espacecameroun.com/register"},r=m(""),a=m(""),l=m([]),p=m(0),n=m(""),d=m(""),P=m(!1),$=m(!1),A=m({}),h=m(null),o=m(0),u=m(0),y=m(0),S=m("all"),T=me(()=>{var Q;return((Q=A.value)==null?void 0:Q.couleur)||"#6b7280"}),L=me(()=>S.value==="commercants"?l.value.filter(Q=>Q.est_commercant):S.value==="nonCommercants"?l.value.filter(Q=>!Q.est_commercant):l.value),O=async()=>{var Q,z;if(!i.user){f.error("Veuillez vous connecter pour accéder à cette page"),b.push("/login");return}try{const V=(await D.get("/parrainages/dashboard")).data;r.value=V.code||"",a.value=r.value?`${c()}/${r.value}`:"",l.value=V.parrainages||[],p.value=V.total_gains||0,A.value=V.niveau_actuel,h.value=V.niveau_suivant,o.value=V.progression,u.value=V.total_parrainages||0,y.value=V.total_parrainages_commercants||0}catch(J){((z=(Q=J.response)==null?void 0:Q.data)==null?void 0:z.message)=="Unauthenticated."&&b.push("login"),f.error("Erreur lors de la récupération des données de parrainage"),console.error(J)}},F=async()=>{var Q,z;if(!i.user){f.error("Veuillez vous connecter");return}P.value=!0;try{const J=await D.post("/parrainages/generateCode");n.value=J.data.suggested_code,d.value=n.value,f.success("Nouveau code suggéré avec succès !"),r.value&&(a.value=`${c()}/${r.value}`)}catch(J){((z=(Q=J.response)==null?void 0:Q.data)==null?void 0:z.message)=="Unauthenticated."&&b.push("login"),f.error("Erreur lors de la génération du code"),console.error(J)}finally{P.value=!1}},M=async()=>{var Q,z,J,V;if(!i.user){f.error("Veuillez vous connecter");return}if(!d.value.trim()){f.error("Veuillez entrer un code valide");return}$.value=!0;try{const g=await D.post("/parrainages/createCode",{code:d.value.trim()});r.value=g.data.code,a.value=g.data.link||`${c()}/${g.data.code}`,f.success(g.data.message||"Code créé avec succès !"),await O()}catch(g){((z=(Q=g.response)==null?void 0:Q.data)==null?void 0:z.message)=="Unauthenticated."&&b.push("login"),f.error(((V=(J=g.response)==null?void 0:J.data)==null?void 0:V.message)||"Erreur lors de la création du code"),console.error(g)}finally{$.value=!1}},oe=Q=>{if(!a.value){f.error("Aucun lien disponible pour le partage");return}let z="";const J=encodeURIComponent(`Rejoins-moi sur Espace Cameroun avec mon lien : ${a.value}`);switch(Q){case"whatsapp":z=`https://api.whatsapp.com/send?text=${J}`;break;case"facebook":z=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(a.value)}`;break;default:f.error("Plateforme non prise en charge");return}window.open(z,"_blank")},le=Q=>{Q.est_commercant?b.push(`/commercants/${Q.id}`):b.push({name:"public-profile",params:{id:Q.id}})};return be(()=>{O()}),(Q,z)=>{var J,V,g,j,E;return t(),s("div",ml,[e("div",fl,[e("div",gl,[e("h2",{class:"text-lg font-semibold mb-4",style:we({color:T.value})},"Niveaux de Parrainage",4),e("p",{class:"text-[var(--espace-gris)] text-sm mb-2 flex justify-between",style:we({color:T.value})},[e("div",null,[z[5]||(z[5]=w(" niveau : ")),e("strong",null,[w(v(A.value?A.value.nom:"Pas de niveau")+" "+v((J=A.value)==null?void 0:J.emoji)+" ",1),e("div",null," ("+v(y.value)+"/"+v(h.value?h.value.filleuls_requis:(V=A.value)==null?void 0:V.filleuls_requis)+" commerçants) ",1)])]),((g=h.value)==null?void 0:g.jetons_bonus)>0?(t(),s("span",bl,"+"+v((j=h.value)==null?void 0:j.jetons_bonus)+" jetons ",1)):C("",!0)],4),e("div",xl,[e("div",{class:"h-4 rounded-full bg-[var(--espace-or)] transition-all duration-300",style:we({width:`${o.value}%`,background:`${T.value}`})},null,4)]),e("p",hl," Prochain niveau : "+v(h.value?h.value.nom:"Légende 🏆")+" à "+v(h.value?h.value.filleuls_requis:"1000+")+" commerçants ",1),(E=A.value.avantages)!=null&&E.length?(t(),s("p",yl," Avantages : "+v(A.value.avantages.join(", ")),1)):C("",!0),e("button",{onClick:z[0]||(z[0]=_=>I(b).push("/parrainage/info")),class:"mt-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},z[6]||(z[6]=[e("i",{class:"fas fa-info-circle mr-2"},null,-1),w(" En savoir plus ")]))]),z[24]||(z[24]=e("div",{class:"bg-white rounded-lg shadow-md p-6 mb-6"},[e("p",{class:"text-[var(--espace-gris)] text-sm sm:text-base"}," Invitez des amis avec votre lien ou code unique et gagnez des récompenses ! Atteignez des niveaux supérieurs pour débloquer des jetons et des avantages. ")],-1)),e("div",_l,[z[15]||(z[15]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Votre Code de Parrainage",-1)),r.value?(t(),s("div",wl,[e("p",kl,[z[7]||(z[7]=w(" Code : ")),e("span",$l,v(r.value),1)]),e("p",Cl,[z[8]||(z[8]=w(" Lien : ")),e("a",{href:a.value,target:"_blank",class:"text-blue-500 underline hover:text-blue-700"},v(a.value),9,Al)])])):(t(),s("div",Pl,[R(e("input",{"onUpdate:modelValue":z[1]||(z[1]=_=>d.value=_),type:"text",placeholder:n.value||"Entrez ou générez un code (ex: DOM2025)",class:"w-full p-2 border rounded mb-2 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",maxlength:"10"},null,8,jl),[[Y,d.value]]),e("div",Sl,[e("button",{onClick:F,disabled:P.value,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition flex-1 disabled:opacity-50"},[P.value?(t(),s("span",Vl,z[9]||(z[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),w(" Génération... ")]))):(t(),s("span",El,z[10]||(z[10]=[e("i",{class:"fas fa-magic mr-2"},null,-1),w(" Générer un code ")])))],8,Ml),e("button",{onClick:M,disabled:$.value||!d.value.trim(),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1 disabled:opacity-50"},[$.value?(t(),s("span",Ul,z[11]||(z[11]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),w(" Création... ")]))):(t(),s("span",Il,z[12]||(z[12]=[e("i",{class:"fas fa-check mr-2"},null,-1),w(" Créer le code ")])))],8,zl)])])),r.value?(t(),s("div",Fl,[e("button",{onClick:z[2]||(z[2]=_=>oe("whatsapp")),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1"},z[13]||(z[13]=[e("i",{class:"fab fa-whatsapp mr-2"},null,-1),w(" Partager sur WhatsApp ")])),e("button",{onClick:z[3]||(z[3]=_=>oe("facebook")),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition flex-1"},z[14]||(z[14]=[e("i",{class:"fab fa-facebook-f mr-2"},null,-1),w(" Partager sur Facebook ")]))])):C("",!0)]),e("div",Ll,[z[18]||(z[18]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Utilisateurs Parrainés",-1)),e("div",Tl,[R(e("select",{"onUpdate:modelValue":z[4]||(z[4]=_=>S.value=_),class:"w-full sm:w-1/3 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},z[16]||(z[16]=[e("option",{value:"all"},"Tous",-1),e("option",{value:"commercants"},"Commerçants",-1),e("option",{value:"nonCommercants"},"Non Commerçants",-1)]),512),[[ke,S.value]])]),L.value.length?(t(),s("div",ql,[e("table",Ol,[z[17]||(z[17]=e("thead",{class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)]"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Nom"),e("th",{class:"px-4 py-2"},"Date d'inscription"),e("th",{class:"px-4 py-2"},"Est commerçant")])],-1)),e("tbody",null,[(t(!0),s(H,null,Z(L.value,_=>(t(),s("tr",{key:_.id,class:"border-b hover:bg-gray-50"},[e("td",{class:"px-4 py-2 cursor-pointer text-blue-500 hover:underline",onClick:x=>le(_)},v(_.filleul_nom||"Anonyme"),9,Nl),e("td",Rl,v(new Date(_.date_inscription).toLocaleDateString("fr-FR")),1),e("td",Dl,v(_.est_commercant?"Oui":"Non"),1)]))),128))])])])):(t(),s("p",Wl," Aucun utilisateur parrainé correspondant au filtre. Commencez à inviter dès maintenant ! "))]),e("div",Jl,[z[22]||(z[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2"},"Vos Gains",-1)),e("p",Bl,v(p.value)+" jetons ",1),e("p",Hl,[z[19]||(z[19]=w(" 🎉 Vous avez invité ")),e("strong",null,v(u.value),1),z[20]||(z[20]=w(" utilisateurs, dont ")),e("strong",null,v(y.value),1),z[21]||(z[21]=w(" sont commerçants ! "))]),z[23]||(z[23]=e("p",{class:"text-[var(--espace-gris)] mt-2"}," Débloquez plus de jetons et d'avantages en atteignant les niveaux supérieurs. ",-1))])])])}}}),$c=re(Gl,[["__scopeId","data-v-32f330af"]]),Xl={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Kl={class:"container mx-auto max-w-4xl"},Ql={class:"flex border-b border-gray-300 mb-6"},Yl={key:0},Zl={key:0,class:"grid grid-cols-1 gap-4"},en={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},tn=["onClick"],sn={class:"text-sm text-[var(--espace-gris)]"},on={class:"text-sm text-[var(--espace-gris)]"},an=["onClick"],rn={class:"flex flex gap-2"},ln=["onClick"],nn=["onClick"],un=["onClick"],dn={key:1,class:"text-center text-[var(--espace-gris)]"},cn={key:1},pn={key:0,class:"grid grid-cols-1 gap-4"},vn={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},mn=["onClick"],fn={class:"text-sm text-[var(--espace-gris)]"},gn={class:"text-sm text-[var(--espace-gris)]"},bn=["onClick"],xn=["onClick"],hn={key:1,class:"text-center text-[var(--espace-gris)]"},yn=ae({__name:"Collaborations",setup(U){const i=P=>{localStorage.setItem("pending_collaborations",JSON.stringify(P))},b=de(),f=ue(),c=m({sent_collaborations:[],received_collaborations:[]}),r=m(!0),a=m("received"),l=async()=>{var P,$,A,h;try{const o=await D.get("/collaborations");c.value=o.data;const u=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");if(u.length>0){const y=new Set(c.value.sent_collaborations.map(T=>T.produit_id)),S=u.filter(T=>!y.has(T.produit_id));S.length!==u.length&&i(S)}}catch(o){console.log(($=(P=o.response)==null?void 0:P.data)==null?void 0:$.message),b.error("Erreur lors du chargement des collaborations"),((h=(A=o.response)==null?void 0:A.data)==null?void 0:h.message)=="Unauthenticated."&&f.push("login")}finally{r.value=!1}},p=P=>{f.push({path:`/produits/${P}`})},n=P=>{var A,h,o;const $=((A=P.commercant)==null?void 0:A.id)||((o=(h=P.produit)==null?void 0:h.commercant)==null?void 0:o.id);$?f.push({path:`/commercants/${$}`}):b.error("Profil du commerçant non disponible")},d=async(P,$)=>{var A;try{const h=await D.post(`/collaborations/${P}`,{statut:$});b.success(h.data.message),await l()}catch(h){b.error(`Erreur lors de la mise à jour de la collaboration${(A=h.response)==null?void 0:A.data.message}`)}};return be(()=>{r.value=!0,l()}),(P,$)=>{var A,h,o,u;return t(),s(H,null,[N(Me,{isLoading:r.value},null,8,["isLoading"]),e("div",Xl,[e("div",Kl,[$[4]||($[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-handshake mr-2 text-[var(--espace-or)]"}),w(" Mes Collaborations ")],-1)),e("div",Ql,[e("button",{class:G(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":a.value==="received","text-[var(--espace-gris)]":a.value!=="received"}]),onClick:$[0]||($[0]=y=>a.value="received")}," Collaborations reçues ",2),e("button",{class:G(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":a.value==="sent","text-[var(--espace-gris)]":a.value!=="sent"}]),onClick:$[1]||($[1]=y=>a.value="sent")}," Collaborations envoyées ",2)]),a.value==="received"?(t(),s("div",Yl,[(h=(A=c.value)==null?void 0:A.received_collaborations)!=null&&h.length?(t(),s("div",Zl,[(t(!0),s(H,null,Z(c.value.received_collaborations,y=>(t(),s("div",{key:y.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",en,[e("div",null,[e("h2",{onClick:S=>p(y.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},v(y.produit.nom),9,tn),e("p",sn," Prix de revente proposé : "+v(y.prix_revente)+" FCFA ",1),e("p",on,[$[2]||($[2]=w(" Statut : ")),e("span",{class:G({"text-green-600":y.statut==="valider","text-yellow-600":y.statut==="en_attente","text-red-600":y.statut==="refuser"})},v(y.statut==="en_attente"?"En attente":y.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:S=>n(y),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,an)]),e("div",rn,[y.statut==="en_attente"?(t(),s("button",{key:0,onClick:S=>d(y.id,"valider"),class:"bg-green-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-green-700 transition text-xs sm:text-sm"}," Valider ",8,ln)):C("",!0),y.statut==="en_attente"?(t(),s("button",{key:1,onClick:S=>d(y.id,"refuser"),class:"bg-red-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-red-700 transition text-xs sm:text-sm"}," Rejeter ",8,nn)):C("",!0),e("button",{onClick:S=>p(y.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,un)])])]))),128))])):(t(),s("p",dn," Aucune collaboration reçue pour le moment. "))])):C("",!0),a.value==="sent"?(t(),s("div",cn,[(u=(o=c.value)==null?void 0:o.sent_collaborations)!=null&&u.length?(t(),s("div",pn,[(t(!0),s(H,null,Z(c.value.sent_collaborations,y=>(t(),s("div",{key:y.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",vn,[e("div",null,[e("h2",{onClick:S=>p(y.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},v(y.produit.nom),9,mn),e("p",fn," Prix de revente proposé : "+v(y.prix_revente)+" FCFA ",1),e("p",gn,[$[3]||($[3]=w(" Statut : ")),e("span",{class:G({"text-green-600":y.statut==="valider","text-yellow-600":y.statut==="en_attente","text-red-600":y.statut==="refuser"})},v(y.statut==="en_attente"?"En attente":y.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:S=>n(y),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,bn)]),e("button",{onClick:S=>p(y.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,xn)])]))),128))])):(t(),s("p",hn," Aucune collaboration envoyée pour le moment. "))])):C("",!0)])])],64)}}}),Cc=re(yn,[["__scopeId","data-v-cac76a42"]]),_n={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm p-4"},wn={class:"overflow-y-scroll h-full pb-16 bg-white p-6 md:p-8 rounded-3xl w-full max-w-2xl shadow-2xl relative border border-gray-200"},kn={key:0,class:"mb-8"},$n={class:"text-lg font-semibold text-[var(--espace-vert)] text-center"},Cn=["disabled"],An={key:0,class:"fas fa-spinner fa-spin mr-2"},Pn={key:1,class:"space-y-4 mb-6"},jn={class:"flex items-center gap-3"},Sn={class:"text-[var(--espace-vert)] font-medium"},Mn={key:0,class:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full"},Vn={class:"flex items-center gap-2"},En=["onClick"],zn=["onClick"],Un={key:2,class:"text-center text-gray-500"},In=ae({__name:"WalletManager",props:{show:{type:Boolean},wallets:{}},emits:["close","refresh-wallets"],setup(U,{emit:i}){const b=ue(),f=i,c=de(),r=m(!1),a=m(!1),l=m({id:null,phone_number:"",payment_service:""}),p=()=>{a.value=!0,l.value={id:null,phone_number:"",payment_service:""}},n=A=>{a.value=!0,l.value={id:A.id,phone_number:A.phone_number,payment_service:A.payment_service}},d=()=>{a.value=!1,l.value={id:null,phone_number:"",payment_service:""}},P=async()=>{var h,o,u,y;if(!/^6[0-9]{8}$/.test(l.value.phone_number)){c.error("Le numéro de téléphone doit commencer par 6 et contenir 9 chiffres.");return}r.value=!0;try{l.value.id?(await D.put(`/wallets/${l.value.id}`,l.value),c.success("Portefeuille mis à jour avec succès !")):(await D.post("/wallets",l.value),c.success("Portefeuille créé avec succès !")),f("refresh-wallets"),d()}catch(S){((o=(h=S.response)==null?void 0:h.data)==null?void 0:o.message)=="Unauthenticated."&&b.push("login"),c.error(((y=(u=S.response)==null?void 0:u.data)==null?void 0:y.message)||"Erreur lors de la sauvegarde du portefeuille"),console.error("Erreur:",S)}finally{r.value=!1}},$=async A=>{var h,o,u,y;if(confirm("Êtes-vous sûr de vouloir supprimer ce portefeuille ?")){r.value=!0;try{await D.delete(`/wallets/${A}`),c.success("Portefeuille supprimé avec succès !"),f("refresh-wallets")}catch(S){((o=(h=S.response)==null?void 0:h.data)==null?void 0:o.message)=="Unauthenticated."&&b.push("login"),c.error(((y=(u=S.response)==null?void 0:u.data)==null?void 0:y.message)||"Erreur lors de la suppression du portefeuille"),console.error("Erreur:",S)}finally{r.value=!1}}};return(A,h)=>A.show?(t(),s("div",_n,[e("div",wn,[e("button",{onClick:h[0]||(h[0]=o=>A.$emit("close")),class:"absolute top-4 right-4 text-gray-400 hover:text-red-500 text-lg"},"✖"),h[9]||(h[9]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] mb-6 text-center"},"💳 Gérer Mes Portefeuilles",-1)),a.value?(t(),s("div",kn,[e("form",{onSubmit:ne(P,["prevent"]),class:G(["space-y-5",{"bg-green-50 p-4 rounded-lg":!l.value.id,"bg-yellow-50 p-4 rounded-lg":l.value.id}])},[e("h3",$n,v(l.value.id?"Modifier le Portefeuille":"Créer un Nouveau Portefeuille"),1),e("div",null,[h[3]||(h[3]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Numéro de téléphone",-1)),R(e("input",{"onUpdate:modelValue":h[1]||(h[1]=o=>l.value.phone_number=o),type:"tel",placeholder:"Ex: 670123456",required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",pattern:"6[0-9]{8}"},null,512),[[Y,l.value.phone_number]])]),e("div",null,[h[5]||(h[5]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Service de paiement",-1)),R(e("select",{"onUpdate:modelValue":h[2]||(h[2]=o=>l.value.payment_service=o),required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},h[4]||(h[4]=[e("option",{value:"",disabled:""},"Sélectionnez un service",-1),e("option",{value:"ORANGE"},"Orange Money",-1),e("option",{value:"MTN"},"MTN Mobile Money",-1)]),512),[[ke,l.value.payment_service]])]),e("button",{type:"submit",disabled:r.value,class:"w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition"},[r.value?(t(),s("i",An)):C("",!0),w(" "+v(l.value.id?"Mettre à jour":"Créer"),1)],8,Cn),e("button",{onClick:d,type:"button",class:"w-full mt-2 text-gray-500 hover:underline"},"Annuler")],34)])):C("",!0),A.wallets&&A.wallets.length>0?(t(),s("div",Pn,[(t(!0),s(H,null,Z(A.wallets,o=>(t(),s("div",{key:o.id||o.phone_number,class:G(["p-4 rounded-lg flex flex-col md:flex-row md:justify-between md:items-center gap-3",{"bg-orange-50":o.payment_service==="ORANGE","bg-purple-50":o.payment_service==="MTN"}])},[e("div",jn,[e("span",Sn,v(o.phone_number)+" ("+v(o.payment_service)+") ",1),o.is_active!==!1?(t(),s("span",Mn,"Actif")):C("",!0)]),e("div",Vn,[e("button",{onClick:u=>n(o),class:"flex items-center gap-1 text-blue-500 bg-blue-100 px-2 py-1 rounded hover:bg-blue-200 transition"},h[6]||(h[6]=[e("i",{class:"fas fa-edit"},null,-1),w(" Modifier ")]),8,En),e("button",{onClick:u=>$(o.id),class:"flex items-center gap-1 text-red-500 bg-red-100 px-2 py-1 rounded hover:bg-red-200 transition"},h[7]||(h[7]=[e("i",{class:"fas fa-trash"},null,-1),w(" Supprimer ")]),8,zn)])],2))),128))])):(t(),s("p",Un,"Aucun portefeuille créé.")),a.value?C("",!0):(t(),s("button",{key:3,onClick:p,type:"button",class:"w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition mt-4"},h[8]||(h[8]=[e("i",{class:"fas fa-plus"},null,-1),w(" Ajouter un portefeuille ")])))])])):C("",!0)}}),Fn=re(In,[["__scopeId","data-v-04e487e6"]]),Ln={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm p-4"},Tn={class:"h-full overflow-y-scroll pb-16 relative bg-white p-6 md:p-8 rounded-3xl w-full max-w-2xl shadow-2xl border border-gray-200 flex flex-col h-full"},qn={class:"flex-1 overflow-y-auto pr-2 space-y-4 mb-4"},On={key:0,class:"space-y-4"},Nn={class:"flex flex-col"},Rn={class:"text-[var(--espace-vert)] font-medium"},Dn={class:"text-xs text-gray-500"},Wn={class:"text-gray-700 text-sm sm:text-base"},Jn={class:"flex items-center gap-2"},Bn=["onClick"],Hn=["onClick"],Gn={key:1,class:"text-center text-gray-500"},Xn={key:0,class:"border-t pt-4 mt-2 bg-gray-50 rounded-lg"},Kn={class:"text-lg font-semibold text-[var(--espace-vert)] text-center"},Qn=["value"],Yn=["disabled"],Zn={key:0,class:"fas fa-spinner fa-spin mr-2"},ei={key:1,class:"border-t pt-4 mt-2"},ti=ae({__name:"OfferManager",props:{show:{type:Boolean},offers:{},wallets:{}},emits:["close","refresh-offers"],setup(U,{emit:i}){const b=U,f=i,c=de(),r=m(!1),a=m([...b.offers]);xe(()=>b.offers,h=>{a.value=[...h]},{deep:!0});const l=m(!1),p=m({id:null,nombre_jetons:0,prix_unitaire:0,description:"",wallet_id:""}),n=()=>{l.value=!0,p.value={id:null,nombre_jetons:0,prix_unitaire:0,description:"",wallet_id:""}},d=h=>{l.value=!0,p.value={id:h.id,nombre_jetons:h.nombre_jetons,prix_unitaire:h.prix_unitaire,description:h.description||"",wallet_id:h.wallet_id}},P=()=>{l.value=!1,p.value={id:null,nombre_jetons:0,prix_unitaire:0,description:"",wallet_id:""}},$=async()=>{var h,o;r.value=!0;try{if(p.value.id){const u=await D.put(`/jeton_market/updateOffer/${p.value.id}`,p.value);c.success("Offre mise à jour avec succès !");const y=a.value.findIndex(S=>S.id===p.value.id);y!==-1&&(a.value[y]={...a.value[y],...p.value})}else{const u=await D.post("/jeton_market/offer",p.value);c.success("Offre créée avec succès !"),a.value.push(u.data)}f("refresh-offers"),P()}catch(u){c.error(((o=(h=u.response)==null?void 0:h.data)==null?void 0:o.message)||"Erreur lors de la sauvegarde de l'offre"),console.error("Erreur:",u)}finally{r.value=!1}},A=async h=>{var o,u;if(confirm("Êtes-vous sûr de vouloir supprimer cette offre ?")){r.value=!0;try{await D.delete(`/jeton_market/deleteOffer/${h}`),c.success("Offre supprimée avec succès !"),a.value=a.value.filter(y=>y.id!==h),f("refresh-offers")}catch(y){c.error(((u=(o=y.response)==null?void 0:o.data)==null?void 0:u.message)||"Erreur lors de la suppression de l'offre"),console.error("Erreur:",y)}finally{r.value=!1}}};return(h,o)=>h.show?(t(),s("div",Ln,[e("div",Tn,[e("button",{onClick:o[0]||(o[0]=u=>h.$emit("close")),class:"absolute top-4 right-4 text-gray-400 hover:text-red-500 text-lg"},"✖"),o[12]||(o[12]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] mb-6 text-center"},"📋 Mes Offres",-1)),e("div",qn,[a.value.length>0?(t(),s("div",On,[(t(!0),s(H,null,Z(a.value,u=>{var y,S;return t(),s("div",{key:u.id,class:"p-4 rounded-lg flex flex-col md:flex-row md:justify-between md:items-center gap-3 bg-gray-50 shadow-sm hover:shadow-md transition"},[e("div",Nn,[e("span",Rn,v(u.nombre_jetons)+" jetons • "+v(u.total_prix)+" FCFA ",1),e("span",Dn,"PU : "+v(u.prix_unitaire)+" FCFA",1),e("p",Wn,[o[4]||(o[4]=e("strong",null,"💳 ",-1)),w(" "+v((y=u.wallet)==null?void 0:y.phone_number)+" ("+v((S=u.wallet)==null?void 0:S.payment_service)+") ",1)])]),e("div",Jn,[e("button",{onClick:T=>d(u),class:"flex items-center gap-1 text-blue-500 bg-blue-100 px-2 py-1 rounded hover:bg-blue-200 transition"},o[5]||(o[5]=[e("i",{class:"fas fa-edit"},null,-1),w(" Modifier ")]),8,Bn),e("button",{onClick:T=>A(u.id),class:"flex items-center gap-1 text-red-500 bg-red-100 px-2 py-1 rounded hover:bg-red-200 transition"},o[6]||(o[6]=[e("i",{class:"fas fa-trash"},null,-1),w(" Supprimer ")]),8,Hn)])])}),128))])):(t(),s("p",Gn,"Aucune offre créée."))]),l.value?(t(),s("div",Xn,[e("form",{onSubmit:ne($,["prevent"]),class:G(["space-y-4",{"bg-green-50 p-4 rounded-lg":!p.value.id,"bg-yellow-50 p-4 rounded-lg":p.value.id}])},[e("h3",Kn,v(p.value.id?"Modifier l'offre":"Créer une nouvelle offre"),1),e("div",null,[o[7]||(o[7]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Quantité",-1)),R(e("input",{"onUpdate:modelValue":o[1]||(o[1]=u=>p.value.nombre_jetons=u),type:"number",min:"1",required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},null,512),[[Y,p.value.nombre_jetons,void 0,{number:!0}]])]),e("div",null,[o[8]||(o[8]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Prix unitaire (FCFA)",-1)),R(e("input",{"onUpdate:modelValue":o[2]||(o[2]=u=>p.value.prix_unitaire=u),type:"number",min:"1",required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},null,512),[[Y,p.value.prix_unitaire,void 0,{number:!0}]])]),e("div",null,[o[10]||(o[10]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Portefeuille",-1)),R(e("select",{"onUpdate:modelValue":o[3]||(o[3]=u=>p.value.wallet_id=u),required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},[o[9]||(o[9]=e("option",{value:"",disabled:""},"Sélectionnez un portefeuille",-1)),(t(!0),s(H,null,Z(h.wallets,u=>(t(),s("option",{key:u.id,value:u.id},v(u.phone_number)+" ("+v(u.payment_service)+") ",9,Qn))),128))],512),[[ke,p.value.wallet_id]])]),e("button",{type:"submit",disabled:r.value,class:"w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition"},[r.value?(t(),s("i",Zn)):C("",!0),w(" "+v(p.value.id?"Mettre à jour":"Créer"),1)],8,Yn),e("button",{onClick:P,type:"button",class:"w-full mt-2 text-gray-500 hover:underline"},"Annuler")],34)])):(t(),s("div",ei,[e("button",{onClick:n,type:"button",class:"w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition"},o[11]||(o[11]=[e("i",{class:"fas fa-plus"},null,-1),w(" Nouvelle offre ")]))]))])])):C("",!0)}}),si=re(ti,[["__scopeId","data-v-03e4f804"]]),oi={class:"w-full pt-5 px-6 bg-gradient-to-b from-gray-50 to-gray-100 relative h-full"},ai={class:"fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-md shadow-md px-4 py-1 flex items-center justify-between"},ri={class:"flex items-center justify-between mb-4"},li={class:"flex items-center gap-3"},ni=["src"],ii={key:1,class:"fas fa-user-circle text-2xl text-gray-500"},ui={class:"px-3 py-1 text-sm font-semibold rounded-full bg-green-100 text-green-800"},di={class:"text-gray-700 text-sm sm:text-base"},ci={class:"text-gray-700 text-sm sm:text-base"},pi={class:"text-xs text-gray-500 mt-3"},vi=["onClick"],mi={key:0,class:"col-span-full text-center py-4"},fi={key:1,class:"text-center text-gray-600 py-24"},gi={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm"},bi={class:"bg-white p-8 rounded-3xl w-full max-w-lg shadow-2xl relative border border-gray-200"},xi=["value"],hi={class:"text-sm text-gray-500"},yi={class:"font-bold"},_i={class:"font-bold"},wi=["disabled"],ki={key:0,class:"fas fa-spinner fa-spin mr-2"},$i={key:0,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm"},Ci={class:"bg-white p-6 rounded-2xl shadow-xl w-full max-w-md relative"},Ai={class:"space-y-4"},Pi={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm"},ji={class:"bg-white p-8 rounded-3xl w-full max-w-lg shadow-2xl relative border border-gray-200"},Si=["value"],Mi={class:"text-sm text-[var(--espace-gris)]"},Vi={class:"font-bold"},Ei=["disabled"],zi={key:0,class:"fas fa-spinner fa-spin mr-2"},Ui={key:1,class:""},Ii={key:2,class:""},Fi={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm"},Li={class:"bg-white p-8 rounded-3xl w-full max-w-lg shadow-2xl relative border border-gray-200"},Ti=["disabled"],qi={key:0,class:"fas fa-spinner fa-spin mr-2"},Oi={class:"fixed bottom-0 left-0 right-0 z-50 bg-white/90 backdrop-blur-md shadow-md px-4 py-3 flex items-center justify-around md:justify-between"},Ni=ae({__name:"JetonMarket",setup(U){const i=()=>{const ee=window.location.hostname;return ee==="localhost"||ee==="127.0.0.1"?"http://localhost:8000/storage/":"https://api.espacecameroun.com/storage/"},b=me(()=>i()),f=ue(),c=m([]),r=m([]),a=m({quantityMin:""}),l=m(!1),p=m(!1),n=m({nombre_jetons:0,prix_unitaire:0,description:"",walletId:""}),d=m(!1),P=m(1),$=m(1),A=m(!1),h=m(!0),o=m(!1),u=m(!1),y=m({walletId:""}),S=m(null),T=m(0),L=m([]),O=m(!1),F=m({id:0,phone_number:"",payment_service:""}),M=m(!1),oe=m(!1),le=de(),Q=()=>{l.value=!1,p.value=!1,u.value=!1,O.value=!1,M.value=!1,oe.value=!1},z=async()=>{try{const ee=await D.get("/wallets");L.value=ee.data.data||[]}catch(ee){console.error("Erreur lors du chargement des portefeuilles:",ee),L.value=[]}},J=async()=>{var ee,k;try{const se=await D.get("/jeton_market/my-offers");r.value=se.data.data||[]}catch(se){((k=(ee=se.response)==null?void 0:ee.data)==null?void 0:k.message)=="Unauthenticated."&&f.push("login"),console.error("Erreur lors du chargement des offres de l'utilisateur:",se),r.value=[]}},V=async()=>{await z(),Q(),L.value.length===0?O.value=!0:l.value=!0},g=async()=>{var ee,k,se,q;d.value=!0;try{Q();const fe=await D.post("/wallets",F.value);le.success(fe.data.message||"Portefeuille créé avec succès !"),O.value=!1,await z(),l.value=!0}catch(fe){((k=(ee=fe.response)==null?void 0:ee.data)==null?void 0:k.message)=="Unauthenticated."&&f.push("login"),le.error(((q=(se=fe.response)==null?void 0:se.data)==null?void 0:q.message)||"Erreur lors de la création du portefeuille"),console.error("Erreur:",fe)}finally{d.value=!1,F.value={id:0,phone_number:"",payment_service:""}}},j=()=>{p.value=!1,P.value=1,c.value=[],W()},E=async()=>{o.value=!0,P.value=1,c.value=[],await W(),o.value=!1},_=me(()=>c.value.filter(ee=>!a.value.quantityMin||ee.nombre_jetons>=parseInt(a.value.quantityMin,10))),x=me(()=>n.value.nombre_jetons*n.value.prix_unitaire),K=me(()=>x.value*.1),W=async()=>{var ee,k;if(!(A.value||P.value>$.value)){A.value=!0;try{const se={page:P.value,quantity_min:a.value.quantityMin||void 0},q=await D.get("/jeton_market/offers",{params:se});c.value=[...c.value,...q.data.data],$.value=q.data.last_page,P.value+=1}catch(se){((k=(ee=se.response)==null?void 0:ee.data)==null?void 0:k.message)=="Unauthenticated."&&f.push("login"),console.error("Erreur lors du chargement des offres:",se)}finally{A.value=!1,h.value=!1}}},B=()=>{const ee=document.querySelector(".grid");if(ee){const{scrollTop:k,clientHeight:se,scrollHeight:q}=ee;k+se>=q-300&&!A.value&&W()}},te=async()=>{var ee,k,se;if(!n.value.walletId){le.error("Veuillez sélectionner un portefeuille.");return}d.value=!0;try{const q=await D.post("/jeton_market/offer",{...n.value,wallet_id:n.value.walletId,total_price:x.value});l.value=!1,le.success(((ee=q==null?void 0:q.data)==null?void 0:ee.message)||"Offre créée avec succès !"),W()}catch(q){le.error(((se=(k=q.response)==null?void 0:k.data)==null?void 0:se.message)||"Erreur lors de la création de l'offre"),console.error("Erreur lors de la création de l'offre:",q.response)}finally{d.value=!1}},ie=(ee,k,se)=>{Q();const q=c.value.find(fe=>fe.id===ee);q&&(S.value=ee,T.value=q.total_prix,y.value.walletId="",u.value=!0)},ce=async()=>{var ee,k;if(!S.value||!y.value.walletId){le.error("Veuillez sélectionner un portefeuille.");return}d.value=!0;try{const se=await D.post(`/jeton_market/buy/${S.value}`,{wallet_id:y.value.walletId});u.value=!1,W(),le.success(se.data.message||"Achat effectué avec succès !")}catch(se){console.error("Erreur lors de l'achat:",se.response.data.message),le.error(((k=(ee=se.response)==null?void 0:ee.data)==null?void 0:k.message)||"Erreur lors de l'achat")}finally{d.value=!1,S.value=null,T.value=0}},ve=ee=>{var k;return(k=ee.user)!=null&&k.commercant?`/commercants/${ee.user.commercant.id}`:`/profile/public/${ee.user_id}`};return be(()=>{h.value=!0,W(),z(),J(),window.addEventListener("scroll",B)}),Se(()=>{window.removeEventListener("scroll",B)}),(ee,k)=>{const se=ge("router-link");return t(),s(H,null,[N(Me,{isLoading:h.value},null,8,["isLoading"]),e("div",oi,[e("div",ai,[N(se,{to:"home",class:"flex items-center gap-2 text-[var(--espace-vert)] hover:text-[var(--espace-or)] transition rounded-xl p-1 sm:p-2"},{default:X(()=>k[16]||(k[16]=[e("i",{class:"fas fa-arrow-left text-lg sm:text-xl"},null,-1),e("span",{class:"hidden sm:inline font-semibold"},"Retour",-1)])),_:1,__:[16]}),k[17]||(k[17]=e("div",{class:"text-center"},[e("h1",{class:"text-xl font-bold text-[var(--espace-vert)]"},"🌍 Marché"),e("p",{class:"text-xs text-gray-600 mt-0 sm:mt-3"},"Achetez & vendez vos jetons en toute sécurité 🚀")],-1)),k[18]||(k[18]=e("div",{class:"w-10"},null,-1))]),c.value.length>0?(t(),s("div",{key:0,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 2xl:grid-cols-6 gap-3 mt-4",onScrollPassive:B},[(t(!0),s(H,null,Z(_.value,q=>(t(),s("div",{key:q.id,class:"bg-white py-6 px-3 rounded-2xl shadow-lg border border-gray-100 hover:shadow-2xl transition transform hover:-translate-y-2 hover:border-[var(--espace-or)]"},[e("div",ri,[e("div",li,[N(se,{to:ve(q),class:"w-10 h-10 bg-[var(--espace-or)] rounded-full flex items-center justify-center overflow-hidden cursor-pointer"},{default:X(()=>[q.user.photo?(t(),s("img",{key:0,src:b.value+q.user.photo,alt:"Photo de profil",class:"w-full h-full object-cover"},null,8,ni)):(t(),s("i",ii))]),_:2},1032,["to"]),N(se,{to:ve(q),class:"text-lg font-bold text-[var(--espace-vert)] truncate hover:underline"},{default:X(()=>[w(v(q.user.nom),1)]),_:2},1032,["to"])]),e("span",ui,[w(v(q.nombre_jetons)+" ",1),k[19]||(k[19]=e("i",{class:"fas fa-coins"},null,-1))])]),e("p",di,[k[20]||(k[20]=e("strong",null,"💵 Prix :",-1)),w(" "+v(q.prix_unitaire)+" FCFA/jeton",1)]),e("p",ci,[k[21]||(k[21]=e("strong",null,"💰 Total :",-1)),w(" "+v(q.total_prix)+" FCFA ",1)]),e("p",pi,"📅 Publiée le "+v(new Date(q.date_creation).toLocaleDateString()),1),e("button",{onClick:fe=>{var $e,Ce;return ie(q.id,($e=q.wallet)==null?void 0:$e.phone_number,(Ce=q.wallet)==null?void 0:Ce.payment_service)},class:"mt-6 w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] px-3 py-2 sm:px-4 sm:py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition text-sm sm:text-base"}," ⚡ Acheter ",8,vi)]))),128)),d.value?(t(),s("div",mi,k[22]||(k[22]=[e("i",{class:"fas fa-spinner fa-spin text-2xl text-[var(--espace-vert)]"},null,-1)]))):C("",!0)],32)):(t(),s("div",fi,[k[25]||(k[25]=e("i",{class:"fas fa-box-open text-6xl text-gray-400 mb-6"},null,-1)),k[26]||(k[26]=e("p",{class:"text-xl"},"Aucune offre disponible pour le moment.",-1)),e("p",{class:"mt-3"},[k[23]||(k[23]=w("Soyez le premier à ")),e("span",{class:"font-bold text-[var(--espace-vert)] cursor-pointer underline",onClick:V},"poster une offre"),k[24]||(k[24]=w(" 🎉"))])])),N(ye,{name:"fade"},{default:X(()=>[l.value?(t(),s("div",gi,[e("div",bi,[e("button",{onClick:k[0]||(k[0]=q=>l.value=!1),class:"absolute top-4 right-4 text-gray-400 hover:text-red-500 text-lg"},"✖"),k[35]||(k[35]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] mb-6 text-center"},"📝 Nouvelle Offre",-1)),e("form",{onSubmit:ne(te,["prevent"]),class:"space-y-5"},[e("div",null,[k[27]||(k[27]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Quantité",-1)),R(e("input",{"onUpdate:modelValue":k[1]||(k[1]=q=>n.value.nombre_jetons=q),type:"number",min:"1",required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},null,512),[[Y,n.value.nombre_jetons,void 0,{number:!0}]])]),e("div",null,[k[28]||(k[28]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Prix unitaire (FCFA)",-1)),R(e("input",{"onUpdate:modelValue":k[2]||(k[2]=q=>n.value.prix_unitaire=q),type:"number",min:"1",required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},null,512),[[Y,n.value.prix_unitaire,void 0,{number:!0}]])]),e("div",null,[k[30]||(k[30]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Portefeuille à utiliser",-1)),R(e("select",{"onUpdate:modelValue":k[3]||(k[3]=q=>n.value.walletId=q),required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},[k[29]||(k[29]=e("option",{value:"",disabled:""},"Sélectionnez un portefeuille",-1)),(t(!0),s(H,null,Z(L.value,q=>(t(),s("option",{key:q.id,value:q.id},v(q.phone_number)+" ("+v(q.payment_service)+") ",9,xi))),128))],512),[[ke,n.value.walletId]])]),e("p",hi,[k[31]||(k[31]=w("💰 Total: ")),e("span",yi,v(x.value),1),k[32]||(k[32]=w(" FCFA | 🏦 Commission (10%): ")),e("span",_i,v(K.value),1),k[33]||(k[33]=w(" FCFA"))]),e("button",{type:"submit",disabled:d.value,class:"w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition"},[d.value?(t(),s("i",ki)):C("",!0),k[34]||(k[34]=w(" Publier "))],8,wi)],32)])])):C("",!0)]),_:1}),N(ye,{name:"fade"},{default:X(()=>[p.value?(t(),s("div",$i,[e("div",Ci,[e("button",{onClick:k[4]||(k[4]=q=>p.value=!1),class:"absolute top-3 right-3 text-gray-400 hover:text-red-500"},"✖"),k[36]||(k[36]=e("h2",{class:"text-lg font-bold text-[var(--espace-vert)] mb-4"},"🎛️ Filtres",-1)),e("div",Ai,[R(e("input",{"onUpdate:modelValue":k[5]||(k[5]=q=>a.value.quantityMin=q),type:"number",placeholder:"Quantité min",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)]"},null,512),[[Y,a.value.quantityMin,void 0,{number:!0}]])]),e("button",{onClick:j,class:"mt-6 w-full bg-[var(--espace-or)] text-[var(--espace-vert)] py-3 rounded-xl font-bold hover:bg-[var(--espace-vert)] hover:text-white transition"}," 🔍 Appliquer ")])])):C("",!0)]),_:1}),N(ye,{name:"fade"},{default:X(()=>[u.value?(t(),s("div",Pi,[e("div",ji,[e("button",{onClick:k[6]||(k[6]=q=>u.value=!1),class:"absolute top-4 right-4 text-gray-400 hover:text-red-500 text-lg"},"✖"),k[41]||(k[41]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] mb-6 text-center"},"📲 Paiement",-1)),e("form",{onSubmit:ne(ce,["prevent"]),class:"space-y-5"},[e("div",null,[k[38]||(k[38]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Sélectionnez votre portefeuille",-1)),R(e("select",{"onUpdate:modelValue":k[7]||(k[7]=q=>y.value.walletId=q),required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},[k[37]||(k[37]=e("option",{value:"",disabled:""},"Sélectionnez un portefeuille",-1)),(t(!0),s(H,null,Z(L.value,q=>(t(),s("option",{key:q.id,value:q.id},v(q.phone_number)+" ("+v(q.payment_service)+") ",9,Si))),128))],512),[[ke,y.value.walletId]])]),e("p",Mi,[k[39]||(k[39]=w("Montant total : ")),e("span",Vi,v(T.value),1),k[40]||(k[40]=w(" FCFA"))]),e("button",{type:"submit",disabled:d.value,class:"w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition"},[d.value?(t(),s("i",zi)):C("",!0),d.value?(t(),s("span",Ui,"Veuillez patienter")):(t(),s("span",Ii,"Confirmer le paiement"))],8,Ei)],32)])])):C("",!0)]),_:1}),N(ye,{name:"fade"},{default:X(()=>[O.value?(t(),s("div",Fi,[e("div",Li,[e("button",{onClick:k[8]||(k[8]=q=>O.value=!1),class:"absolute top-4 right-4 text-gray-400 hover:text-red-500 text-lg"},"✖"),k[46]||(k[46]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] mb-6 text-center"},"💳 Créer un Portefeuille ",-1)),e("form",{onSubmit:ne(g,["prevent"]),class:"space-y-5"},[e("div",null,[k[42]||(k[42]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Numéro de téléphone",-1)),R(e("input",{"onUpdate:modelValue":k[9]||(k[9]=q=>F.value.phone_number=q),type:"tel",placeholder:"Ex: 670123456",required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",pattern:"6[0-9]{8}"},null,512),[[Y,F.value.phone_number]])]),e("div",null,[k[44]||(k[44]=e("label",{class:"block text-sm font-semibold text-[var(--espace-vert)]"},"Service de paiement",-1)),R(e("select",{"onUpdate:modelValue":k[10]||(k[10]=q=>F.value.payment_service=q),required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none"},k[43]||(k[43]=[e("option",{value:"",disabled:""},"Sélectionnez un service",-1),e("option",{value:"ORANGE"},"Orange Money",-1),e("option",{value:"MTN"},"MTN Mobile Money",-1)]),512),[[ke,F.value.payment_service]])]),e("button",{type:"submit",disabled:d.value,class:"w-full bg-gradient-to-r from-[var(--espace-or)] to-yellow-400 text-[var(--espace-vert)] py-3 rounded-xl font-bold shadow hover:from-[var(--espace-vert)] hover:to-green-700 hover:text-white transition"},[d.value?(t(),s("i",qi)):C("",!0),k[45]||(k[45]=w(" Créer "))],8,Ti)],32)])])):C("",!0)]),_:1}),M.value?(t(),pe(Fn,{key:2,show:M.value,wallets:L.value,onClose:k[11]||(k[11]=q=>M.value=!1),onRefreshWallets:z},null,8,["show","wallets"])):C("",!0),oe.value?(t(),pe(si,{key:3,show:oe.value,wallets:L.value,offers:r.value,onClose:k[12]||(k[12]=q=>oe.value=!1),onRefreshOffers:W},null,8,["show","wallets","offers"])):C("",!0),e("div",Oi,[e("button",{onClick:k[13]||(k[13]=q=>{Q(),p.value=!0}),class:"flex items-center gap-1 rounded-xl p-2 hover:bg-gray-200 transition text-[var(--espace-vert)]"},k[47]||(k[47]=[e("i",{class:"fas fa-filter text-xl"},null,-1),e("span",{class:"hidden md:inline font-semibold"},"Filtres",-1)])),e("button",{onClick:E,class:G(["flex items-center gap-1 rounded-xl p-2 hover:bg-gray-200 transition text-[var(--espace-vert)]",{"bg-gray-400":o.value}])},[e("i",{class:G(["fas fa-sync-alt text-xl",{"fa-spin":o.value}])},null,2),k[48]||(k[48]=e("span",{class:"hidden md:inline font-semibold"},"Actualiser",-1))],2),e("button",{onClick:k[14]||(k[14]=q=>{Q(),M.value=!0}),class:"flex items-center gap-1 rounded-xl p-2 hover:bg-[var(--espace-or)] transition bg-[var(--espace-ver)] text-[var(--espace-vert)]"},k[49]||(k[49]=[e("i",{class:"fas fa-wallet text-xl"},null,-1),e("span",{class:"hidden md:inline font-semibold"},"Porte feuille",-1)])),e("button",{onClick:V,class:"flex items-center gap-1 rounded-xl p-2 hover:bg-[var(--espace-or)] transition text-[var(--espace-vert)]"},k[50]||(k[50]=[e("i",{class:"fas fa-plus text-xl"},null,-1),e("span",{class:"hidden md:inline font-semibold"},"Poster",-1)])),e("button",{onClick:k[15]||(k[15]=q=>{Q(),oe.value=!0}),class:"flex items-center gap-1 rounded-xl p-2 hover:bg-[var(--espace-or)] transition text-[var(--espace-vert)]"},k[51]||(k[51]=[e("i",{class:"fas fa-list text-xl"},null,-1),e("span",{class:"hidden md:inline font-semibold"},"Offres",-1)]))])])],64)}}}),Ac=re(Ni,[["__scopeId","data-v-42750d66"]]),Ri={class:"overflow-y-scroll bg-gray-100"},Di={class:"container mx-auto px-4 sm:px-6 py-8"},Wi={key:0,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mb-8 border border-gray-100 overflow-hidden"},Ji={class:"flex flex-col sm:flex-row items-center gap-6"},Bi={class:"w-24 h-24 bg-[var(--espace-or)] rounded-full flex items-center justify-center overflow-hidden"},Hi=["src"],Gi={key:1,class:"fas fa-user text-3xl text-[var(--espace-vert)]"},Xi={class:"flex-1"},Ki={class:"text-3xl font-bold text-[var(--espace-vert)] mb-2 text-center"},Qi={class:"text-sm text-[var(--espace-gris)] mb-1"},Yi={class:"text-sm text-[var(--espace-gris)] mb-1"},Zi={class:"text-sm text-[var(--espace-gris)]"},eu={key:0,class:"text-sm text-[var(--espace-gris)]"},tu={class:"mt-2 flex space-x-2 flex-col"},su={class:"text-sm text-[var(--espace-gris)]"},ou={class:"text-xs text-[var(--espace-gris)]"},au={class:"mt-4 flex flex-col sm:flex-row gap-4"},ru={class:"mt-4 flex flex-wrap gap-4"},lu={class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},nu={key:0,class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},iu={key:1,class:"text-base text-[var(--espace-gris)] italic"},uu={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},du={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},cu={class:"flex items-center space-x-2"},pu={key:3},vu={key:4,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-4 border border-gray-100"},mu={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},fu={key:5,class:"text-base text-[var(--espace-gris)] italic"},gu={key:6,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-8 border border-gray-100"},bu={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},xu={class:"text-sm text-[var(--espace-gris)]"},hu={class:"text-sm text-[var(--espace-gris)]"},yu=ae({__name:"CommercantDetails",setup(U){const i=je(),b=ue(),f=de(),c=m(!1),r=m(null),a=m(null),l=m(0),p=m(0),n=m(!1),d=async()=>{c.value=!0;try{const h=await D.get(`/commercant/${i.params.commercantId}`);r.value=h.data.commercant,l.value=h.data.average_rating||0,p.value=h.data.vote_count||0,r.value.produits||console.warn("Aucun produit trouvé dans la réponse de l'API pour ce commerçant.")}catch{f.error("Erreur lors du chargement des détails du commerçant.")}finally{c.value=!1}},P=async()=>{var h,o,u,y;if(a.value===null||a.value<1||a.value>5){f.error("Veuillez sélectionner une note entre 1 et 5.");return}try{const S=await D.post(`/commercant/${i.params.commercantId}/rate`,{rating:a.value});l.value=S.data.average_rating||0,f.success("Merci pour votre note !"),a.value=null,n.value=!1,p.value=S.data.vote_count||p.value+1}catch(S){((o=(h=S.response)==null?void 0:h.data)==null?void 0:o.message)=="Unauthenticated."&&b.push("login"),f.error(((y=(u=S.response)==null?void 0:u.data)==null?void 0:y.message)||"Erreur lors de la notation.")}},$=me(()=>{var h;return((h=r.value)==null?void 0:h.produits)||[]}),A=()=>{n.value=!0};return be(async()=>{d()}),(h,o)=>{const u=ge("router-link");return t(),s(H,null,[N(Me,{isLoading:c.value},null,8,["isLoading"]),e("div",Ri,[N(Qe),e("div",Di,[r.value?(t(),s("div",Wi,[e("div",Ji,[e("div",Bi,[r.value.photo_url?(t(),s("img",{key:0,src:r.value.photo_url,alt:"Photo du commerçant",class:"w-full h-full object-cover"},null,8,Hi)):(t(),s("i",Gi))]),e("div",Xi,[e("h1",Ki," Commerçant : "+v(r.value.nom),1),e("p",Qi,[o[2]||(o[2]=e("strong",null,"Ville :",-1)),w(" "+v(r.value.ville),1)]),e("p",Yi,[o[3]||(o[3]=e("strong",null,"Inscrit depuis :",-1)),w(" "+v(new Date(r.value.created_at).toLocaleDateString()),1)]),e("p",Zi,[o[4]||(o[4]=e("strong",null,"Contact :",-1)),w(" "+v(r.value.email||"Non disponible"),1)]),r.value.telephone?(t(),s("p",eu,[o[5]||(o[5]=e("strong",null,"Téléphone :",-1)),w(" "+v(r.value.telephone),1)])):C("",!0),e("div",tu,[e("div",{class:"flex items-center space-x-1 cursor-pointer",onClick:A},[(t(),s(H,null,Z(5,y=>e("span",{key:y,class:"relative text-yellow-400 w-5 h-5"},[o[6]||(o[6]=e("i",{class:"far fa-star absolute left-0 top-0"},null,-1)),e("i",{class:"fas fa-star absolute left-0 top-0 overflow-hidden",style:we({width:y<=Math.floor(l.value)?"100%":y===Math.ceil(l.value)&&l.value%1!==0?`${l.value%1*100}%`:"0%"})},null,4)])),64)),e("p",su,v(Number(l.value).toFixed(1))+"/5 ",1)]),e("span",ou,"("+v(p.value)+" votes)",1)])])]),e("div",au,[N(u,{to:`/chat/${r.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:X(()=>o[7]||(o[7]=[e("i",{class:"fas fa-comment mr-2"},null,-1),w(" Envoyer un message ")])),_:1,__:[7]},8,["to"]),N(u,{to:`/public-profile/${r.value.user_id||r.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:X(()=>o[8]||(o[8]=[e("i",{class:"fas fa-user mr-2"},null,-1),w(" Voir Profil Public ")])),_:1,__:[8]},8,["to"])]),e("div",ru,[e("span",lu,"Produits : "+v($.value.length),1),r.value.revenus?(t(),s("span",nu,"Revenus : "+v(r.value.revenus)+" FCFA",1)):C("",!0)])])):c.value?C("",!0):(t(),s("div",iu,"Commerçant non trouvé.")),n.value?(t(),s("div",uu,[e("div",du,[o[9]||(o[9]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Noter ce Commerçant",-1)),e("div",cu,[R(e("input",{"onUpdate:modelValue":o[0]||(o[0]=y=>a.value=y),type:"number",min:"1",max:"5",step:"1",class:"w-16 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"1-5"},null,512),[[Y,a.value,void 0,{number:!0}]]),e("button",{onClick:P,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Soumettre "),e("button",{onClick:o[1]||(o[1]=y=>n.value=!1),class:"bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors ml-2"}," Annuler ")])])])):C("",!0),c.value?(t(),s("div",pu)):$.value.length>0?(t(),s("div",vu,[o[10]||(o[10]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-6"},"Produits du Commerçant",-1)),e("div",mu,[(t(!0),s(H,null,Z($.value,y=>(t(),pe(Le,{key:y.id,produit:y},null,8,["produit"]))),128))])])):r.value&&$.value.length===0?(t(),s("div",fu,"Aucun produit disponible pour ce commerçant.")):C("",!0),r.value&&r.value.statistiques?(t(),s("div",gu,[o[13]||(o[13]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Statistiques",-1)),e("div",bu,[e("p",xu,[o[11]||(o[11]=e("strong",null,"Vues totales :",-1)),w(" "+v(r.value.statistiques.total_views),1)]),e("p",hu,[o[12]||(o[12]=e("strong",null,"Produits populaires :",-1)),w(" "+v(r.value.statistiques.popular_products),1)])])])):C("",!0)])])],64)}}}),Pc=re(yu,[["__scopeId","data-v-28e3885d"]]),_u={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},wu={class:"container mx-auto max-w-2xl"},ku={class:"bg-white rounded-lg shadow-md p-6"},$u={key:0,class:"text-red-500 text-xs"},Cu={key:0,class:"text-red-500 text-xs"},Au={key:0,class:"text-red-500 text-xs"},Pu={key:0,class:"text-red-500 text-xs"},ju={key:0,class:"text-red-500 text-xs"},Su=["disabled"],Mu={key:0},Vu={key:1},Eu=ae({__name:"CommercantCreate",setup(U){const i=ue(),b=de(),f=m({nom:"",ville:"",email:"",telephone:"",photo:null}),c=m(!1),r=m({}),a=p=>{const n=p.target;n.files&&n.files[0]&&(f.value.photo=n.files[0])},l=async()=>{var p,n,d,P;c.value=!0,r.value={};try{const $=new FormData;$.append("nom",f.value.nom),$.append("ville",f.value.ville),$.append("email",f.value.email),$.append("telephone",f.value.telephone),f.value.photo&&$.append("photo",f.value.photo);const A=await D.post("/commercants",$,{headers:{"Content-Type":"multipart/form-data"}});b.success("Commerçant créé avec succès !"),i.push("/profil")}catch($){((n=(p=$.response)==null?void 0:p.data)==null?void 0:n.message)=="Unauthenticated."&&i.push("login"),(P=(d=$.response)==null?void 0:d.data)!=null&&P.errors?r.value=$.response.data.errors:b.error("Erreur lors de la création du commerçant"),console.error($)}finally{c.value=!1}};return(p,n)=>(t(),s("div",_u,[e("div",wu,[n[11]||(n[11]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-store mr-2 text-[var(--espace-or)]"}),w(" Créer un Commerçant ")],-1)),e("div",ku,[e("form",{onSubmit:ne(l,["prevent"]),class:"space-y-6"},[e("div",null,[n[4]||(n[4]=e("label",{for:"nom",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom *",-1)),R(e("input",{"onUpdate:modelValue":n[0]||(n[0]=d=>f.value.nom=d),id:"nom",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerçant",required:""},null,512),[[Y,f.value.nom]]),r.value.nom?(t(),s("span",$u,v(r.value.nom),1)):C("",!0)]),e("div",null,[n[5]||(n[5]=e("label",{for:"ville",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Ville *",-1)),R(e("input",{"onUpdate:modelValue":n[1]||(n[1]=d=>f.value.ville=d),id:"ville",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville",required:""},null,512),[[Y,f.value.ville]]),r.value.ville?(t(),s("span",Cu,v(r.value.ville),1)):C("",!0)]),e("div",null,[n[6]||(n[6]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),R(e("input",{"onUpdate:modelValue":n[2]||(n[2]=d=>f.value.email=d),id:"email",type:"email",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"email@exemple.com"},null,512),[[Y,f.value.email]]),r.value.email?(t(),s("span",Au,v(r.value.email),1)):C("",!0)]),e("div",null,[n[7]||(n[7]=e("label",{for:"telephone",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Téléphone",-1)),R(e("input",{"onUpdate:modelValue":n[3]||(n[3]=d=>f.value.telephone=d),id:"telephone",type:"tel",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"+237 6XX XX XX XX"},null,512),[[Y,f.value.telephone]]),r.value.telephone?(t(),s("span",Pu,v(r.value.telephone),1)):C("",!0)]),e("div",null,[n[8]||(n[8]=e("label",{for:"photo",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Photo (optionnel)",-1)),e("input",{id:"photo",type:"file",onChange:a,class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",accept:"image/*"},null,32),r.value.photo?(t(),s("span",ju,v(r.value.photo),1)):C("",!0)]),e("div",null,[e("button",{type:"submit",disabled:c.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition disabled:opacity-50"},[c.value?(t(),s("span",Mu,n[9]||(n[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),w(" Création en cours... ")]))):(t(),s("span",Vu,n[10]||(n[10]=[e("i",{class:"fas fa-plus mr-2"},null,-1),w(" Créer le commerçant ")])))],8,Su)])],32)])])]))}}),jc=re(Eu,[["__scopeId","data-v-50d6542f"]]),zu={class:"overflow-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Uu={class:"container mx-auto max-w-4xl pb-8"},Iu={class:"text-md font-semibold text-white flex items-center"},Fu={class:"ml-2 text-sm text-white/80"},Lu={class:"text-white/90 text-sm mt-2"},Tu={key:0,class:"text-white/90 text-sm mt-1"},qu={class:"list-disc list-inside ml-4"},Ou=ae({__name:"ParrainageInfo",setup(U){const i=ue(),b=de(),f=m([]),c=async()=>{try{const a=await D.get("/parrainages/niveaux");f.value=a.data.niveaux}catch(a){b.error("Erreur lors de la récupération des niveaux de parrainage"),console.error(a)}},r=()=>{i.go(-1)};return be(()=>{c()}),(a,l)=>(t(),s("div",zu,[e("div",Uu,[l[4]||(l[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-info-circle mr-2 text-[var(--espace-or)]"}),w(" Tout Savoir sur le Parrainage ")],-1)),e("button",{onClick:r,class:"mb-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},l[0]||(l[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),w(" Retour ")])),l[5]||(l[5]=Ae('<div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-910c08f4><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-910c08f4>Qu&#39;est-ce que le Parrainage ?</h2><p class="text-[var(--espace-gris)] text-sm sm:text-base" data-v-910c08f4> Le système de parrainage d&#39;Espace Cameroun vous permet d&#39;inviter des amis avec votre code ou lien unique. Vos gains dépendent des <strong data-v-910c08f4>niveaux de parrainage</strong>, débloqués par le nombre de commerçants parrainés, avec des bonus en jetons cumulatifs. Plus vous parrainez, plus vous montez de niveau ! Découvrez les détails ci-dessous. </p></div><div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-910c08f4><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-910c08f4>Comment ça fonctionne ?</h2><ol class="list-decimal list-inside text-[var(--espace-gris)] text-sm sm:text-base space-y-2" data-v-910c08f4><li data-v-910c08f4><strong data-v-910c08f4>Obtenez votre code unique :</strong> Générez ou créez votre code de parrainage via la page &quot;Mon Parrainage&quot;.</li><li data-v-910c08f4><strong data-v-910c08f4>Partagez avec vos amis :</strong> Diffusez votre lien ou code via WhatsApp, Facebook ou d&#39;autres moyens pour inviter des amis à s&#39;inscrire.</li><li data-v-910c08f4><strong data-v-910c08f4>Attirez des commerçants :</strong> Encouragez vos filleuls à devenir des commerçants actifs sur la plateforme. Seuls les commerçants parrainés comptent pour débloquer les niveaux.</li><li data-v-910c08f4><strong data-v-910c08f4>Montez de niveau :</strong> Chaque niveau nécessite un nombre spécifique de commerçants parrainés. Une fois le seuil atteint, vous débloquez un bonus en jetons correspondant à ce niveau, en plus des bonus des niveaux précédents.</li><li data-v-910c08f4><strong data-v-910c08f4>Suivez vos progrès :</strong> Consultez votre niveau actuel, vos jetons bonus et vos avantages exclusifs sur la page &quot;Mon Parrainage&quot;.</li></ol><p class="text-[var(--espace-gris)] text-sm mt-4" data-v-910c08f4><strong data-v-910c08f4>Note importante :</strong> Les jetons bonus sont cumulatifs et attribués en fonction des niveaux atteints, pas directement par parrainage individuel. Par exemple, si vous atteignez le niveau 2 avec 5 commerçants, vous recevez les bonus des niveaux 1 et 2. </p></div>',2)),(t(!0),s(H,null,Z(f.value,p=>(t(),s("div",{key:p.id,class:"mb-6 p-4 border rounded-lg",style:we({backgroundColor:p.couleur||"#f0f0f0"})},[e("h3",Iu,[w(v(p.nom)+" "+v(p.emoji)+" ",1),e("span",Fu,"("+v(p.filleuls_requis)+" commerçants requis)",1)]),e("p",Lu,[l[1]||(l[1]=e("strong",null,"Bonus en jetons :",-1)),w(" "+v(p.jetons_bonus)+" jetons ",1)]),p.avantages.length?(t(),s("p",Tu,[l[2]||(l[2]=e("strong",null,"Avantages exclusifs :",-1)),e("ul",qu,[(t(!0),s(H,null,Z(p.avantages,n=>(t(),s("li",{key:n},v(n),1))),128))])])):C("",!0),l[3]||(l[3]=e("p",{class:"text-white/70 text-xs mt-1 italic"}," * Les jetons bonus sont crédités une fois le niveau atteint et cumulés avec les niveaux précédents. ",-1))],4))),128))])]))}}),Sc=re(Ou,[["__scopeId","data-v-910c08f4"]]),Nu={class:"w-full flex relative px-0"},Ru=["onClick"],Du={class:"flex items-center"},Wu=["onClick"],Ju=["src"],Bu={key:1,class:"fas fa-user-circle text-2xl text-gray-500"},Hu={class:"min-w-0"},Gu={class:"font-semibold text-[var(--espace-vert)] truncate"},Xu={class:"text-xs text-[var(--espace-gris)] truncate"},Ku={class:"flex items-center"},Qu={key:0,class:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center mr-2"},Yu={class:"text-xs text-[var(--espace-gris)] ml-2 whitespace-nowrap"},Zu={class:"w-full grid grid-rows-[10%_86%]"},ed={class:"flex border-b"},td={key:1,class:"text-xl h-[10%] font-semibold text-[var(--espace-vert)] p-4"},sd={key:0,class:"h-full flex flex-col"},od={class:"block text-[var(--espace-vert)]"},ad={class:"text-gray-800"},rd={class:"text-xs text-[var(--espace-gris)] text-right mr-2"},ld={key:0,class:"text-center text-[var(--espace-gris)]"},nd={class:"px-2 md:px-4 z-20"},id={class:"bg-white shadow-lg rounded-full flex items-center flex-wrap p-2 border max-w-3xl mx-auto gap-2"},ud={key:0,class:"bg-yellow-200 text-yellow-800 text-xs px-3 py-1 rounded-full flex items-center gap-2 ml-4"},dd={key:1,class:"flex items-center justify-center h-full"},cd=ae({__name:"Messages",setup(U){const i=()=>{const E=window.location.hostname;return E==="localhost"||E==="127.0.0.1"?"http://localhost:8000/storage/":"https://api.espacecameroun.com/storage/"},b=me(()=>i()),f=ue(),c=je(),r=he(),a=de(),l=Ie(),p=m([]),n=m([]),d=m(null),P=m(""),$=m(!0),A=m(0),h=m(!1),o=m(!1),u=m(null),y=m(null),S=m(window.innerWidth<768);let T=null;const L=()=>{Ge(()=>{var E;(E=u.value)==null||E.scrollTo({top:u.value.scrollHeight,behavior:"smooth"})})},O=()=>{y.value=null,localStorage.removeItem("chatProduct")},F=async()=>{var E,_;try{const x=await D.get("/conversations");p.value=x.data.conversations}catch(x){((_=(E=x.response)==null?void 0:E.data)==null?void 0:_.message)=="Unauthenticated."&&f.push("login"),a.error("Erreur lors de la récupération des conversations"),console.error(x)}},M=async(E,_=!0)=>{var x,K,W;if(!o.value){o.value=!0;try{_&&(A.value=0,n.value=[]),$.value=!1;const B=await D.get(`/chat/${E}?offset=${A.value}`);n.value=[...B.data.messages],h.value=B.data.hasMore;const te=localStorage.getItem("chatProduct"),ie=p.value.find(ee=>ee.user_id===E);let ce="",ve="/default-avatar.png";ie?(ce=ie.is_commercant?ie.name:((x=B.data.user)==null?void 0:x.nom)||"",ve=ie.profile_photo||"/default-avatar.png"):te?(ce=JSON.parse(te).commercant_name||((K=B.data.user)==null?void 0:K.nom)||"",ve=(ie==null?void 0:ie.profile_photo)||"/default-avatar.png"):ce=((W=B.data.user)==null?void 0:W.nom)||"",d.value={user_id:E,name:ce,is_commercant:(ie==null?void 0:ie.is_commercant)||!1,profile_photo:ve},te&&(y.value=JSON.parse(te)),await J(E),L()}catch(B){a.error("Erreur lors du chargement des messages"),console.error(B)}finally{o.value=!1}}},oe=E=>{f.push({name:"messages",params:{receiverId:E}}),S.value&&($.value=!1)},le=async()=>{var x,K,W,B,te,ie,ce,ve,ee,k,se,q;if(!P.value.trim()||!d.value){a.error("Veuillez sélectionner une conversation et écrire un message");return}const E=P.value.trim(),_={id:-Date.now(),sender_id:(x=r.user)==null?void 0:x.id,receiver_id:d.value.user_id,content:E,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_read:!1,product_id:((K=y.value)==null?void 0:K.id)||null,sender:{id:((W=r.user)==null?void 0:W.id)??0,nom:((B=r.user)==null?void 0:B.nom)??"",email:((te=r.user)==null?void 0:te.email)??"",telephone:((ie=r.user)==null?void 0:ie.telephone)??"",ville:((ce=r.user)==null?void 0:ce.ville)??"",premium:((ve=r.user)==null?void 0:ve.premium)??!1,parrain_id:((ee=r.user)==null?void 0:ee.parrain_id)??0},receiver:{id:d.value.user_id,nom:d.value.name,email:null,telephone:null,ville:null,premium:!1,parrain_id:null},product:y.value||null};n.value.push(_),P.value="",L();try{const fe=await D.post(`/chat/${d.value.user_id}`,{content:E,product_id:(k=y.value)==null?void 0:k.id});y.value&&O()}catch(fe){((q=(se=fe.response)==null?void 0:se.data)==null?void 0:q.message)=="Unauthenticated."&&f.push("login"),a.error("Échec d'envoi"),console.error(fe),n.value=n.value.filter($e=>$e.id!==_.id)}},Q=()=>{!u.value||!h.value||o.value||u.value.scrollTop<=100&&(A.value+=30,M(d.value.user_id,!1))},z=()=>{S.value=window.innerWidth<768,$.value=window.innerWidth>=768},J=async E=>{var _,x;try{const K=await D.put("/messages/mark-all-as-read");l.saveUnreadMessagesToLocalStorage(K.data.unread_messages)}catch(K){((x=(_=K.response)==null?void 0:_.data)==null?void 0:x.message)=="Unauthenticated."&&f.push("login"),console.error("Erreur lors du marquage des messages comme lus:",K),a.error("Erreur lors de la mise à jour des messages lus")}},V=()=>{$.value=!$.value},g=(E,_)=>{const x=_?`/commercants/${E}`:`/users/${E}`;f.push(x)},j=E=>{var _;T&&(T.stopListening("MessageSent"),window.Echo.leave(`chat.${T.params.receiverId}`)),E&&((_=r.user)!=null&&_.id)&&(T=window.Echo.channel("public-channel").listen("message.sent",x=>{var K,W;if(((K=d.value)==null?void 0:K.user_id)===E&&x.sender_id!==((W=r.user)==null?void 0:W.id)){const B={id:x.message.id,sender_id:x.sender_id,receiver_id:x.receiver_id,content:x.message.content,created_at:x.message.created_at,updated_at:x.message.updated_at,is_read:x.message.is_read,product_id:x.message.product_id||null,sender:x.sender,receiver:x.receiver,product:x.message.product||null};n.value.push(B),L(),l.saveUnreadMessagesToLocalStorage(x.unread_messages)}}),T.params={receiverId:E})};return be(()=>{F(),c.params.receiverId&&M(parseInt(c.params.receiverId)),window.addEventListener("resize",z)}),Se(()=>{T&&(T.stopListening("MessageSent"),window.Echo.leave(`chat.${T.params.receiverId}`)),window.removeEventListener("resize",z)}),xe(()=>{var E;return(E=d.value)==null?void 0:E.user_id},E=>{E&&j(E)}),xe(()=>c.params.receiverId,async E=>{E&&await M(parseInt(E))}),(E,_)=>{var K,W;const x=ge("router-link");return t(),s("div",Nu,[N(ye,{name:"slide-fade"},{default:X(()=>[$.value||!S.value?(t(),s("div",{key:0,class:G(["bg-white pt-8 shadow-md p-4 overflow-y-auto transition-all",S.value?"absolute top-0 left-0 h-full z-30 w-full":"w-[400px]"])},[_[1]||(_[1]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Conversations",-1)),(t(!0),s(H,null,Z(p.value,B=>(t(),s("div",{key:B.user_id,onClick:te=>oe(B.user_id),class:"p-2 hover:bg-gray-100 cursor-pointer rounded flex items-center justify-between transition-colors"},[e("div",Du,[e("div",{onClick:ne(te=>g(B.user_id,B.is_commercant),["stop"]),class:"w-10 h-10 bg-[var(--espace-or)] rounded-full mr-2 flex items-center justify-center overflow-hidden cursor-pointer"},[B.profile_photo?(t(),s("img",{key:0,src:b.value+B.profile_photo,alt:"Photo de profil",class:"w-full h-full object-cover"},null,8,Ju)):(t(),s("i",Bu))],8,Wu),e("div",Hu,[e("p",Gu,v(B.name),1),e("p",Xu,v(B.last_message),1)])]),e("div",Ku,[B.unread_count>0?(t(),s("div",Qu,v(B.unread_count),1)):C("",!0),e("div",Yu,v(new Date(B.updated_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)])],8,Ru))),128))],2)):C("",!0)]),_:1}),e("div",Zu,[e("div",ed,[!$.value&&S.value&&d.value?(t(),s("button",{key:0,onClick:V,class:"text-green-900 p-2 rounded-full hover:bg-[var(--espace-or)] transition text-start"},_[2]||(_[2]=[e("i",{class:"fas fa-arrow-left text-2xl"},null,-1)]))):C("",!0),d.value?(t(),s("h2",td,v(d.value.name),1)):C("",!0)]),e("div",{class:G(["bg-white shadow-md transition-all duration-300 flex flex-col flex-1 h-full overflow-hidden w-full",$.value&&!S.value?"":"rounded-r-lg"]),onScroll:Q},[d.value?(t(),s("div",sd,[e("div",{ref_key:"messagesContainer",ref:u,class:"h-full flex-1 overflow-y-auto p-2 md:p-4 space-y-3 bg-gray-50 messages-container"},[(t(!0),s(H,null,Z(n.value,B=>{var te,ie,ce;return t(),s("div",{key:B.id,class:G(["p-3 rounded-full break-words",{"bg-blue-200 ml-auto max-w-[85%] md:max-w-[70%]":B.sender_id===((te=I(r).user)==null?void 0:te.id),"bg-gray-200 max-w-[85%] md:max-w-[70%]":B.sender_id!==((ie=I(r).user)==null?void 0:ie.id)}])},[e("strong",od,v(B.sender.nom)+" :",1),e("p",ad,[(ce=B.product)!=null&&ce.id?(t(),pe(x,{key:0,to:{name:"produit",params:{id:B.product.id}},class:"text-blue-500 underline hover:text-blue-700 ml-1"},{default:X(()=>[w("[Produit "+v(B.product.nom)+"]",1)]),_:2},1032,["to"])):C("",!0),w(" "+v(B.content),1)]),e("p",rd,v(new Date(B.created_at).toLocaleTimeString()),1)],2)}),128)),o.value?(t(),s("div",ld,"Chargement...")):C("",!0)],512),e("div",nd,[e("div",id,[(K=y.value)!=null&&K.id?(t(),s("span",ud,[w(" Produit "+v((W=y.value)==null?void 0:W.nom)+" ",1),e("button",{onClick:O,class:"ml-2 text-yellow-800 hover:text-red-600 font-bold",title:"Retirer le tag"}," × ")])):C("",!0),R(e("input",{"onUpdate:modelValue":_[0]||(_[0]=B=>P.value=B),onKeyup:He(le,["enter"]),type:"text",placeholder:"Écrivez votre message...",class:"flex-1 px-4 py-2 rounded-full focus:outline-none text-gray-700 text-sm placeholder-gray-400 min-w-[100px] md:min-w[200px]"},null,544),[[Y,P.value]]),e("button",{onClick:le,class:"ml-2 p-3 rounded-full bg-[var(--espace-vert)] text-white hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},_[3]||(_[3]=[e("i",{class:"fas fa-location-arrow text-lg"},null,-1)]))])])])):(t(),s("div",dd,_[4]||(_[4]=[e("p",{class:"text-[var(--espace-gris)] text-lg"},"Sélectionnez une conversation pour commencer.",-1)])))],34)])])}}}),Mc=re(cd,[["__scopeId","data-v-dc36503b"]]),pd={class:"mx-auto max-w-4xl py-5 px-4 flex flex-col gap-3"},vd={key:0,class:"overflow-y-scroll space-y-4"},md={class:"flex justify-between items-center"},fd={class:"text-lg font-semibold"},gd={class:"text-gray-600"},bd={class:"text-gray-600"},xd={class:"text-gray-600"},hd={class:"text-gray-600"},yd={class:"text-gray-600"},_d={key:0,class:"text-gray-600"},wd={class:"text-right"},kd=["onClick"],$d={key:1,class:"text-gray-500"},Cd={class:"mt-6 flex gap-4"},Ad={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Pd=ae({__name:"JetonHistory",setup(U){const i=ue(),f=he().user,c=m([]),r=m(!1),a=de(),l=async()=>{try{const d=await D.get(`/jeton-transactions/${f==null?void 0:f.id}`);c.value=d.data}catch(d){console.error("Erreur lors du chargement des transactions:",d)}},p=d=>new Date(d).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=async d=>{var P,$,A,h;if(confirm(`Refaire l'achat de ${d.nombre_jetons} jetons avec le même service (${d.methode_paiement}) ?`)){r.value=!0;try{const o=await D.post("/acheter-jetons",{nombre_jetons:d.nombre_jetons,payment_service:d.methode_paiement,phone_number:d.phone_number});a.success(o.data.message),l()}catch(o){(($=(P=o.response)==null?void 0:P.data)==null?void 0:$.message)=="Unauthenticated."&&i.push("login"),a.error(((h=(A=o.response)==null?void 0:A.data)==null?void 0:h.message)||"Erreur lors de l'achat."),console.error(o)}finally{r.value=!1}}};return be(()=>{f&&l()}),(d,P)=>{const $=ge("router-link");return t(),s("div",pd,[P[4]||(P[4]=e("h1",{class:"text-3xl font-bold text-[var(--espace-vert)]"},"Historique des Transactions de Jetons",-1)),c.value.length>0?(t(),s("div",vd,[(t(!0),s(H,null,Z(c.value,A=>(t(),s("div",{key:A.id,class:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow"},[e("div",md,[e("div",null,[e("p",fd,"Achat de "+v(A.nombre_jetons)+" jetons",1),e("p",gd,"Montant: "+v(A.montant)+" FCFA",1),e("p",bd,"Méthode: "+v(A.methode_paiement),1),e("p",xd,"Numéro: "+v(A.phone_number),1),e("p",hd,"Statut: "+v(A.statut),1),e("p",yd,"Date: "+v(p(A.date_transaction)),1),A.transaction_id_mesomb?(t(),s("p",_d," ID Transaction: "+v(A.transaction_id_mesomb),1)):C("",!0)]),e("div",wd,[e("button",{onClick:h=>n(A),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] mr-2"},P[0]||(P[0]=[e("i",{class:"fas fa-redo"},null,-1),w(" Refaire ")]),8,kd)])])]))),128))])):(t(),s("p",$d,"Aucune transaction trouvée.")),e("div",Cd,[N($,{to:"/acheter-jetons",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:X(()=>P[1]||(P[1]=[w(" Acheter des Jetons ")])),_:1,__:[1]}),N($,{to:"/commercant/produits",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:X(()=>P[2]||(P[2]=[w(" Booster un Produit ")])),_:1,__:[2]})]),r.value?(t(),s("div",Ad,P[3]||(P[3]=[Ae('<div class="bg-white p-6 rounded-lg shadow-lg text-center" data-v-5312e1a5><p class="text-lg text-[var(--espace-vert)]" data-v-5312e1a5>Veuillez patienter...</p><svg class="animate-spin h-8 w-8 text-[var(--espace-vert)] mx-auto mt-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-5312e1a5><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-5312e1a5></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" data-v-5312e1a5></path></svg></div>',1)]))):C("",!0)])}}}),Vc=re(Pd,[["__scopeId","data-v-5312e1a5"]]),jd={class:"min-h-screen bg-gray-100 py-8 sm:px-6"},Sd={class:"container mx-auto max-w-3xl bg-white rounded-lg shadow-md p-6"},Md={class:"flex flex-col sm:flex-row items-center gap-6 mb-6"},Vd={class:"relative"},Ed=["src"],zd={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-xl p-1 rounded-full"},Ud={class:"flex-1"},Id={class:"text-gray-600"},Fd={key:0,class:"text-sm text-gray-500"},Ld={class:"text-gray-600"},Td={class:"text-gray-600"},qd=ae({__name:"ProfilePublic",setup(U){const i=je(),b=ue(),f=de(),c=m(null),r=async()=>{var l,p;try{const n=await D.get(`/profile/public/${i.params.id}`);c.value=n.data}catch(n){((p=(l=n.response)==null?void 0:l.data)==null?void 0:p.message)=="Unauthenticated."&&b.push("login"),f.error("Erreur lors de la récupération du profil."),console.error(n)}},a=()=>{var l;(l=c.value)!=null&&l.id?b.push({name:"messages",params:{receiverId:c.value.id}}):f.error("Impossible d'accéder au chat. Profil invalide.")};return be(()=>{r()}),(l,p)=>{var n,d,P,$,A,h,o,u,y,S,T,L,O,F,M,oe,le,Q,z,J,V,g;return t(),s("div",jd,[e("div",Sd,[e("div",Md,[e("div",Vd,[(n=c.value)!=null&&n.photo?(t(),s("img",{key:0,src:`http://localhost:8000/storage/${(d=c.value)==null?void 0:d.photo}`,alt:"Photo de profil",class:"w-24 h-24 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,Ed)):(t(),s("div",{key:1,class:"w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:we({background:`${((h=(A=($=(P=c.value)==null?void 0:P.niveaux_users)==null?void 0:$.at(-1))==null?void 0:A.parrainage_niveau)==null?void 0:h.couleur)||"#0af"}`})},p[0]||(p[0]=[e("i",{class:"fas fa-user-circle text-5xl"},null,-1)]),4)),(o=c.value)!=null&&o.premium?(t(),s("i",zd)):C("",!0)]),e("div",Ud,[e("h1",{class:"text-3xl font-bold flex items-center gap-2",style:we({color:`${((T=(S=(y=(u=c.value)==null?void 0:u.niveaux_users)==null?void 0:y.at(-1))==null?void 0:S.parrainage_niveau)==null?void 0:T.couleur)||"#0af"}`})},[w(v((L=c.value)==null?void 0:L.nom)+" ",1),(O=c.value)!=null&&O.premium?(t(),s("span",{key:0,class:"text-white text-sm px-2 py-1 rounded-full uppercase font-semibold",style:we({background:`${((le=(oe=(M=(F=c.value)==null?void 0:F.niveaux_users)==null?void 0:M.at(-1))==null?void 0:oe.parrainage_niveau)==null?void 0:le.couleur)||"#0af"}`})}," Premium ",4)):C("",!0)],4),e("p",Id,"Statut : "+v((Q=c.value)!=null&&Q.commercant?"Commerçant":"Utilisateur"),1),(z=c.value)!=null&&z.subscription_ends_at?(t(),s("p",Fd," Abonnement Premium jusqu'au "+v(new Date((J=c.value)==null?void 0:J.subscription_ends_at).toLocaleDateString()),1)):C("",!0),e("p",Ld,"Ville : "+v((V=c.value)==null?void 0:V.ville),1),e("p",Td,"Téléphone : "+v((g=c.value)==null?void 0:g.telephone),1)]),e("div",{class:"mt-6 flex justify-center"},[e("button",{onClick:a,class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},p[1]||(p[1]=[e("i",{class:"fas fa-comments mr-2"},null,-1),w(" Discuter ")]))])]),p[2]||(p[2]=e("div",{class:"mt-6 text-center"},[e("p",{class:"text-gray-700"},"Ce profil affiche les informations publiques de l'utilisateur.")],-1))])])}}}),Ec=re(qd,[["__scopeId","data-v-e1d303b7"]]),Od={class:"overflow-y-scroll h-full bg-gradient-to-b from-gray-50 to-gray-100 p-4"},Nd={class:"bg-white p-6 rounded-lg shadow-md mb-6"},Rd={class:"space-y-4"},Dd={class:"text-gray-700"},Wd={class:"text-gray-700"},Jd={class:"text-gray-700"},Bd={class:"text-gray-700"},Hd={class:"text-gray-700"},Gd={class:"bg-white p-6 rounded-lg shadow-md mb-6"},Xd=["disabled"],Kd={key:0,class:"animate-spin inline-block w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2"},Qd={key:0,class:"mt-4 text-green-600 text-center"},Yd=ae({__name:"Doc",setup(U){ue();const i=m(!1),b=m(!1),f=m({name:"",email:"",message:""}),c=async()=>{i.value=!0;try{if((await fetch("https://formspree.io/f/xanwpnlk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f.value)})).ok)b.value=!0,f.value={name:"",email:"",message:""},setTimeout(()=>{b.value=!1},5e3);else throw new Error("Échec de l’envoi")}catch(r){console.error("Erreur lors de la soumission:",r)}finally{i.value=!1}};return(r,a)=>{const l=ge("router-link");return t(),s("div",Od,[a[33]||(a[33]=Ae('<div class="text-center mb-8" data-v-e1156810><h1 class="text-3xl font-bold text-[var(--espace-vert)]" data-v-e1156810>📘 Documentation - Espace Cameroun</h1><p class="text-gray-600 mt-2" data-v-e1156810>Votre espace pour faciliter le commerce au Cameroun</p><p class="text-lg font-semibold text-[var(--espace-or)] mt-1" data-v-e1156810>Commerce facile, opportunités infinies.</p></div><section class="bg-white p-6 rounded-lg shadow-md mb-6" data-v-e1156810><h2 class="text-xl font-semibold text-[var(--espace-vert)] mb-4" data-v-e1156810>À Propos d’Espace Cameroun</h2><p class="text-gray-700" data-v-e1156810> Espace Cameroun est une plateforme de marketplace conçue pour connecter commerçants, acheteurs et revendeurs. Son objectif principal est de créer un espace numérique où les transactions commerciales peuvent se dérouler facilement et en toute sécurité. Notre mission est de faciliter l’activité commerciale au Cameroun en offrant des outils simples et accessibles à tous. </p></section>',2)),e("section",Nd,[a[27]||(a[27]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4"},"Fonctionnalités Clés",-1)),e("div",Rd,[e("div",null,[a[6]||(a[6]=e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Messagerie",-1)),e("p",Dd,[a[4]||(a[4]=w(" Communiquez directement avec vos partenaires commerciaux pour négocier ou confirmer des transactions via la section ")),N(l,{to:"/messages",class:"text-blue-500 underline"},{default:X(()=>a[3]||(a[3]=[w("Chat")])),_:1,__:[3]}),a[5]||(a[5]=w(". "))])]),a[23]||(a[23]=e("div",null,[e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Gestion des Portefeuilles"),e("p",{class:"text-gray-700"}," Créez et gérez vos portefeuilles Orange Money ou MTN pour recevoir ou envoyer des paiements en toute sécurité. ")],-1)),e("div",null,[a[10]||(a[10]=e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Achat et Vente de Jetons",-1)),e("p",Wd,[a[8]||(a[8]=w(" Participez au marché des jetons via ")),N(l,{to:"/jetonMarket",class:"text-blue-500 underline"},{default:X(()=>a[7]||(a[7]=[w("Marché des Jetons")])),_:1,__:[7]}),a[9]||(a[9]=w(" pour vendre vos jetons ou en acheter, générant des revenus ou des ressources pour booster vos annonces. "))])]),e("div",null,[a[14]||(a[14]=e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Poster des Produits ou Services",-1)),e("p",Jd,[a[12]||(a[12]=w(" Devenez commerçant en créant un compte via ")),N(l,{to:"/profil",class:"text-blue-500 underline"},{default:X(()=>a[11]||(a[11]=[w("Profil")])),_:1,__:[11]}),a[13]||(a[13]=w(", puis publiez vos produits (ex. téléphones, vêtements) ou services (ex. réparations, cours) en remplissant les détails (nom, prix, description, photos), sélectionnant un portefeuille, et soumettant votre annonce. "))])]),a[24]||(a[24]=e("div",null,[e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Boostage des Produits et Services"),e("p",{class:"text-gray-700"}," Utilisez vos jetons gagnés pour booster vos produits ou services, augmentant leur visibilité auprès des acheteurs et revendeurs sur la plateforme. ")],-1)),e("div",null,[a[18]||(a[18]=e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Collaborations",-1)),e("p",Bd,[a[16]||(a[16]=w(" Travaillez avec d’autres commerçants pour proposer des produits ou services en collaboration via ")),N(l,{to:"/collaborations",class:"text-blue-500 underline"},{default:X(()=>a[15]||(a[15]=[w("Collaborations")])),_:1,__:[15]}),a[17]||(a[17]=w(". "))])]),e("div",null,[a[22]||(a[22]=e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Système de Parrainage",-1)),e("p",Hd,[a[20]||(a[20]=w(" Invitez d’autres utilisateurs à créer un compte commerçant via ")),N(l,{to:"/parrainage",class:"text-blue-500 underline"},{default:X(()=>a[19]||(a[19]=[w("Équipe")])),_:1,__:[19]}),a[21]||(a[21]=w(" et gagnez 1 jeton par parrainage. Atteignez des paliers (ex. 10 commerçants parrainés pour 10 jetons bonus) et utilisez ces jetons pour booster vos annonces ou les échanger sur le marché des jetons. "))])]),a[25]||(a[25]=e("div",null,[e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Abonnement Premium"),e("p",{class:"text-gray-700"}," Souscrivez à un abonnement premium pour accéder à des privilèges exclusifs, comme une visibilité accrue, des fonctionnalités avancées, et des avantages spéciaux (détails à venir). ")],-1)),a[26]||(a[26]=e("div",null,[e("h3",{class:"text-lg font-medium text-[var(--espace-vert)]"},"Et Bien Plus"),e("p",{class:"text-gray-700"}," Découvrez d’autres fonctionnalités au fil de votre utilisation pour optimiser votre expérience commerciale. ")],-1))])]),e("section",Gd,[a[31]||(a[31]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4"},"Ressources et Support",-1)),a[32]||(a[32]=e("p",{class:"text-gray-700 mb-4"}," Pour toute question ou assistance, utilisez le formulaire ci-dessous pour nous contacter. Vous pouvez aussi rester à l’écoute pour les mises à jour et les nouvelles fonctionnalités à venir. ",-1)),e("form",{onSubmit:ne(c,["prevent"]),class:"space-y-4"},[e("div",null,[a[28]||(a[28]=e("label",{for:"name",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom",-1)),R(e("input",{type:"text",id:"name",name:"name","onUpdate:modelValue":a[0]||(a[0]=p=>f.value.name=p),required:"",class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",placeholder:"Votre nom"},null,512),[[Y,f.value.name]])]),e("div",null,[a[29]||(a[29]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),R(e("input",{type:"email",id:"email",name:"email","onUpdate:modelValue":a[1]||(a[1]=p=>f.value.email=p),required:"",class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",placeholder:"votre@email.com"},null,512),[[Y,f.value.email]])]),e("div",null,[a[30]||(a[30]=e("label",{for:"message",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Message",-1)),R(e("textarea",{id:"message",name:"message","onUpdate:modelValue":a[2]||(a[2]=p=>f.value.message=p),required:"",rows:"4",class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",placeholder:"Votre message"},null,512),[[Y,f.value.message]])]),e("button",{type:"submit",disabled:i.value,class:G(["w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg font-bold flex items-center justify-center transition",{"opacity-50 cursor-not-allowed":i.value}])},[i.value?(t(),s("span",Kd)):C("",!0),e("span",null,v(i.value?"Envoi...":"Envoyer"),1)],10,Xd)],32),b.value?(t(),s("p",Qd,"Merci ! Votre message a été envoyé avec succès. ")):C("",!0)]),a[34]||(a[34]=e("section",{class:"bg-white p-6 rounded-lg shadow-md"},[e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4"},"Prochaines Étapes"),e("p",{class:"text-gray-700"}," Nous travaillons continuellement pour améliorer Espace Cameroun. Restez connectés pour découvrir de nouvelles fonctionnalités et opportunités commerciales dans un avenir proche. ")],-1))])}}}),zc=re(Yd,[["__scopeId","data-v-e1156810"]]),Zd={class:"overflow-y-scroll bg-gray-50 flex flex-col"},ec={class:"max-w-5xl mx-auto px-6 sm:px-8 py-12 grid gap-6"},tc={class:"flex items-center mb-4"},sc={class:"flex items-center justify-center w-12 h-12 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full shadow"},oc={class:"ml-4 text-lg font-semibold text-gray-800"},ac={key:0,class:"text-gray-700 mb-2 leading-relaxed"},rc={key:1,class:"list-disc pl-6 space-y-1 text-gray-700"},lc={class:"bg-white max-w-3xl mx-auto px-6 py-10 rounded-2xl shadow-lg mb-12"},nc=["disabled"],ic={key:0,class:"animate-spin inline-block w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2"},uc={key:0,class:"mt-4 text-green-600 text-center"},dc=ae({__name:"Politique",setup(U){new Date().toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"});const i=m([{id:"intro",title:"Introduction",icon:"fas fa-user-shield",text:"Chez Espace Cameroun, nous nous engageons à protéger vos informations personnelles et à respecter votre vie privée."},{id:"collecte",title:"Données collectées",icon:"fas fa-database",list:["Nom, email, téléphone","Produits publiés","Messages échangés","Logs techniques","Historique de jetons"]},{id:"utilisation",title:"Utilisation des données",icon:"fas fa-cogs",list:["Gestion des comptes","Amélioration du service","Sécurité et anti-fraude"]},{id:"partage",title:"Partage",icon:"fas fa-share-alt",text:"Nous ne vendons jamais vos données. Elles ne sont partagées qu’avec nos prestataires ou si la loi l’exige."},{id:"securite",title:"Sécurité",icon:"fas fa-lock",list:["HTTPS","Hachage des mots de passe","Surveillance des accès"]},{id:"droits",title:"Vos droits",icon:"fas fa-user-check",list:["Accès et rectification","Suppression du compte","Opposition et portabilité"]}]),b=m(!1),f=m(!1),c=m({name:"",email:"",message:""}),r=async()=>{b.value=!0;try{if((await fetch("https://formspree.io/f/xanwpnlk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c.value)})).ok)f.value=!0,c.value={name:"",email:"",message:""},setTimeout(()=>{f.value=!1},5e3);else throw new Error("Échec de l’envoi")}catch(a){console.error("Erreur envoi :",a)}finally{b.value=!1}};return(a,l)=>(t(),s("div",Zd,[l[8]||(l[8]=Ae('<section class="bg-gradient-to-r from-[var(--espace-vert)] to-green-700 text-white pt-6 pb-8 shadow-lg" data-v-0622a650><div class="max-w-4xl mx-auto text-center px-6" data-v-0622a650><h1 class="text-4xl sm:text-5xl font-bold mb-4" data-v-0622a650>Politique de Confidentialité</h1><p class="text-lg text-green-100 max-w-2xl mx-auto" data-v-0622a650> Découvrez comment <strong data-v-0622a650>Espace Cameroun</strong> protège vos données et respecte votre vie privée. </p><p class="text-lg font-semibold text-[var(--espace-or)] mt-2" data-v-0622a650>Commerce facile, opportunités infinies. </p></div></section>',1)),e("section",ec,[N(Oe,{name:"fade",tag:"div",class:"grid gap-6 md:grid-cols-2"},{default:X(()=>[(t(!0),s(H,null,Z(i.value,p=>(t(),s("div",{key:p.id,class:"bg-white rounded-2xl shadow-md hover:shadow-xl transition transform hover:-translate-y-1 p-6 flex flex-col"},[e("div",tc,[e("div",sc,[e("i",{class:G([p.icon,"text-xl"])},null,2)]),e("h2",oc,v(p.title),1)]),p.text?(t(),s("p",ac,v(p.text),1)):C("",!0),p.list?(t(),s("ul",rc,[(t(!0),s(H,null,Z(p.list,n=>(t(),s("li",{key:n},v(n),1))),128))])):C("",!0)]))),128))]),_:1})]),e("section",lc,[l[6]||(l[6]=e("h3",{class:"text-2xl font-semibold text-center text-[var(--espace-vert)] mb-4"}," 💌 Une question sur vos données ? ",-1)),l[7]||(l[7]=e("p",{class:"text-gray-600 text-center mb-6"}," Utilisez ce formulaire pour nous contacter directement. Nous vous répondrons dans les plus brefs délais. ",-1)),e("form",{onSubmit:ne(r,["prevent"]),class:"space-y-4"},[e("div",null,[l[3]||(l[3]=e("label",{for:"name",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom",-1)),R(e("input",{type:"text",id:"name",name:"name","onUpdate:modelValue":l[0]||(l[0]=p=>c.value.name=p),required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",placeholder:"Votre nom"},null,512),[[Y,c.value.name]])]),e("div",null,[l[4]||(l[4]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),R(e("input",{type:"email",id:"email",name:"email","onUpdate:modelValue":l[1]||(l[1]=p=>c.value.email=p),required:"",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",placeholder:"votre@email.com"},null,512),[[Y,c.value.email]])]),e("div",null,[l[5]||(l[5]=e("label",{for:"message",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Message",-1)),R(e("textarea",{id:"message",name:"message","onUpdate:modelValue":l[2]||(l[2]=p=>c.value.message=p),required:"",rows:"4",class:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[var(--espace-vert)] focus:outline-none",placeholder:"Votre message..."},null,512),[[Y,c.value.message]])]),e("button",{type:"submit",disabled:b.value,class:G(["w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-3 rounded-lg font-bold flex items-center justify-center transition hover:bg-yellow-400",{"opacity-50 cursor-not-allowed":b.value}])},[b.value?(t(),s("span",ic)):C("",!0),e("span",null,v(b.value?"Envoi...":"Envoyer"),1)],10,nc)],32),f.value?(t(),s("p",uc," ✅ Merci ! Votre message a été envoyé avec succès. ")):C("",!0)])]))}}),Uc=re(dc,[["__scopeId","data-v-0622a650"]]);export{to as A,bc as C,zc as D,fc as F,mc as H,Vc as J,gc as L,Mc as M,hc as P,xc as R,_c as a,Pc as b,jc as c,kc as d,yc as e,$c as f,Sc as g,wc as h,Cc as i,Ec as j,Ac as k,Uc as l};
