import{r as f,u as te,d as Q,a as ce,w as ie,o as le,b as ve,c as a,e as A,f as V,g as s,h as e,i as D,j as G,k,t as v,l as we,m as be,n as $e,F as J,p as B,q as ue,s as W,v as N,x as H,y as Te,z as Re,T as fe,A as oe,B as pe,C as _e,D as Be,E as Me,G as Xe,H as Ye,I as Ge}from"./vue-DTxKeDEm.js";import{d as De}from"./pinia-eoHnihP1.js";import{a as Ie}from"./axios-Dq7h7Pqt.js";const et=()=>{const E=window.location.hostname;return E==="localhost"||E==="127.0.0.1"?"http://localhost:8000/api/v1":"https://espacecameroun.devfack.com/api/v1"};Ie.defaults.withCredentials=!0;Ie.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";Ie.defaults.withXSRFToken=!0;const R=Ie.create({withCredentials:!0,baseURL:et(),headers:{Accept:"application/json","Content-Type":"application/json"}});R.interceptors.request.use(E=>(localStorage.getItem("auth_token"),E));const re=De("auth",{state:()=>({user:null,token:localStorage.getItem("token")||null}),actions:{async login(E){const o=await R.post("/login",E);this.user=o.data.user,this.token=o.data.token,localStorage.setItem("token",this.token??""),R.defaults.headers.common.Authorization=`Bearer ${this.token}`},async register(E){const o=await R.post("/register",E);this.user=o.data.user,this.token=o.data.token,localStorage.setItem("token",this.token??""),R.defaults.headers.common.Authorization=`Bearer ${this.token}`},async checkAuth(){if(!this.token)return!1;try{R.defaults.headers.common.Authorization=`Bearer ${this.token}`;const E=await R.get("/user");return this.user=E.data.user,!0}catch{return this.user=null,this.token=null,localStorage.removeItem("token"),!1}},async logout(){try{this.token&&(R.defaults.headers.common.Authorization=`Bearer ${this.token}`,await R.post("/logout"))}catch{}this.user=null,this.token=null,localStorage.removeItem("token"),delete R.defaults.headers.common.Authorization}}}),Ke="/assets/logoOrangeweb-C9Cko1mf.webp",ze=De("userState",()=>{const E=f(0),o=f(0),x=te(),m=()=>{const r=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");E.value=r.length;const g=localStorage.getItem("unread_messages");o.value=g?parseInt(g,10):0},t=r=>{localStorage.setItem("pending_collaborations",JSON.stringify(r)),E.value=r.length},d=r=>{localStorage.setItem("unread_messages",r.toString()),o.value=r},i=async r=>{var _;const g=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");g.push({produit_id:r.produit_id,prix_revente:r.prix_revente,status:"pending",created_at:new Date().toISOString()}),t(g);try{return await R.post("/collaborations",{produit_id:r.produit_id,prix_revente:r.prix_revente}),await p(),x.success("Demande de collaboration envoyée !"),!0}catch(P){const b=g.filter(n=>!(n.produit_id===r.produit_id&&n.prix_revente===r.prix_revente));return t(b),x.error(((_=P.response)==null?void 0:_.data.message)||"Erreur lors de la demande de collaboration"),!1}},p=async()=>{try{const r=await R.get("/user/badges");E.value=r.data.collaborations_pending,console.log(r.data),d(r.data.unread_messages||0)}catch(r){console.error("Erreur lors de la synchronisation des badges:",r)}};return{collaborationsPending:E,unreadMessages:o,initializeState:m,addCollaboration:i,syncCollaborationsWithBackend:p,clearState:()=>{localStorage.removeItem("pending_collaborations"),localStorage.removeItem("unread_messages"),E.value=0,o.value=0},saveCollaborationsToLocalStorage:t,saveUnreadMessagesToLocalStorage:d}}),Ee=De("product",{state:()=>({product:{},products:[],isLoading:!1,hasMore:!0,page:1,sort:"random",userId:null,relatedProperties:[]}),getters:{user:E=>re().user},actions:{async fetchProducts(E={},o=!1){var x,m;if(!(this.isLoading||!o&&!this.hasMore)){this.isLoading=!0,o&&(this.products=[],this.page=1,this.hasMore=!0);try{const t=await R.get("/produits",{params:{...E,page:this.page,sort:this.sort}});if(console.log(t.data.data),E.per_page==="all")this.products=o?t.data:[...this.products,...t.data];else{const d=t.data.data;this.products=o?d:[...this.products,...d],this.hasMore=t.data.current_page<t.data.last_page,this.page=t.data.current_page+1}}catch(t){throw((m=(x=t.response)==null?void 0:x.data)==null?void 0:m.message)||"Erreur lors du chargement des produits"}finally{this.isLoading=!1}}},async toggleFavorite(E){var d,i;const o=re();if(!o.user&&(await o.checkAuth(),!o.user)){console.warn("Utilisateur non connecté, redirection ou action nécessaire");return}const x=o.user;console.log(`user ${JSON.stringify(x)}`);const m=this.products.find(p=>p.id===E);let t=!1;m&&(m.is_favorited_by=!m.is_favorited_by,m.counts.favorites_count=m.is_favorited_by?m.counts.favorites_count+1:m.counts.favorites_count-1,t=!0),this.product&&this.product.id===E&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count+1:this.product.counts.favorites_count-1,t=!0);try{const p=await R.post(`/produits/${E}/favorite`),c=p.data.produit;if(t){const r=this.products.findIndex(g=>g.id===E);r!==-1&&(this.products[r]={...this.products[r],...c}),this.product&&this.product.id===E&&(this.product={...this.product,...c})}return p.data.message}catch(p){if(t){const c=this.products.find(r=>r.id===E);c&&(c.is_favorited_by=!c.is_favorited_by,c.counts.favorites_count=c.is_favorited_by?c.counts.favorites_count-1:c.counts.favorites_count+1),this.product&&this.product.id===E&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count-1:this.product.counts.favorites_count+1)}throw((i=(d=p.response)==null?void 0:d.data)==null?void 0:i.message)||"Erreur lors de la mise à jour des favoris"}},async viewProduct(E){var o,x;try{const m=await R.get(`/produits/${E}`);this.product=m.data.produit;const t=this.products.findIndex(d=>d.id===E);t!==-1?this.products[t]={...this.products[t],...this.product}:this.products.push(this.product)}catch(m){throw((x=(o=m.response)==null?void 0:o.data)==null?void 0:x.message)||"Erreur lors du chargement du produit"}},setSort(E){this.sort=E,this.page=1,this.products=[],this.hasMore=!0,this.fetchProducts({},!0)},setUserId(E){this.userId=E}}}),tt={key:0,class:"fixed top-14 right-4 z-50 flex items-center gap-2 rounded-full px-4 py-2"},st={class:"text-sm font-semibold text-[var(--espace-vert)]"},ot={class:"text-gray-800"},at=Q({__name:"SoldeUser",setup(E){ce();const o=re(),x=f(0),m=async()=>{if(o.user)try{x.value=o.user.jetons,console.log(x.value)}catch(t){console.error("Erreur lors de la récupération des jetons:",t)}};return ie(()=>o.user,()=>{m()}),le(()=>{m()}),(t,d)=>{const i=ve("router-link");return V(o).user?(s(),a("div",tt,[d[1]||(d[1]=e("i",{class:"fas fa-coins text-[var(--espace-or)] text-lg"},null,-1)),e("span",st,[D(i,{to:"/jeton-history"},{default:G(()=>[d[0]||(d[0]=k(" Jetons : ")),e("span",ot,v(x.value),1)]),_:1,__:[0]})])])):A("",!0)}}}),Z=(E,o)=>{const x=E.__vccOpts||E;for(const[m,t]of o)x[m]=t;return x},Qe=Z(at,[["__scopeId","data-v-12adcefd"]]),rt={class:"relative"},lt={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] top-0 left-0 w-full z-50 shadow-md"},nt={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},it={class:"flex items-center gap-1 sm:gap-3"},ut={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},ct=["aria-label"],dt={class:"flex items-center gap-2"},pt=["src"],vt={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},mt={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},ft=Q({__name:"HeaderBar",setup(E){const o=re(),x=ze();ce();const m=o.user;we();const t=f(!1),d=f(!1),i=f(""),p=Ee(),c=f(!1),r=f(null),g=f(!1),_=be(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...o.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle"},{to:"/messages",label:"Messages",icon:"fa-comment-dots",badge:x.unreadMessages},...o.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:x.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),P=async()=>{if(o.user)try{await x.syncCollaborationsWithBackend()}catch($){console.error("Erreur lors du chargement des badges:",$)}};ie(()=>o.user,$=>{$&&(P(),x.initializeState())},{immediate:!0}),ie(()=>x.collaborationsPending,$=>{$>-1&&(t.value=!0,setTimeout(()=>t.value=!1,300))}),ie(()=>x.unreadMessages,$=>{$>-1&&(d.value=!0,setTimeout(()=>d.value=!1,300))});const b=async()=>{if(i.value.trim())try{await p.fetchProducts({search:i.value.trim()},!0),i.value="",c.value=!1}catch($){console.error("Erreur lors de la recherche:",$)}},n=$=>{if(g.value){g.value=!1;return}r.value&&!r.value.contains($.target)&&(c.value=!1)},h=async()=>{c.value=!c.value,c.value&&(g.value=!0,await Re())};return le(()=>{var $;o.user&&(P(),x.initializeState()),document.addEventListener("click",n),($=o.user)!=null&&$.id&&window.Echo.channel(`chat.${o.user.id}`).listen("MessageSent",F=>{var z;console.log("📩 header e reçu :",F.message),((z=o.user)==null?void 0:z.id)===F.receiver_id&&(console.log("📩 header e reçu :",F.message),x.saveUnreadMessagesToLocalStorage(F.unread_messages))})}),$e(()=>{var $;document.removeEventListener("click",n),($=o.user)!=null&&$.id&&window.Echo.leave(`chat.${o.user.id}`)}),($,F)=>{const z=ve("RouterLink");return s(),a("div",rt,[e("header",lt,[e("div",nt,[e("div",it,[D(z,{to:"/","aria-label":"Retour à l'accueil"},{default:G(()=>F[2]||(F[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Ke,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),F[3]||(F[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ",-1))]),e("nav",ut,[(s(!0),a(J,null,B(_.value,M=>(s(),ue(z,{key:M.to,to:M.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:G(()=>[e("i",{class:W(["fas",M.icon])},null,2),k(" "+v(M.label)+" ",1),M!=null&&M.badge&&M.badge>-1?(s(),a("span",{key:0,class:W(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":M.to==="/collaborations"&&t.value||M.to==="/messages"&&d.value}]),"aria-label":M.to==="/collaborations"?"Collaborations en attente":M.to==="/messages"?"Messages non lus":""},v(M.badge),11,ct)):A("",!0)]),_:2},1032,["to"]))),128))]),D(Qe),e("div",dt,[V(m)?(s(),a("button",{key:0,onClick:h,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},F[4]||(F[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)]))):A("",!0),V(o).user?(s(),ue(z,{key:1,to:"/profil",class:"relative flex items-center justify-center","aria-label":"Profil"},{default:G(()=>{var M;return[(M=V(m))!=null&&M.photo?(s(),a("img",{key:0,src:`http://localhost:8000/storage/${V(m).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,pt)):(s(),a("div",vt,F[5]||(F[5]=[e("i",{class:"fas fa-user-circle text-2xl text-gray-100"},null,-1)])))]}),_:1})):A("",!0),V(o).user?(s(),ue(z,{key:2,to:"/messages",class:"relative flex items-center justify-center","aria-label":"Messages"},{default:G(()=>[F[6]||(F[6]=e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},[e("i",{class:"fas fa-comment-dots text-2xl text-gray-100"})],-1)),V(x).unreadMessages>-1?(s(),a("span",{key:0,class:W(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":d.value}]),"aria-label":"Messages non lus"},v(V(x).unreadMessages),3)):A("",!0)]),_:1,__:[6]})):A("",!0)])]),c.value?(s(),a("div",{key:0,ref_key:"searchOverlayRef",ref:r,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",mt,[N(e("input",{"onUpdate:modelValue":F[0]||(F[0]=M=>i.value=M),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Te(b,["enter"])},null,544),[[H,i.value]]),e("button",{onClick:b,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},F[7]||(F[7]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:F[1]||(F[1]=M=>c.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},F[8]||(F[8]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):A("",!0)])])}}}),cu=Z(ft,[["__scopeId","data-v-22f0f65a"]]),gt={class:"relative"},xt={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},bt={class:"flex justify-around items-center py-2"},ht=["aria-label"],yt=Q({__name:"FooterBar",setup(E){const o=re(),x=ze();ce();const m=f(!1),t=f(!1),d=be(()=>[{to:"/",label:"Accueil",icon:"fa-home"},...o.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle"},...o.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open"}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:x.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users"}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt"},{to:"/register",label:"Inscription",icon:"fa-user-plus"}]]);return ie(()=>x.collaborationsPending,i=>{i>0&&(m.value=!0,setTimeout(()=>m.value=!1,300))}),ie(()=>x.unreadMessages,i=>{i>0&&(t.value=!0,setTimeout(()=>t.value=!1,300))}),(i,p)=>{const c=ve("RouterLink");return s(),a("div",gt,[D(fe,{name:"slide-up"},{default:G(()=>[e("nav",xt,[e("div",bt,[(s(!0),a(J,null,B(d.value,r=>(s(),ue(c,{key:r.to,to:r.to,"aria-label":r.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:G(()=>[e("i",{class:W(["fas text-lg",r.icon])},null,2),r!=null&&r.badge&&r.badge>-1?(s(),a("span",{key:0,class:W(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":r.to==="/collaborations"&&m.value||r.to==="/messages"&&t.value}]),"aria-label":r.to==="/collaborations"?"Collaborations en attente":r.to==="/messages"?"Messages non lus":""},v(r.badge),11,ht)):A("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),du=Z(yt,[["__scopeId","data-v-df5ad5ec"]]),_t={class:"mb-4"},wt={class:"block text-sm sm:text-base font-medium mb-1 text-[var(--espace-gris)]"},$t={class:"relative"},kt={class:"absolute inset-y-0 left-3 flex items-center text-[var(--espace-or)]"},Ct=["type","value","required","placeholder"],At={key:0,class:"text-red-500 text-sm mt-1"},de=Q({__name:"Form",props:{label:String,icon:String,type:{type:String,default:"text"},modelValue:[String,Number],required:Boolean,placeholder:String,error:String},emits:["update:modelValue"],setup(E){return(o,x)=>(s(),a("div",_t,[e("label",wt,v(E.label),1),e("div",$t,[e("span",kt,[e("i",{class:W(`fas ${E.icon}`)},null,2)]),e("input",{type:E.type,value:E.modelValue,onInput:x[0]||(x[0]=m=>o.$emit("update:modelValue",m.target.value)),required:E.required,placeholder:E.placeholder,class:W(["w-full pl-10 pr-4 py-3 rounded-xl border text-sm sm:text-base transition","focus:outline-none focus:ring-2",E.error?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-[var(--espace-or)]"])},null,42,Ct)]),E.error?(s(),a("p",At,v(E.error),1)):A("",!0)]))}}),Pt={class:"overflow-y-scroll bg-gray-100 flex items-center justify-center px-4 py-8"},St={class:"w-full max-w-lg bg-[rgba(255,255,255,0.85)] rounded-2xl shadow-xl p-6 sm:p-10"},jt={class:"text-center text-sm text-gray-600 mt-6"},Vt=Q({__name:"Login",setup(E){const o=f({login:"",mot_de_passe:""}),x=f({}),m=ce(),t=te(),d=re(),i=async()=>{var p;try{await d.login({login:o.value.login,mot_de_passe:o.value.mot_de_passe}),t.success("Connexion réussie !"),m.push({name:"home"})}catch(c){console.error("Erreur lors de la connexion:",c);const r=c.message||"Erreur lors de la connexion. Veuillez vérifier vos informations.";t.error(r),((p=c.response)==null?void 0:p.status)===422&&(x.value=c.response.data.errors||{})}};return(p,c)=>{const r=ve("router-link");return s(),a("div",Pt,[e("div",St,[c[5]||(c[5]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-sign-in-alt mr-2 text-[var(--espace-or)]"}),k(" Connexion ")],-1)),c[6]||(c[6]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[k(" Connectez-vous à "),e("strong",null,"Espace Cameroun"),k(" pour accéder à vos achats et votre espace commerçant. ")],-1)),e("form",{onSubmit:oe(i,["prevent"]),class:"space-y-5"},[D(de,{label:"Email ou Téléphone",icon:"fa-envelope",modelValue:o.value.login,"onUpdate:modelValue":c[0]||(c[0]=g=>o.value.login=g),type:"text",required:"",error:x.value.login},null,8,["modelValue","error"]),D(de,{label:"Mot de passe",icon:"fa-lock",modelValue:o.value.mot_de_passe,"onUpdate:modelValue":c[1]||(c[1]=g=>o.value.mot_de_passe=g),type:"password",required:"",error:x.value.mot_de_passe},null,8,["modelValue","error"]),c[2]||(c[2]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-sign-in-alt mr-2"}),k(" Se connecter ")],-1))],32),e("p",jt,[c[4]||(c[4]=k(" Pas de compte ? ")),D(r,{to:"/register",class:"text-[var(--espace-vert)] font-medium hover:text-[var(--espace-or)] hover:underline"},{default:G(()=>c[3]||(c[3]=[k(" Inscrivez-vous ici ")])),_:1,__:[3]})])])])}}}),pu=Z(Vt,[["__scopeId","data-v-2cfde5d8"]]),Mt="/assets/logo-ba4eAQQi.png",zt={key:0,class:"fixed inset-0 bg-[var(--espace-white)] bg-opacity-50 flex items-center justify-center z-50","aria-label":"Chargement en cours",role:"status"},Et=Q({__name:"Loader",props:{isLoading:{type:Boolean}},setup(E){return(o,x)=>(s(),ue(fe,{name:"fade"},{default:G(()=>[o.isLoading?(s(),a("div",zt,x[0]||(x[0]=[e("div",{class:"relative p-6"},[e("img",{src:Mt,alt:"Logo Espace Cameroun",class:"h-12 w-12 object-contain animate-spin-pulse"}),e("div",{class:"absolute inset-0 rounded-full border-4 border-[var(--espace-or)] border-t-transparent animate-spin"})],-1)]))):A("",!0)]),_:1}))}}),ke=Z(Et,[["__scopeId","data-v-f60cc94a"]]),It={class:"h-full bg-gray-100 pt-5 px-4 sm:px-2"},Lt={class:"h-full w-full overflow-y-scroll"},Ft={key:0},Tt={key:1,class:"grid grid-cols-1 pt-4 pb-2 lg:pb-12 md:grid-cols-3 sm:grid-cols-2 lg:grid-cols-4 gap-6"},Rt={class:"relative w-full h-40 overflow-hidden rounded-t-lg mb-2"},Dt={key:0,class:"absolute z-12 top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Nt=["src"],Ut=["onClick"],Ot=["onClick"],qt={key:3,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Jt={class:"p-2"},Wt={class:"text-lg font-semibold flex justify-between text-[var(--espace-vert)] truncate"},Ht=["onClick"],Bt={class:"text-sm text-[var(--espace-gris)] line-clamp-2"},Xt={class:"text-md font-bold text-[var(--espace-or)] mt-2"},Gt={class:"text-sm text-[var(--espace-gris)]"},Kt={class:"text-sm text-[var(--espace-gris)] mt-2"},Qt={class:"ml-4"},Zt={key:2,class:"text-center text-[var(--espace-gris)]"},Yt={class:"bg-white rounded-lg p-6 sm:p-8 w-full max-w-md mx-4 shadow-lg"},es={class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},ts={class:"mt-2 p-4 bg-gray-50 rounded-lg border border-gray-200"},ss={key:0,class:"grid grid-cols-3 gap-2 mb-2"},os=["src"],as=["onClick"],rs=["value"],ls={key:0,class:"flex items-center gap-2"},ns={class:"flex gap-4 pt-2"},is={type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition"},us=Q({__name:"CommercantProduits",setup(E){const o=re(),x=ce(),m=te(),t=f(!1),d=f([]),i=f([]),p=f(!1),c=f(!1),r=f(null),g=f({}),_=f({nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0}),P=f([]),b=f([]),n=f(null),h=async()=>{t.value=!0;try{const y=await R.get("/commercant/produits");d.value=y.data.produits.map(l=>({...l,photo_url:l.photos&&l.photos.length>0?l.photos[0]:"https://via.placeholder.com/150"})),console.log(y.data),d.value.forEach(l=>{g.value[l.id]||(g.value[l.id]=0)})}catch{m.error("Erreur lors du chargement des produits")}finally{t.value=!1}},$=async()=>{t.value=!0;try{const y=await R.get("/categories");i.value=y.data.categories}catch{m.error("Erreur lors de la chargement des catégories")}finally{t.value=!1}},F=()=>{_.value={nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0},P.value=[],b.value=[],p.value=!0},z=y=>{r.value=y,_.value={nom:y.nom,description:y.description||"",prix:y.prix,stock:y.quantite,category_id:y.category_id,collaboratif:!!y.collaboratif,marge_min:y.marge_min||0},P.value=[],b.value=y.photos||[],g.value[y.id]||(g.value[y.id]=0),c.value=!0},M=y=>{const l=y.target;if(l.files){const u=Array.from(l.files);P.value=[...P.value,...u],b.value=[...b.value,...u.map(S=>URL.createObjectURL(S))],n.value&&(n.value.value="")}},w=y=>{P.value.splice(y,1),b.value.splice(y,1)},U=async()=>{var l,u;t.value=!0;const y=new FormData;y.append("nom",_.value.nom),y.append("description",_.value.description),y.append("prix",_.value.prix.toString()),y.append("stock",_.value.stock.toString()),y.append("category_id",_.value.category_id),y.append("collaboratif",_.value.collaboratif?"1":"0"),y.append("marge_min",_.value.marge_min.toString()),P.value.forEach(S=>y.append("photos[]",S));for(let[S,I]of y.entries())console.log(`${S}:`,I);try{if(p.value){const S=await R.post("/commercant/produits",y,{headers:{"Content-Type":"multipart/form-data"}});console.log(S.data),m.success("Produit ajouté avec succès")}else{const S=await R.post(`/commercant/produits/${(l=r.value)==null?void 0:l.id}`,y,{headers:{"Content-Type":"multipart/form-data"}});m.success("Produit modifié avec succès")}await h(),O()}catch(S){m.error(((u=S.response)==null?void 0:u.data.message)||"Erreur lors de la sauvegarde du produit")}finally{t.value=!1}},O=()=>{p.value=!1,c.value=!1,r.value=null,P.value=[],b.value=[]},L=be(()=>y=>g.value[y]||0),ee=y=>{var S;const l=d.value.find(I=>I.id===y),u=(S=l==null?void 0:l.photos)!=null&&S.length?l.photos.length-1:0;g.value[y]=Math.min((g.value[y]||0)+1,u)},ae=y=>{g.value[y]=Math.max((g.value[y]||0)-1,0)};return le(()=>{var y;if(!((y=o.user)!=null&&y.commercant)){m.error("Accès réservé aux commerçants"),x.push("/");return}h(),$()}),(y,l)=>{const u=ve("router-link");return s(),a(J,null,[D(ke,{isLoading:t.value},null,8,["isLoading"]),e("div",It,[e("div",Lt,[e("div",{class:"flex justify-between items-center"},[l[9]||(l[9]=e("h1",{class:"text-1xl md:text-2xl font-bold text-[var(--espace-vert)] text-md mb-2 font-poppins"},[e("i",{class:"fas fa-box-open mr-1 text-[var(--espace-or)] text-md!important"}),k(" Mes Produits ")],-1)),e("button",{onClick:F,class:"mb-2 md:text-xl text-[var(--espace-vert)] font-semibold px-2 py-1 rounded hover:bg-[var(--espace-vert)] hover:text-white transition inline-flex items-center"},l[8]||(l[8]=[e("i",{class:"fas fa-plus mr-2"},null,-1),k(" Ajouter un produit ")]))]),t.value?(s(),a("div",Ft,l[10]||(l[10]=[e("div",{class:"flex items-center justify-center py-10"},[e("i",{class:"fas fa-spinner animate-spin text-2xl text-[var(--espace-vert)]"})],-1)]))):d.value.length?(s(),a("div",Tt,[(s(!0),a(J,null,B(d.value,S=>(s(),a("div",{key:S.id,class:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition relative"},[e("div",Rt,[S.collaboratif?(s(),a("span",Dt," Collaboratif ")):A("",!0),D(u,{to:`/produits/${S.id}`,class:"block relative"},{default:G(()=>[e("div",{class:"flex w-full h-full slider-container",style:pe({transform:`translateX(-${L.value(S.id)*100}%)`})},[(s(!0),a(J,null,B(S.photos,(I,q)=>(s(),a("img",{key:q,src:I,class:"h-40 object-contain flex-shrink-0 mx-auto w-full",alt:"Photo du produit"},null,8,Nt))),128))],4)]),_:2},1032,["to"]),S.photos&&S.photos.length>1?(s(),a("button",{key:1,onClick:I=>ae(S.id),class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},l[11]||(l[11]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,Ut)):A("",!0),S.photos&&S.photos.length>1?(s(),a("button",{key:2,onClick:I=>ee(S.id),class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},l[12]||(l[12]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,Ot)):A("",!0),S.photos&&S.photos.length>1?(s(),a("div",qt,[(s(!0),a(J,null,B(S.photos,(I,q)=>(s(),a("span",{key:q,class:W(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":q===L.value(S.id)}])},null,2))),128))])):A("",!0)]),e("div",Jt,[e("h2",Wt,[D(u,{to:`/produits/${S.id}`,class:"block relative"},{default:G(()=>[k(v(S.nom),1)]),_:2},1032,["to"]),e("button",{onClick:I=>z(S),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},l[13]||(l[13]=[e("i",{class:"fas fa-pencil text-sm"},null,-1)]),8,Ht)]),e("p",Bt,v(S.description||"Aucune"),1),e("p",Xt,v(S.prix)+" FCFA",1),e("p",Gt,"Stock: "+v(S.quantite),1),e("div",Kt,[e("span",null,[l[14]||(l[14]=e("i",{class:"fas fa-eye mr-1"},null,-1)),k(" "+v(S.raw_views_count||0)+" vues",1)]),e("span",Qt,[l[15]||(l[15]=e("i",{class:"fas fa-heart mr-1"},null,-1)),k(" "+v(S.favorites_count||0)+" favoris",1)])])])]))),128))])):(s(),a("p",Zt,"Aucun produit pour le moment."))]),D(fe,{name:"fade"},{default:G(()=>{var S;return[p.value||c.value?(s(),a("div",{key:0,class:"overflow-y-scroll fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:oe(O,["self"])},[e("div",Yt,[e("h2",es,v(p.value?"Ajouter un produit":"Modifier le produit"),1),e("form",{onSubmit:oe(U,["prevent"]),class:"space-y-4"},[e("div",null,[l[19]||(l[19]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Photos du produit",-1)),e("div",ts,[b.value.length?(s(),a("div",ss,[(s(!0),a(J,null,B(b.value,(I,q)=>(s(),a("div",{key:q,class:"relative w-full h-20"},[e("img",{src:I,class:"w-full h-full object-cover rounded-lg",alt:"Prévisualisation"},null,8,os),e("button",{onClick:oe(K=>w(q),["prevent"]),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs"},l[16]||(l[16]=[e("i",{class:"fas fa-times"},null,-1)]),8,as)]))),128))])):A("",!0),e("input",{ref_key:"fileInput",ref:n,type:"file",multiple:"",onChange:M,class:"hidden",accept:"image/*"},null,544),b.value.length?(s(),a("button",{key:2,onClick:l[1]||(l[1]=I=>{var q;return(q=n.value)==null?void 0:q.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},l[18]||(l[18]=[e("i",{class:"fas fa-plus mr-2"},null,-1),k(" Ajouter une autre photo ")]))):(s(),a("button",{key:1,onClick:l[0]||(l[0]=I=>{var q;return(q=n.value)==null?void 0:q.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},l[17]||(l[17]=[e("i",{class:"fas fa-camera mr-2"},null,-1),k(" Ajouter une photo ")])))])]),e("div",null,[l[20]||(l[20]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Nom",-1)),N(e("input",{"onUpdate:modelValue":l[2]||(l[2]=I=>_.value.nom=I),type:"text",required:"",class:"input-style"},null,512),[[H,_.value.nom]])]),e("div",null,[l[21]||(l[21]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Description",-1)),N(e("textarea",{"onUpdate:modelValue":l[3]||(l[3]=I=>_.value.description=I),rows:"3",class:"input-style"},null,512),[[H,_.value.description]])]),e("div",null,[l[22]||(l[22]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Prix (FCFA)",-1)),N(e("input",{"onUpdate:modelValue":l[4]||(l[4]=I=>_.value.prix=I),type:"number",min:"0",required:"",class:"input-style"},null,512),[[H,_.value.prix,void 0,{number:!0}]])]),e("div",null,[l[23]||(l[23]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Stock",-1)),N(e("input",{"onUpdate:modelValue":l[5]||(l[5]=I=>_.value.stock=I),type:"number",min:"0",required:"",class:"input-style"},null,512),[[H,_.value.stock,void 0,{number:!0}]])]),e("div",null,[l[25]||(l[25]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Catégorie",-1)),N(e("select",{"onUpdate:modelValue":l[6]||(l[6]=I=>_.value.category_id=I),required:"",class:"input-style"},[l[24]||(l[24]=e("option",{value:""},"Sélectionner une catégorie",-1)),(s(!0),a(J,null,B(i.value,I=>(s(),a("option",{key:I.id,value:I.id},v(I.nom),9,rs))),128))],512),[[_e,_.value.category_id]])]),p.value||!((S=r.value)!=null&&S.collaboratif)?(s(),a("div",ls,[N(e("input",{id:"collaboratif",type:"checkbox","onUpdate:modelValue":l[7]||(l[7]=I=>_.value.collaboratif=I)},null,512),[[Be,_.value.collaboratif]]),l[26]||(l[26]=e("label",{for:"collaboratif",class:"text-sm text-[var(--espace-vert)]"},"Collaboratif",-1))])):A("",!0),e("div",ns,[e("button",is,v(p.value?"Ajouter":"Modifier"),1),e("button",{type:"button",onClick:O,class:"flex-1 bg-[var(--espace-gris)] text-white font-semibold px-4 py-2 rounded hover:bg-gray-700 transition"}," Annuler ")])],32)])])):A("",!0)]}),_:1})])],64)}}}),vu=Z(us,[["__scopeId","data-v-05d3d6ce"]]),cs={class:"overflow-y-scroll bg-white flex justify-center px-4"},ds={class:"flex flex-col w-full max-w-lg rounded-2xl pb-16 sm:p-10"},ps={class:"text-center text-sm text-gray-600 mt-6"},vs=Q({__name:"Register",setup(E){const o=f({nom:"",telephone:"",email:"",ville:"",mot_de_passe:"",parrain_code:""}),x=f({}),m=ce(),t=we(),d=te(),i=re();le(()=>{const c=t.params.code;c&&(o.value.parrain_code=c)});const p=async()=>{var c,r,g;try{console.log("Envoi des données d'inscription:",o.value),await i.register(o.value),d.success("Inscription réussie !"),m.push({name:"home"})}catch(_){console.error("Erreur lors de l'inscription:",_);const P=((r=(c=_.response)==null?void 0:c.data)==null?void 0:r.message)||"Erreur lors de l'inscription. Veuillez vérifier vos informations.";d.error(P),((g=_.response)==null?void 0:g.status)===422&&(x.value=_.response.data.errors)}};return(c,r)=>{const g=ve("router-link");return s(),a("div",cs,[e("div",ds,[r[9]||(r[9]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-user-plus mr-2 text-[var(--espace-or)]"}),k(" Créez votre compte ")],-1)),r[10]||(r[10]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[k(" Rejoignez "),e("strong",null,"Espace Cameroun"),k(" et profitez d’une expérience d’achat unique. Vos informations resteront confidentielles. ")],-1)),e("form",{onSubmit:oe(p,["prevent"]),class:"space-y-5"},[D(de,{label:"Nom",icon:"fa-user",modelValue:o.value.nom,"onUpdate:modelValue":r[0]||(r[0]=_=>o.value.nom=_),type:"text",required:"",error:x.value.nom},null,8,["modelValue","error"]),D(de,{label:"Téléphone",icon:"fa-phone",modelValue:o.value.telephone,"onUpdate:modelValue":r[1]||(r[1]=_=>o.value.telephone=_),type:"tel",required:"",error:x.value.telephone},null,8,["modelValue","error"]),D(de,{label:"Email (optionnel)",icon:"fa-envelope",modelValue:o.value.email,"onUpdate:modelValue":r[2]||(r[2]=_=>o.value.email=_),type:"email",error:x.value.email},null,8,["modelValue","error"]),D(de,{label:"Ville",icon:"fa-city",modelValue:o.value.ville,"onUpdate:modelValue":r[3]||(r[3]=_=>o.value.ville=_),type:"text",required:"",error:x.value.ville},null,8,["modelValue","error"]),D(de,{label:"Mot de passe",icon:"fa-lock",modelValue:o.value.mot_de_passe,"onUpdate:modelValue":r[4]||(r[4]=_=>o.value.mot_de_passe=_),type:"password",required:"",error:x.value.mot_de_passe},null,8,["modelValue","error"]),D(de,{label:"Code de parrainage (optionnel)",icon:"fa-users",modelValue:o.value.parrain_code,"onUpdate:modelValue":r[5]||(r[5]=_=>o.value.parrain_code=_),type:"text",error:x.value.parrain_code},null,8,["modelValue","error"]),r[6]||(r[6]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-user-plus mr-2"}),k(" S'inscrire ")],-1))],32),e("p",ps,[r[8]||(r[8]=k(" Vous avez déjà un compte ? ")),D(g,{to:"/login",class:"text-[var(--espace-vert)] font-medium hover:underline"},{default:G(()=>r[7]||(r[7]=[k(" Connectez-vous ici ")])),_:1,__:[7]})]),r[11]||(r[11]=e("p",{class:"text-center text-xs text-gray-400 mt-2 pb-4"},[k(" En vous inscrivant, vous acceptez nos "),e("a",{href:"/conditions",class:"hover:underline text-[var(--espace-vert)]"},"conditions d'utilisation"),k(" et notre "),e("a",{href:"/confidentialite",class:"hover:underline text-[var(--espace-vert)]"},"politique de confidentialité"),k(". ")],-1))])])}}}),mu=Z(vs,[["__scopeId","data-v-d079a63c"]]),ms={key:0,class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-4"},fs={class:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-y-auto animate-fade-in max-h-[90vh]"},gs={class:"p-6"},xs={key:0,class:"grid md:grid-cols-3 gap-6"},bs={key:1,class:"flex flex-col md:flex-row max-w-3xl mx-auto p-8 bg-white rounded-xl shadow-lg"},hs={class:"md:w-1/3 mb-6 md:mb-0 pr-6 border-r border-gray-200"},ys={class:"font-extrabold text-lg mb-2"},_s={class:"mb-2 text-sm opacity-90"},ws={class:"text-3xl font-extrabold"},$s={class:"flex flex-col text-sm font-medium text-gray-700"},ks={key:0,class:"text-xs text-red-600 mt-1"},Cs={class:"flex gap-4"},As=["value"],Ps=["src"],Ss={key:0,class:"text-xs text-red-600 mt-1 block"},js=["disabled"],Vs={class:"text-xs text-gray-400 mt-4 text-center"},Ms=Q({__name:"SubscriptionModal",props:{isOpen:{type:Boolean}},emits:["close","upgraded"],setup(E,{emit:o}){const x=o,m=te(),t=f(""),d=f(""),i=f(""),p=f(!1),c=f(!1),r=f(!1),g=b=>{t.value=b,p.value=!1,c.value=!1,d.value="",i.value=""},_=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],P=async()=>{if(p.value=!i.value,c.value=!d.value,p.value||c.value){m.error("Veuillez remplir tous les champs correctement.");return}r.value=!0;try{console.log({subscription_type:t.value,payment_service:d.value,phone_number:i.value});const b=await R.post("/upgrade-to-premium",{subscription_type:t.value,payment_service:d.value,phone_number:i.value});r.value=!1,m.success(b.data.message),x("upgraded"),x("close")}catch(b){b.response&&b.response.data?(b.response.data,m.error("Paiement échoué :Verifiez vos informations et réessayer")):m.error("Verifiez vos informations et réessayer."),console.error(b)}finally{r.value=!1}};return(b,n)=>b.isOpen?(s(),a("div",ms,[e("div",fs,[n[17]||(n[17]=e("div",{class:"bg-gradient-to-r from-[var(--espace-vert)] to-[var(--espace-or)] p-6 text-center"},[e("h2",{class:"text-3xl font-bold text-white"},"🚀 Passez à Premium"),e("p",{class:"text-white/90 mt-1"}," Comparez et choisissez le plan qui boostera votre business ")],-1)),e("div",gs,[t.value?(s(),a("div",bs,[e("div",hs,[n[11]||(n[11]=e("h3",{class:"text-xl font-bold mb-4"},"Votre abonnement",-1)),e("div",{class:W([{"bg-green-600 text-white":t.value==="monthly","bg-yellow-400 text-gray-900":t.value==="yearly"},"rounded-lg p-4"])},[e("h4",ys,v(t.value==="monthly"?"Premium Mensuel":"Premium Annuel"),1),e("p",_s,v(t.value==="monthly"?"Accès complet à toutes les fonctionnalités.":"Payez moins, profitez plus avec 16% d’économie !"),1),e("div",ws,v(t.value==="monthly"?"5 000 FCFA":"50 000 FCFA"),1)],2)]),e("form",{onSubmit:oe(P,["prevent"]),class:"md:w-2/3 flex flex-col gap-6",novalidate:""},[n[15]||(n[15]=e("h3",{class:"text-xl font-bold mb-2"},"Détails du paiement",-1)),e("label",$s,[n[12]||(n[12]=k(" Numéro de téléphone ")),N(e("input",{"onUpdate:modelValue":n[4]||(n[4]=h=>i.value=h),type:"tel",placeholder:"Ex: 696428651",class:W(["mt-1 rounded-lg border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",{"border-red-500":p.value}]),onInput:n[5]||(n[5]=h=>p.value=!i.value),required:""},null,34),[[H,i.value]]),p.value?(s(),a("span",ks,"Veuillez entrer un numéro valide.")):A("",!0)]),n[16]||(n[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Service de paiement ",-1)),e("div",Cs,[(s(),a(J,null,B(_,h=>e("label",{key:h.value,class:W(["flex items-center gap-2 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":d.value===h.value,"border-gray-300 bg-white":d.value!==h.value,"border-red-500":c.value&&!d.value}])},[N(e("input",{type:"radio",value:h.value,"onUpdate:modelValue":n[6]||(n[6]=$=>d.value=$),class:"hidden"},null,8,As),[[Xe,d.value]]),e("img",{src:h.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Ps),e("span",{class:W([{"text-[var(--espace-vert)]":d.value===h.value,"text-gray-700":d.value!==h.value},"font-semibold select-none"])},v(h.label),3)],2)),64))]),c.value&&!d.value?(s(),a("span",Ss," Veuillez sélectionner un service. ")):A("",!0),e("button",{type:"submit",disabled:r.value||!i.value||!d.value,class:"w-full py-3 rounded-lg bg-[var(--espace-vert)] text-white font-bold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[r.value?(s(),a(J,{key:0},[n[13]||(n[13]=e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1)),n[14]||(n[14]=k(" Veuillez patienter... "))],64)):(s(),a(J,{key:1},[k(" Payer & Souscrire ")],64))],8,js),e("button",{type:"button",onClick:n[7]||(n[7]=h=>t.value=""),class:"w-full text-center text-gray-500 hover:text-[var(--espace-vert)] transition"}," ← Retour aux plans "),e("p",Vs," 🔒 Paiement sécurisé via "+v(d.value||"votre service"),1)],32)])):(s(),a("div",xs,[n[10]||(n[10]=Me('<div class="border border-gray-200 bg-gray-50 rounded-xl p-6 flex flex-col justify-between" data-v-7e8d0671><div data-v-7e8d0671><h3 class="text-xl font-bold text-gray-800" data-v-7e8d0671>Gratuit (Base)</h3><p class="text-sm text-gray-500 mb-4" data-v-7e8d0671>Pour débuter sans frais</p><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 10 produits max </li><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 5 collaborations max </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Pas de statistiques détaillées </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Pas de badge Premium </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Position prioritaire </li></ul></div><button disabled class="mt-6 w-full py-2 rounded-lg bg-gray-300 text-gray-600 font-semibold cursor-not-allowed" data-v-7e8d0671> Actuel </button></div>',1)),e("div",{class:"relative bg-gradient-to-br from-[var(--espace-vert)] to-green-500 rounded-xl text-white p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 scale-103 transition cursor-pointer",onClick:n[1]||(n[1]=h=>g("monthly"))},[n[8]||(n[8]=Me('<span class="absolute top-1 right-3 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>⭐ Populaire</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Mensuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671> Accès complet à toutes les fonctionnalités </p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>5000 FCFA / mois </div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:n[0]||(n[0]=oe(h=>g("monthly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-vert)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")]),e("div",{class:"relative bg-gradient-to-br from-yellow-400 to-[var(--espace-or)] rounded-xl text-gray-900 p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 transition cursor-pointer",onClick:n[3]||(n[3]=h=>g("yearly"))},[n[9]||(n[9]=Me('<span class="absolute top-1 right-3 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>-16% Économie</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Annuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671>Payez moins, profitez plus</p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>50 000 FCFA / an</div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:n[2]||(n[2]=oe(h=>g("yearly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-or)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")])]))])])])):A("",!0)}}),zs=Z(Ms,[["__scopeId","data-v-7e8d0671"]]),Es={class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Is={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 space-y-6 animate-fade-in max-h-[90vh] overflow-auto"},Ls={class:"flex justify-center gap-3 mb-4"},Fs=["onClick"],Ts={key:0,class:"text-xs text-red-600 mt-1"},Rs={class:"flex gap-4"},Ds=["value"],Ns=["src"],Us={key:1,class:"text-xs text-red-600 mt-1"},Os={class:"text-center text-lg font-bold mt-6"},qs={class:"text-[var(--espace-vert)]"},Js=["disabled"],Ws={key:0},Hs={key:1},Bs={key:2,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Xs={class:"w-full mt-2 text-center text-gray-500 hover:text-[var(--espace-vert)] transition"},Gs=Q({__name:"AchatJetonModal",props:{isOpen:{type:Boolean}},emits:["close","purchased"],setup(E,{emit:o}){const x=o,m=te(),t=f(10),d=f(""),i=f(""),p=f(t.value*25),c=f(!1),r=f(!1),g=f(!1),_=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],P=[10,20,50,100],b=be(()=>t.value>=10&&d.value.trim().length===9&&/^6\d{8}$/.test(d.value)&&i.value!==""),n=()=>{p.value=t.value*25},h=M=>{t.value=M,n()},$=()=>{n()},F=()=>{g.value=!(d.value.trim().length===9&&/^6\d{8}$/.test(d.value))},z=async()=>{if(r.value=!i.value,!b.value){m.error("Veuillez remplir tous les champs correctement.");return}c.value=!0;try{const M=await R.post("/acheter-jetons",{nombre_jetons:t.value,payment_service:i.value,phone_number:d.value});console.log(M.data),m.success(M.data.message),x("purchased",t.value),x("close")}catch(M){if(M.response&&M.response.data){const w=M.response.data;m.error(`Erreur: ${w.error_message||"Achat échoué"}. Détails: ${w.details||"Aucun détail."}`)}else m.error("Erreur lors de l'achat. Veuillez réessayer.");console.error(M)}finally{c.value=!1}};return ie(d,()=>{F()}),(M,w)=>{const U=ve("router-link");return s(),a("div",Es,[e("div",Is,[w[7]||(w[7]=e("h2",{class:"text-3xl font-extrabold text-[var(--espace-vert)] text-center"}," 🎫 Acheter des Jetons ",-1)),w[8]||(w[8]=e("p",{class:"text-center text-gray-600 text-sm mb-6"},"1 jeton = 25 FCFA",-1)),e("div",Ls,[(s(),a(J,null,B(P,O=>e("button",{key:O,type:"button",onClick:L=>h(O),class:W(["rounded-full px-4 py-2 border font-semibold transition",t.value===O?"bg-[var(--espace-vert)] text-white border-[var(--espace-vert)]":"bg-white text-gray-700 border-gray-300 hover:bg-[var(--espace-vert)] hover:text-white"])},v(O),11,Fs)),64))]),w[9]||(w[9]=e("label",{class:"block text-gray-700 font-semibold mb-1",for:"jetonQuantity"},[k(" Nombre de jetons "),e("span",{class:"text-sm text-gray-500"},"(min 10)")],-1)),N(e("input",{id:"jetonQuantity","onUpdate:modelValue":w[0]||(w[0]=O=>t.value=O),type:"number",min:"10",placeholder:"Ex: 10",onInput:$,class:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition"},null,544),[[H,t.value,void 0,{number:!0}]]),w[10]||(w[10]=e("label",{class:"block text-gray-700 font-semibold mb-1 mt-4",for:"phoneNumber"},[k(" Numéro de téléphone "),e("span",{class:"text-sm text-red-500"},"*")],-1)),N(e("input",{id:"phoneNumber","onUpdate:modelValue":w[1]||(w[1]=O=>d.value=O),type:"tel",placeholder:"Ex: 696428651",onInput:F,class:W(["w-full rounded-lg border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",g.value?"border-red-500":"border-gray-300"])},null,34),[[H,d.value]]),g.value?(s(),a("p",Ts," Veuillez entrer un numéro valide (9 chiffres, commençant par 6). ")):A("",!0),w[11]||(w[11]=e("label",{class:"block text-gray-700 font-semibold mb-2 mt-4",for:"paymentService"}," Service de paiement ",-1)),e("div",Rs,[(s(),a(J,null,B(_,O=>e("label",{key:O.value,class:W(["flex items-center gap-3 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":i.value===O.value,"border-gray-300 bg-white":i.value!==O.value}])},[N(e("input",{type:"radio",value:O.value,"onUpdate:modelValue":w[2]||(w[2]=L=>i.value=L),class:"hidden"},null,8,Ds),[[Xe,i.value]]),e("img",{src:O.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Ns),e("span",{class:W({"text-[var(--espace-vert)] font-bold":i.value===O.value,"text-gray-700":i.value!==O.value})},v(O.label),3)],2)),64))]),r.value&&!i.value?(s(),a("p",Us," Veuillez sélectionner un service. ")):A("",!0),e("div",Os,[w[4]||(w[4]=k(" Montant total : ")),e("span",qs,v(p.value)+" FCFA",1)]),e("button",{onClick:z,disabled:!b.value||c.value,class:"w-full mt-4 bg-[var(--espace-vert)] text-white py-3 rounded-lg font-semibold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-3"},[c.value?(s(),a("span",Hs,"veuillez patientez")):(s(),a("span",Ws,"Acheter")),c.value?(s(),a("svg",Bs,w[5]||(w[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))):A("",!0)],8,Js),e("button",Xs,[D(U,{to:"/jeton-history",onClick:w[3]||(w[3]=O=>x("close"))},{default:G(()=>w[6]||(w[6]=[k("Annuler")])),_:1,__:[6]})])])])}}}),Ks=Z(Gs,[["__scopeId","data-v-c7a0e7a2"]]),Qs={class:"space-y-6"},Zs={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},Ys={key:0,class:"space-y-2 text-[var(--espace-gris)]"},eo={class:"flex gap-2"},to={key:0,class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},so={key:0,class:"space-y-2 text-[var(--espace-gris)]"},oo={key:0,class:"w-24 h-24"},ao=["src"],ro={key:0,class:"mt-2 w-24 h-24"},lo=["src"],no={class:"flex gap-2"},io=Q({__name:"userProfile",props:{user:Object},setup(E){var _,P,b,n,h,$,F,z,M,w,U,O,L,ee,ae,y;const o=re(),x=te(),m=f(!1),t=f(o.user),d=f({nom:((_=t.value)==null?void 0:_.nom)||"",telephone:((P=t.value)==null?void 0:P.telephone)||"",email:((b=t.value)==null?void 0:b.email)||"",ville:((n=t.value)==null?void 0:n.ville)||""}),i=f(!1),p=f({nom:(($=(h=t.value)==null?void 0:h.commercant)==null?void 0:$.nom)||"",description:((z=(F=t.value)==null?void 0:F.commercant)==null?void 0:z.description)||"",email:((w=(M=t.value)==null?void 0:M.commercant)==null?void 0:w.email)||"",telephone:((O=(U=t.value)==null?void 0:U.commercant)==null?void 0:O.telephone)||"",ville:((ee=(L=t.value)==null?void 0:L.commercant)==null?void 0:ee.ville)||"",logo:null,logoPreview:(y=(ae=t.value)==null?void 0:ae.commercant)!=null&&y.logo?`http://localhost:8000/storage/${t.value.commercant.logo}`:null});console.log(` com ${JSON.stringify(p.value)}`);const c=l=>{var S;const u=(S=l.target.files)==null?void 0:S[0];if(u){if(!u.type.startsWith("image/")){x.error("Veuillez sélectionner une image.");return}if(u.size>2*1024*1024){x.error("Image trop volumineuse (max 2Mo).");return}p.value.logo=u,p.value.logoPreview=URL.createObjectURL(u)}},r=async()=>{var l;try{const u=await R.put("/profile",d.value);t.value&&(t.value.nom=u.data.user.nom||"",t.value.telephone=u.data.user.telephone||"",t.value.email=u.data.user.email||"",t.value.ville=u.data.user.ville||""),o.user=u.data.user,m.value=!1,x.success("Profil mis à jour avec succès.")}catch(u){x.error(((l=u.response)==null?void 0:l.data.message)||"Erreur lors de la mise à jour.")}},g=async()=>{var l,u,S;try{const I=new FormData;I.append("nom",p.value.nom),I.append("description",p.value.description),I.append("email",p.value.email),I.append("telephone",p.value.telephone),I.append("ville",p.value.ville),p.value.logo&&I.append("logo",p.value.logo);const q=await R.post("/commercant/update",I,{headers:{"Content-Type":"multipart/form-data"}});console.log(` com ${JSON.stringify(q.data)}`),(l=t.value)!=null&&l.commercant&&(t.value.commercant.nom=q.data.commercant.nom,t.value.commercant.description=q.data.commercant.description,t.value.commercant.email=q.data.commercant.email,t.value.commercant.telephone=q.data.commercant.telephone,t.value.commercant.ville=q.data.commercant.ville,t.value.commercant.logo=q.data.commercant.logo),o.user=t.value,p.value.logoPreview=q.data.commercant.logo?`http://localhost:8000/storage/${q.data.commercant.logo}`:null,i.value=!1,x.success("Commerce mis à jour avec succès.")}catch(I){x.error(((S=(u=I.response)==null?void 0:u.data)==null?void 0:S.message)||"Erreur lors de la mise à jour du commerce.")}};return ie(()=>o.user,l=>{var u,S,I,q,K,T;t.value=l||null,d.value={nom:(l==null?void 0:l.nom)||"",telephone:(l==null?void 0:l.telephone)||"",email:(l==null?void 0:l.email)||"",ville:(l==null?void 0:l.ville)||""},p.value={nom:((u=l==null?void 0:l.commercant)==null?void 0:u.nom)||"",description:((S=l==null?void 0:l.commercant)==null?void 0:S.description)||"",email:((I=l==null?void 0:l.commercant)==null?void 0:I.email)||"",telephone:((q=l==null?void 0:l.commercant)==null?void 0:q.telephone)||"",ville:((K=l==null?void 0:l.commercant)==null?void 0:K.ville)||"",logo:null,logoPreview:(T=l==null?void 0:l.commercant)!=null&&T.logo?`http://localhost:8000/storage/${l.commercant.logo}`:null}},{immediate:!0}),(l,u)=>{var S,I,q,K,T,se;return s(),a("div",Qs,[e("section",Zs,[u[23]||(u[23]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations personnelles",-1)),m.value?(s(),a("form",{key:1,onSubmit:oe(r,["prevent"]),class:"space-y-4"},[e("div",null,[u[18]||(u[18]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom"},"Nom",-1)),N(e("input",{"onUpdate:modelValue":u[1]||(u[1]=j=>d.value.nom=j),id:"nom",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre nom"},null,512),[[H,d.value.nom]])]),e("div",null,[u[19]||(u[19]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone"},"Téléphone",-1)),N(e("input",{"onUpdate:modelValue":u[2]||(u[2]=j=>d.value.telephone=j),id:"telephone",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre téléphone"},null,512),[[H,d.value.telephone]])]),e("div",null,[u[20]||(u[20]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email"},"Email",-1)),N(e("input",{"onUpdate:modelValue":u[3]||(u[3]=j=>d.value.email=j),id:"email",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre email (optionnel)"},null,512),[[H,d.value.email]])]),e("div",null,[u[21]||(u[21]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville"},"Ville",-1)),N(e("input",{"onUpdate:modelValue":u[4]||(u[4]=j=>d.value.ville=j),id:"ville",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre ville"},null,512),[[H,d.value.ville]])]),e("div",eo,[u[22]||(u[22]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Enregistrer les modifications"}," Enregistrer ",-1)),e("button",{onClick:u[5]||(u[5]=j=>m.value=!1),class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Annuler"}," Annuler ")])],32)):(s(),a("div",Ys,[e("p",null,[u[13]||(u[13]=e("strong",null,"Nom :",-1)),k(" "+v((S=t.value)==null?void 0:S.nom),1)]),e("p",null,[u[14]||(u[14]=e("strong",null,"Téléphone :",-1)),k(" "+v((I=t.value)==null?void 0:I.telephone),1)]),e("p",null,[u[15]||(u[15]=e("strong",null,"Email :",-1)),k(" "+v(((q=t.value)==null?void 0:q.email)||"Non défini"),1)]),e("p",null,[u[16]||(u[16]=e("strong",null,"Ville :",-1)),k(" "+v((K=t.value)==null?void 0:K.ville),1)]),e("p",null,[u[17]||(u[17]=e("strong",null,"Statut Premium :",-1)),k(" "+v((T=t.value)!=null&&T.premium?"Actif":"Inactif"),1)]),e("button",{onClick:u[0]||(u[0]=j=>m.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Modifier le profil"}," Modifier ")]))]),(se=t.value)!=null&&se.commercant?(s(),a("section",to,[u[36]||(u[36]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations du Commerce",-1)),i.value?(s(),a("form",{key:1,onSubmit:oe(g,["prevent"]),class:"space-y-4"},[e("div",null,[u[29]||(u[29]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom_commerce"},"Nom du commerce",-1)),N(e("input",{"onUpdate:modelValue":u[7]||(u[7]=j=>p.value.nom=j),id:"nom_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerce"},null,512),[[H,p.value.nom]])]),e("div",null,[u[30]||(u[30]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"description_commerce"},"Description",-1)),N(e("textarea",{"onUpdate:modelValue":u[8]||(u[8]=j=>p.value.description=j),id:"description_commerce",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Description du commerce",rows:"3"},null,512),[[H,p.value.description]])]),e("div",null,[u[31]||(u[31]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email_commerce"},"Email",-1)),N(e("input",{"onUpdate:modelValue":u[9]||(u[9]=j=>p.value.email=j),id:"email_commerce",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Email du commerce (optionnel)"},null,512),[[H,p.value.email]])]),e("div",null,[u[32]||(u[32]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone_commerce"},"Téléphone",-1)),N(e("input",{"onUpdate:modelValue":u[10]||(u[10]=j=>p.value.telephone=j),id:"telephone_commerce",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Téléphone du commerce"},null,512),[[H,p.value.telephone]])]),e("div",null,[u[33]||(u[33]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville_commerce"},"Ville",-1)),N(e("input",{"onUpdate:modelValue":u[11]||(u[11]=j=>p.value.ville=j),id:"ville_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville du commerce"},null,512),[[H,p.value.ville]])]),e("div",null,[u[34]||(u[34]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"logo_commerce"},"Logo",-1)),e("input",{id:"logo_commerce",type:"file",accept:"image/*",onChange:c,class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},null,32),p.value.logoPreview?(s(),a("div",ro,[e("img",{src:p.value.logoPreview,alt:"Aperçu logo",class:"w-full h-full object-cover rounded-md shadow"},null,8,lo)])):A("",!0)]),e("div",no,[u[35]||(u[35]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Enregistrer ",-1)),e("button",{onClick:u[12]||(u[12]=j=>i.value=!1),type:"button",class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Annuler ")])],32)):(s(),a("div",so,[t.value.commercant.logo?(s(),a("div",oo,[e("img",{src:`http://localhost:8000/storage/${t.value.commercant.logo}`,alt:"Logo du commerce",class:"w-full h-full object-cover rounded-md shadow"},null,8,ao)])):A("",!0),e("p",null,[u[24]||(u[24]=e("strong",null,"Nom du commerce :",-1)),k(" "+v(t.value.commercant.nom),1)]),e("p",null,[u[25]||(u[25]=e("strong",null,"Description :",-1)),k(" "+v(t.value.commercant.description||"Non définie"),1)]),e("p",null,[u[26]||(u[26]=e("strong",null,"Email :",-1)),k(" "+v(t.value.commercant.email||"Non défini"),1)]),e("p",null,[u[27]||(u[27]=e("strong",null,"Téléphone :",-1)),k(" "+v(t.value.commercant.telephone),1)]),e("p",null,[u[28]||(u[28]=e("strong",null,"Ville :",-1)),k(" "+v(t.value.commercant.ville),1)]),e("button",{onClick:u[6]||(u[6]=j=>i.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Modifier ")]))])):A("",!0),u[37]||(u[37]=e("section",{class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},[e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Mon Parrainage")],-1))])}}}),uo=Z(io,[["__scopeId","data-v-aaaa75a7"]]),co=Q({__name:"MerchantProfile",props:{user:Object},setup(E){const o=te(),x=f(null),m=f([]);return le(async()=>{try{const t=await R.get("/commercant/profil");x.value=t.data.commercant,m.value=t.data.produits||[]}catch(t){o.error("Erreur lors du chargement des données du commerçant: "+(t.message||t))}}),(t,d)=>null}}),po=Z(co,[["__scopeId","data-v-ce205108"]]),vo={class:"overflow-y-scroll min-h-screen relative bg-gray-100 py-8 sm:px-6"},mo={class:"flex flex-col sm:flex-row items-center justify-between mb-8 gap-4"},fo={class:"flex items-center space-x-4 relative w-full gap-1 px-3"},go={class:"relative"},xo=["src"],bo={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-lg p-1 rounded-full",style:{}},ho={key:3,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-36 bg-white border rounded-md shadow z-10"},yo={class:"space-y-1"},_o={key:0,class:"text-sm text-gray-500"},wo={key:0,class:"ml-4 flex items-center gap-2"},$o=["src"],ko=["disabled"],Co={class:"flex flex-col sm:flex-row gap-2 items-center"},Ao={class:"container mx-auto max-w-4xl"},Po={key:2,class:"fixed inset-0 bg-black bg-opacity-0 flex items-center justify-center z-50"},So={class:"bg-white rounded-lg p-4 relative w-full max-w-md"},jo=Q({__name:"Profile",setup(E){const o=ce(),x=te(),m=re(),t=f(m.user);console.log(t==null?void 0:t.value);const d=f(!1),i=f(!1),p=f(null),c=f(null),r=f(!1),g=f(!1),_=f(!1),P=be(()=>g.value?po:uo),b=f(null),n=f(null),h=f(!1);let $=null;const F=()=>{var y;(y=b.value)==null||y.click(),d.value=!1},z=y=>{const l=y.target;if(l.files&&l.files[0]){const u=l.files[0];if(!u.type.startsWith("image/")){x.error("Veuillez sélectionner une image.");return}if(u.size>2*1024*1024){x.error("Image trop volumineuse (max 2Mo).");return}c.value=u,p.value=URL.createObjectURL(u)}},M=async()=>{try{$=await navigator.mediaDevices.getUserMedia({video:!0}),h.value=!0,d.value=!1,setTimeout(()=>{n.value&&(n.value.srcObject=$)},100)}catch(y){x.error("Impossible d'accéder à la caméra."),console.error(y)}},w=()=>{if(!n.value)return;const y=n.value,l=document.createElement("canvas");l.width=y.videoWidth,l.height=y.videoHeight;const u=l.getContext("2d");u&&(u.drawImage(y,0,0,l.width,l.height),l.toBlob(S=>{S&&(c.value=new File([S],"photo.jpg",{type:"image/jpeg"}),p.value=URL.createObjectURL(c.value),U())},"image/jpeg"))},U=()=>{$&&($.getTracks().forEach(y=>y.stop()),$=null),h.value=!1},O=()=>{c.value=null,p.value=null},L=async()=>{var y,l;if(c.value){i.value=!0;try{const u=new FormData;u.append("photo",c.value);const S=await R.post("/profile/photo",u,{headers:{"Content-Type":"multipart/form-data"}});S.data.photo&&(t.value&&(t.value.photo=S.data.photo,m.user=t.value),x.success("Photo mise à jour."),O())}catch(u){x.error(((l=(y=u.response)==null?void 0:y.data)==null?void 0:l.message)||"Erreur lors de l'envoi.")}finally{i.value=!1}}},ee=async()=>{r.value=!1},ae=y=>{x.success(`Vous avez acheté ${y} jetons !`)};return ie(()=>m.user,y=>{t.value=y||null},{immediate:!0}),le(()=>{}),$e(()=>{p.value&&URL.revokeObjectURL(p.value),$&&$.getTracks().forEach(y=>y.stop())}),(y,l)=>{var u,S,I,q,K,T,se,j,C,Y,X,ne,me,ge,he,xe,Ce,Ae,Pe,Se,je;return s(),a("div",vo,[e("div",mo,[e("div",fo,[e("div",go,[(u=t.value)!=null&&u.photo?(s(),a("img",{key:0,src:`http://localhost:8000/storage/${(S=t.value)==null?void 0:S.photo}`,alt:"Photo de profil",class:"w-16 h-16 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,xo)):(s(),a("div",{key:1,class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:pe({background:`${((T=(K=(q=(I=t.value)==null?void 0:I.niveaux_users)==null?void 0:q.at(-1))==null?void 0:K.parrainage_niveau)==null?void 0:T.couleur)||"#0af"}`})},l[6]||(l[6]=[e("i",{class:"fas fa-user-circle text-4xl"},null,-1)]),4)),(se=t.value)!=null&&se.premium?(s(),a("i",bo)):A("",!0),e("button",{onClick:l[0]||(l[0]=ye=>d.value=!d.value),class:"absolute bottom-0 right-0 w-6 h-6 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full flex items-center justify-center hover:bg-[var(--espace-vert)] hover:text-white",style:{}},l[7]||(l[7]=[e("i",{class:"fas fa-pencil-alt text-xs"},null,-1)])),d.value?(s(),a("div",ho,[e("button",{onClick:M,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Caméra "),e("button",{onClick:F,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Galerie ")])):A("",!0)]),e("input",{ref_key:"galleryInput",ref:b,type:"file",accept:"image/*",class:"hidden",onChange:z},null,544),e("div",yo,[e("h1",{class:"text-2xl sm:text-3xl font-bold flex items-center gap-2 text-blue-500",style:pe({color:`${((X=(Y=(C=(j=t.value)==null?void 0:j.niveaux_users)==null?void 0:C.at(-1))==null?void 0:Y.parrainage_niveau)==null?void 0:X.couleur)||"#0af"}`})},[k(v((ne=t.value)==null?void 0:ne.nom)+" ",1),(me=t.value)!=null&&me.premium?(s(),a("span",{key:0,class:"text-black text-xs px-3 py-1 rounded-full uppercase font-bold",style:pe({background:`${((Ce=(xe=(he=(ge=t.value)==null?void 0:ge.niveaux_users)==null?void 0:he.at(-1))==null?void 0:xe.parrainage_niveau)==null?void 0:Ce.couleur)||"#0af"}`})}," Premium ",4)):A("",!0)],4),(Ae=t.value)!=null&&Ae.subscription_ends_at?(s(),a("span",_o," Jusqu'au "+v(new Date((Pe=t.value)==null?void 0:Pe.subscription_ends_at).toLocaleDateString()),1)):A("",!0)]),p.value?(s(),a("div",wo,[e("img",{src:p.value,alt:"Preview",class:"w-12 h-12 rounded-full object-cover"},null,8,$o),e("button",{onClick:L,disabled:i.value,class:W(["bg-[var(--espace-vert)] text-white px-3 py-1 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]",{"opacity-50 cursor-not-allowed":i.value}])},v(i.value?"Upload...":"Confirmer"),11,ko),e("button",{onClick:O,class:"text-red-500 hover:text-red-700"}," Annuler ")])):A("",!0)]),e("div",Co,[(Se=t.value)!=null&&Se.commercant?(s(),a("button",{key:0,onClick:l[1]||(l[1]=ye=>g.value=!g.value),class:"text-[var(--espace-or)] hover:text-[var(--espace-vert)] font-medium flex items-center gap-1"},l[8]||(l[8]=[e("i",{class:"fas fa-store"},null,-1),k(" Compte Commerçant ")]))):(s(),a("button",{key:1,onClick:l[2]||(l[2]=ye=>V(o).push("/commercant/create")),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-vert)] hover:text-white"}," Devenir commerçant ")),(je=t.value)!=null&&je.premium?A("",!0):(s(),a("button",{key:2,onClick:l[3]||(l[3]=ye=>r.value=!0),class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"}," Passer Premium "))])]),e("div",Ao,[(s(),ue(Ye(P.value)))]),r.value?(s(),ue(zs,{key:0,"is-open":r.value,onClose:l[4]||(l[4]=ye=>r.value=!1),onUpgraded:ee},null,8,["is-open"])):A("",!0),_.value?(s(),ue(Ks,{key:1,"is-open":_.value,onClose:l[5]||(l[5]=ye=>_.value=!1),onPurchased:ae},null,8,["is-open"])):A("",!0),h.value?(s(),a("div",Po,[e("div",So,[e("video",{ref_key:"videoRef",ref:n,autoplay:"",playsinline:"",class:"rounded w-full"},null,512),e("div",{class:"mt-2 flex justify-between"},[e("button",{onClick:w,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Capturer "),e("button",{onClick:U,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Annuler ")])])])):A("",!0)])}}}),fu=Z(jo,[["__scopeId","data-v-8f61c657"]]),Vo={class:"min-h-screen bg-gray-100 pt-16 pb-20 px-4 sm:px-6 flex flex-col lg:flex-row gap-4"},Mo={class:"hidden lg:block w-full max-w-xs bg-[var(--espace-blanc)] rounded-lg shadow-md p-4"},zo={class:"space-y-2"},Eo=["onClick"],Io={class:"font-poppins"},Lo={class:"flex-1 bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Fo={class:"lg:hidden mb-4"},To={class:"flex overflow-x-auto space-x-2 border-b border-[var(--espace-gris)]"},Ro=["onClick"],Do={key:0,class:"space-y-6"},No={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Uo={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Oo={class:"flex items-center gap-4 mb-4"},qo=["src"],Jo={class:"text-[var(--espace-vert)] font-semibold"},Wo={class:"text-sm text-[var(--espace-gris)]"},Ho={class:"text-sm text-[var(--espace-gris)]"},Bo={class:"text-sm text-[var(--espace-gris)]"},Xo={key:0,class:"space-y-6"},Go={key:0,class:"space-y-6"},Ko={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Qo={class:"text-base font-medium font-poppins"},Zo={class:"text-sm text-[var(--espace-gris)]"},Yo=Q({__name:"Parametres",setup(E){const o=f(!1),x=re(),m=ce(),t=te(),d=x.user,i=f("profile"),p=f({id:(d==null?void 0:d.id)??0,nom:(d==null?void 0:d.nom)??"",email:(d==null?void 0:d.email)??"",telephone:(d==null?void 0:d.telephone)??"",ville:(d==null?void 0:d.ville)??""});x.user={...x.user,...p.value};const c=f({current_password:"",new_password:"",confirm_password:""});f({});const r=f(""),g=be(()=>[...d!=null&&d.commercant?[{to:"/commercant",label:"Espace Commerçant",icon:"fa-store-alt",description:"Gérez votre boutique et vos produits"}]:[],{to:"/parrainage",label:"Parrainage",icon:"fa-users",description:"Invitez des amis et gagnez des récompenses"},{to:"/abonnements",label:"Abonnements",icon:"fa-star",description:"Gérez vos abonnements premium"},{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",description:"Gérez vos collaborations sur des produits"}]),_=async()=>{var h,$;o.value=!0;try{await R.put("/user/profile",p.value),localStorage.setItem("user",JSON.stringify(x.user)),t.success("Profil mis à jour avec succès",{timeout:3e3})}catch(F){t.error((($=(h=F.response)==null?void 0:h.data)==null?void 0:$.message)||"Erreur lors de la mise à jour du profil")}finally{o.value=!1}},P=async()=>{var h,$;o.value=!0;try{if(c.value.new_password!==c.value.confirm_password){t.error("Les mots de passe ne correspondent pas");return}if(r.value==="weak"){t.error("Le mot de passe est trop faible. Utilisez au moins 8 caractères avec des lettres, chiffres et symboles.");return}await R.put("/user/password",c.value),t.success("Mot de passe mis à jour avec succès",{timeout:3e3}),c.value={current_password:"",new_password:"",confirm_password:""},r.value=""}catch(F){t.error((($=(h=F.response)==null?void 0:h.data)==null?void 0:$.message)||"Erreur lors de la mise à jour du mot de passe")}finally{o.value=!1}},b=()=>{x.logout(),m.push({name:"login"})},n=()=>{const h=c.value.new_password;h.length===0?r.value="":h.length<8||!/[A-Za-z]/.test(h)||!/[0-9]/.test(h)?r.value="weak":/[!@#$%^&*]/.test(h)?r.value="strong":r.value="medium"};return ie(()=>c.value.new_password,n),(h,$)=>{const F=ve("RouterLink");return s(),a(J,null,[D(ke,{isLoading:o.value},null,8,["isLoading"]),e("div",Vo,[e("aside",Mo,[$[7]||($[7]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4 font-poppins"},"Paramètres",-1)),e("nav",zo,[(s(),a(J,null,B([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres options",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],z=>e("button",{key:z.id,onClick:M=>z.id==="logout"?b():i.value=z.id,class:W(["w-full flex items-center gap-3 p-3 rounded-lg transition-colors duration-300",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":i.value===z.id,"text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":i.value!==z.id}])},[e("i",{class:W(["fas",z.icon])},null,2),e("span",Io,v(z.label),1)],10,Eo)),64))])]),e("main",Lo,[e("div",Fo,[e("div",To,[(s(),a(J,null,B([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],z=>e("button",{key:z.id,onClick:M=>z.id==="logout"?b():i.value=z.id,class:W(["flex items-center gap-2 px-4 py-2 text-sm font-medium font-poppins transition-colors duration-300",{"border-b-2 border-[var(--espace-or)] text-[var(--espace-vert)]":i.value===z.id,"text-[var(--espace-gris)] hover:text-[var(--espace-vert)]":i.value!==z.id}])},[e("i",{class:W(["fas",z.icon])},null,2),k(" "+v(z.label),1)],10,Ro)),64))])]),D(fe,{name:"slide"},{default:G(()=>{var z,M;return[i.value==="profile"?(s(),a("section",Do,[$[10]||($[10]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Profil",-1)),e("div",No,[e("form",{onSubmit:oe(_,["prevent"]),class:"space-y-4"},[D(de,{label:"Nom",icon:"fa-user",modelValue:p.value.nom,"onUpdate:modelValue":$[0]||($[0]=w=>p.value.nom=w),type:"text",required:"",placeholder:"Votre nom"},null,8,["modelValue"]),D(de,{label:"Email",icon:"fa-envelope",modelValue:p.value.email,"onUpdate:modelValue":$[1]||($[1]=w=>p.value.email=w),type:"email",placeholder:"Votre email"},null,8,["modelValue"]),D(de,{label:"Téléphone",icon:"fa-phone",modelValue:p.value.telephone,"onUpdate:modelValue":$[2]||($[2]=w=>p.value.telephone=w),type:"tel",required:"",placeholder:"Votre numéro de téléphone"},null,8,["modelValue"]),D(de,{label:"Ville",icon:"fa-city",modelValue:p.value.ville,"onUpdate:modelValue":$[3]||($[3]=w=>p.value.ville=w),type:"text",required:"",placeholder:"Votre ville"},null,8,["modelValue"]),$[8]||($[8]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Mettre à jour ",-1))],32),e("div",Uo,[$[9]||($[9]=e("h3",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2 font-poppins"},"Aperçu",-1)),e("div",Oo,[e("img",{src:((M=(z=V(d))==null?void 0:z.commercant)==null?void 0:M.logo)||"https://via.placeholder.com/50",alt:"Photo de profil",class:"w-12 h-12 rounded-full object-cover"},null,8,qo),e("div",null,[e("p",Jo,v(p.value.nom||"Nonni"),1),e("p",Wo,v(p.value.email||"Non défini"),1)])]),e("p",Ho,"Téléphone: "+v(p.value.telephone||"Nonni"),1),e("p",Bo,"Ville: "+v(p.value.ville||"Non défini"),1)])])])):A("",!0)]}),_:1}),D(fe,{name:"slide"},{default:G(()=>[i.value==="security"?(s(),a("section",Xo,[$[12]||($[12]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Sécurité",-1)),e("form",{onSubmit:oe(P,["prevent"]),class:"space-y-4"},[D(de,{label:"Mot de passe actuel",icon:"fa-lock",modelValue:c.value.current_password,"onUpdate:modelValue":$[4]||($[4]=z=>c.value.current_password=z),type:"password",required:"",placeholder:"Mot de passe actuel"},null,8,["modelValue"]),D(de,{label:"Nouveau mot de passe",icon:"fa-lock",modelValue:c.value.new_password,"onUpdate:modelValue":$[5]||($[5]=z=>c.value.new_password=z),type:"password",required:"",placeholder:"Nouveau mot de passe",onInput:n},null,8,["modelValue"]),r.value?(s(),a("div",{key:0,class:W(["text-sm",{"text-red-500":r.value==="weak","text-yellow-500":r.value==="medium","text-green-500":r.value==="strong"}])}," Force du mot de passe : "+v(r.value==="weak"?"Faible":r.value==="medium"?"Moyen":"Fort"),3)):A("",!0),D(de,{label:"Confirmer le nouveau mot de passe",icon:"fa-lock",modelValue:c.value.confirm_password,"onUpdate:modelValue":$[6]||($[6]=z=>c.value.confirm_password=z),type:"password",required:"",placeholder:"Confirmer le mot de passe"},null,8,["modelValue"]),$[11]||($[11]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Changer le mot de passe ",-1))],32)])):A("",!0)]),_:1}),D(fe,{name:"slide"},{default:G(()=>[i.value==="links"?(s(),a("section",Go,[$[13]||($[13]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Autres options",-1)),e("div",Ko,[(s(!0),a(J,null,B(g.value,z=>(s(),ue(F,{key:z.to,to:z.to,class:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"},{default:G(()=>[e("i",{class:W(["fas",z.icon])},null,2),e("div",null,[e("h3",Qo,v(z.label),1),e("p",Zo,v(z.description),1)])]),_:2},1032,["to"]))),128))])])):A("",!0)]),_:1})])])],64)}}}),gu=Z(Yo,[["__scopeId","data-v-34fd2bf9"]]),ea={class:"bg-[var(--espace-blanc)] border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200"},ta={class:"relative w-full h-32 overflow-hidden rounded-lg mb-2"},sa=["src","alt"],oa={key:0,class:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex space-x-1"},aa={key:0,class:"absolute top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},ra={key:1,class:"absolute top-2 right-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},la={class:"text-sm font-semibold text-[var(--espace-vert)] font-poppins truncate"},na={class:"text-xs text-[var(--espace-gris)] truncate"},ia={class:"text-sm font-medium text-[var(--espace-or)]"},ua={class:"flex items-center justify-between mt-2 text-xs text-[var(--espace-gris)]"},ca={class:"flex items-center gap-1"},da={class:"flex items-center gap-1"},pa=["aria-label"],va=Q({__name:"ProductCard",props:{produit:{}},emits:["toggle-favorite","handleToggleFavorite"],setup(E,{emit:o}){const x=E,m=o,t=te(),d=Ee(),i=r=>{if(r==null||isNaN(r)||r===0)return"0";const g=Math.abs(r);return g<1e3?r.toString():g<1e4?(r/1e3).toFixed(1).replace(/\.0$/,"")+"k":g<1e6?Math.floor(r/1e3)+"k":g<1e9?(r/1e6).toFixed(1).replace(/\.0$/,"")+"M":(r/1e9).toFixed(1).replace(/\.0$/,"")+"B"},p=f(0),c=async()=>{var r,g;try{await d.toggleFavorite(x.produit.id),m("toggle-favorite",x.produit.id)}catch(_){t.error(((g=(r=_.response)==null?void 0:r.data)==null?void 0:g.message)||"Erreur lors de la mise à jour des favoris.")}};return(r,g)=>{var P,b;const _=ve("router-link");return s(),a("div",ea,[D(_,{to:`/produits/${r.produit.id}`,class:"block relative"},{default:G(()=>[e("div",ta,[e("div",{class:"flex w-full h-full slider-container",style:pe({transform:`translateX(-${p.value*100}%)`})},[(s(!0),a(J,null,B(r.produit.photos||[r.produit.photo_url||"https://via.placeholder.com/150"],(n,h)=>(s(),a("img",{key:h,src:n,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${r.produit.nom} - ${h+1}`},null,8,sa))),128))],4),r.produit.photos&&r.produit.photos.length>1?(s(),a("div",oa,[(s(!0),a(J,null,B(r.produit.photos,(n,h)=>(s(),a("span",{key:h,class:W(["w-1.5 h-1.5 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":h===p.value}])},null,2))),128))])):A("",!0)]),r.produit.collaboratif?(s(),a("span",aa," Collaboratif ")):A("",!0),r.produit.boosted_until&&new Date(r.produit.boosted_until)>new Date?(s(),a("span",ra," Boosté ")):A("",!0),e("h3",la,v(r.produit.nom),1),e("p",na,v(r.produit.description||"Aucune description"),1),e("p",ia,v(r.produit.prix)+" XAF",1)]),_:1},8,["to"]),e("div",ua,[e("div",ca,[g[0]||(g[0]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(i((P=r.produit.counts)==null?void 0:P.views_count)),1)]),e("div",da,[e("button",{onClick:c,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] transition active:scale-95 focus:outline-none","aria-label":r.produit.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:W(["fas fa-bookmark text-sm",{"text-[var(--espace-or)]":r.produit.is_favorited_by}])},null,2)],8,pa),e("span",null,v(i((b=r.produit.counts)==null?void 0:b.favorites_count)),1)])])])}}}),Le=Z(va,[["__scopeId","data-v-03efe6d5"]]),ma={class:"pt-4 bg-[var(--espace-blanc)] max-h-full relative"},fa={class:"relative overflow-y-scroll mx-auto px-4 sm:px-6 py-4 max-h-full"},ga={class:"fixed flex items-center overflow-x-auto space-x-2 mb-3 snap-x snap-mandatory z-5"},xa=["onClick","aria-label","aria-current"],ba={class:"fixed right-10 z-5 flex justify-end items-center mb-3"},ha=["aria-label","aria-expanded"],ya={key:0,class:"absolute -top-1 -right-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] text-[10px] rounded-full h-5 w-5 flex items-center justify-center"},_a={key:0,class:"bg-[var(--espace-blanc)] rounded-xl shadow-md p-4 mb-4 fixed top-0 left-0 right-0 z-50 sm:static sm:flex sm:items-center sm:gap-3 sm:flex-wrap"},wa={class:"flex-1 min-w-[120px]"},$a={class:"flex-1 min-w-[120px]"},ka=["value"],Ca={class:"flex-1 min-w-[100px]"},Aa={class:"flex-1 min-w-[100px]"},Pa={class:"flex-1 min-w-[120px]"},Sa=["value"],ja={class:"flex-1 min-w-[100px]"},Va=["aria-busy"],Ma={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},za=Q({__name:"Home",setup(E){const o=Ee(),x=re(),m=f([]),t=te(),d=f(!1),i=f({search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""}),p=f(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),c=f(null),r=f(null),g=async()=>{try{const z=await R.get("/categories");m.value=z.data.categories}catch(z){console.error("Erreur lors du chargement des catégories:",z),t.error("Erreur lors du chargement des catégories.")}},_=()=>{if(i.value.prix_min&&i.value.prix_max&&parseFloat(i.value.prix_min)>parseFloat(i.value.prix_max)){t.error("Le prix minimum doit être inférieur au prix maximum.");return}o.fetchProducts(i.value,!0),d.value=!1},P=()=>{i.value={search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""},o.fetchProducts({},!0)},b=z=>{o.setSort(z)},n=()=>Object.values(i.value).filter(z=>z!=="").length,h=z=>{F(z)},$=z=>{F(z)},F=async z=>{var L,ee,ae;const M=(L=x.user)==null?void 0:L.id,w=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),U=new Date().toISOString().split("T")[0],O=localStorage.getItem("lastResetDate");if((!O||O!==U)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",U)),!await w[z])try{setTimeout(async()=>{const y=await R.post("/record_view",{product_id:z,user_id:M??null});console.log(y.data),t.success(y.data.message)},1e3),w[z]=!0,localStorage.setItem("viewedProducts",JSON.stringify(w))}catch(y){console.error("Erreur lors de l'enregistrement de la vue:",y),t.error(((ae=(ee=y.response)==null?void 0:ee.data)==null?void 0:ae.message)||"Erreur lors de l'enregistrement de la vue.")}};return le(async()=>{try{await o.fetchProducts(),await g()}catch(z){console.error("Erreur lors du chargement des produits ou catégories:",z),t.error("Erreur lors du chargement des produits. Veuillez réessayer.")}c.value=new IntersectionObserver(z=>{z[0].isIntersecting&&!o.isLoading&&o.hasMore&&o.fetchProducts(i.value)},{threshold:.1}),r.value&&c.value.observe(r.value)}),$e(()=>{c.value&&r.value&&c.value.unobserve(r.value)}),(z,M)=>(s(),a("div",ma,[D(ke,{isLoading:V(o).isLoading},null,8,["isLoading"]),e("div",fa,[e("div",ga,[(s(),a(J,null,B([{id:"popular",label:"Populaire",icon:"fa-fire"},{id:"favorites",label:"Favoris",icon:"fa-heart"}],w=>e("button",{key:w.id,onClick:U=>b(w.id),class:W(["flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium font-poppins snap-center shrink-0 transition-all duration-200",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":V(o).sort===w.id,"bg-gray-100 text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":V(o).sort!==w.id}]),"aria-label":`Trier par ${w.label}`,"aria-current":V(o).sort===w.id?"true":void 0},[e("i",{class:W(["fas",w.icon])},null,2),k(" "+v(w.label),1)],10,xa)),64))]),e("div",ba,[e("button",{onClick:M[0]||(M[0]=w=>d.value=!d.value),class:"relative flex items-center justify-center w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition active:scale-95","aria-label":d.value?"Masquer les filtres":"Afficher les filtres","aria-expanded":d.value},[M[7]||(M[7]=e("i",{class:"fas fa-filter text-sm"},null,-1)),n()>0?(s(),a("span",ya,v(n()),1)):A("",!0)],8,ha)]),D(fe,{name:"slide-up"},{default:G(()=>[d.value?(s(),a("div",_a,[e("form",{onSubmit:oe(_,["prevent"]),class:"grid grid-cols-2 gap-3 sm:flex sm:flex-row sm:gap-3"},[e("div",wa,[N(e("input",{"onUpdate:modelValue":M[1]||(M[1]=w=>i.value.search=w),id:"search",type:"text",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Rechercher...","aria-label":"Rechercher un produit"},null,512),[[H,i.value.search]])]),e("div",$a,[N(e("select",{"onUpdate:modelValue":M[2]||(M[2]=w=>i.value.category=w),id:"category",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[M[8]||(M[8]=e("option",{value:""},"Toutes les Catégories",-1)),(s(!0),a(J,null,B(m.value,w=>(s(),a("option",{key:w.id,value:w.id},v(w.nom),9,ka))),128))],512),[[_e,i.value.category]])]),e("div",Ca,[N(e("input",{"onUpdate:modelValue":M[3]||(M[3]=w=>i.value.prix_min=w),id:"prix_min",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix min","aria-label":"Prix minimum"},null,512),[[H,i.value.prix_min]])]),e("div",Aa,[N(e("input",{"onUpdate:modelValue":M[4]||(M[4]=w=>i.value.prix_max=w),id:"prix_max",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix max","aria-label":"Prix maximum"},null,512),[[H,i.value.prix_max]])]),e("div",Pa,[N(e("select",{"onUpdate:modelValue":M[5]||(M[5]=w=>i.value.ville=w),id:"ville",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[M[9]||(M[9]=e("option",{value:""},"Tous les villes",-1)),(s(!0),a(J,null,B(p.value,w=>(s(),a("option",{key:w,value:w},v(w),9,Sa))),128))],512),[[_e,i.value.ville]])]),e("div",ja,[N(e("select",{"onUpdate:modelValue":M[6]||(M[6]=w=>i.value.collaboratif=w),id:"collaboratif",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},M[10]||(M[10]=[e("option",{value:""},"Collaboratif",-1),e("option",{value:"true"},"Oui",-1),e("option",{value:"false"},"Non",-1)]),512),[[_e,i.value.collaboratif]])]),e("div",{class:"flex gap-2 col-span-2 sm:col-span-1"},[M[12]||(M[12]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Appliquer les filtres"},[e("i",{class:"fas fa-check text-sm"})],-1)),e("button",{onClick:P,type:"button",class:"w-10 h-10 bg-[var(--espace-gris)] text-[var(--espace-blanc)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Réinitialiser les filtres"},M[11]||(M[11]=[e("i",{class:"fas fa-times text-sm"},null,-1)]))])],32)])):A("",!0)]),_:1}),D(Ge,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 pt-12"},{default:G(()=>[(s(!0),a(J,null,B(V(o).products,w=>(s(),ue(Le,{key:w.id,produit:w,onMouseover:U=>h(w.id),onTouchstart:U=>$(w.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:r,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":V(o).isLoading},[V(o).hasMore?A("",!0):(s(),a("p",Ma," Aucun produit supplémentaire "))],8,Va)])]))}}),xu=Z(za,[["__scopeId","data-v-53ae2504"]]),Ea={class:"overflow-y-scroll bg-[var(--espace-blanc)] pt-16 pb-20 px-4 sm:px-6"},Ia={class:"container mx-auto max-w-5xl"},La={key:0,class:"text-center text-[var(--espace-gris)]"},Fa={key:1,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Ta={class:"flex flex-col lg:flex-row gap-4 sm:gap-6"},Ra={class:"w-full lg:w-1/2 relative"},Da={class:"relative w-full h-64 sm:h-80 lg:h-96 overflow-hidden rounded-lg"},Na=["src","alt"],Ua={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Oa={key:0,class:"absolute top-3 left-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},qa={key:1,class:"absolute top-3 right-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Ja={key:2,class:"absolute bottom-3 left-3 bg-[var(--espace-bleu)] text-[var(--espace-blanc)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Commerçant Pro"},Wa={class:"w-full lg:w-1/2"},Ha={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"},Ba={class:"text-sm text-[var(--espace-gris)] mb-3"},Xa={class:"text-lg sm:text-xl font-semibold text-[var(--espace-or)] mb-3"},Ga={class:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 text-xs text-[var(--espace-gris)]"},Ka={class:"flex items-center gap-3"},Qa={class:"flex items-center gap-1"},Za={class:"flex items-center gap-1"},Ya=["aria-label"],er={class:"border-t pt-3 mt-3"},tr={class:"text-xs text-[var(--espace-gris)] mb-1"},sr={key:0,class:"ml-1 text-[var(--espace-or)]","aria-label":"Commerçant vérifié",title:"Commerçant vérifié"},or={class:"text-xs text-[var(--espace-gris)] mb-1"},ar={class:"text-xs text-[var(--espace-gris)] mb-1"},rr={class:"text-xs text-[var(--espace-gris)] mb-2"},lr={class:"flex flex-col sm:flex-row gap-3 mt-4"},nr=["disabled","aria-label"],ir={key:2,class:"text-center text-[var(--espace-gris)] text-sm font-poppins"},ur={class:"bg-[var(--espace-blanc)] rounded-lg p-4 sm:p-6 w-full max-w-md mx-4 shadow-lg"},cr={class:"text-base sm:text-lg font-semibold text-[var(--espace-vert)] mb-3 font-poppins"},dr={class:"text-xs text-[var(--espace-gris)] mb-3"},pr=["aria-label"],vr={key:0,class:"text-xs text-[var(--espace-gris)] mt-1"},mr={class:"bg-[var(--espace-blanc)] rounded-lg p-6 w-full max-w-md mx-4 shadow-lg border border-[var(--espace-or)]"},fr={class:"text-xs text-[var(--espace-gris)] mt-1 text-center"},gr={class:"text-xs text-[var(--espace-gris)] mt-1 text-center"},xr={class:"text-sm text-[var(--espace-gris)]"},br={class:"text-[var(--espace-or)]"},hr={class:"flex gap-4"},yr={key:0,class:"mt-6"},_r=["aria-busy"],wr={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},$r=Q({__name:"Produit",setup(E){const o=Ee(),x=we(),m=ce(),t=re(),d=ze(),i=te();f([]);const p=f(!1),c=f(null),r=f(null),g=f(null),_=f(!1),P=f(1),b=f(0),n=f(5),h=[100,500,1e3,5e3,1e4],$=[5,15,25,50,75],F=j=>{if(j==null||isNaN(j)||j===0)return"0";const C=Math.abs(j);return C<1e3?j.toString():C<1e4?(j/1e3).toFixed(1).replace(/\.0$/,"")+"k":C<1e6?Math.floor(j/1e3)+"k":C<1e9?(j/1e6).toFixed(1).replace(/\.0$/,"")+"M":(j/1e9).toFixed(1).replace(/\.0$/,"")+"B"},z=async()=>{try{o.isLoading=!0,await o.viewProduct(x.params.id),o.isLoading=!1,o.product.photos&&!o.product.photo_url&&(o.product.photo_url=o.product.photos[0]),await o.fetchProducts({category:o.product.category_id,per_page:8},!0),console.log(o.product)}catch(j){i.error(j||"Erreur lors du chargement du produit"),m.push({name:"home"})}finally{o.isLoading=!1}},M=()=>{var Y,X;if(!t.user){i.error("Veuillez vous connecter pour contacter le commerçant"),m.push({name:"login"});return}const j=(Y=o.product.commercant)==null?void 0:Y.telephone,C=encodeURIComponent(`Bonjour ${(X=o.product.commercant)==null?void 0:X.nom}, je suis intéressé par ${o.product.nom}. Pouvez-vous me contacter ?`);window.open(`https://wa.me/${j}?text=${C}`,"_blank")},w=()=>{var j;if(!t.user){i.error("Veuillez vous connecter pour collaborer"),m.push({name:"login"});return}if(((j=t.user.commercant)==null?void 0:j.id)===o.product.commercant_id){i.error("Vous ne pouvez pas collaborer sur votre propre produit");return}if(!o.product.collaboratif){i.error("Ce produit n’est pas ouvert à la collaboration");return}c.value=o.product.prix+(o.product.marge_min||500),p.value=!0},U=async()=>{if(!c.value||c.value<o.product.prix+(o.product.marge_min||0)){i.error(`Le prix de revente doit être supérieur ou égal à ${o.product.prix+(o.product.marge_min||0)} XAF`);return}await d.addCollaboration({produit_id:o.product.id,prix_revente:c.value})&&(i.success("Demande de collaboration envoyée",{timeout:3e3}),p.value=!1,c.value=null)},O=()=>{p.value=!1,c.value=null},L=()=>{m.push({path:`/commercant/produits/${o.product.id}/edit`})},ee=async()=>{var j,C,Y;if(!t.user||((j=t.user.commercant)==null?void 0:j.id)!==o.product.commercant_id){i.error("Seul le commerçant propriétaire peut booster ce produit");return}if(t.user.jetons<n.value){i.error(`Pas assez de Jetons. Il vous faut ${n.value} Jetons pour ce boost.`);return}try{const X=await R.post(`/produits/${o.product.id}/boost`,{duration_days:P.value,target_views:h[b.value]});t.user.jetons-=n.value,o.product.boosted_until=X.data.data.end_date,i.success(X.data.message||"Produit boosté avec succès !"),_.value=!1}catch(X){i.error(((Y=(C=X.response)==null?void 0:C.data)==null?void 0:Y.message)||"Erreur lors du boostage du produit")}},ae=()=>{var j;if(!t.user||((j=t.user.commercant)==null?void 0:j.id)!==o.product.commercant_id){i.error("Seul le commerçant propriétaire peut booster ce produit");return}_.value=!0,y()},y=()=>{const j=P.value*5,C=$[b.value];n.value=Math.max(5,j+C)};ie([P,b],()=>{y()});const l=j=>{S(j)},u=j=>{S(j)},S=async j=>{var me,ge,he;const C=(me=t.user)==null?void 0:me.id;if(!C){i.error("Connexion requise pour enregistrer la vue.");return}const Y=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),X=new Date().toISOString().split("T")[0],ne=localStorage.getItem("lastResetDate");if((!ne||ne!==X)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",X)),!Y[j])try{setTimeout(async()=>{const xe=await R.post("/record_view",{product_id:j,user_id:C});i.success(xe.data.message)},1e3),Y[j]=!0,localStorage.setItem("viewedProducts",JSON.stringify(Y))}catch(xe){console.error("Erreur lors de l'enregistrement de la vue:",xe),i.error(((he=(ge=xe.response)==null?void 0:ge.data)==null?void 0:he.message)||"Erreur lors de l'enregistrement de la vue.")}},I=async()=>{var j,C;try{await o.toggleFavorite(o.product.id)}catch(Y){i.error(((C=(j=Y.response)==null?void 0:j.data)==null?void 0:C.message)||"Erreur lors de la mise à jour des favoris.")}},q=(j,C,Y)=>{var ne;if(!t.user){i.error("Veuillez vous connecter pour démarrer une conversation"),m.push({name:"login"});return}const X={id:j,name:C,commercant_id:o.product.commercant_id,name_user:((ne=t.user)==null?void 0:ne.nom)||"Inconnu"};localStorage.setItem("chatProduct",JSON.stringify(X)),m.push(`/messages/${Y}`)},K=f(0),T=()=>{var C;const j=(((C=o.product.photos)==null?void 0:C.length)||1)-1;K.value=Math.min(K.value+1,j)},se=()=>{K.value=Math.max(K.value-1,0)};return le(()=>{z(),d.initializeState(),r.value=new IntersectionObserver(j=>{j[0].isIntersecting&&!o.isLoading&&o.hasMore&&o.fetchProducts({category:o.product.category_id,per_page:8},!1)},{threshold:.1}),g.value&&r.value.observe(g.value)}),$e(()=>{r.value&&g.value&&r.value.unobserve(g.value)}),ie(()=>x.params.id,j=>{j&&(z(),K.value=0)}),ie(o.product,j=>{j&&(o.page=1,o.fetchProducts({category:j.category_id,per_page:4},!0),K.value=0)}),(j,C)=>{const Y=ve("router-link");return s(),a(J,null,[D(ke,{isLoading:V(o).isLoading},null,8,["isLoading"]),e("div",Ea,[e("div",Ia,[V(o).isLoading?(s(),a("div",La)):V(o).product?(s(),a("div",Fa,[D(fe,{name:"slide-up"},{default:G(()=>{var X,ne,me,ge,he,xe,Ce,Ae,Pe,Se,je,ye,Ne,Ue,Oe,qe,Je,We,He;return[e("div",Ta,[e("div",Ra,[e("div",Da,[e("div",{class:"flex w-full h-full slider-container",style:pe({transform:`translateX(-${K.value*100}%)`})},[(s(!0),a(J,null,B(V(o).product.photos||[V(o).product.photo_url||"https://via.placeholder.com/300"],(Fe,Ve)=>(s(),a("img",{key:Ve,src:Fe,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${V(o).product.nom} - ${Ve+1}`},null,8,Na))),128))],4),V(o).product.photos&&V(o).product.photos.length>1?(s(),a("button",{key:0,onClick:se,class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image précédente"},C[6]||(C[6]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))):A("",!0),V(o).product.photos&&V(o).product.photos.length>1?(s(),a("button",{key:1,onClick:T,class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image suivante"},C[7]||(C[7]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))):A("",!0),V(o).product.photos&&V(o).product.photos.length>1?(s(),a("div",Ua,[(s(!0),a(J,null,B(V(o).product.photos,(Fe,Ve)=>(s(),a("span",{key:Ve,class:W(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":Ve===K.value}])},null,2))),128))])):A("",!0)]),V(o).product.boosted_until&&new Date(V(o).product.boosted_until)>new Date?(s(),a("span",Oa," Boosté ")):A("",!0),V(o).product.collaboratif?(s(),a("span",qa," Collaboratif ")):A("",!0),(X=V(t).user)!=null&&X.premium?(s(),a("span",Ja," Premium ")):A("",!0)]),e("div",Wa,[e("h1",Ha,v(V(o).product.nom),1),e("p",Ba,v(V(o).product.description||"Aucune description disponible"),1),e("p",Xa,v(V(o).product.prix)+" XAF ",1),e("div",Ga,[e("p",null,[C[8]||(C[8]=e("strong",null,"Catégorie :",-1)),k(" "+v(((ne=V(o).product.category)==null?void 0:ne.nom)||"Non spécifiée"),1)]),e("p",null,[C[9]||(C[9]=e("strong",null,"Quantité :",-1)),k(" "+v(V(o).product.quantite),1)]),e("p",null,[C[10]||(C[10]=e("strong",null,"Ville :",-1)),k(" "+v(V(o).product.ville||"Non spécifiée"),1)]),e("p",null,[C[11]||(C[11]=e("strong",null,"Ajouté le :",-1)),k(" "+v(new Date(V(o).product.created_at).toLocaleDateString("fr-FR")),1)]),e("div",Ka,[e("div",Qa,[C[12]||(C[12]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(F((me=V(o).product.counts)==null?void 0:me.views_count))+" vues",1)]),e("div",Za,[e("i",{class:W(["fas fa-heart text-[10px]",{"text-[var(--espace-or)]":V(o).product.is_favorited_by}])},null,2),e("span",null,v(F((ge=V(o).product.counts)==null?void 0:ge.favorites_count))+" favoris",1)])])]),e("button",{onClick:I,class:"w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm mb-3","aria-label":V(o).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:W(["fas fa-heart mr-2 text-sm",{"text-[var(--espace-or)]":V(o).product.is_favorited_by}])},null,2),k(" "+v(V(o).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"),1)],8,Ya),e("div",er,[C[17]||(C[17]=e("h2",{class:"text-base font-semibold text-[var(--espace-vert)] mb-2 font-poppins"}," À propos du commerçant ",-1)),e("p",tr,[e("strong",null,v((he=V(o).product.commercant)==null?void 0:he.nom),1),(xe=V(o).product.commercant)!=null&&xe.verified?(s(),a("span",sr,C[13]||(C[13]=[e("i",{class:"fas fa-check-circle text-[10px]"},null,-1)]))):A("",!0)]),e("p",or,v(((Ce=V(o).product.commercant)==null?void 0:Ce.description)||"Aucune description disponible"),1),e("p",ar,[C[14]||(C[14]=e("strong",null,"Ville :",-1)),k(" "+v(((Ae=V(o).product.commercant)==null?void 0:Ae.ville)||"Nonspécifiée"),1)]),e("p",rr,[C[15]||(C[15]=e("strong",null,"Note :",-1)),k(" "+v(Number((Pe=V(o).product.commercant)==null?void 0:Pe.rating).toFixed(1)||"Non évalué")+" / 5 ",1)]),D(Y,{to:`/commercants/${V(o).product.commercant_id}`,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline text-xs font-poppins","aria-label":"Voir le profil du commerçant"},{default:G(()=>C[16]||(C[16]=[k(" Voir le profil du commerçant ")])),_:1,__:[16]},8,["to"])]),e("div",lr,[((je=(Se=V(t).user)==null?void 0:Se.commercant)==null?void 0:je.id)!==V(o).product.commercant_id?(s(),a("button",{key:0,onClick:M,class:"flex-1 bg-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] text-white transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le commerçant"},C[18]||(C[18]=[e("i",{class:"fas fa-phone mr-2 text-sm"},null,-1),k(" Contacter le commerçant ")]))):A("",!0),V(o).product.collaboratif&&((Ne=(ye=V(t).user)==null?void 0:ye.commercant)==null?void 0:Ne.id)!==V(o).product.commercant_id?(s(),a("button",{key:1,onClick:w,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Collaborer sur ce produit"},C[19]||(C[19]=[e("i",{class:"fas fa-handshake mr-2 text-sm"},null,-1),k(" Collaborer ")]))):A("",!0),((Oe=(Ue=V(t).user)==null?void 0:Ue.commercant)==null?void 0:Oe.id)===V(o).product.commercant_id?(s(),a("button",{key:2,onClick:L,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Modifier le produit"},C[20]||(C[20]=[e("i",{class:"fas fa-edit mr-2 text-sm"},null,-1),k(" Modifier le produit ")]))):A("",!0),((Je=(qe=V(t).user)==null?void 0:qe.commercant)==null?void 0:Je.id)===V(o).product.commercant_id?(s(),a("button",{key:3,onClick:ae,class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] flex items-center justify-center gap-1 font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm",disabled:!!V(o).product.boosted_until&&new Date(V(o).product.boosted_until)>new Date,"aria-label":V(o).product.boosted_until&&new Date(V(o).product.boosted_until)>new Date?"Boost déjà actif":"Personnaliser le boost"},C[21]||(C[21]=[e("span",{class:"md:flex"},"Boost",-1),e("i",{class:"fas fa-rocket mr-2 text-sm"},null,-1)]),8,nr)):A("",!0),((He=(We=V(t).user)==null?void 0:We.commercant)==null?void 0:He.id)!==V(o).product.commercant_id?(s(),a("button",{key:4,onClick:C[0]||(C[0]=Fe=>q(V(o).product.id,V(o).product.nom,V(o).product.commercant.user.id)),class:"flex-1 bg-green-500 text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-green-600 transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le vendeur"},C[22]||(C[22]=[e("i",{class:"fas fa-comment mr-2 text-sm"},null,-1),k(" Contacter le vendeur ")]))):A("",!0)])])])]}),_:1})])):(s(),a("div",ir," Produit non trouvé. ")),D(fe,{name:"fade"},{default:G(()=>[p.value?(s(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:oe(O,["self"]),role:"dialog","aria-modal":"true","aria-label":"Proposer un prix de revente"},[e("div",ur,[e("h2",cr," Collaborer sur "+v(V(o).product.nom),1),e("p",dr," Proposez un prix de revente (minimum : "+v(V(o).product.prix+(V(o).product.marge_min||0))+" XAF) ",1),e("form",{onSubmit:oe(U,["prevent"]),class:"space-y-3"},[e("div",null,[C[23]||(C[23]=e("label",{for:"prix_revente",class:"text-xs text-[var(--espace-vert)] font-medium"},"Prix de revente (XAF)",-1)),N(e("input",{id:"prix_revente","onUpdate:modelValue":C[1]||(C[1]=X=>c.value=X),type:"number",min:"0",class:"w-full h-10 p-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition","aria-label":`Prix de revente pour ${V(o).product.nom}`,required:""},null,8,pr),[[H,c.value,void 0,{number:!0}]]),c.value?(s(),a("p",vr," Marge potentielle : "+v(c.value-V(o).product.prix)+" XAF ",1)):A("",!0)]),e("div",{class:"flex gap-3"},[C[24]||(C[24]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-xs","aria-label":"Envoyer la demande de collaboration"}," Envoyer ",-1)),e("button",{type:"button",onClick:O,class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):A("",!0)]),_:1}),D(fe,{name:"fade"},{default:G(()=>[_.value?(s(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:C[5]||(C[5]=oe(X=>_.value=!1,["self"])),role:"dialog","aria-modal":"true","aria-label":"Personnaliser le boost du produit"},[e("div",mr,[C[30]||(C[30]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4 font-poppins"}," Personnaliser le Boost ",-1)),e("form",{onSubmit:oe(ee,["prevent"]),class:"space-y-6"},[e("div",null,[C[25]||(C[25]=e("label",{class:"text-sm text-[var(--espace-vert)] font-medium mb-2 block"},"Durée (jours)",-1)),N(e("input",{type:"range","onUpdate:modelValue":C[2]||(C[2]=X=>P.value=X),min:"1",max:"20",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--espace-or)]",onInput:y},null,544),[[H,P.value,void 0,{number:!0}]]),e("p",fr,v(P.value)+" jours ",1)]),e("div",null,[C[26]||(C[26]=e("label",{class:"text-sm text-[var(--espace-vert)] font-medium mb-2 block"},"Objectif de vues",-1)),N(e("input",{type:"range","onUpdate:modelValue":C[3]||(C[3]=X=>b.value=X),min:"0",max:"4",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--espace-or)]",onInput:y},null,544),[[H,b.value,void 0,{number:!0}]]),e("p",gr,v(h[b.value])+" vues ",1)]),e("p",xr,[C[27]||(C[27]=k("Coût estimé : ")),e("strong",br,v(n.value),1),C[28]||(C[28]=k(" Jetons"))]),e("div",hr,[C[29]||(C[29]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm"}," Confirmer ",-1)),e("button",{type:"button",onClick:C[4]||(C[4]=X=>_.value=!1),class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):A("",!0)]),_:1})]),V(o).products?(s(),a("div",yr,[C[31]||(C[31]=e("h2",{class:"text-lg sm:text-xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"}," Produits similaires ",-1)),D(Ge,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},{default:G(()=>[(s(!0),a(J,null,B(V(o).products,X=>(s(),ue(Le,{key:X.id,produit:X,onMouseover:ne=>l(X.id),onTouchstart:ne=>u(X.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:g,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":V(o).isLoading},[V(o).hasMore?A("",!0):(s(),a("p",wr," Aucun produit supplémentaire "))],8,_r)])):A("",!0)])],64)}}}),bu=Z($r,[["__scopeId","data-v-6f2ace11"]]),kr={class:"relative bg-green-500"},Cr={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] fixed top-0 left-0 w-full z-50 shadow-md"},Ar={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},Pr={class:"flex items-center gap-1 sm:gap-3"},Sr={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},jr=["aria-label"],Vr={class:"flex items-center gap-2"},Mr=["src"],zr={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},Er={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},Ir={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},Lr={class:"flex justify-around items-center py-2"},Fr=["aria-label"],Tr=Q({__name:"AppHeader",setup(E){var M;const o=re(),x=ze(),m=ce(),t=o.user;we();const d=f(!1),i=f(!1),p=f(!1),c=f(""),r=Ee(),g=f(!1),_=f(null),P=f(!1),b=be(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...o.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...o.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:x.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),n=async()=>{if(o.user)try{const w=await R.get("/user/badges");x.saveCollaborationsToLocalStorage(w.data.collaborations_pending.map(U=>({produit_id:U.produit_id,prix_revente:U.prix_revente,status:U.status,created_at:U.created_at})))}catch(w){console.error("Erreur lors du chargement des badges:",w)}};ie(()=>o.user,w=>{w&&(n(),x.initializeState())},{immediate:!0}),ie(()=>x.collaborationsPending,()=>{x.collaborationsPending>0&&(i.value=!0,setTimeout(()=>i.value=!1,300))});const h=async()=>{if(c.value.trim())try{await r.fetchProducts({search:c.value.trim()},!0),c.value="",g.value=!1}catch(w){console.error("Erreur lors de la recherche:",w)}},$=w=>{if(P.value){P.value=!1;return}_.value&&!_.value.contains(w.target)&&(g.value=!1)},F=async()=>{g.value=!g.value,g.value&&(P.value=!0,await Re())},z=()=>{m.push("/messages")};return console.log("📩 header e reçu :"),(M=o.user)!=null&&M.id&&window.Echo.channel(`chat.${o.user.id}`).listen("MessageSent",w=>{var U;console.log("📩 header e reçu :",w.message),((U=o.user)==null?void 0:U.id)===w.receiver_id&&(console.log("📩 header e reçu :",w.message),x.saveUnreadMessagesToLocalStorage(w.unread_messages))}),le(()=>{o.user&&(n(),x.initializeState()),document.addEventListener("click",$)}),$e(()=>{document.removeEventListener("click",$)}),(w,U)=>{const O=ve("RouterLink");return s(),a("div",kr,[e("header",Cr,[e("div",Ar,[e("div",Pr,[D(O,{to:"/","aria-label":"Retour à l'accueil"},{default:G(()=>U[2]||(U[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Ke,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),U[3]||(U[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"},null,-1))]),e("nav",Sr,[(s(!0),a(J,null,B(b.value,L=>(s(),ue(O,{key:L.to,to:L.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:G(()=>[e("i",{class:W(["fas",L.icon])},null,2),k(" "+v(L.label)+" ",1),L.badge>0?(s(),a("span",{key:0,class:W(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":L.to==="/panier"&&d.value||L.to==="/collaborations"&&i.value||L.to==="/commandes"&&p.value}]),"aria-label":L.to==="/panier"?"Nombre d'articles dans le panier":L.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(L.badge),11,jr)):A("",!0)]),_:2},1032,["to"]))),128))]),D(Qe),e("div",Vr,[e("button",{onClick:F,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},U[4]||(U[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)])),e("button",{onClick:z,class:"text-[var(--espace-white)] px-1 rounded hover:bg-white transition"},U[5]||(U[5]=[e("i",{class:"fas fa-comment-dots text-2xl"},null,-1)])),(s(!0),a(J,null,B(b.value.filter(L=>V(o).user?L.to==="/profil":["/login","/register"].includes(L.to)),L=>(s(),ue(O,{key:L.to,to:L.to,class:"relative flex items-center justify-center","aria-label":L.label},{default:G(()=>{var ee;return[(ee=V(t))!=null&&ee.photo?(s(),a("img",{key:0,src:`http://localhost:8000/storage/${V(t).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,Mr)):(s(),a("div",zr,[e("i",{class:W([`fas ${L.icon}`,"text-2xl text-gray-100"])},null,2)])),L.badge>0&&L.to==="/collaborations"?(s(),a("span",{key:2,class:W(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":L.to==="/collaborations"&&i.value}]),"aria-label":"Collaborations en attente"},v(L.badge),3)):A("",!0)]}),_:2},1032,["to","aria-label"]))),128))])]),g.value?(s(),a("div",{key:0,ref_key:"searchOverlayRef",ref:_,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",Er,[N(e("input",{"onUpdate:modelValue":U[0]||(U[0]=L=>c.value=L),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Te(h,["enter"])},null,544),[[H,c.value]]),e("button",{onClick:h,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},U[6]||(U[6]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:U[1]||(U[1]=L=>g.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},U[7]||(U[7]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):A("",!0)]),D(fe,{name:"slide-up"},{default:G(()=>[e("nav",Ir,[e("div",Lr,[(s(!0),a(J,null,B(b.value,L=>(s(),ue(O,{key:L.to,to:L.to,"aria-label":L.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:G(()=>[e("i",{class:W(["fas text-lg",L.icon])},null,2),L.badge>0?(s(),a("span",{key:0,class:W(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":L.to==="/panier"&&d.value||L.to==="/collaborations"&&i.value||L.to==="/commandes"&&p.value}]),"aria-label":L.to==="/panier"?"Nombre d'articles dans le panier":L.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(L.badge),11,Fr)):A("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),Ze=Z(Tr,[["__scopeId","data-v-e17b2a25"]]),Rr={class:"min-h-screen bg-gray-100",style:{background:"url(/src/assets/images/bginsc.jpg) center/cover"}},Dr={class:"container mx-auto px-4 sm:px-6 py-6"},Nr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Ur={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Or={key:0,class:"text-sm sm:text-base text-[var(--espace-gris)]"},qr={key:1,class:"text-sm sm:text-base text-[var(--espace-gris)]"},Jr={key:2,class:"text-sm text-[var(--espace-gris)] italic"},Wr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Hr=["value"],Br={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Xr=["value"],Gr={class:"flex items-center gap-2 text-sm col-span-2 sm:col-span-1"},Kr=["value"],Qr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 border border-gray-100"},Zr={key:0,class:"flex items-center gap-3 text-[var(--espace-vert)]"},Yr={key:1,class:"text-base text-[var(--espace-gris)] italic"},el={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},tl=["onClick"],sl=Q({__name:"CommercantDashboard",setup(E){const o=te(),x=f([]),m=f([]),t=f(null),d=f(!1),i=f({nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}),p=f({nom:"",description:"",ville:""}),c=f(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),r=async()=>{d.value=!0;try{const[b,n,h]=await Promise.all([R.get("/commercant/produits"),R.get("/categories"),R.get("/commercant/profil")]);d.value=!1,x.value=b.data.produits.map($=>{var F;return{...$,commercant_id:((F=t.value)==null?void 0:F.id)||""}}),m.value=n.data.categories,t.value=h.data.commercant,p.value={nom:t.value.nom,description:t.value.description||"",ville:t.value.ville||""}}catch{o.error("Erreur lors du chargement des données."),d.value=!1}},g=async()=>{try{const b=await R.post("/commercant/produits",i.value);o.success("Produit ajouté avec succès."),r(),i.value={nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}}catch{o.error("Erreur lors de l’ajout du produit.")}},_=async b=>{if(confirm("Voulez-vous supprimer ce produit ?"))try{await R.delete(`/commercant/produits/${b}`),o.success("Produit supprimé avec succès."),r()}catch{o.error("Erreur lors de la suppression du produit.")}},P=async()=>{try{await R.put("/commercant/profil",p.value),o.success("Profil mis à jour avec succès."),r()}catch{o.error("Erreur lors de la mise à jour du profil.")}};return le(()=>{r()}),(b,n)=>(s(),a("div",Rr,[D(Ze),e("div",Dr,[n[26]||(n[26]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] flex items-center gap-3 mb-6"},[e("i",{class:"fas fa-store text-xl"}),k(" Espace Commerçant ")],-1)),e("div",Nr,[n[14]||(n[14]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-3"},"Statistiques",-1)),e("div",Ur,[t.value?(s(),a("p",Or,[n[12]||(n[12]=e("span",{class:"font-medium"},"Revenus :",-1)),k(" "+v(t.value.revenus)+" FCFA ",1)])):A("",!0),t.value?(s(),a("p",qr,[n[13]||(n[13]=e("span",{class:"font-medium"},"Produits vendus :",-1)),k(" "+v(t.value.produits_vendus),1)])):(s(),a("p",Jr,"Chargement..."))])]),e("div",Wr,[n[17]||(n[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Profil Commerçant",-1)),e("form",{onSubmit:oe(P,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[N(e("input",{"onUpdate:modelValue":n[0]||(n[0]=h=>p.value.nom=h),type:"text",placeholder:"Nom du commerçant",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[H,p.value.nom]]),N(e("textarea",{"onUpdate:modelValue":n[1]||(n[1]=h=>p.value.description=h),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[H,p.value.description]]),N(e("select",{"onUpdate:modelValue":n[2]||(n[2]=h=>p.value.ville=h),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2 sm:col-span-1"},[n[15]||(n[15]=e("option",{value:""},"Ville",-1)),(s(!0),a(J,null,B(c.value,h=>(s(),a("option",{key:h,value:h},v(h),9,Hr))),128))],512),[[_e,p.value.ville]]),n[16]||(n[16]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-check"})],-1))],32)]),e("div",Br,[n[22]||(n[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Ajouter un produit",-1)),e("form",{onSubmit:oe(g,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[N(e("input",{"onUpdate:modelValue":n[3]||(n[3]=h=>i.value.nom=h),type:"text",placeholder:"Nom du produit",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[H,i.value.nom]]),N(e("textarea",{"onUpdate:modelValue":n[4]||(n[4]=h=>i.value.description=h),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[H,i.value.description]]),N(e("input",{"onUpdate:modelValue":n[5]||(n[5]=h=>i.value.prix=h),type:"number",placeholder:"Prix",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[H,i.value.prix]]),N(e("input",{"onUpdate:modelValue":n[6]||(n[6]=h=>i.value.photo_url=h),type:"text",placeholder:"URL de la photo",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[H,i.value.photo_url]]),N(e("select",{"onUpdate:modelValue":n[7]||(n[7]=h=>i.value.category_id=h),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[n[18]||(n[18]=e("option",{value:""},"Catégorie",-1)),(s(!0),a(J,null,B(m.value,h=>(s(),a("option",{key:h.id,value:h.id},v(h.nom),9,Xr))),128))],512),[[_e,i.value.category_id]]),e("label",Gr,[N(e("input",{"onUpdate:modelValue":n[8]||(n[8]=h=>i.value.collaboratif=h),type:"checkbox"},null,512),[[Be,i.value.collaboratif]]),n[19]||(n[19]=k(" Collaboratif "))]),N(e("input",{"onUpdate:modelValue":n[9]||(n[9]=h=>i.value.marge_min=h),type:"number",placeholder:"Marge minimum",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[H,i.value.marge_min]]),N(e("input",{"onUpdate:modelValue":n[10]||(n[10]=h=>i.value.stock=h),type:"number",placeholder:"Stock",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[H,i.value.stock]]),N(e("select",{"onUpdate:modelValue":n[11]||(n[11]=h=>i.value.ville=h),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[n[20]||(n[20]=e("option",{value:""},"Ville",-1)),(s(!0),a(J,null,B(c.value,h=>(s(),a("option",{key:h,value:h},v(h),9,Kr))),128))],512),[[_e,i.value.ville]]),n[21]||(n[21]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-plus"})],-1))],32)]),e("div",Qr,[n[25]||(n[25]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Produits",-1)),d.value?(s(),a("div",Zr,n[23]||(n[23]=[e("i",{class:"fas fa-spinner animate-spin text-xl"},null,-1),e("span",{class:"text-base font-poppins"},"Chargement...",-1)]))):x.value.length===0?(s(),a("div",Yr," Aucun produit disponible. ")):(s(),a("div",el,[(s(!0),a(J,null,B(x.value,h=>(s(),a("div",{key:h.id,class:"relative"},[D(Le,{produit:h},null,8,["produit"]),e("button",{onClick:$=>_(h.id),class:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition flex items-center justify-center","aria-label":"Supprimer le produit"},n[24]||(n[24]=[e("i",{class:"fas fa-trash text-sm"},null,-1)]),8,tl)]))),128))]))])])]))}}),hu=Z(sl,[["__scopeId","data-v-98a2ca3d"]]),ol={class:"overflow-y-scroll bg-gray-100 pt-2 pb-12 px-4 sm:px-6"},al={class:"container mx-auto max-w-4xl"},rl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},ll={key:0,class:"ml-2"},nl={class:"w-full bg-gray-200 rounded-full h-4"},il={class:"text-[var(--espace-gris)] text-xs mt-2"},ul={key:0,class:"text-[var(--espace-gris)] text-xs mt-1"},cl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},dl={key:0,class:"mb-4"},pl={class:"text-sm text-[var(--espace-gris)]"},vl={class:"font-bold text-[var(--espace-or)]"},ml={class:"text-sm text-[var(--espace-gris)] truncate"},fl=["href"],gl={key:1,class:"mb-4"},xl=["placeholder"],bl={class:"flex flex-col sm:flex-row gap-2"},hl=["disabled"],yl={key:0},_l={key:1},wl=["disabled"],$l={key:0},kl={key:1},Cl={key:2,class:"mt-4 flex flex-col sm:flex-row gap-2"},Al={class:"bg-white rounded-lg shadow-md p-6 mb-6"},Pl={class:"mb-4"},Sl={key:0,class:"overflow-x-auto"},jl={class:"w-full text-sm text-left text-[var(--espace-gris)]"},Vl=["onClick"],Ml={class:"px-4 py-2"},zl={class:"px-4 py-2"},El={key:1,class:"text-center text-[var(--espace-gris)] py-4"},Il={class:"bg-white rounded-lg shadow-md p-6 text-center"},Ll={class:"text-2xl sm:text-3xl font-bold text-[var(--espace-or)]"},Fl={class:"text-[var(--espace-gris)] mt-2"},Tl=Q({__name:"Parrainage",setup(E){const o=re(),x=ce(),m=te(),t=()=>{const y=window.location.hostname;return y==="localhost"||y==="127.0.0.1"?"http://localhost:4000/register":"https://espacecameroun.devfack.com/register"},d=f(""),i=f(""),p=f([]),c=f(0),r=f(""),g=f(""),_=f(!1),P=f(!1),b=f({}),n=f(null),h=f(0),$=f(0),F=f(0),z=f("all"),M=be(()=>{var y;return((y=b.value)==null?void 0:y.couleur)||"#6b7280"}),w=be(()=>z.value==="commercants"?p.value.filter(y=>y.est_commercant):z.value==="nonCommercants"?p.value.filter(y=>!y.est_commercant):p.value),U=async()=>{if(!o.user){m.error("Veuillez vous connecter pour accéder à cette page"),x.push("/login");return}try{const l=(await R.get("/parrainages/dashboard")).data;d.value=l.code||"",i.value=d.value?`${t()}/${d.value}`:"",p.value=l.parrainages||[],c.value=l.total_gains||0,b.value=l.niveau_actuel,n.value=l.niveau_suivant,h.value=l.progression,$.value=l.total_parrainages||0,F.value=l.total_parrainages_commercants||0}catch(y){m.error("Erreur lors de la récupération des données de parrainage"),console.error(y)}},O=async()=>{if(!o.user){m.error("Veuillez vous connecter");return}_.value=!0;try{const y=await R.post("/parrainages/generateCode");r.value=y.data.suggested_code,g.value=r.value,m.success("Nouveau code suggéré avec succès !"),d.value&&(i.value=`${t()}/${d.value}`)}catch(y){m.error("Erreur lors de la génération du code"),console.error(y)}finally{_.value=!1}},L=async()=>{var y,l;if(!o.user){m.error("Veuillez vous connecter");return}if(!g.value.trim()){m.error("Veuillez entrer un code valide");return}P.value=!0;try{const u=await R.post("/parrainages/createCode",{code:g.value.trim()});d.value=u.data.code,i.value=u.data.link||`${t()}/${u.data.code}`,m.success(u.data.message||"Code créé avec succès !"),await U()}catch(u){m.error(((l=(y=u.response)==null?void 0:y.data)==null?void 0:l.message)||"Erreur lors de la création du code"),console.error(u)}finally{P.value=!1}},ee=y=>{if(!i.value){m.error("Aucun lien disponible pour le partage");return}let l="";const u=encodeURIComponent(`Rejoins-moi sur Espace Cameroun avec mon lien : ${i.value}`);switch(y){case"whatsapp":l=`https://api.whatsapp.com/send?text=${u}`;break;case"facebook":l=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(i.value)}`;break;default:m.error("Plateforme non prise en charge");return}window.open(l,"_blank")},ae=y=>{y.est_commercant?x.push(`/commercants/${y.id}`):x.push({name:"public-profile",params:{id:y.id}})};return le(()=>{U()}),(y,l)=>{var u,S,I,q,K;return s(),a("div",ol,[e("div",al,[e("div",rl,[e("h2",{class:"text-lg font-semibold mb-4",style:pe({color:M.value})},"Niveaux de Parrainage",4),e("p",{class:"text-[var(--espace-gris)] text-sm mb-2 flex justify-between",style:pe({color:M.value})},[e("div",null,[l[5]||(l[5]=k(" Votre niveau actuel : ")),e("strong",null,v(b.value?b.value.nom:"Pas de niveau")+" "+v((u=b.value)==null?void 0:u.emoji)+" ("+v(F.value)+"/"+v(n.value?n.value.filleuls_requis:(S=b.value)==null?void 0:S.filleuls_requis)+" commerçants)",1)]),((I=n.value)==null?void 0:I.jetons_bonus)>0?(s(),a("span",ll,"+"+v((q=n.value)==null?void 0:q.jetons_bonus)+" jetons ",1)):A("",!0)],4),e("div",nl,[e("div",{class:"h-4 rounded-full bg-[var(--espace-or)] transition-all duration-300",style:pe({width:`${h.value}%`,background:`${M.value}`})},null,4)]),e("p",il," Prochain niveau : "+v(n.value?n.value.nom:"Légende 🏆")+" à "+v(n.value?n.value.filleuls_requis:"1000+")+" commerçants ",1),(K=b.value.avantages)!=null&&K.length?(s(),a("p",ul," Avantages : "+v(b.value.avantages.join(", ")),1)):A("",!0),e("button",{onClick:l[0]||(l[0]=T=>V(x).push("/parrainage/info")),class:"mt-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},l[6]||(l[6]=[e("i",{class:"fas fa-info-circle mr-2"},null,-1),k(" En savoir plus ")]))]),l[24]||(l[24]=e("div",{class:"bg-white rounded-lg shadow-md p-6 mb-6"},[e("p",{class:"text-[var(--espace-gris)] text-sm sm:text-base"}," Invitez des amis avec votre lien ou code unique et gagnez des récompenses ! Atteignez des niveaux supérieurs pour débloquer des jetons et des avantages. ")],-1)),e("div",cl,[l[15]||(l[15]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Votre Code de Parrainage",-1)),d.value?(s(),a("div",dl,[e("p",pl,[l[7]||(l[7]=k(" Code : ")),e("span",vl,v(d.value),1)]),e("p",ml,[l[8]||(l[8]=k(" Lien : ")),e("a",{href:i.value,target:"_blank",class:"text-blue-500 underline hover:text-blue-700"},v(i.value),9,fl)])])):(s(),a("div",gl,[N(e("input",{"onUpdate:modelValue":l[1]||(l[1]=T=>g.value=T),type:"text",placeholder:r.value||"Entrez ou générez un code (ex: DOM2025)",class:"w-full p-2 border rounded mb-2 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",maxlength:"10"},null,8,xl),[[H,g.value]]),e("div",bl,[e("button",{onClick:O,disabled:_.value,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition flex-1 disabled:opacity-50"},[_.value?(s(),a("span",yl,l[9]||(l[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),k(" Génération... ")]))):(s(),a("span",_l,l[10]||(l[10]=[e("i",{class:"fas fa-magic mr-2"},null,-1),k(" Générer un code ")])))],8,hl),e("button",{onClick:L,disabled:P.value||!g.value.trim(),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1 disabled:opacity-50"},[P.value?(s(),a("span",$l,l[11]||(l[11]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),k(" Création... ")]))):(s(),a("span",kl,l[12]||(l[12]=[e("i",{class:"fas fa-check mr-2"},null,-1),k(" Créer le code ")])))],8,wl)])])),d.value?(s(),a("div",Cl,[e("button",{onClick:l[2]||(l[2]=T=>ee("whatsapp")),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1"},l[13]||(l[13]=[e("i",{class:"fab fa-whatsapp mr-2"},null,-1),k(" Partager sur WhatsApp ")])),e("button",{onClick:l[3]||(l[3]=T=>ee("facebook")),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition flex-1"},l[14]||(l[14]=[e("i",{class:"fab fa-facebook-f mr-2"},null,-1),k(" Partager sur Facebook ")]))])):A("",!0)]),e("div",Al,[l[18]||(l[18]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Utilisateurs Parrainés",-1)),e("div",Pl,[N(e("select",{"onUpdate:modelValue":l[4]||(l[4]=T=>z.value=T),class:"w-full sm:w-1/3 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},l[16]||(l[16]=[e("option",{value:"all"},"Tous",-1),e("option",{value:"commercants"},"Commerçants",-1),e("option",{value:"nonCommercants"},"Non Commerçants",-1)]),512),[[_e,z.value]])]),w.value.length?(s(),a("div",Sl,[e("table",jl,[l[17]||(l[17]=e("thead",{class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)]"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Nom"),e("th",{class:"px-4 py-2"},"Date d'inscription"),e("th",{class:"px-4 py-2"},"Est commerçant")])],-1)),e("tbody",null,[(s(!0),a(J,null,B(w.value,T=>(s(),a("tr",{key:T.id,class:"border-b hover:bg-gray-50"},[e("td",{class:"px-4 py-2 cursor-pointer text-blue-500 hover:underline",onClick:se=>ae(T)},v(T.filleul_nom||"Anonyme"),9,Vl),e("td",Ml,v(new Date(T.date_inscription).toLocaleDateString("fr-FR")),1),e("td",zl,v(T.est_commercant?"Oui":"Non"),1)]))),128))])])])):(s(),a("p",El," Aucun utilisateur parrainé correspondant au filtre. Commencez à inviter dès maintenant ! "))]),e("div",Il,[l[22]||(l[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2"},"Vos Gains",-1)),e("p",Ll,v(c.value)+" jetons ",1),e("p",Fl,[l[19]||(l[19]=k(" 🎉 Vous avez invité ")),e("strong",null,v($.value),1),l[20]||(l[20]=k(" utilisateurs, dont ")),e("strong",null,v(F.value),1),l[21]||(l[21]=k(" sont commerçants ! "))]),l[23]||(l[23]=e("p",{class:"text-[var(--espace-gris)] mt-2"}," Débloquez plus de jetons et d'avantages en atteignant les niveaux supérieurs. ",-1))])])])}}}),yu=Z(Tl,[["__scopeId","data-v-fa541dd4"]]),Rl={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Dl={class:"container mx-auto max-w-4xl"},Nl={class:"flex border-b border-gray-300 mb-6"},Ul={key:0},Ol={key:0,class:"grid grid-cols-1 gap-4"},ql={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Jl=["onClick"],Wl={class:"text-sm text-[var(--espace-gris)]"},Hl={class:"text-sm text-[var(--espace-gris)]"},Bl=["onClick"],Xl={class:"flex flex gap-2"},Gl=["onClick"],Kl=["onClick"],Ql=["onClick"],Zl={key:1,class:"text-center text-[var(--espace-gris)]"},Yl={key:1},en={key:0,class:"grid grid-cols-1 gap-4"},tn={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},sn=["onClick"],on={class:"text-sm text-[var(--espace-gris)]"},an={class:"text-sm text-[var(--espace-gris)]"},rn=["onClick"],ln=["onClick"],nn={key:1,class:"text-center text-[var(--espace-gris)]"},un=Q({__name:"Collaborations",setup(E){const o=_=>{localStorage.setItem("pending_collaborations",JSON.stringify(_))},x=te(),m=ce(),t=f({sent_collaborations:[],received_collaborations:[]}),d=f(!0),i=f("received"),p=async()=>{try{const _=await R.get("/collaborations");console.log(_.data),t.value=_.data;const P=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");if(P.length>0){const b=new Set(t.value.sent_collaborations.map(h=>h.produit_id)),n=P.filter(h=>!b.has(h.produit_id));n.length!==P.length&&(o(n),console.log("Collaborations en attente nettoyées dans localStorage"))}}catch{x.error("Erreur lors du chargement des collaborations")}finally{d.value=!1}},c=_=>{m.push({path:`/produits/${_}`})},r=_=>{var b,n,h;const P=((b=_.commercant)==null?void 0:b.id)||((h=(n=_.produit)==null?void 0:n.commercant)==null?void 0:h.id);P?m.push({path:`/commercants/${P}`}):x.error("Profil du commerçant non disponible")},g=async(_,P)=>{var b;try{const n=await R.post(`/collaborations/${_}`,{statut:P});x.success(n.data.message),await p()}catch(n){console.log(n.response.data.message),x.error(`Erreur lors de la mise à jour de la collaboration${(b=n.response)==null?void 0:b.data.message}`)}};return le(()=>{d.value=!0,p()}),(_,P)=>(s(),a(J,null,[D(ke,{isLoading:d.value},null,8,["isLoading"]),e("div",Rl,[e("div",Dl,[P[4]||(P[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-handshake mr-2 text-[var(--espace-or)]"}),k(" Mes Collaborations ")],-1)),e("div",Nl,[e("button",{class:W(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":i.value==="received","text-[var(--espace-gris)]":i.value!=="received"}]),onClick:P[0]||(P[0]=b=>i.value="received")}," Collaborations reçues ",2),e("button",{class:W(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":i.value==="sent","text-[var(--espace-gris)]":i.value!=="sent"}]),onClick:P[1]||(P[1]=b=>i.value="sent")}," Collaborations envoyées ",2)]),i.value==="received"?(s(),a("div",Ul,[t.value.received_collaborations.length?(s(),a("div",Ol,[(s(!0),a(J,null,B(t.value.received_collaborations,b=>(s(),a("div",{key:b.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",ql,[e("div",null,[e("h2",{onClick:n=>c(b.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},v(b.produit.nom),9,Jl),e("p",Wl," Prix de revente proposé : "+v(b.prix_revente)+" FCFA ",1),e("p",Hl,[P[2]||(P[2]=k(" Statut : ")),e("span",{class:W({"text-green-600":b.statut==="valider","text-yellow-600":b.statut==="en_attente","text-red-600":b.statut==="refuser"})},v(b.statut==="en_attente"?"En attente":b.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:n=>r(b),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,Bl)]),e("div",Xl,[b.statut==="en_attente"?(s(),a("button",{key:0,onClick:n=>g(b.id,"valider"),class:"bg-green-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-green-700 transition text-xs sm:text-sm"}," Valider ",8,Gl)):A("",!0),b.statut==="en_attente"?(s(),a("button",{key:1,onClick:n=>g(b.id,"refuser"),class:"bg-red-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-red-700 transition text-xs sm:text-sm"}," Rejeter ",8,Kl)):A("",!0),e("button",{onClick:n=>c(b.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,Ql)])])]))),128))])):(s(),a("p",Zl," Aucune collaboration reçue pour le moment. "))])):A("",!0),i.value==="sent"?(s(),a("div",Yl,[t.value.sent_collaborations.length?(s(),a("div",en,[(s(!0),a(J,null,B(t.value.sent_collaborations,b=>(s(),a("div",{key:b.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",tn,[e("div",null,[e("h2",{onClick:n=>c(b.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},v(b.produit.nom),9,sn),e("p",on," Prix de revente proposé : "+v(b.prix_revente)+" FCFA ",1),e("p",an,[P[3]||(P[3]=k(" Statut : ")),e("span",{class:W({"text-green-600":b.statut==="valider","text-yellow-600":b.statut==="en_attente","text-red-600":b.statut==="refuser"})},v(b.statut==="en_attente"?"En attente":b.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:n=>r(b),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,rn)]),e("button",{onClick:n=>c(b.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,ln)])]))),128))])):(s(),a("p",nn," Aucune collaboration envoyée pour le moment. "))])):A("",!0)])])],64))}}),_u=Z(un,[["__scopeId","data-v-61e28846"]]),cn={class:"overflow-y-scroll bg-gray-100"},dn={class:"container mx-auto px-4 sm:px-6 py-8"},pn={key:0,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mb-8 border border-gray-100 overflow-hidden"},vn={class:"flex flex-col sm:flex-row items-center gap-6"},mn={class:"w-24 h-24 bg-[var(--espace-or)] rounded-full flex items-center justify-center overflow-hidden"},fn=["src"],gn={key:1,class:"fas fa-user text-3xl text-[var(--espace-vert)]"},xn={class:"flex-1"},bn={class:"text-3xl font-bold text-[var(--espace-vert)] mb-2 text-center"},hn={class:"text-sm text-[var(--espace-gris)] mb-1"},yn={class:"text-sm text-[var(--espace-gris)] mb-1"},_n={class:"text-sm text-[var(--espace-gris)]"},wn={key:0,class:"text-sm text-[var(--espace-gris)]"},$n={class:"mt-2 flex space-x-2 flex-col"},kn={class:"text-sm text-[var(--espace-gris)]"},Cn={class:"text-xs text-[var(--espace-gris)]"},An={class:"mt-4 flex flex-col sm:flex-row gap-4"},Pn={class:"mt-4 flex flex-wrap gap-4"},Sn={class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},jn={key:0,class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},Vn={key:1,class:"text-base text-[var(--espace-gris)] italic"},Mn={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},zn={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},En={class:"flex items-center space-x-2"},In={key:3},Ln={key:4,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-4 border border-gray-100"},Fn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},Tn={key:5,class:"text-base text-[var(--espace-gris)] italic"},Rn={key:6,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-8 border border-gray-100"},Dn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Nn={class:"text-sm text-[var(--espace-gris)]"},Un={class:"text-sm text-[var(--espace-gris)]"},On=Q({__name:"CommercantDetails",setup(E){const o=we(),x=te(),m=f(!1),t=f(null),d=f(null),i=f(0),p=f(0),c=f(!1),r=async()=>{m.value=!0;try{const b=await R.get(`/commercant/${o.params.commercantId}`);console.log(b.data),t.value=b.data.commercant,i.value=b.data.average_rating||0,p.value=b.data.vote_count||0,t.value.produits||console.warn("Aucun produit trouvé dans la réponse de l'API pour ce commerçant.")}catch{x.error("Erreur lors du chargement des détails du commerçant.")}finally{m.value=!1}},g=async()=>{var b,n;if(d.value===null||d.value<1||d.value>5){x.error("Veuillez sélectionner une note entre 1 et 5.");return}try{const h=await R.post(`/commercant/${o.params.commercantId}/rate`,{rating:d.value});i.value=h.data.average_rating||0,x.success("Merci pour votre note !"),d.value=null,c.value=!1,p.value=h.data.vote_count||p.value+1}catch(h){x.error(((n=(b=h.response)==null?void 0:b.data)==null?void 0:n.message)||"Erreur lors de la notation.")}},_=be(()=>{var b;return((b=t.value)==null?void 0:b.produits)||[]}),P=()=>{c.value=!0};return le(async()=>{r()}),(b,n)=>{const h=ve("router-link");return s(),a(J,null,[D(ke,{isLoading:m.value},null,8,["isLoading"]),e("div",cn,[D(Ze),e("div",dn,[t.value?(s(),a("div",pn,[e("div",vn,[e("div",mn,[t.value.photo_url?(s(),a("img",{key:0,src:t.value.photo_url,alt:"Photo du commerçant",class:"w-full h-full object-cover"},null,8,fn)):(s(),a("i",gn))]),e("div",xn,[e("h1",bn," Commerçant : "+v(t.value.nom),1),e("p",hn,[n[2]||(n[2]=e("strong",null,"Ville :",-1)),k(" "+v(t.value.ville),1)]),e("p",yn,[n[3]||(n[3]=e("strong",null,"Inscrit depuis :",-1)),k(" "+v(new Date(t.value.created_at).toLocaleDateString()),1)]),e("p",_n,[n[4]||(n[4]=e("strong",null,"Contact :",-1)),k(" "+v(t.value.email||"Non disponible"),1)]),t.value.telephone?(s(),a("p",wn,[n[5]||(n[5]=e("strong",null,"Téléphone :",-1)),k(" "+v(t.value.telephone),1)])):A("",!0),e("div",$n,[e("div",{class:"flex items-center space-x-1 cursor-pointer",onClick:P},[(s(),a(J,null,B(5,$=>e("span",{key:$,class:"relative text-yellow-400 w-5 h-5"},[n[6]||(n[6]=e("i",{class:"far fa-star absolute left-0 top-0"},null,-1)),e("i",{class:"fas fa-star absolute left-0 top-0 overflow-hidden",style:pe({width:$<=Math.floor(i.value)?"100%":$===Math.ceil(i.value)&&i.value%1!==0?`${i.value%1*100}%`:"0%"})},null,4)])),64)),e("p",kn,v(Number(i.value).toFixed(1))+"/5 ",1)]),e("span",Cn,"("+v(p.value)+" votes)",1)])])]),e("div",An,[D(h,{to:`/chat/${t.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:G(()=>n[7]||(n[7]=[e("i",{class:"fas fa-comment mr-2"},null,-1),k(" Envoyer un message ")])),_:1,__:[7]},8,["to"]),D(h,{to:`/public-profile/${t.value.user_id||t.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:G(()=>n[8]||(n[8]=[e("i",{class:"fas fa-user mr-2"},null,-1),k(" Voir Profil Public ")])),_:1,__:[8]},8,["to"])]),e("div",Pn,[e("span",Sn,"Produits : "+v(_.value.length),1),t.value.revenus?(s(),a("span",jn,"Revenus : "+v(t.value.revenus)+" FCFA",1)):A("",!0)])])):m.value?A("",!0):(s(),a("div",Vn,"Commerçant non trouvé.")),c.value?(s(),a("div",Mn,[e("div",zn,[n[9]||(n[9]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Noter ce Commerçant",-1)),e("div",En,[N(e("input",{"onUpdate:modelValue":n[0]||(n[0]=$=>d.value=$),type:"number",min:"1",max:"5",step:"1",class:"w-16 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"1-5"},null,512),[[H,d.value,void 0,{number:!0}]]),e("button",{onClick:g,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Soumettre "),e("button",{onClick:n[1]||(n[1]=$=>c.value=!1),class:"bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors ml-2"}," Annuler ")])])])):A("",!0),m.value?(s(),a("div",In)):_.value.length>0?(s(),a("div",Ln,[n[10]||(n[10]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-6"},"Produits du Commerçant",-1)),e("div",Fn,[(s(!0),a(J,null,B(_.value,$=>(s(),ue(Le,{key:$.id,produit:$},null,8,["produit"]))),128))])])):t.value&&_.value.length===0?(s(),a("div",Tn,"Aucun produit disponible pour ce commerçant.")):A("",!0),t.value&&t.value.statistiques?(s(),a("div",Rn,[n[13]||(n[13]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Statistiques",-1)),e("div",Dn,[e("p",Nn,[n[11]||(n[11]=e("strong",null,"Vues totales :",-1)),k(" "+v(t.value.statistiques.total_views),1)]),e("p",Un,[n[12]||(n[12]=e("strong",null,"Produits populaires :",-1)),k(" "+v(t.value.statistiques.popular_products),1)])])])):A("",!0)])])],64)}}}),wu=Z(On,[["__scopeId","data-v-e97faea3"]]),qn={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Jn={class:"container mx-auto max-w-2xl"},Wn={class:"bg-white rounded-lg shadow-md p-6"},Hn={key:0,class:"text-red-500 text-xs"},Bn={key:0,class:"text-red-500 text-xs"},Xn={key:0,class:"text-red-500 text-xs"},Gn={key:0,class:"text-red-500 text-xs"},Kn={key:0,class:"text-red-500 text-xs"},Qn=["disabled"],Zn={key:0},Yn={key:1},ei=Q({__name:"CommercantCreate",setup(E){const o=ce(),x=te(),m=f({nom:"",ville:"",email:"",telephone:"",photo:null}),t=f(!1),d=f({}),i=c=>{const r=c.target;r.files&&r.files[0]&&(m.value.photo=r.files[0])},p=async()=>{var c,r;t.value=!0,d.value={};try{const g=new FormData;g.append("nom",m.value.nom),g.append("ville",m.value.ville),g.append("email",m.value.email),g.append("telephone",m.value.telephone),m.value.photo&&g.append("photo",m.value.photo);const _=await R.post("/commercants",g,{headers:{"Content-Type":"multipart/form-data"}});console.log(_.data.message),x.success("Commerçant créé avec succès !"),o.push("/profil")}catch(g){(r=(c=g.response)==null?void 0:c.data)!=null&&r.errors?d.value=g.response.data.errors:x.error("Erreur lors de la création du commerçant"),console.error(g)}finally{t.value=!1}};return(c,r)=>(s(),a("div",qn,[e("div",Jn,[r[11]||(r[11]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-store mr-2 text-[var(--espace-or)]"}),k(" Créer un Commerçant ")],-1)),e("div",Wn,[e("form",{onSubmit:oe(p,["prevent"]),class:"space-y-6"},[e("div",null,[r[4]||(r[4]=e("label",{for:"nom",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom *",-1)),N(e("input",{"onUpdate:modelValue":r[0]||(r[0]=g=>m.value.nom=g),id:"nom",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerçant",required:""},null,512),[[H,m.value.nom]]),d.value.nom?(s(),a("span",Hn,v(d.value.nom),1)):A("",!0)]),e("div",null,[r[5]||(r[5]=e("label",{for:"ville",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Ville *",-1)),N(e("input",{"onUpdate:modelValue":r[1]||(r[1]=g=>m.value.ville=g),id:"ville",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville",required:""},null,512),[[H,m.value.ville]]),d.value.ville?(s(),a("span",Bn,v(d.value.ville),1)):A("",!0)]),e("div",null,[r[6]||(r[6]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),N(e("input",{"onUpdate:modelValue":r[2]||(r[2]=g=>m.value.email=g),id:"email",type:"email",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"email@exemple.com"},null,512),[[H,m.value.email]]),d.value.email?(s(),a("span",Xn,v(d.value.email),1)):A("",!0)]),e("div",null,[r[7]||(r[7]=e("label",{for:"telephone",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Téléphone",-1)),N(e("input",{"onUpdate:modelValue":r[3]||(r[3]=g=>m.value.telephone=g),id:"telephone",type:"tel",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"+237 6XX XX XX XX"},null,512),[[H,m.value.telephone]]),d.value.telephone?(s(),a("span",Gn,v(d.value.telephone),1)):A("",!0)]),e("div",null,[r[8]||(r[8]=e("label",{for:"photo",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Photo (optionnel)",-1)),e("input",{id:"photo",type:"file",onChange:i,class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",accept:"image/*"},null,32),d.value.photo?(s(),a("span",Kn,v(d.value.photo),1)):A("",!0)]),e("div",null,[e("button",{type:"submit",disabled:t.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition disabled:opacity-50"},[t.value?(s(),a("span",Zn,r[9]||(r[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),k(" Création en cours... ")]))):(s(),a("span",Yn,r[10]||(r[10]=[e("i",{class:"fas fa-plus mr-2"},null,-1),k(" Créer le commerçant ")])))],8,Qn)])],32)])])]))}}),$u=Z(ei,[["__scopeId","data-v-0c50a6f0"]]),ti={class:"overflow-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},si={class:"container mx-auto max-w-4xl"},oi={class:"text-md font-semibold text-white flex items-center"},ai={class:"ml-2 text-sm text-white/80"},ri={class:"text-white/90 text-sm mt-2"},li={key:0,class:"text-white/90 text-sm mt-1"},ni={class:"list-disc list-inside ml-4"},ii=Q({__name:"ParrainageInfo",setup(E){const o=ce(),x=te(),m=f([]),t=async()=>{try{const i=await R.get("/parrainages/niveaux");m.value=i.data.niveaux}catch(i){x.error("Erreur lors de la récupération des niveaux de parrainage"),console.error(i)}},d=()=>{o.go(-1)};return le(()=>{t()}),(i,p)=>(s(),a("div",ti,[e("div",si,[p[4]||(p[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-info-circle mr-2 text-[var(--espace-or)]"}),k(" Tout Savoir sur le Parrainage ")],-1)),e("button",{onClick:d,class:"mb-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},p[0]||(p[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),k(" Retour ")])),p[5]||(p[5]=Me('<div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-9d89fe08><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-9d89fe08>Qu&#39;est-ce que le Parrainage ?</h2><p class="text-[var(--espace-gris)] text-sm sm:text-base" data-v-9d89fe08> Le système de parrainage d&#39;Espace Cameroun vous permet d&#39;inviter des amis avec votre code ou lien unique. Vos gains dépendent des <strong data-v-9d89fe08>niveaux de parrainage</strong>, débloqués par le nombre de commerçants parrainés, avec des bonus en jetons cumulatifs. Plus vous parrainez, plus vous montez de niveau ! Découvrez les détails ci-dessous. </p></div><div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-9d89fe08><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-9d89fe08>Comment ça fonctionne ?</h2><ol class="list-decimal list-inside text-[var(--espace-gris)] text-sm sm:text-base space-y-2" data-v-9d89fe08><li data-v-9d89fe08><strong data-v-9d89fe08>Obtenez votre code unique :</strong> Générez ou créez votre code de parrainage via la page &quot;Mon Parrainage&quot;.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Partagez avec vos amis :</strong> Diffusez votre lien ou code via WhatsApp, Facebook ou d&#39;autres moyens pour inviter des amis à s&#39;inscrire.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Attirez des commerçants :</strong> Encouragez vos filleuls à devenir des commerçants actifs sur la plateforme. Seuls les commerçants parrainés comptent pour débloquer les niveaux.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Montez de niveau :</strong> Chaque niveau nécessite un nombre spécifique de commerçants parrainés. Une fois le seuil atteint, vous débloquez un bonus en jetons correspondant à ce niveau, en plus des bonus des niveaux précédents.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Suivez vos progrès :</strong> Consultez votre niveau actuel, vos jetons bonus et vos avantages exclusifs sur la page &quot;Mon Parrainage&quot;.</li></ol><p class="text-[var(--espace-gris)] text-sm mt-4" data-v-9d89fe08><strong data-v-9d89fe08>Note importante :</strong> Les jetons bonus sont cumulatifs et attribués en fonction des niveaux atteints, pas directement par parrainage individuel. Par exemple, si vous atteignez le niveau 2 avec 5 commerçants, vous recevez les bonus des niveaux 1 et 2. </p></div>',2)),(s(!0),a(J,null,B(m.value,c=>(s(),a("div",{key:c.id,class:"mb-6 p-4 border rounded-lg",style:pe({backgroundColor:c.couleur||"#f0f0f0"})},[e("h3",oi,[k(v(c.nom)+" "+v(c.emoji)+" ",1),e("span",ai,"("+v(c.filleuls_requis)+" commerçants requis)",1)]),e("p",ri,[p[1]||(p[1]=e("strong",null,"Bonus en jetons :",-1)),k(" "+v(c.jetons_bonus)+" jetons ",1)]),c.avantages.length?(s(),a("p",li,[p[2]||(p[2]=e("strong",null,"Avantages exclusifs :",-1)),e("ul",ni,[(s(!0),a(J,null,B(c.avantages,r=>(s(),a("li",{key:r},v(r),1))),128))])])):A("",!0),p[3]||(p[3]=e("p",{class:"text-white/70 text-xs mt-1 italic"}," * Les jetons bonus sont crédités une fois le niveau atteint et cumulés avec les niveaux précédents. ",-1))],4))),128))])]))}}),ku=Z(ii,[["__scopeId","data-v-9d89fe08"]]),ui={class:"w-full flex relative px-0"},ci=["onClick"],di={class:"flex items-center"},pi=["onClick"],vi=["src"],mi={class:"min-w-0"},fi={class:"font-semibold text-[var(--espace-vert)] truncate"},gi={class:"text-xs text-[var(--espace-gris)] truncate"},xi={class:"flex items-center"},bi={key:0,class:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center mr-2"},hi={class:"text-xs text-[var(--espace-gris)] ml-2 whitespace-nowrap"},yi={class:"w-full grid grid-rows-[10%_86%]"},_i={class:"flex border-b"},wi={key:1,class:"text-xl h-[10%] font-semibold text-[var(--espace-vert)] p-4"},$i={key:0,class:"h-full flex flex-col"},ki={class:"block text-[var(--espace-vert)]"},Ci={class:"text-gray-800"},Ai={class:"text-xs text-[var(--espace-gris)] text-right mr-2"},Pi={key:0,class:"text-center text-[var(--espace-gris)]"},Si={class:"px-2 md:px-4 z-20"},ji={class:"bg-white shadow-lg rounded-full flex items-center flex-wrap p-2 border max-w-3xl mx-auto gap-2"},Vi={key:0,class:"bg-yellow-200 text-yellow-800 text-xs px-3 py-1 rounded-full flex items-center gap-2 ml-4"},Mi={key:1,class:"flex items-center justify-center h-full"},zi=Q({__name:"Messages",setup(E){const o=ce(),x=we(),m=re(),t=te(),d=ze(),i=f([]),p=f([]),c=f(null),r=f(""),g=f(!0),_=f(0),P=f(!1),b=f(!1),n=f(null),h=f(null),$=f(window.innerWidth<768),F=()=>{Re(()=>{var u;(u=n.value)==null||u.scrollTo({top:n.value.scrollHeight,behavior:"smooth"})})},z=()=>{h.value=null,localStorage.removeItem("chatProduct")},M=async()=>{try{const u=await R.get("/conversations");i.value=u.data.conversations}catch(u){t.error("Erreur lors de la récupération des conversations"),console.error(u)}},w=async(u,S=!0)=>{var I,q,K;if(!b.value){b.value=!0;try{S&&(_.value=0,p.value=[]),g.value=!1;const T=await R.get(`/chat/${u}?offset=${_.value}`);p.value=[...T.data.messages],console.log(T.data),P.value=T.data.hasMore;const se=localStorage.getItem("chatProduct"),j=i.value.find(X=>X.user_id===u);let C="",Y="/default-avatar.png";j?(C=j.is_commercant?j.name:((I=T.data.user)==null?void 0:I.nom)||"",Y=j.profile_photo):se?(C=JSON.parse(se).commercant_name||((q=T.data.user)==null?void 0:q.nom)||"",Y=(j==null?void 0:j.profile_photo)||"/default-avatar.png"):C=((K=T.data.user)==null?void 0:K.nom)||"",c.value={user_id:u,name:C,is_commercant:(j==null?void 0:j.is_commercant)||!1,profile_photo:Y},se&&(h.value=JSON.parse(se)),await ae(u),F()}catch(T){t.error("Erreur lors du chargement des messages"),console.error(T)}finally{b.value=!1}}},U=u=>{o.push({name:"messages",params:{receiverId:u}}),$.value&&(g.value=!1)},O=async()=>{var I,q,K,T,se,j,C,Y,X,ne;if(!r.value.trim()||!c.value){t.error("Veuillez sélectionner une conversation et écrire un message");return}const u=r.value.trim(),S={id:-Date.now(),sender_id:(I=m.user)==null?void 0:I.id,receiver_id:c.value.user_id,content:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_read:!1,product_id:((q=h.value)==null?void 0:q.id)||null,sender:{id:((K=m.user)==null?void 0:K.id)??0,nom:((T=m.user)==null?void 0:T.nom)??"",email:((se=m.user)==null?void 0:se.email)??"",telephone:((j=m.user)==null?void 0:j.telephone)??"",ville:((C=m.user)==null?void 0:C.ville)??"",premium:((Y=m.user)==null?void 0:Y.premium)??!1,parrain_id:((X=m.user)==null?void 0:X.parrain_id)??0},receiver:{id:c.value.user_id,nom:c.value.name,email:null,telephone:null,ville:null,premium:!1,parrain_id:null},product:h.value||null};p.value.push(S),r.value="",F();try{const me=await R.post(`/chat/${c.value.user_id}`,{content:u,product_id:(ne=h.value)==null?void 0:ne.id});console.log(me.data),h.value&&z()}catch(me){t.error("Échec d'envoi"),console.error(me),p.value=p.value.filter(ge=>ge.id!==S.id)}},L=()=>{!n.value||!P.value||b.value||n.value.scrollTop<=100&&(_.value+=30,w(c.value.user_id,!1))},ee=()=>{$.value=window.innerWidth<768,g.value=window.innerWidth>=768},ae=async u=>{try{const S=await R.put("/messages/mark-all-as-read");d.saveUnreadMessagesToLocalStorage(S.data.unread_messages)}catch(S){console.error("Erreur lors du marquage des messages comme lus:",S),t.error("Erreur lors de la mise à jour des messages lus")}},y=()=>{g.value=!g.value},l=(u,S)=>{const I=S?`/commercants/${u}`:`/users/${u}`;o.push(I)};return le(()=>{M(),x.params.receiverId&&w(parseInt(x.params.receiverId)),window.addEventListener("resize",ee)}),$e(()=>{window.removeEventListener("resize",ee)}),ie(()=>x.params.receiverId,async u=>{u&&await w(parseInt(u))}),(u,S)=>{var q,K;const I=ve("router-link");return s(),a("div",ui,[D(fe,{name:"slide-fade"},{default:G(()=>[g.value||!$.value?(s(),a("div",{key:0,class:W(["bg-white pt-8 shadow-md p-4 overflow-y-auto transition-all",$.value?"absolute top-0 left-0 h-full z-30 w-full":"w-[400px]"])},[S[1]||(S[1]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Conversations",-1)),(s(!0),a(J,null,B(i.value,T=>(s(),a("div",{key:T.user_id,onClick:se=>U(T.user_id),class:"p-2 hover:bg-gray-100 cursor-pointer rounded flex items-center justify-between transition-colors"},[e("div",di,[e("div",{onClick:oe(se=>l(T.user_id,T.is_commercant),["stop"]),class:"w-10 h-10 bg-[var(--espace-or)] rounded-full mr-2 flex items-center justify-center overflow-hidden cursor-pointer"},[e("img",{src:T.profile_photo,alt:"Photo de profil",class:"w-full h-full object-cover"},null,8,vi)],8,pi),e("div",mi,[e("p",fi,v(T.name),1),e("p",gi,v(T.last_message),1)])]),e("div",xi,[T.unread_count>0?(s(),a("div",bi,v(T.unread_count),1)):A("",!0),e("div",hi,v(new Date(T.updated_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)])],8,ci))),128))],2)):A("",!0)]),_:1}),e("div",yi,[e("div",_i,[!g.value&&$.value&&c.value?(s(),a("button",{key:0,onClick:y,class:"text-green-900 p-2 rounded-full hover:bg-[var(--espace-or)] transition text-start"},S[2]||(S[2]=[e("i",{class:"fas fa-arrow-left text-2xl"},null,-1)]))):A("",!0),c.value?(s(),a("h2",wi,v(c.value.name),1)):A("",!0)]),e("div",{class:W(["bg-white shadow-md transition-all duration-300 flex flex-col flex-1 h-full overflow-hidden w-full",g.value&&!$.value?"":"rounded-r-lg"]),onScroll:L},[c.value?(s(),a("div",$i,[e("div",{ref_key:"messagesContainer",ref:n,class:"h-full flex-1 overflow-y-auto p-2 md:p-4 space-y-3 bg-gray-50 messages-container"},[(s(!0),a(J,null,B(p.value,T=>{var se,j,C;return s(),a("div",{key:T.id,class:W(["p-3 rounded-full break-words",{"bg-blue-200 ml-auto max-w-[85%] md:max-w-[70%]":T.sender_id===((se=V(m).user)==null?void 0:se.id),"bg-gray-200 max-w-[85%] md:max-w-[70%]":T.sender_id!==((j=V(m).user)==null?void 0:j.id)}])},[e("strong",ki,v(T.sender.nom)+" :",1),e("p",Ci,[(C=T.product)!=null&&C.id?(s(),ue(I,{key:0,to:{name:"produit",params:{id:T.product.id}},class:"text-blue-500 underline hover:text-blue-700 ml-1"},{default:G(()=>[k("[Produit "+v(T.product.nom)+"]",1)]),_:2},1032,["to"])):A("",!0),k(" "+v(T.content),1)]),e("p",Ai,v(new Date(T.created_at).toLocaleTimeString()),1)],2)}),128)),b.value?(s(),a("div",Pi,"Chargement...")):A("",!0)],512),e("div",Si,[e("div",ji,[(q=h.value)!=null&&q.id?(s(),a("span",Vi,[k(" Produit "+v((K=h.value)==null?void 0:K.nom)+" ",1),e("button",{onClick:z,class:"ml-2 text-yellow-800 hover:text-red-600 font-bold",title:"Retirer le tag"}," × ")])):A("",!0),N(e("input",{"onUpdate:modelValue":S[0]||(S[0]=T=>r.value=T),onKeyup:Te(O,["enter"]),type:"text",placeholder:"Écrivez votre message...",class:"flex-1 px-4 py-2 rounded-full focus:outline-none text-gray-700 text-sm placeholder-gray-400 min-w-[100px] md:min-w[200px]"},null,544),[[H,r.value]]),e("button",{onClick:O,class:"ml-2 p-3 rounded-full bg-[var(--espace-vert)] text-white hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},S[3]||(S[3]=[e("i",{class:"fas fa-location-arrow text-lg"},null,-1)]))])])])):(s(),a("div",Mi,S[4]||(S[4]=[e("p",{class:"text-[var(--espace-gris)] text-lg"},"Sélectionnez une conversation pour commencer.",-1)])))],34)])])}}}),Cu=Z(zi,[["__scopeId","data-v-caa700a1"]]),Ei={class:"mx-auto max-w-4xl py-5 px-4 flex flex-col gap-3"},Ii={key:0,class:"overflow-y-scroll space-y-4"},Li={class:"flex justify-between items-center"},Fi={class:"text-lg font-semibold"},Ti={class:"text-gray-600"},Ri={class:"text-gray-600"},Di={class:"text-gray-600"},Ni={class:"text-gray-600"},Ui={class:"text-gray-600"},Oi={key:0,class:"text-gray-600"},qi={class:"text-right"},Ji=["onClick"],Wi={key:1,class:"text-gray-500"},Hi={class:"mt-6 flex gap-4"},Bi={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Xi=Q({__name:"JetonHistory",setup(E){const x=re().user,m=f([]),t=f(!1),d=te(),i=async()=>{try{const r=await R.get(`/jeton-transactions/${x==null?void 0:x.id}`);console.log(r.data),m.value=r.data}catch(r){console.error("Erreur lors du chargement des transactions:",r)}},p=r=>new Date(r).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=async r=>{var g,_;if(console.log("Refaire la transaction:",r),!!confirm(`Refaire l'achat de ${r.nombre_jetons} jetons avec le même service (${r.methode_paiement}) ?`)){t.value=!0;try{const P=await R.post("/acheter-jetons",{nombre_jetons:r.nombre_jetons,payment_service:r.methode_paiement,phone_number:r.phone_number});d.success(P.data.message),i()}catch(P){d.error(((_=(g=P.response)==null?void 0:g.data)==null?void 0:_.message)||"Erreur lors de l'achat."),console.error(P)}finally{t.value=!1}}};return le(()=>{x&&i()}),(r,g)=>{const _=ve("router-link");return s(),a("div",Ei,[g[4]||(g[4]=e("h1",{class:"text-3xl font-bold text-[var(--espace-vert)]"},"Historique des Transactions de Jetons",-1)),m.value.length>0?(s(),a("div",Ii,[(s(!0),a(J,null,B(m.value,P=>(s(),a("div",{key:P.id,class:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow"},[e("div",Li,[e("div",null,[e("p",Fi,"Achat de "+v(P.nombre_jetons)+" jetons",1),e("p",Ti,"Montant: "+v(P.montant)+" FCFA",1),e("p",Ri,"Méthode: "+v(P.methode_paiement),1),e("p",Di,"Numéro: "+v(P.phone_number),1),e("p",Ni,"Statut: "+v(P.statut),1),e("p",Ui,"Date: "+v(p(P.date_transaction)),1),P.transaction_id_mesomb?(s(),a("p",Oi," ID Transaction: "+v(P.transaction_id_mesomb),1)):A("",!0)]),e("div",qi,[e("button",{onClick:b=>c(P),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] mr-2"},g[0]||(g[0]=[e("i",{class:"fas fa-redo"},null,-1),k(" Refaire ")]),8,Ji)])])]))),128))])):(s(),a("p",Wi,"Aucune transaction trouvée.")),e("div",Hi,[D(_,{to:"/acheter-jetons",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:G(()=>g[1]||(g[1]=[k(" Acheter des Jetons ")])),_:1,__:[1]}),D(_,{to:"/commercant/produits",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:G(()=>g[2]||(g[2]=[k(" Booster un Produit ")])),_:1,__:[2]})]),t.value?(s(),a("div",Bi,g[3]||(g[3]=[Me('<div class="bg-white p-6 rounded-lg shadow-lg text-center" data-v-4d0a432e><p class="text-lg text-[var(--espace-vert)]" data-v-4d0a432e>Veuillez patienter...</p><svg class="animate-spin h-8 w-8 text-[var(--espace-vert)] mx-auto mt-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-4d0a432e><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-4d0a432e></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" data-v-4d0a432e></path></svg></div>',1)]))):A("",!0)])}}}),Au=Z(Xi,[["__scopeId","data-v-4d0a432e"]]),Gi={class:"min-h-screen bg-gray-100 py-8 sm:px-6"},Ki={class:"container mx-auto max-w-3xl bg-white rounded-lg shadow-md p-6"},Qi={class:"flex flex-col sm:flex-row items-center gap-6 mb-6"},Zi={class:"relative"},Yi=["src"],eu={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-xl p-1 rounded-full"},tu={class:"flex-1"},su={class:"text-gray-600"},ou={key:0,class:"text-sm text-gray-500"},au={class:"text-gray-600"},ru={class:"text-gray-600"},lu=Q({__name:"ProfilePublic",setup(E){const o=we(),x=ce(),m=te(),t=f(null),d=async()=>{try{const p=await R.get(`/profile/public/${o.params.id}`);t.value=p.data}catch(p){m.error("Erreur lors de la récupération du profil."),console.error(p)}},i=()=>{var p;(p=t.value)!=null&&p.id?x.push({name:"messages",params:{receiverId:t.value.id}}):m.error("Impossible d'accéder au chat. Profil invalide.")};return le(()=>{d()}),(p,c)=>{var r,g,_,P,b,n,h,$,F,z,M,w,U,O,L,ee,ae,y,l,u,S,I;return s(),a("div",Gi,[e("div",Ki,[e("div",Qi,[e("div",Zi,[(r=t.value)!=null&&r.photo?(s(),a("img",{key:0,src:`http://localhost:8000/storage/${(g=t.value)==null?void 0:g.photo}`,alt:"Photo de profil",class:"w-24 h-24 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,Yi)):(s(),a("div",{key:1,class:"w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:pe({background:`${((n=(b=(P=(_=t.value)==null?void 0:_.niveaux_users)==null?void 0:P.at(-1))==null?void 0:b.parrainage_niveau)==null?void 0:n.couleur)||"#0af"}`})},c[0]||(c[0]=[e("i",{class:"fas fa-user-circle text-5xl"},null,-1)]),4)),(h=t.value)!=null&&h.premium?(s(),a("i",eu)):A("",!0)]),e("div",tu,[e("h1",{class:"text-3xl font-bold flex items-center gap-2",style:pe({color:`${((M=(z=(F=($=t.value)==null?void 0:$.niveaux_users)==null?void 0:F.at(-1))==null?void 0:z.parrainage_niveau)==null?void 0:M.couleur)||"#0af"}`})},[k(v((w=t.value)==null?void 0:w.nom)+" ",1),(U=t.value)!=null&&U.premium?(s(),a("span",{key:0,class:"text-white text-sm px-2 py-1 rounded-full uppercase font-semibold",style:pe({background:`${((ae=(ee=(L=(O=t.value)==null?void 0:O.niveaux_users)==null?void 0:L.at(-1))==null?void 0:ee.parrainage_niveau)==null?void 0:ae.couleur)||"#0af"}`})}," Premium ",4)):A("",!0)],4),e("p",su,"Statut : "+v((y=t.value)!=null&&y.commercant?"Commerçant":"Utilisateur"),1),(l=t.value)!=null&&l.subscription_ends_at?(s(),a("p",ou," Abonnement Premium jusqu'au "+v(new Date((u=t.value)==null?void 0:u.subscription_ends_at).toLocaleDateString()),1)):A("",!0),e("p",au,"Ville : "+v((S=t.value)==null?void 0:S.ville),1),e("p",ru,"Téléphone : "+v((I=t.value)==null?void 0:I.telephone),1)]),e("div",{class:"mt-6 flex justify-center"},[e("button",{onClick:i,class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},c[1]||(c[1]=[e("i",{class:"fas fa-comments mr-2"},null,-1),k(" Discuter ")]))])]),c[2]||(c[2]=e("div",{class:"mt-6 text-center"},[e("p",{class:"text-gray-700"},"Ce profil affiche les informations publiques de l'utilisateur.")],-1))])])}}}),Pu=Z(lu,[["__scopeId","data-v-eef19e07"]]);export{Ks as A,vu as C,du as F,cu as H,Au as J,pu as L,Cu as M,fu as P,mu as R,xu as a,wu as b,$u as c,hu as d,gu as e,yu as f,ku as g,bu as h,_u as i,Pu as j,re as u};
