import{r as g,u as se,d as Y,a as ue,w as ne,o as le,b as pe,c as r,e as A,f as j,g as s,h as e,i as D,j as K,k as C,t as m,l as _e,m as be,n as we,F as J,p as X,q as ie,s as H,v as N,x as B,y as Fe,z as Re,T as me,A as oe,B as de,C as ye,D as He,E as Me,G as Be,H as Ze,I as Xe}from"./vue-DTxKeDEm.js";import{d as De}from"./pinia-eoHnihP1.js";import{a as Ie}from"./axios-Dq7h7Pqt.js";Ie.defaults.withCredentials=!0;Ie.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";Ie.defaults.withXSRFToken=!0;const F=Ie.create({withCredentials:!0,baseURL:"http://localhost:8000/api/v1",headers:{Accept:"application/json","Content-Type":"application/json"}});F.interceptors.request.use(z=>(localStorage.getItem("auth_token"),z));const re=De("auth",{state:()=>({user:null,token:localStorage.getItem("token")||null}),actions:{async login(z){const o=await F.post("/login",z);this.user=o.data.user,this.token=o.data.token,localStorage.setItem("token",this.token??""),F.defaults.headers.common.Authorization=`Bearer ${this.token}`},async register(z){const o=await F.post("/register",z);this.user=o.data.user,this.token=o.data.token,localStorage.setItem("token",this.token??""),F.defaults.headers.common.Authorization=`Bearer ${this.token}`},async checkAuth(){if(!this.token)return!1;try{F.defaults.headers.common.Authorization=`Bearer ${this.token}`;const z=await F.get("/user");return this.user=z.data.user,!0}catch{return this.user=null,this.token=null,localStorage.removeItem("token"),!1}},async logout(){try{this.token&&(F.defaults.headers.common.Authorization=`Bearer ${this.token}`,await F.post("/logout"))}catch{}this.user=null,this.token=null,localStorage.removeItem("token"),delete F.defaults.headers.common.Authorization}}}),Ge="/assets/logoOrangeweb-C9Cko1mf.webp",ze=De("userState",()=>{const z=g(0),o=g(0),h=se(),f=()=>{const a=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");z.value=a.length;const x=localStorage.getItem("unread_messages");o.value=x?parseInt(x,10):0},t=a=>{localStorage.setItem("pending_collaborations",JSON.stringify(a)),z.value=a.length},c=a=>{localStorage.setItem("unread_messages",a.toString()),o.value=a},n=async a=>{var w;const x=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");x.push({produit_id:a.produit_id,prix_revente:a.prix_revente,status:"pending",created_at:new Date().toISOString()}),t(x);try{return await F.post("/collaborations",{produit_id:a.produit_id,prix_revente:a.prix_revente}),await v(),h.success("Demande de collaboration envoyée !"),!0}catch(P){const b=x.filter(l=>!(l.produit_id===a.produit_id&&l.prix_revente===a.prix_revente));return t(b),h.error(((w=P.response)==null?void 0:w.data.message)||"Erreur lors de la demande de collaboration"),!1}},v=async()=>{try{const a=await F.get("/user/badges");z.value=a.data.collaborations_pending,console.log(a.data),c(a.data.unread_messages||0)}catch(a){console.error("Erreur lors de la synchronisation des badges:",a)}};return{collaborationsPending:z,unreadMessages:o,initializeState:f,addCollaboration:n,syncCollaborationsWithBackend:v,clearState:()=>{localStorage.removeItem("pending_collaborations"),localStorage.removeItem("unread_messages"),z.value=0,o.value=0},saveCollaborationsToLocalStorage:t,saveUnreadMessagesToLocalStorage:c}}),Ee=De("product",{state:()=>({product:{},products:[],isLoading:!1,hasMore:!0,page:1,sort:"random",userId:null,relatedProperties:[]}),getters:{user:z=>re().user},actions:{async fetchProducts(z={},o=!1){var h,f;if(!(this.isLoading||!o&&!this.hasMore)){this.isLoading=!0,o&&(this.products=[],this.page=1,this.hasMore=!0);try{const t=await F.get("/produits",{params:{...z,page:this.page,sort:this.sort}});if(console.log(t.data.data),z.per_page==="all")this.products=o?t.data:[...this.products,...t.data];else{const c=t.data.data;this.products=o?c:[...this.products,...c],this.hasMore=t.data.current_page<t.data.last_page,this.page=t.data.current_page+1}}catch(t){throw((f=(h=t.response)==null?void 0:h.data)==null?void 0:f.message)||"Erreur lors du chargement des produits"}finally{this.isLoading=!1}}},async toggleFavorite(z){var c,n;const o=re();if(!o.user&&(await o.checkAuth(),!o.user)){console.warn("Utilisateur non connecté, redirection ou action nécessaire");return}const h=o.user;console.log(`user ${JSON.stringify(h)}`);const f=this.products.find(v=>v.id===z);let t=!1;f&&(f.is_favorited_by=!f.is_favorited_by,f.counts.favorites_count=f.is_favorited_by?f.counts.favorites_count+1:f.counts.favorites_count-1,t=!0),this.product&&this.product.id===z&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count+1:this.product.counts.favorites_count-1,t=!0);try{const v=await F.post(`/produits/${z}/favorite`),u=v.data.produit;if(t){const a=this.products.findIndex(x=>x.id===z);a!==-1&&(this.products[a]={...this.products[a],...u}),this.product&&this.product.id===z&&(this.product={...this.product,...u})}return v.data.message}catch(v){if(t){const u=this.products.find(a=>a.id===z);u&&(u.is_favorited_by=!u.is_favorited_by,u.counts.favorites_count=u.is_favorited_by?u.counts.favorites_count-1:u.counts.favorites_count+1),this.product&&this.product.id===z&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.counts.favorites_count=this.product.is_favorited_by?this.product.counts.favorites_count-1:this.product.counts.favorites_count+1)}throw((n=(c=v.response)==null?void 0:c.data)==null?void 0:n.message)||"Erreur lors de la mise à jour des favoris"}},async viewProduct(z){var o,h;try{const f=await F.get(`/produits/${z}`);this.product=f.data.produit;const t=this.products.findIndex(c=>c.id===z);t!==-1?this.products[t]={...this.products[t],...this.product}:this.products.push(this.product)}catch(f){throw((h=(o=f.response)==null?void 0:o.data)==null?void 0:h.message)||"Erreur lors du chargement du produit"}},setSort(z){this.sort=z,this.page=1,this.products=[],this.hasMore=!0,this.fetchProducts({},!0)},setUserId(z){this.userId=z}}}),Ye={key:0,class:"fixed top-14 right-4 z-50 flex items-center gap-2 rounded-full px-4 py-2"},et={class:"text-sm font-semibold text-[var(--espace-vert)]"},tt={class:"text-gray-800"},st=Y({__name:"SoldeUser",setup(z){ue();const o=re(),h=g(0),f=async()=>{if(o.user)try{h.value=o.user.jetons,console.log(h.value)}catch(t){console.error("Erreur lors de la récupération des jetons:",t)}};return ne(()=>o.user,()=>{f()}),le(()=>{f()}),(t,c)=>{const n=pe("router-link");return j(o).user?(s(),r("div",Ye,[c[1]||(c[1]=e("i",{class:"fas fa-coins text-[var(--espace-or)] text-lg"},null,-1)),e("span",et,[D(n,{to:"/jeton-history"},{default:K(()=>[c[0]||(c[0]=C(" Jetons : ")),e("span",tt,m(h.value),1)]),_:1,__:[0]})])])):A("",!0)}}}),ee=(z,o)=>{const h=z.__vccOpts||z;for(const[f,t]of o)h[f]=t;return h},Ke=ee(st,[["__scopeId","data-v-12adcefd"]]),ot={class:"relative"},at={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] top-0 left-0 w-full z-50 shadow-md"},rt={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},lt={class:"flex items-center gap-1 sm:gap-3"},nt={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},it=["aria-label"],ut={class:"flex items-center gap-2"},ct=["src"],dt={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},pt={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},vt=Y({__name:"HeaderBar",setup(z){const o=re(),h=ze();ue();const f=o.user;_e();const t=g(!1),c=g(!1),n=g(""),v=Ee(),u=g(!1),a=g(null),x=g(!1),w=be(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...o.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle"},{to:"/messages",label:"Messages",icon:"fa-comment-dots",badge:h.unreadMessages},...o.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:h.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),P=async()=>{if(o.user)try{await h.syncCollaborationsWithBackend()}catch($){console.error("Erreur lors du chargement des badges:",$)}};ne(()=>o.user,$=>{$&&(P(),h.initializeState())},{immediate:!0}),ne(()=>h.collaborationsPending,$=>{$>-1&&(t.value=!0,setTimeout(()=>t.value=!1,300))}),ne(()=>h.unreadMessages,$=>{$>-1&&(c.value=!0,setTimeout(()=>c.value=!1,300))});const b=async()=>{if(n.value.trim())try{await v.fetchProducts({search:n.value.trim()},!0),n.value="",u.value=!1}catch($){console.error("Erreur lors de la recherche:",$)}},l=$=>{if(x.value){x.value=!1;return}a.value&&!a.value.contains($.target)&&(u.value=!1)},y=async()=>{u.value=!u.value,u.value&&(x.value=!0,await Re())};return le(()=>{var $;o.user&&(P(),h.initializeState()),document.addEventListener("click",l),($=o.user)!=null&&$.id&&window.Echo.channel(`chat.${o.user.id}`).listen("MessageSent",L=>{var M;console.log("📩 header e reçu :",L.message),((M=o.user)==null?void 0:M.id)===L.receiver_id&&(console.log("📩 header e reçu :",L.message),h.saveUnreadMessagesToLocalStorage(L.unread_messages))})}),we(()=>{var $;document.removeEventListener("click",l),($=o.user)!=null&&$.id&&window.Echo.leave(`chat.${o.user.id}`)}),($,L)=>{const M=pe("RouterLink");return s(),r("div",ot,[e("header",at,[e("div",rt,[e("div",lt,[D(M,{to:"/","aria-label":"Retour à l'accueil"},{default:K(()=>L[2]||(L[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Ge,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),L[3]||(L[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ",-1))]),e("nav",nt,[(s(!0),r(J,null,X(w.value,V=>(s(),ie(M,{key:V.to,to:V.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:K(()=>[e("i",{class:H(["fas",V.icon])},null,2),C(" "+m(V.label)+" ",1),V!=null&&V.badge&&V.badge>-1?(s(),r("span",{key:0,class:H(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":V.to==="/collaborations"&&t.value||V.to==="/messages"&&c.value}]),"aria-label":V.to==="/collaborations"?"Collaborations en attente":V.to==="/messages"?"Messages non lus":""},m(V.badge),11,it)):A("",!0)]),_:2},1032,["to"]))),128))]),D(Ke),e("div",ut,[j(f)?(s(),r("button",{key:0,onClick:y,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},L[4]||(L[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)]))):A("",!0),j(o).user?(s(),ie(M,{key:1,to:"/profil",class:"relative flex items-center justify-center","aria-label":"Profil"},{default:K(()=>{var V;return[(V=j(f))!=null&&V.photo?(s(),r("img",{key:0,src:`http://localhost:8000/storage/${j(f).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,ct)):(s(),r("div",dt,L[5]||(L[5]=[e("i",{class:"fas fa-user-circle text-2xl text-gray-100"},null,-1)])))]}),_:1})):A("",!0),j(o).user?(s(),ie(M,{key:2,to:"/messages",class:"relative flex items-center justify-center","aria-label":"Messages"},{default:K(()=>[L[6]||(L[6]=e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},[e("i",{class:"fas fa-comment-dots text-2xl text-gray-100"})],-1)),j(h).unreadMessages>-1?(s(),r("span",{key:0,class:H(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":c.value}]),"aria-label":"Messages non lus"},m(j(h).unreadMessages),3)):A("",!0)]),_:1,__:[6]})):A("",!0)])]),u.value?(s(),r("div",{key:0,ref_key:"searchOverlayRef",ref:a,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",pt,[N(e("input",{"onUpdate:modelValue":L[0]||(L[0]=V=>n.value=V),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Fe(b,["enter"])},null,544),[[B,n.value]]),e("button",{onClick:b,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},L[7]||(L[7]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:L[1]||(L[1]=V=>u.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},L[8]||(L[8]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):A("",!0)])])}}}),iu=ee(vt,[["__scopeId","data-v-22f0f65a"]]),mt={class:"relative"},ft={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},gt={class:"flex justify-around items-center py-2"},xt=["aria-label"],bt=Y({__name:"FooterBar",setup(z){const o=re(),h=ze();ue();const f=g(!1),t=g(!1),c=be(()=>[{to:"/",label:"Accueil",icon:"fa-home"},...o.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle"},...o.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open"}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:h.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users"}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt"},{to:"/register",label:"Inscription",icon:"fa-user-plus"}]]);return ne(()=>h.collaborationsPending,n=>{n>0&&(f.value=!0,setTimeout(()=>f.value=!1,300))}),ne(()=>h.unreadMessages,n=>{n>0&&(t.value=!0,setTimeout(()=>t.value=!1,300))}),(n,v)=>{const u=pe("RouterLink");return s(),r("div",mt,[D(me,{name:"slide-up"},{default:K(()=>[e("nav",ft,[e("div",gt,[(s(!0),r(J,null,X(c.value,a=>(s(),ie(u,{key:a.to,to:a.to,"aria-label":a.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:K(()=>[e("i",{class:H(["fas text-lg",a.icon])},null,2),a!=null&&a.badge&&a.badge>-1?(s(),r("span",{key:0,class:H(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":a.to==="/collaborations"&&f.value||a.to==="/messages"&&t.value}]),"aria-label":a.to==="/collaborations"?"Collaborations en attente":a.to==="/messages"?"Messages non lus":""},m(a.badge),11,xt)):A("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),uu=ee(bt,[["__scopeId","data-v-df5ad5ec"]]),ht={class:"mb-4"},yt={class:"block text-sm sm:text-base font-medium mb-1 text-[var(--espace-gris)]"},_t={class:"relative"},wt={class:"absolute inset-y-0 left-3 flex items-center text-[var(--espace-or)]"},kt=["type","value","required","placeholder"],$t={key:0,class:"text-red-500 text-sm mt-1"},ce=Y({__name:"Form",props:{label:String,icon:String,type:{type:String,default:"text"},modelValue:[String,Number],required:Boolean,placeholder:String,error:String},emits:["update:modelValue"],setup(z){return(o,h)=>(s(),r("div",ht,[e("label",yt,m(z.label),1),e("div",_t,[e("span",wt,[e("i",{class:H(`fas ${z.icon}`)},null,2)]),e("input",{type:z.type,value:z.modelValue,onInput:h[0]||(h[0]=f=>o.$emit("update:modelValue",f.target.value)),required:z.required,placeholder:z.placeholder,class:H(["w-full pl-10 pr-4 py-3 rounded-xl border text-sm sm:text-base transition","focus:outline-none focus:ring-2",z.error?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-[var(--espace-or)]"])},null,42,kt)]),z.error?(s(),r("p",$t,m(z.error),1)):A("",!0)]))}}),Ct={class:"overflow-y-scroll bg-gray-100 flex items-center justify-center px-4 py-8"},At={class:"w-full max-w-lg bg-[rgba(255,255,255,0.85)] rounded-2xl shadow-xl p-6 sm:p-10"},Pt={class:"text-center text-sm text-gray-600 mt-6"},St=Y({__name:"Login",setup(z){const o=g({login:"",mot_de_passe:""}),h=g({}),f=ue(),t=se(),c=re(),n=async()=>{var v,u;try{await c.login({login:o.value.login,mot_de_passe:o.value.mot_de_passe}),t.success("Connexion réussie !"),f.push((v=c.user)!=null&&v.commercant?{name:"commercant"}:{name:"profil"})}catch(a){console.error("Erreur lors de la connexion:",a);const x=a.message||"Erreur lors de la connexion. Veuillez vérifier vos informations.";t.error(x),((u=a.response)==null?void 0:u.status)===422&&(h.value=a.response.data.errors||{})}};return(v,u)=>{const a=pe("router-link");return s(),r("div",Ct,[e("div",At,[u[5]||(u[5]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-sign-in-alt mr-2 text-[var(--espace-or)]"}),C(" Connexion ")],-1)),u[6]||(u[6]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[C(" Connectez-vous à "),e("strong",null,"Espace Cameroun"),C(" pour accéder à vos achats et votre espace commerçant. ")],-1)),e("form",{onSubmit:oe(n,["prevent"]),class:"space-y-5"},[D(ce,{label:"Email ou Téléphone",icon:"fa-envelope",modelValue:o.value.login,"onUpdate:modelValue":u[0]||(u[0]=x=>o.value.login=x),type:"text",required:"",error:h.value.login},null,8,["modelValue","error"]),D(ce,{label:"Mot de passe",icon:"fa-lock",modelValue:o.value.mot_de_passe,"onUpdate:modelValue":u[1]||(u[1]=x=>o.value.mot_de_passe=x),type:"password",required:"",error:h.value.mot_de_passe},null,8,["modelValue","error"]),u[2]||(u[2]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-sign-in-alt mr-2"}),C(" Se connecter ")],-1))],32),e("p",Pt,[u[4]||(u[4]=C(" Pas de compte ? ")),D(a,{to:"/register",class:"text-[var(--espace-vert)] font-medium hover:text-[var(--espace-or)] hover:underline"},{default:K(()=>u[3]||(u[3]=[C(" Inscrivez-vous ici ")])),_:1,__:[3]})])])])}}}),cu=ee(St,[["__scopeId","data-v-3b18d20d"]]),jt="/assets/logo-ba4eAQQi.png",Vt={key:0,class:"fixed inset-0 bg-[var(--espace-white)] bg-opacity-50 flex items-center justify-center z-50","aria-label":"Chargement en cours",role:"status"},Mt=Y({__name:"Loader",props:{isLoading:{type:Boolean}},setup(z){return(o,h)=>(s(),ie(me,{name:"fade"},{default:K(()=>[o.isLoading?(s(),r("div",Vt,h[0]||(h[0]=[e("div",{class:"relative p-6"},[e("img",{src:jt,alt:"Logo Espace Cameroun",class:"h-12 w-12 object-contain animate-spin-pulse"}),e("div",{class:"absolute inset-0 rounded-full border-4 border-[var(--espace-or)] border-t-transparent animate-spin"})],-1)]))):A("",!0)]),_:1}))}}),ke=ee(Mt,[["__scopeId","data-v-f60cc94a"]]),zt={class:"h-full bg-gray-100 pt-5 px-4 sm:px-2"},Et={class:"h-full w-full overflow-y-scroll"},It={key:0},Lt={key:1,class:"grid grid-cols-1 pt-4 pb-2 lg:pb-12 md:grid-cols-3 sm:grid-cols-2 lg:grid-cols-4 gap-6"},Tt={class:"relative w-full h-40 overflow-hidden rounded-t-lg mb-2"},Ft={key:0,class:"absolute z-12 top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Rt=["src"],Dt=["onClick"],Nt=["onClick"],Ut={key:3,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Ot={class:"p-2"},qt={class:"text-lg font-semibold flex justify-between text-[var(--espace-vert)] truncate"},Jt=["onClick"],Wt={class:"text-sm text-[var(--espace-gris)] line-clamp-2"},Ht={class:"text-md font-bold text-[var(--espace-or)] mt-2"},Bt={class:"text-sm text-[var(--espace-gris)]"},Xt={class:"text-sm text-[var(--espace-gris)] mt-2"},Gt={class:"ml-4"},Kt={key:2,class:"text-center text-[var(--espace-gris)]"},Qt={class:"bg-white rounded-lg p-6 sm:p-8 w-full max-w-md mx-4 shadow-lg"},Zt={class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},Yt={class:"mt-2 p-4 bg-gray-50 rounded-lg border border-gray-200"},es={key:0,class:"grid grid-cols-3 gap-2 mb-2"},ts=["src"],ss=["onClick"],os=["value"],as={key:0,class:"flex items-center gap-2"},rs={class:"flex gap-4 pt-2"},ls={type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition"},ns=Y({__name:"CommercantProduits",setup(z){const o=re(),h=ue(),f=se(),t=g(!1),c=g([]),n=g([]),v=g(!1),u=g(!1),a=g(null),x=g({}),w=g({nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0}),P=g([]),b=g([]),l=g(null),y=async()=>{t.value=!0;try{const d=await F.get("/commercant/produits");c.value=d.data.produits.map(i=>({...i,photo_url:i.photos&&i.photos.length>0?i.photos[0]:"https://via.placeholder.com/150"})),console.log(d.data),c.value.forEach(i=>{x.value[i.id]||(x.value[i.id]=0)})}catch{f.error("Erreur lors du chargement des produits")}finally{t.value=!1}},$=async()=>{t.value=!0;try{const d=await F.get("/categories");n.value=d.data.categories}catch{f.error("Erreur lors de la chargement des catégories")}finally{t.value=!1}},L=()=>{w.value={nom:"",description:"",prix:0,stock:0,category_id:"",collaboratif:!1,marge_min:0},P.value=[],b.value=[],v.value=!0},M=d=>{a.value=d,w.value={nom:d.nom,description:d.description||"",prix:d.prix,stock:d.quantite,category_id:d.category_id,collaboratif:!!d.collaboratif,marge_min:d.marge_min||0},P.value=[],b.value=d.photos||[],x.value[d.id]||(x.value[d.id]=0),u.value=!0},V=d=>{const i=d.target;if(i.files){const p=Array.from(i.files);P.value=[...P.value,...p],b.value=[...b.value,...p.map(S=>URL.createObjectURL(S))],l.value&&(l.value.value="")}},k=d=>{P.value.splice(d,1),b.value.splice(d,1)},U=async()=>{var i,p;t.value=!0;const d=new FormData;d.append("nom",w.value.nom),d.append("description",w.value.description),d.append("prix",w.value.prix.toString()),d.append("stock",w.value.stock.toString()),d.append("category_id",w.value.category_id),d.append("collaboratif",w.value.collaboratif?"1":"0"),d.append("marge_min",w.value.marge_min.toString()),P.value.forEach(S=>d.append("photos[]",S));for(let[S,E]of d.entries())console.log(`${S}:`,E);try{if(v.value){const S=await F.post("/commercant/produits",d,{headers:{"Content-Type":"multipart/form-data"}});console.log(S.data),f.success("Produit ajouté avec succès")}else{const S=await F.post(`/commercant/produits/${(i=a.value)==null?void 0:i.id}`,d,{headers:{"Content-Type":"multipart/form-data"}});f.success("Produit modifié avec succès")}await y(),O()}catch(S){f.error(((p=S.response)==null?void 0:p.data.message)||"Erreur lors de la sauvegarde du produit")}finally{t.value=!1}},O=()=>{v.value=!1,u.value=!1,a.value=null,P.value=[],b.value=[]},I=be(()=>d=>x.value[d]||0),te=d=>{var S;const i=c.value.find(E=>E.id===d),p=(S=i==null?void 0:i.photos)!=null&&S.length?i.photos.length-1:0;x.value[d]=Math.min((x.value[d]||0)+1,p)},W=d=>{x.value[d]=Math.max((x.value[d]||0)-1,0)};return le(()=>{var d;if(!((d=o.user)!=null&&d.commercant)){f.error("Accès réservé aux commerçants"),h.push("/");return}y(),$()}),(d,i)=>{const p=pe("router-link");return s(),r(J,null,[D(ke,{isLoading:t.value},null,8,["isLoading"]),e("div",zt,[e("div",Et,[e("div",{class:"flex justify-between items-center"},[i[9]||(i[9]=e("h1",{class:"text-1xl md:text-2xl font-bold text-[var(--espace-vert)] text-md mb-2 font-poppins"},[e("i",{class:"fas fa-box-open mr-1 text-[var(--espace-or)] text-md!important"}),C(" Mes Produits ")],-1)),e("button",{onClick:L,class:"mb-2 md:text-xl text-[var(--espace-vert)] font-semibold px-2 py-1 rounded hover:bg-[var(--espace-vert)] hover:text-white transition inline-flex items-center"},i[8]||(i[8]=[e("i",{class:"fas fa-plus mr-2"},null,-1),C(" Ajouter un produit ")]))]),t.value?(s(),r("div",It,i[10]||(i[10]=[e("div",{class:"flex items-center justify-center py-10"},[e("i",{class:"fas fa-spinner animate-spin text-2xl text-[var(--espace-vert)]"})],-1)]))):c.value.length?(s(),r("div",Lt,[(s(!0),r(J,null,X(c.value,S=>(s(),r("div",{key:S.id,class:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition relative"},[e("div",Tt,[S.collaboratif?(s(),r("span",Ft," Collaboratif ")):A("",!0),D(p,{to:`/produits/${S.id}`,class:"block relative"},{default:K(()=>[e("div",{class:"flex w-full h-full slider-container",style:de({transform:`translateX(-${I.value(S.id)*100}%)`})},[(s(!0),r(J,null,X(S.photos,(E,R)=>(s(),r("img",{key:R,src:E,class:"h-40 object-contain flex-shrink-0 mx-auto w-full",alt:"Photo du produit"},null,8,Rt))),128))],4)]),_:2},1032,["to"]),S.photos&&S.photos.length>1?(s(),r("button",{key:1,onClick:E=>W(S.id),class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},i[11]||(i[11]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,Dt)):A("",!0),S.photos&&S.photos.length>1?(s(),r("button",{key:2,onClick:E=>te(S.id),class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},i[12]||(i[12]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,Nt)):A("",!0),S.photos&&S.photos.length>1?(s(),r("div",Ut,[(s(!0),r(J,null,X(S.photos,(E,R)=>(s(),r("span",{key:R,class:H(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":R===I.value(S.id)}])},null,2))),128))])):A("",!0)]),e("div",Ot,[e("h2",qt,[D(p,{to:`/produits/${S.id}`,class:"block relative"},{default:K(()=>[C(m(S.nom),1)]),_:2},1032,["to"]),e("button",{onClick:E=>M(S),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},i[13]||(i[13]=[e("i",{class:"fas fa-pencil text-sm"},null,-1)]),8,Jt)]),e("p",Wt,m(S.description||"Aucune"),1),e("p",Ht,m(S.prix)+" FCFA",1),e("p",Bt,"Stock: "+m(S.quantite),1),e("div",Xt,[e("span",null,[i[14]||(i[14]=e("i",{class:"fas fa-eye mr-1"},null,-1)),C(" "+m(S.raw_views_count||0)+" vues",1)]),e("span",Gt,[i[15]||(i[15]=e("i",{class:"fas fa-heart mr-1"},null,-1)),C(" "+m(S.favorites_count||0)+" favoris",1)])])])]))),128))])):(s(),r("p",Kt,"Aucun produit pour le moment."))]),D(me,{name:"fade"},{default:K(()=>{var S;return[v.value||u.value?(s(),r("div",{key:0,class:"overflow-y-scroll fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:oe(O,["self"])},[e("div",Qt,[e("h2",Zt,m(v.value?"Ajouter un produit":"Modifier le produit"),1),e("form",{onSubmit:oe(U,["prevent"]),class:"space-y-4"},[e("div",null,[i[19]||(i[19]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Photos du produit",-1)),e("div",Yt,[b.value.length?(s(),r("div",es,[(s(!0),r(J,null,X(b.value,(E,R)=>(s(),r("div",{key:R,class:"relative w-full h-20"},[e("img",{src:E,class:"w-full h-full object-cover rounded-lg",alt:"Prévisualisation"},null,8,ts),e("button",{onClick:oe(Q=>k(R),["prevent"]),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs"},i[16]||(i[16]=[e("i",{class:"fas fa-times"},null,-1)]),8,ss)]))),128))])):A("",!0),e("input",{ref_key:"fileInput",ref:l,type:"file",multiple:"",onChange:V,class:"hidden",accept:"image/*"},null,544),b.value.length?(s(),r("button",{key:2,onClick:i[1]||(i[1]=E=>{var R;return(R=l.value)==null?void 0:R.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},i[18]||(i[18]=[e("i",{class:"fas fa-plus mr-2"},null,-1),C(" Ajouter une autre photo ")]))):(s(),r("button",{key:1,onClick:i[0]||(i[0]=E=>{var R;return(R=l.value)==null?void 0:R.click()}),class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center"},i[17]||(i[17]=[e("i",{class:"fas fa-camera mr-2"},null,-1),C(" Ajouter une photo ")])))])]),e("div",null,[i[20]||(i[20]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Nom",-1)),N(e("input",{"onUpdate:modelValue":i[2]||(i[2]=E=>w.value.nom=E),type:"text",required:"",class:"input-style"},null,512),[[B,w.value.nom]])]),e("div",null,[i[21]||(i[21]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Description",-1)),N(e("textarea",{"onUpdate:modelValue":i[3]||(i[3]=E=>w.value.description=E),rows:"3",class:"input-style"},null,512),[[B,w.value.description]])]),e("div",null,[i[22]||(i[22]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Prix (FCFA)",-1)),N(e("input",{"onUpdate:modelValue":i[4]||(i[4]=E=>w.value.prix=E),type:"number",min:"0",required:"",class:"input-style"},null,512),[[B,w.value.prix,void 0,{number:!0}]])]),e("div",null,[i[23]||(i[23]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Stock",-1)),N(e("input",{"onUpdate:modelValue":i[5]||(i[5]=E=>w.value.stock=E),type:"number",min:"0",required:"",class:"input-style"},null,512),[[B,w.value.stock,void 0,{number:!0}]])]),e("div",null,[i[25]||(i[25]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Catégorie",-1)),N(e("select",{"onUpdate:modelValue":i[6]||(i[6]=E=>w.value.category_id=E),required:"",class:"input-style"},[i[24]||(i[24]=e("option",{value:""},"Sélectionner une catégorie",-1)),(s(!0),r(J,null,X(n.value,E=>(s(),r("option",{key:E.id,value:E.id},m(E.nom),9,os))),128))],512),[[ye,w.value.category_id]])]),v.value||!((S=a.value)!=null&&S.collaboratif)?(s(),r("div",as,[N(e("input",{id:"collaboratif",type:"checkbox","onUpdate:modelValue":i[7]||(i[7]=E=>w.value.collaboratif=E)},null,512),[[He,w.value.collaboratif]]),i[26]||(i[26]=e("label",{for:"collaboratif",class:"text-sm text-[var(--espace-vert)]"},"Collaboratif",-1))])):A("",!0),e("div",rs,[e("button",ls,m(v.value?"Ajouter":"Modifier"),1),e("button",{type:"button",onClick:O,class:"flex-1 bg-[var(--espace-gris)] text-white font-semibold px-4 py-2 rounded hover:bg-gray-700 transition"}," Annuler ")])],32)])])):A("",!0)]}),_:1})])],64)}}}),du=ee(ns,[["__scopeId","data-v-05d3d6ce"]]),is={class:"overflow-y-scroll bg-white flex justify-center px-4"},us={class:"flex flex-col w-full max-w-lg rounded-2xl pb-16 sm:p-10"},cs={class:"text-center text-sm text-gray-600 mt-6"},ds=Y({__name:"Register",setup(z){const o=g({nom:"",telephone:"",email:"",ville:"",mot_de_passe:"",parrain_code:""}),h=g({}),f=ue(),t=_e(),c=se(),n=re();le(()=>{const u=t.params.code;u&&(o.value.parrain_code=u)});const v=async()=>{var u,a,x;try{console.log("Envoi des données d'inscription:",o.value),await n.register(o.value),c.success("Inscription réussie !"),f.push({name:"home"})}catch(w){console.error("Erreur lors de l'inscription:",w);const P=((a=(u=w.response)==null?void 0:u.data)==null?void 0:a.message)||"Erreur lors de l'inscription. Veuillez vérifier vos informations.";c.error(P),((x=w.response)==null?void 0:x.status)===422&&(h.value=w.response.data.errors)}};return(u,a)=>{const x=pe("router-link");return s(),r("div",is,[e("div",us,[a[9]||(a[9]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-user-plus mr-2 text-[var(--espace-or)]"}),C(" Créez votre compte ")],-1)),a[10]||(a[10]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[C(" Rejoignez "),e("strong",null,"Espace Cameroun"),C(" et profitez d’une expérience d’achat unique. Vos informations resteront confidentielles. ")],-1)),e("form",{onSubmit:oe(v,["prevent"]),class:"space-y-5"},[D(ce,{label:"Nom",icon:"fa-user",modelValue:o.value.nom,"onUpdate:modelValue":a[0]||(a[0]=w=>o.value.nom=w),type:"text",required:"",error:h.value.nom},null,8,["modelValue","error"]),D(ce,{label:"Téléphone",icon:"fa-phone",modelValue:o.value.telephone,"onUpdate:modelValue":a[1]||(a[1]=w=>o.value.telephone=w),type:"tel",required:"",error:h.value.telephone},null,8,["modelValue","error"]),D(ce,{label:"Email (optionnel)",icon:"fa-envelope",modelValue:o.value.email,"onUpdate:modelValue":a[2]||(a[2]=w=>o.value.email=w),type:"email",error:h.value.email},null,8,["modelValue","error"]),D(ce,{label:"Ville",icon:"fa-city",modelValue:o.value.ville,"onUpdate:modelValue":a[3]||(a[3]=w=>o.value.ville=w),type:"text",required:"",error:h.value.ville},null,8,["modelValue","error"]),D(ce,{label:"Mot de passe",icon:"fa-lock",modelValue:o.value.mot_de_passe,"onUpdate:modelValue":a[4]||(a[4]=w=>o.value.mot_de_passe=w),type:"password",required:"",error:h.value.mot_de_passe},null,8,["modelValue","error"]),D(ce,{label:"Code de parrainage (optionnel)",icon:"fa-users",modelValue:o.value.parrain_code,"onUpdate:modelValue":a[5]||(a[5]=w=>o.value.parrain_code=w),type:"text",error:h.value.parrain_code},null,8,["modelValue","error"]),a[6]||(a[6]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-user-plus mr-2"}),C(" S'inscrire ")],-1))],32),e("p",cs,[a[8]||(a[8]=C(" Vous avez déjà un compte ? ")),D(x,{to:"/login",class:"text-[var(--espace-vert)] font-medium hover:underline"},{default:K(()=>a[7]||(a[7]=[C(" Connectez-vous ici ")])),_:1,__:[7]})]),a[11]||(a[11]=e("p",{class:"text-center text-xs text-gray-400 mt-2 pb-4"},[C(" En vous inscrivant, vous acceptez nos "),e("a",{href:"/conditions",class:"hover:underline text-[var(--espace-vert)]"},"conditions d'utilisation"),C(" et notre "),e("a",{href:"/confidentialite",class:"hover:underline text-[var(--espace-vert)]"},"politique de confidentialité"),C(". ")],-1))])])}}}),pu=ee(ds,[["__scopeId","data-v-d079a63c"]]),ps={key:0,class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-4"},vs={class:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-y-auto animate-fade-in max-h-[90vh]"},ms={class:"p-6"},fs={key:0,class:"grid md:grid-cols-3 gap-6"},gs={key:1,class:"flex flex-col md:flex-row max-w-3xl mx-auto p-8 bg-white rounded-xl shadow-lg"},xs={class:"md:w-1/3 mb-6 md:mb-0 pr-6 border-r border-gray-200"},bs={class:"font-extrabold text-lg mb-2"},hs={class:"mb-2 text-sm opacity-90"},ys={class:"text-3xl font-extrabold"},_s={class:"flex flex-col text-sm font-medium text-gray-700"},ws={key:0,class:"text-xs text-red-600 mt-1"},ks={class:"flex gap-4"},$s=["value"],Cs=["src"],As={key:0,class:"text-xs text-red-600 mt-1 block"},Ps=["disabled"],Ss={class:"text-xs text-gray-400 mt-4 text-center"},js=Y({__name:"SubscriptionModal",props:{isOpen:{type:Boolean}},emits:["close","upgraded"],setup(z,{emit:o}){const h=o,f=se(),t=g(""),c=g(""),n=g(""),v=g(!1),u=g(!1),a=g(!1),x=b=>{t.value=b,v.value=!1,u.value=!1,c.value="",n.value=""},w=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],P=async()=>{if(v.value=!n.value,u.value=!c.value,v.value||u.value){f.error("Veuillez remplir tous les champs correctement.");return}a.value=!0;try{console.log({subscription_type:t.value,payment_service:c.value,phone_number:n.value});const b=await F.post("/upgrade-to-premium",{subscription_type:t.value,payment_service:c.value,phone_number:n.value});a.value=!1,f.success(b.data.message),h("upgraded"),h("close")}catch(b){b.response&&b.response.data?(b.response.data,f.error("Paiement échoué :Verifiez vos informations et réessayer")):f.error("Verifiez vos informations et réessayer."),console.error(b)}finally{a.value=!1}};return(b,l)=>b.isOpen?(s(),r("div",ps,[e("div",vs,[l[17]||(l[17]=e("div",{class:"bg-gradient-to-r from-[var(--espace-vert)] to-[var(--espace-or)] p-6 text-center"},[e("h2",{class:"text-3xl font-bold text-white"},"🚀 Passez à Premium"),e("p",{class:"text-white/90 mt-1"}," Comparez et choisissez le plan qui boostera votre business ")],-1)),e("div",ms,[t.value?(s(),r("div",gs,[e("div",xs,[l[11]||(l[11]=e("h3",{class:"text-xl font-bold mb-4"},"Votre abonnement",-1)),e("div",{class:H([{"bg-green-600 text-white":t.value==="monthly","bg-yellow-400 text-gray-900":t.value==="yearly"},"rounded-lg p-4"])},[e("h4",bs,m(t.value==="monthly"?"Premium Mensuel":"Premium Annuel"),1),e("p",hs,m(t.value==="monthly"?"Accès complet à toutes les fonctionnalités.":"Payez moins, profitez plus avec 16% d’économie !"),1),e("div",ys,m(t.value==="monthly"?"5 000 FCFA":"50 000 FCFA"),1)],2)]),e("form",{onSubmit:oe(P,["prevent"]),class:"md:w-2/3 flex flex-col gap-6",novalidate:""},[l[15]||(l[15]=e("h3",{class:"text-xl font-bold mb-2"},"Détails du paiement",-1)),e("label",_s,[l[12]||(l[12]=C(" Numéro de téléphone ")),N(e("input",{"onUpdate:modelValue":l[4]||(l[4]=y=>n.value=y),type:"tel",placeholder:"Ex: 696428651",class:H(["mt-1 rounded-lg border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",{"border-red-500":v.value}]),onInput:l[5]||(l[5]=y=>v.value=!n.value),required:""},null,34),[[B,n.value]]),v.value?(s(),r("span",ws,"Veuillez entrer un numéro valide.")):A("",!0)]),l[16]||(l[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Service de paiement ",-1)),e("div",ks,[(s(),r(J,null,X(w,y=>e("label",{key:y.value,class:H(["flex items-center gap-2 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":c.value===y.value,"border-gray-300 bg-white":c.value!==y.value,"border-red-500":u.value&&!c.value}])},[N(e("input",{type:"radio",value:y.value,"onUpdate:modelValue":l[6]||(l[6]=$=>c.value=$),class:"hidden"},null,8,$s),[[Be,c.value]]),e("img",{src:y.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Cs),e("span",{class:H([{"text-[var(--espace-vert)]":c.value===y.value,"text-gray-700":c.value!==y.value},"font-semibold select-none"])},m(y.label),3)],2)),64))]),u.value&&!c.value?(s(),r("span",As," Veuillez sélectionner un service. ")):A("",!0),e("button",{type:"submit",disabled:a.value||!n.value||!c.value,class:"w-full py-3 rounded-lg bg-[var(--espace-vert)] text-white font-bold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[a.value?(s(),r(J,{key:0},[l[13]||(l[13]=e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1)),l[14]||(l[14]=C(" Veuillez patienter... "))],64)):(s(),r(J,{key:1},[C(" Payer & Souscrire ")],64))],8,Ps),e("button",{type:"button",onClick:l[7]||(l[7]=y=>t.value=""),class:"w-full text-center text-gray-500 hover:text-[var(--espace-vert)] transition"}," ← Retour aux plans "),e("p",Ss," 🔒 Paiement sécurisé via "+m(c.value||"votre service"),1)],32)])):(s(),r("div",fs,[l[10]||(l[10]=Me('<div class="border border-gray-200 bg-gray-50 rounded-xl p-6 flex flex-col justify-between" data-v-7e8d0671><div data-v-7e8d0671><h3 class="text-xl font-bold text-gray-800" data-v-7e8d0671>Gratuit (Base)</h3><p class="text-sm text-gray-500 mb-4" data-v-7e8d0671>Pour débuter sans frais</p><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 10 produits max </li><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 5 collaborations max </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Pas de statistiques détaillées </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Pas de badge Premium </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>❌</span> Position prioritaire </li></ul></div><button disabled class="mt-6 w-full py-2 rounded-lg bg-gray-300 text-gray-600 font-semibold cursor-not-allowed" data-v-7e8d0671> Actuel </button></div>',1)),e("div",{class:"relative bg-gradient-to-br from-[var(--espace-vert)] to-green-500 rounded-xl text-white p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 scale-103 transition cursor-pointer",onClick:l[1]||(l[1]=y=>x("monthly"))},[l[8]||(l[8]=Me('<span class="absolute top-1 right-3 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>⭐ Populaire</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Mensuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671> Accès complet à toutes les fonctionnalités </p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>5000 FCFA / mois </div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:l[0]||(l[0]=oe(y=>x("monthly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-vert)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")]),e("div",{class:"relative bg-gradient-to-br from-yellow-400 to-[var(--espace-or)] rounded-xl text-gray-900 p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 transition cursor-pointer",onClick:l[3]||(l[3]=y=>x("yearly"))},[l[9]||(l[9]=Me('<span class="absolute top-1 right-3 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>-16% Économie</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Annuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671>Payez moins, profitez plus</p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>50 000 FCFA / an</div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Produits illimités</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Collaborations illimitées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Statistiques détaillées</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Badge “Premium”</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>✔</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:l[2]||(l[2]=oe(y=>x("yearly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-or)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")])]))])])])):A("",!0)}}),Vs=ee(js,[["__scopeId","data-v-7e8d0671"]]),Ms={class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},zs={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 space-y-6 animate-fade-in max-h-[90vh] overflow-auto"},Es={class:"flex justify-center gap-3 mb-4"},Is=["onClick"],Ls={key:0,class:"text-xs text-red-600 mt-1"},Ts={class:"flex gap-4"},Fs=["value"],Rs=["src"],Ds={key:1,class:"text-xs text-red-600 mt-1"},Ns={class:"text-center text-lg font-bold mt-6"},Us={class:"text-[var(--espace-vert)]"},Os=["disabled"],qs={key:0},Js={key:1},Ws={key:2,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Hs={class:"w-full mt-2 text-center text-gray-500 hover:text-[var(--espace-vert)] transition"},Bs=Y({__name:"AchatJetonModal",props:{isOpen:{type:Boolean}},emits:["close","purchased"],setup(z,{emit:o}){const h=o,f=se(),t=g(10),c=g(""),n=g(""),v=g(t.value*25),u=g(!1),a=g(!1),x=g(!1),w=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],P=[10,20,50,100],b=be(()=>t.value>=10&&c.value.trim().length===9&&/^6\d{8}$/.test(c.value)&&n.value!==""),l=()=>{v.value=t.value*25},y=V=>{t.value=V,l()},$=()=>{l()},L=()=>{x.value=!(c.value.trim().length===9&&/^6\d{8}$/.test(c.value))},M=async()=>{if(a.value=!n.value,!b.value){f.error("Veuillez remplir tous les champs correctement.");return}u.value=!0;try{const V=await F.post("/acheter-jetons",{nombre_jetons:t.value,payment_service:n.value,phone_number:c.value});console.log(V.data),f.success(V.data.message),h("purchased",t.value),h("close")}catch(V){if(V.response&&V.response.data){const k=V.response.data;f.error(`Erreur: ${k.error_message||"Achat échoué"}. Détails: ${k.details||"Aucun détail."}`)}else f.error("Erreur lors de l'achat. Veuillez réessayer.");console.error(V)}finally{u.value=!1}};return ne(c,()=>{L()}),(V,k)=>{const U=pe("router-link");return s(),r("div",Ms,[e("div",zs,[k[7]||(k[7]=e("h2",{class:"text-3xl font-extrabold text-[var(--espace-vert)] text-center"}," 🎫 Acheter des Jetons ",-1)),k[8]||(k[8]=e("p",{class:"text-center text-gray-600 text-sm mb-6"},"1 jeton = 25 FCFA",-1)),e("div",Es,[(s(),r(J,null,X(P,O=>e("button",{key:O,type:"button",onClick:I=>y(O),class:H(["rounded-full px-4 py-2 border font-semibold transition",t.value===O?"bg-[var(--espace-vert)] text-white border-[var(--espace-vert)]":"bg-white text-gray-700 border-gray-300 hover:bg-[var(--espace-vert)] hover:text-white"])},m(O),11,Is)),64))]),k[9]||(k[9]=e("label",{class:"block text-gray-700 font-semibold mb-1",for:"jetonQuantity"},[C(" Nombre de jetons "),e("span",{class:"text-sm text-gray-500"},"(min 10)")],-1)),N(e("input",{id:"jetonQuantity","onUpdate:modelValue":k[0]||(k[0]=O=>t.value=O),type:"number",min:"10",placeholder:"Ex: 10",onInput:$,class:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition"},null,544),[[B,t.value,void 0,{number:!0}]]),k[10]||(k[10]=e("label",{class:"block text-gray-700 font-semibold mb-1 mt-4",for:"phoneNumber"},[C(" Numéro de téléphone "),e("span",{class:"text-sm text-red-500"},"*")],-1)),N(e("input",{id:"phoneNumber","onUpdate:modelValue":k[1]||(k[1]=O=>c.value=O),type:"tel",placeholder:"Ex: 696428651",onInput:L,class:H(["w-full rounded-lg border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",x.value?"border-red-500":"border-gray-300"])},null,34),[[B,c.value]]),x.value?(s(),r("p",Ls," Veuillez entrer un numéro valide (9 chiffres, commençant par 6). ")):A("",!0),k[11]||(k[11]=e("label",{class:"block text-gray-700 font-semibold mb-2 mt-4",for:"paymentService"}," Service de paiement ",-1)),e("div",Ts,[(s(),r(J,null,X(w,O=>e("label",{key:O.value,class:H(["flex items-center gap-3 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":n.value===O.value,"border-gray-300 bg-white":n.value!==O.value}])},[N(e("input",{type:"radio",value:O.value,"onUpdate:modelValue":k[2]||(k[2]=I=>n.value=I),class:"hidden"},null,8,Fs),[[Be,n.value]]),e("img",{src:O.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Rs),e("span",{class:H({"text-[var(--espace-vert)] font-bold":n.value===O.value,"text-gray-700":n.value!==O.value})},m(O.label),3)],2)),64))]),a.value&&!n.value?(s(),r("p",Ds," Veuillez sélectionner un service. ")):A("",!0),e("div",Ns,[k[4]||(k[4]=C(" Montant total : ")),e("span",Us,m(v.value)+" FCFA",1)]),e("button",{onClick:M,disabled:!b.value||u.value,class:"w-full mt-4 bg-[var(--espace-vert)] text-white py-3 rounded-lg font-semibold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-3"},[u.value?(s(),r("span",Js,"veuillez patientez")):(s(),r("span",qs,"Acheter")),u.value?(s(),r("svg",Ws,k[5]||(k[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))):A("",!0)],8,Os),e("button",Hs,[D(U,{to:"/jeton-history",onClick:k[3]||(k[3]=O=>h("close"))},{default:K(()=>k[6]||(k[6]=[C("Annuler")])),_:1,__:[6]})])])])}}}),Xs=ee(Bs,[["__scopeId","data-v-c7a0e7a2"]]),Gs={class:"space-y-6"},Ks={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},Qs={key:0,class:"space-y-2 text-[var(--espace-gris)]"},Zs={class:"flex gap-2"},Ys={key:0,class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},eo={key:0,class:"space-y-2 text-[var(--espace-gris)]"},to={key:0,class:"w-24 h-24"},so=["src"],oo={key:0,class:"mt-2 w-24 h-24"},ao=["src"],ro={class:"flex gap-2"},lo=Y({__name:"userProfile",props:{user:Object},setup(z){var w,P,b,l,y,$,L,M,V,k,U,O,I,te,W,d;const o=re(),h=se(),f=g(!1),t=g(o.user),c=g({nom:((w=t.value)==null?void 0:w.nom)||"",telephone:((P=t.value)==null?void 0:P.telephone)||"",email:((b=t.value)==null?void 0:b.email)||"",ville:((l=t.value)==null?void 0:l.ville)||""}),n=g(!1),v=g({nom:(($=(y=t.value)==null?void 0:y.commercant)==null?void 0:$.nom)||"",description:((M=(L=t.value)==null?void 0:L.commercant)==null?void 0:M.description)||"",email:((k=(V=t.value)==null?void 0:V.commercant)==null?void 0:k.email)||"",telephone:((O=(U=t.value)==null?void 0:U.commercant)==null?void 0:O.telephone)||"",ville:((te=(I=t.value)==null?void 0:I.commercant)==null?void 0:te.ville)||"",logo:null,logoPreview:(d=(W=t.value)==null?void 0:W.commercant)!=null&&d.logo?`http://localhost:8000/storage/${t.value.commercant.logo}`:null});console.log(` com ${JSON.stringify(v.value)}`);const u=i=>{var S;const p=(S=i.target.files)==null?void 0:S[0];if(p){if(!p.type.startsWith("image/")){h.error("Veuillez sélectionner une image.");return}if(p.size>2*1024*1024){h.error("Image trop volumineuse (max 2Mo).");return}v.value.logo=p,v.value.logoPreview=URL.createObjectURL(p)}},a=async()=>{var i;try{const p=await F.put("/profile",c.value);t.value&&(t.value.nom=p.data.user.nom||"",t.value.telephone=p.data.user.telephone||"",t.value.email=p.data.user.email||"",t.value.ville=p.data.user.ville||""),o.user=p.data.user,f.value=!1,h.success("Profil mis à jour avec succès.")}catch(p){h.error(((i=p.response)==null?void 0:i.data.message)||"Erreur lors de la mise à jour.")}},x=async()=>{var i,p,S;try{const E=new FormData;E.append("nom",v.value.nom),E.append("description",v.value.description),E.append("email",v.value.email),E.append("telephone",v.value.telephone),E.append("ville",v.value.ville),v.value.logo&&E.append("logo",v.value.logo);const R=await F.post("/commercant/update",E,{headers:{"Content-Type":"multipart/form-data"}});console.log(` com ${JSON.stringify(R.data)}`),(i=t.value)!=null&&i.commercant&&(t.value.commercant.nom=R.data.commercant.nom,t.value.commercant.description=R.data.commercant.description,t.value.commercant.email=R.data.commercant.email,t.value.commercant.telephone=R.data.commercant.telephone,t.value.commercant.ville=R.data.commercant.ville,t.value.commercant.logo=R.data.commercant.logo),o.user=t.value,v.value.logoPreview=R.data.commercant.logo?`http://localhost:8000/storage/${R.data.commercant.logo}`:null,n.value=!1,h.success("Commerce mis à jour avec succès.")}catch(E){h.error(((S=(p=E.response)==null?void 0:p.data)==null?void 0:S.message)||"Erreur lors de la mise à jour du commerce.")}};return ne(()=>o.user,i=>{var p,S,E,R,Q,q;t.value=i||null,c.value={nom:(i==null?void 0:i.nom)||"",telephone:(i==null?void 0:i.telephone)||"",email:(i==null?void 0:i.email)||"",ville:(i==null?void 0:i.ville)||""},v.value={nom:((p=i==null?void 0:i.commercant)==null?void 0:p.nom)||"",description:((S=i==null?void 0:i.commercant)==null?void 0:S.description)||"",email:((E=i==null?void 0:i.commercant)==null?void 0:E.email)||"",telephone:((R=i==null?void 0:i.commercant)==null?void 0:R.telephone)||"",ville:((Q=i==null?void 0:i.commercant)==null?void 0:Q.ville)||"",logo:null,logoPreview:(q=i==null?void 0:i.commercant)!=null&&q.logo?`http://localhost:8000/storage/${i.commercant.logo}`:null}},{immediate:!0}),(i,p)=>{var S,E,R,Q,q,T;return s(),r("div",Gs,[e("section",Ks,[p[23]||(p[23]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations personnelles",-1)),f.value?(s(),r("form",{key:1,onSubmit:oe(a,["prevent"]),class:"space-y-4"},[e("div",null,[p[18]||(p[18]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom"},"Nom",-1)),N(e("input",{"onUpdate:modelValue":p[1]||(p[1]=_=>c.value.nom=_),id:"nom",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre nom"},null,512),[[B,c.value.nom]])]),e("div",null,[p[19]||(p[19]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone"},"Téléphone",-1)),N(e("input",{"onUpdate:modelValue":p[2]||(p[2]=_=>c.value.telephone=_),id:"telephone",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre téléphone"},null,512),[[B,c.value.telephone]])]),e("div",null,[p[20]||(p[20]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email"},"Email",-1)),N(e("input",{"onUpdate:modelValue":p[3]||(p[3]=_=>c.value.email=_),id:"email",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre email (optionnel)"},null,512),[[B,c.value.email]])]),e("div",null,[p[21]||(p[21]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville"},"Ville",-1)),N(e("input",{"onUpdate:modelValue":p[4]||(p[4]=_=>c.value.ville=_),id:"ville",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre ville"},null,512),[[B,c.value.ville]])]),e("div",Zs,[p[22]||(p[22]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Enregistrer les modifications"}," Enregistrer ",-1)),e("button",{onClick:p[5]||(p[5]=_=>f.value=!1),class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Annuler"}," Annuler ")])],32)):(s(),r("div",Qs,[e("p",null,[p[13]||(p[13]=e("strong",null,"Nom :",-1)),C(" "+m((S=t.value)==null?void 0:S.nom),1)]),e("p",null,[p[14]||(p[14]=e("strong",null,"Téléphone :",-1)),C(" "+m((E=t.value)==null?void 0:E.telephone),1)]),e("p",null,[p[15]||(p[15]=e("strong",null,"Email :",-1)),C(" "+m(((R=t.value)==null?void 0:R.email)||"Non défini"),1)]),e("p",null,[p[16]||(p[16]=e("strong",null,"Ville :",-1)),C(" "+m((Q=t.value)==null?void 0:Q.ville),1)]),e("p",null,[p[17]||(p[17]=e("strong",null,"Statut Premium :",-1)),C(" "+m((q=t.value)!=null&&q.premium?"Actif":"Inactif"),1)]),e("button",{onClick:p[0]||(p[0]=_=>f.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Modifier le profil"}," Modifier ")]))]),(T=t.value)!=null&&T.commercant?(s(),r("section",Ys,[p[36]||(p[36]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations du Commerce",-1)),n.value?(s(),r("form",{key:1,onSubmit:oe(x,["prevent"]),class:"space-y-4"},[e("div",null,[p[29]||(p[29]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom_commerce"},"Nom du commerce",-1)),N(e("input",{"onUpdate:modelValue":p[7]||(p[7]=_=>v.value.nom=_),id:"nom_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerce"},null,512),[[B,v.value.nom]])]),e("div",null,[p[30]||(p[30]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"description_commerce"},"Description",-1)),N(e("textarea",{"onUpdate:modelValue":p[8]||(p[8]=_=>v.value.description=_),id:"description_commerce",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Description du commerce",rows:"3"},null,512),[[B,v.value.description]])]),e("div",null,[p[31]||(p[31]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email_commerce"},"Email",-1)),N(e("input",{"onUpdate:modelValue":p[9]||(p[9]=_=>v.value.email=_),id:"email_commerce",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Email du commerce (optionnel)"},null,512),[[B,v.value.email]])]),e("div",null,[p[32]||(p[32]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone_commerce"},"Téléphone",-1)),N(e("input",{"onUpdate:modelValue":p[10]||(p[10]=_=>v.value.telephone=_),id:"telephone_commerce",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Téléphone du commerce"},null,512),[[B,v.value.telephone]])]),e("div",null,[p[33]||(p[33]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville_commerce"},"Ville",-1)),N(e("input",{"onUpdate:modelValue":p[11]||(p[11]=_=>v.value.ville=_),id:"ville_commerce",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville du commerce"},null,512),[[B,v.value.ville]])]),e("div",null,[p[34]||(p[34]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"logo_commerce"},"Logo",-1)),e("input",{id:"logo_commerce",type:"file",accept:"image/*",onChange:u,class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},null,32),v.value.logoPreview?(s(),r("div",oo,[e("img",{src:v.value.logoPreview,alt:"Aperçu logo",class:"w-full h-full object-cover rounded-md shadow"},null,8,ao)])):A("",!0)]),e("div",ro,[p[35]||(p[35]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Enregistrer ",-1)),e("button",{onClick:p[12]||(p[12]=_=>n.value=!1),type:"button",class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Annuler ")])],32)):(s(),r("div",eo,[t.value.commercant.logo?(s(),r("div",to,[e("img",{src:`http://localhost:8000/storage/${t.value.commercant.logo}`,alt:"Logo du commerce",class:"w-full h-full object-cover rounded-md shadow"},null,8,so)])):A("",!0),e("p",null,[p[24]||(p[24]=e("strong",null,"Nom du commerce :",-1)),C(" "+m(t.value.commercant.nom),1)]),e("p",null,[p[25]||(p[25]=e("strong",null,"Description :",-1)),C(" "+m(t.value.commercant.description||"Non définie"),1)]),e("p",null,[p[26]||(p[26]=e("strong",null,"Email :",-1)),C(" "+m(t.value.commercant.email||"Non défini"),1)]),e("p",null,[p[27]||(p[27]=e("strong",null,"Téléphone :",-1)),C(" "+m(t.value.commercant.telephone),1)]),e("p",null,[p[28]||(p[28]=e("strong",null,"Ville :",-1)),C(" "+m(t.value.commercant.ville),1)]),e("button",{onClick:p[6]||(p[6]=_=>n.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Modifier ")]))])):A("",!0),p[37]||(p[37]=e("section",{class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},[e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Mon Parrainage")],-1))])}}}),no=ee(lo,[["__scopeId","data-v-aaaa75a7"]]),io=Y({__name:"MerchantProfile",props:{user:Object},setup(z){const o=se(),h=g(null),f=g([]);return le(async()=>{try{const t=await F.get("/commercant/profil");h.value=t.data.commercant,f.value=t.data.produits||[]}catch(t){o.error("Erreur lors du chargement des données du commerçant: "+(t.message||t))}}),(t,c)=>null}}),uo=ee(io,[["__scopeId","data-v-ce205108"]]),co={class:"overflow-y-scroll min-h-screen relative bg-gray-100 py-8 sm:px-6"},po={class:"flex flex-col sm:flex-row items-center justify-between mb-8 gap-4"},vo={class:"flex items-center space-x-4 relative w-full gap-1 px-3"},mo={class:"relative"},fo=["src"],go={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-lg p-1 rounded-full",style:{}},xo={key:3,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-36 bg-white border rounded-md shadow z-10"},bo={class:"space-y-1"},ho={key:0,class:"text-sm text-gray-500"},yo={key:0,class:"ml-4 flex items-center gap-2"},_o=["src"],wo=["disabled"],ko={class:"flex flex-col sm:flex-row gap-2 items-center"},$o={class:"container mx-auto max-w-4xl"},Co={key:2,class:"fixed inset-0 bg-black bg-opacity-0 flex items-center justify-center z-50"},Ao={class:"bg-white rounded-lg p-4 relative w-full max-w-md"},Po=Y({__name:"Profile",setup(z){const o=ue(),h=se(),f=re(),t=g(f.user);console.log(t==null?void 0:t.value);const c=g(!1),n=g(!1),v=g(null),u=g(null),a=g(!1),x=g(!1),w=g(!1),P=be(()=>x.value?uo:no),b=g(null),l=g(null),y=g(!1);let $=null;const L=()=>{var d;(d=b.value)==null||d.click(),c.value=!1},M=d=>{const i=d.target;if(i.files&&i.files[0]){const p=i.files[0];if(!p.type.startsWith("image/")){h.error("Veuillez sélectionner une image.");return}if(p.size>2*1024*1024){h.error("Image trop volumineuse (max 2Mo).");return}u.value=p,v.value=URL.createObjectURL(p)}},V=async()=>{try{$=await navigator.mediaDevices.getUserMedia({video:!0}),y.value=!0,c.value=!1,setTimeout(()=>{l.value&&(l.value.srcObject=$)},100)}catch(d){h.error("Impossible d'accéder à la caméra."),console.error(d)}},k=()=>{if(!l.value)return;const d=l.value,i=document.createElement("canvas");i.width=d.videoWidth,i.height=d.videoHeight;const p=i.getContext("2d");p&&(p.drawImage(d,0,0,i.width,i.height),i.toBlob(S=>{S&&(u.value=new File([S],"photo.jpg",{type:"image/jpeg"}),v.value=URL.createObjectURL(u.value),U())},"image/jpeg"))},U=()=>{$&&($.getTracks().forEach(d=>d.stop()),$=null),y.value=!1},O=()=>{u.value=null,v.value=null},I=async()=>{var d,i;if(u.value){n.value=!0;try{const p=new FormData;p.append("photo",u.value);const S=await F.post("/profile/photo",p,{headers:{"Content-Type":"multipart/form-data"}});S.data.photo&&(t.value&&(t.value.photo=S.data.photo,f.user=t.value),h.success("Photo mise à jour."),O())}catch(p){h.error(((i=(d=p.response)==null?void 0:d.data)==null?void 0:i.message)||"Erreur lors de l'envoi.")}finally{n.value=!1}}},te=async()=>{a.value=!1},W=d=>{h.success(`Vous avez acheté ${d} jetons !`)};return ne(()=>f.user,d=>{t.value=d||null},{immediate:!0}),le(()=>{}),we(()=>{v.value&&URL.revokeObjectURL(v.value),$&&$.getTracks().forEach(d=>d.stop())}),(d,i)=>{var p,S,E,R,Q,q,T,_,Z,G,ae,fe,ve,ge,xe,$e,Ce,Ae,Pe,Se,je;return s(),r("div",co,[e("div",po,[e("div",vo,[e("div",mo,[(p=t.value)!=null&&p.photo?(s(),r("img",{key:0,src:`http://localhost:8000/storage/${(S=t.value)==null?void 0:S.photo}`,alt:"Photo de profil",class:"w-16 h-16 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,fo)):(s(),r("div",{key:1,class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:de({background:`${((q=(Q=(R=(E=t.value)==null?void 0:E.niveaux_users)==null?void 0:R.at(-1))==null?void 0:Q.parrainage_niveau)==null?void 0:q.couleur)||"#0af"}`})},i[6]||(i[6]=[e("i",{class:"fas fa-user-circle text-4xl"},null,-1)]),4)),(T=t.value)!=null&&T.premium?(s(),r("i",go)):A("",!0),e("button",{onClick:i[0]||(i[0]=he=>c.value=!c.value),class:"absolute bottom-0 right-0 w-6 h-6 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full flex items-center justify-center hover:bg-[var(--espace-vert)] hover:text-white",style:{}},i[7]||(i[7]=[e("i",{class:"fas fa-pencil-alt text-xs"},null,-1)])),c.value?(s(),r("div",xo,[e("button",{onClick:V,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Caméra "),e("button",{onClick:L,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Galerie ")])):A("",!0)]),e("input",{ref_key:"galleryInput",ref:b,type:"file",accept:"image/*",class:"hidden",onChange:M},null,544),e("div",bo,[e("h1",{class:"text-2xl sm:text-3xl font-bold flex items-center gap-2 text-blue-500",style:de({color:`${((ae=(G=(Z=(_=t.value)==null?void 0:_.niveaux_users)==null?void 0:Z.at(-1))==null?void 0:G.parrainage_niveau)==null?void 0:ae.couleur)||"#0af"}`})},[C(m((fe=t.value)==null?void 0:fe.nom)+" ",1),(ve=t.value)!=null&&ve.premium?(s(),r("span",{key:0,class:"text-black text-xs px-3 py-1 rounded-full uppercase font-bold",style:de({background:`${((Ce=($e=(xe=(ge=t.value)==null?void 0:ge.niveaux_users)==null?void 0:xe.at(-1))==null?void 0:$e.parrainage_niveau)==null?void 0:Ce.couleur)||"#0af"}`})}," Premium ",4)):A("",!0)],4),(Ae=t.value)!=null&&Ae.subscription_ends_at?(s(),r("span",ho," Jusqu'au "+m(new Date((Pe=t.value)==null?void 0:Pe.subscription_ends_at).toLocaleDateString()),1)):A("",!0)]),v.value?(s(),r("div",yo,[e("img",{src:v.value,alt:"Preview",class:"w-12 h-12 rounded-full object-cover"},null,8,_o),e("button",{onClick:I,disabled:n.value,class:H(["bg-[var(--espace-vert)] text-white px-3 py-1 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]",{"opacity-50 cursor-not-allowed":n.value}])},m(n.value?"Upload...":"Confirmer"),11,wo),e("button",{onClick:O,class:"text-red-500 hover:text-red-700"}," Annuler ")])):A("",!0)]),e("div",ko,[(Se=t.value)!=null&&Se.commercant?(s(),r("button",{key:0,onClick:i[1]||(i[1]=he=>x.value=!x.value),class:"text-[var(--espace-or)] hover:text-[var(--espace-vert)] font-medium flex items-center gap-1"},i[8]||(i[8]=[e("i",{class:"fas fa-store"},null,-1),C(" Compte Commerçant ")]))):(s(),r("button",{key:1,onClick:i[2]||(i[2]=he=>j(o).push("/commercant/create")),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-vert)] hover:text-white"}," Devenir commerçant ")),(je=t.value)!=null&&je.premium?A("",!0):(s(),r("button",{key:2,onClick:i[3]||(i[3]=he=>a.value=!0),class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"}," Passer Premium "))])]),e("div",$o,[(s(),ie(Ze(P.value)))]),a.value?(s(),ie(Vs,{key:0,"is-open":a.value,onClose:i[4]||(i[4]=he=>a.value=!1),onUpgraded:te},null,8,["is-open"])):A("",!0),w.value?(s(),ie(Xs,{key:1,"is-open":w.value,onClose:i[5]||(i[5]=he=>w.value=!1),onPurchased:W},null,8,["is-open"])):A("",!0),y.value?(s(),r("div",Co,[e("div",Ao,[e("video",{ref_key:"videoRef",ref:l,autoplay:"",playsinline:"",class:"rounded w-full"},null,512),e("div",{class:"mt-2 flex justify-between"},[e("button",{onClick:k,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Capturer "),e("button",{onClick:U,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Annuler ")])])])):A("",!0)])}}}),vu=ee(Po,[["__scopeId","data-v-8f61c657"]]),So={class:"min-h-screen bg-gray-100 pt-16 pb-20 px-4 sm:px-6 flex flex-col lg:flex-row gap-4"},jo={class:"hidden lg:block w-full max-w-xs bg-[var(--espace-blanc)] rounded-lg shadow-md p-4"},Vo={class:"space-y-2"},Mo=["onClick"],zo={class:"font-poppins"},Eo={class:"flex-1 bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Io={class:"lg:hidden mb-4"},Lo={class:"flex overflow-x-auto space-x-2 border-b border-[var(--espace-gris)]"},To=["onClick"],Fo={key:0,class:"space-y-6"},Ro={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Do={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},No={class:"flex items-center gap-4 mb-4"},Uo=["src"],Oo={class:"text-[var(--espace-vert)] font-semibold"},qo={class:"text-sm text-[var(--espace-gris)]"},Jo={class:"text-sm text-[var(--espace-gris)]"},Wo={class:"text-sm text-[var(--espace-gris)]"},Ho={key:0,class:"space-y-6"},Bo={key:0,class:"space-y-6"},Xo={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Go={class:"text-base font-medium font-poppins"},Ko={class:"text-sm text-[var(--espace-gris)]"},Qo=Y({__name:"Parametres",setup(z){const o=g(!1),h=re(),f=ue(),t=se(),c=h.user,n=g("profile"),v=g({id:(c==null?void 0:c.id)??0,nom:(c==null?void 0:c.nom)??"",email:(c==null?void 0:c.email)??"",telephone:(c==null?void 0:c.telephone)??"",ville:(c==null?void 0:c.ville)??""});h.user={...h.user,...v.value};const u=g({current_password:"",new_password:"",confirm_password:""});g({});const a=g(""),x=be(()=>[...c!=null&&c.commercant?[{to:"/commercant",label:"Espace Commerçant",icon:"fa-store-alt",description:"Gérez votre boutique et vos produits"}]:[],{to:"/parrainage",label:"Parrainage",icon:"fa-users",description:"Invitez des amis et gagnez des récompenses"},{to:"/abonnements",label:"Abonnements",icon:"fa-star",description:"Gérez vos abonnements premium"},{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",description:"Gérez vos collaborations sur des produits"}]),w=async()=>{var y,$;o.value=!0;try{await F.put("/user/profile",v.value),localStorage.setItem("user",JSON.stringify(h.user)),t.success("Profil mis à jour avec succès",{timeout:3e3})}catch(L){t.error((($=(y=L.response)==null?void 0:y.data)==null?void 0:$.message)||"Erreur lors de la mise à jour du profil")}finally{o.value=!1}},P=async()=>{var y,$;o.value=!0;try{if(u.value.new_password!==u.value.confirm_password){t.error("Les mots de passe ne correspondent pas");return}if(a.value==="weak"){t.error("Le mot de passe est trop faible. Utilisez au moins 8 caractères avec des lettres, chiffres et symboles.");return}await F.put("/user/password",u.value),t.success("Mot de passe mis à jour avec succès",{timeout:3e3}),u.value={current_password:"",new_password:"",confirm_password:""},a.value=""}catch(L){t.error((($=(y=L.response)==null?void 0:y.data)==null?void 0:$.message)||"Erreur lors de la mise à jour du mot de passe")}finally{o.value=!1}},b=()=>{h.logout(),f.push({name:"login"})},l=()=>{const y=u.value.new_password;y.length===0?a.value="":y.length<8||!/[A-Za-z]/.test(y)||!/[0-9]/.test(y)?a.value="weak":/[!@#$%^&*]/.test(y)?a.value="strong":a.value="medium"};return ne(()=>u.value.new_password,l),(y,$)=>{const L=pe("RouterLink");return s(),r(J,null,[D(ke,{isLoading:o.value},null,8,["isLoading"]),e("div",So,[e("aside",jo,[$[7]||($[7]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4 font-poppins"},"Paramètres",-1)),e("nav",Vo,[(s(),r(J,null,X([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres options",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],M=>e("button",{key:M.id,onClick:V=>M.id==="logout"?b():n.value=M.id,class:H(["w-full flex items-center gap-3 p-3 rounded-lg transition-colors duration-300",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":n.value===M.id,"text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":n.value!==M.id}])},[e("i",{class:H(["fas",M.icon])},null,2),e("span",zo,m(M.label),1)],10,Mo)),64))])]),e("main",Eo,[e("div",Io,[e("div",Lo,[(s(),r(J,null,X([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"Sécurité",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres",icon:"fa-cog"},{id:"logout",label:"Déconnexion",icon:"fa-sign-out-alt"}],M=>e("button",{key:M.id,onClick:V=>M.id==="logout"?b():n.value=M.id,class:H(["flex items-center gap-2 px-4 py-2 text-sm font-medium font-poppins transition-colors duration-300",{"border-b-2 border-[var(--espace-or)] text-[var(--espace-vert)]":n.value===M.id,"text-[var(--espace-gris)] hover:text-[var(--espace-vert)]":n.value!==M.id}])},[e("i",{class:H(["fas",M.icon])},null,2),C(" "+m(M.label),1)],10,To)),64))])]),D(me,{name:"slide"},{default:K(()=>{var M,V;return[n.value==="profile"?(s(),r("section",Fo,[$[10]||($[10]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Profil",-1)),e("div",Ro,[e("form",{onSubmit:oe(w,["prevent"]),class:"space-y-4"},[D(ce,{label:"Nom",icon:"fa-user",modelValue:v.value.nom,"onUpdate:modelValue":$[0]||($[0]=k=>v.value.nom=k),type:"text",required:"",placeholder:"Votre nom"},null,8,["modelValue"]),D(ce,{label:"Email",icon:"fa-envelope",modelValue:v.value.email,"onUpdate:modelValue":$[1]||($[1]=k=>v.value.email=k),type:"email",placeholder:"Votre email"},null,8,["modelValue"]),D(ce,{label:"Téléphone",icon:"fa-phone",modelValue:v.value.telephone,"onUpdate:modelValue":$[2]||($[2]=k=>v.value.telephone=k),type:"tel",required:"",placeholder:"Votre numéro de téléphone"},null,8,["modelValue"]),D(ce,{label:"Ville",icon:"fa-city",modelValue:v.value.ville,"onUpdate:modelValue":$[3]||($[3]=k=>v.value.ville=k),type:"text",required:"",placeholder:"Votre ville"},null,8,["modelValue"]),$[8]||($[8]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Mettre à jour ",-1))],32),e("div",Do,[$[9]||($[9]=e("h3",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2 font-poppins"},"Aperçu",-1)),e("div",No,[e("img",{src:((V=(M=j(c))==null?void 0:M.commercant)==null?void 0:V.logo)||"https://via.placeholder.com/50",alt:"Photo de profil",class:"w-12 h-12 rounded-full object-cover"},null,8,Uo),e("div",null,[e("p",Oo,m(v.value.nom||"Nonni"),1),e("p",qo,m(v.value.email||"Non défini"),1)])]),e("p",Jo,"Téléphone: "+m(v.value.telephone||"Nonni"),1),e("p",Wo,"Ville: "+m(v.value.ville||"Non défini"),1)])])])):A("",!0)]}),_:1}),D(me,{name:"slide"},{default:K(()=>[n.value==="security"?(s(),r("section",Ho,[$[12]||($[12]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Sécurité",-1)),e("form",{onSubmit:oe(P,["prevent"]),class:"space-y-4"},[D(ce,{label:"Mot de passe actuel",icon:"fa-lock",modelValue:u.value.current_password,"onUpdate:modelValue":$[4]||($[4]=M=>u.value.current_password=M),type:"password",required:"",placeholder:"Mot de passe actuel"},null,8,["modelValue"]),D(ce,{label:"Nouveau mot de passe",icon:"fa-lock",modelValue:u.value.new_password,"onUpdate:modelValue":$[5]||($[5]=M=>u.value.new_password=M),type:"password",required:"",placeholder:"Nouveau mot de passe",onInput:l},null,8,["modelValue"]),a.value?(s(),r("div",{key:0,class:H(["text-sm",{"text-red-500":a.value==="weak","text-yellow-500":a.value==="medium","text-green-500":a.value==="strong"}])}," Force du mot de passe : "+m(a.value==="weak"?"Faible":a.value==="medium"?"Moyen":"Fort"),3)):A("",!0),D(ce,{label:"Confirmer le nouveau mot de passe",icon:"fa-lock",modelValue:u.value.confirm_password,"onUpdate:modelValue":$[6]||($[6]=M=>u.value.confirm_password=M),type:"password",required:"",placeholder:"Confirmer le mot de passe"},null,8,["modelValue"]),$[11]||($[11]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Changer le mot de passe ",-1))],32)])):A("",!0)]),_:1}),D(me,{name:"slide"},{default:K(()=>[n.value==="links"?(s(),r("section",Bo,[$[13]||($[13]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Autres options",-1)),e("div",Xo,[(s(!0),r(J,null,X(x.value,M=>(s(),ie(L,{key:M.to,to:M.to,class:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"},{default:K(()=>[e("i",{class:H(["fas",M.icon])},null,2),e("div",null,[e("h3",Go,m(M.label),1),e("p",Ko,m(M.description),1)])]),_:2},1032,["to"]))),128))])])):A("",!0)]),_:1})])])],64)}}}),mu=ee(Qo,[["__scopeId","data-v-34fd2bf9"]]),Zo={class:"bg-[var(--espace-blanc)] border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200"},Yo={class:"relative w-full h-32 overflow-hidden rounded-lg mb-2"},ea=["src","alt"],ta={key:0,class:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex space-x-1"},sa={key:0,class:"absolute top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},oa={key:1,class:"absolute top-2 right-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},aa={class:"text-sm font-semibold text-[var(--espace-vert)] font-poppins truncate"},ra={class:"text-xs text-[var(--espace-gris)] truncate"},la={class:"text-sm font-medium text-[var(--espace-or)]"},na={class:"flex items-center justify-between mt-2 text-xs text-[var(--espace-gris)]"},ia={class:"flex items-center gap-1"},ua={class:"flex items-center gap-1"},ca=["aria-label"],da=Y({__name:"ProductCard",props:{produit:{}},emits:["toggle-favorite","handleToggleFavorite"],setup(z,{emit:o}){const h=z,f=o,t=se(),c=Ee(),n=a=>{if(a==null||isNaN(a)||a===0)return"0";const x=Math.abs(a);return x<1e3?a.toString():x<1e4?(a/1e3).toFixed(1).replace(/\.0$/,"")+"k":x<1e6?Math.floor(a/1e3)+"k":x<1e9?(a/1e6).toFixed(1).replace(/\.0$/,"")+"M":(a/1e9).toFixed(1).replace(/\.0$/,"")+"B"},v=g(0),u=async()=>{var a,x;try{await c.toggleFavorite(h.produit.id),f("toggle-favorite",h.produit.id)}catch(w){t.error(((x=(a=w.response)==null?void 0:a.data)==null?void 0:x.message)||"Erreur lors de la mise à jour des favoris.")}};return(a,x)=>{var P,b;const w=pe("router-link");return s(),r("div",Zo,[D(w,{to:`/produits/${a.produit.id}`,class:"block relative"},{default:K(()=>[e("div",Yo,[e("div",{class:"flex w-full h-full slider-container",style:de({transform:`translateX(-${v.value*100}%)`})},[(s(!0),r(J,null,X(a.produit.photos||[a.produit.photo_url||"https://via.placeholder.com/150"],(l,y)=>(s(),r("img",{key:y,src:l,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${a.produit.nom} - ${y+1}`},null,8,ea))),128))],4),a.produit.photos&&a.produit.photos.length>1?(s(),r("div",ta,[(s(!0),r(J,null,X(a.produit.photos,(l,y)=>(s(),r("span",{key:y,class:H(["w-1.5 h-1.5 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":y===v.value}])},null,2))),128))])):A("",!0)]),a.produit.collaboratif?(s(),r("span",sa," Collaboratif ")):A("",!0),a.produit.boosted_until&&new Date(a.produit.boosted_until)>new Date?(s(),r("span",oa," Boosté ")):A("",!0),e("h3",aa,m(a.produit.nom),1),e("p",ra,m(a.produit.description||"Aucune description"),1),e("p",la,m(a.produit.prix)+" XAF",1)]),_:1},8,["to"]),e("div",na,[e("div",ia,[x[0]||(x[0]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,m(n((P=a.produit.counts)==null?void 0:P.views_count)),1)]),e("div",ua,[e("button",{onClick:u,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] transition active:scale-95 focus:outline-none","aria-label":a.produit.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:H(["fas fa-bookmark text-sm",{"text-[var(--espace-or)]":a.produit.is_favorited_by}])},null,2)],8,ca),e("span",null,m(n((b=a.produit.counts)==null?void 0:b.favorites_count)),1)])])])}}}),Le=ee(da,[["__scopeId","data-v-03efe6d5"]]),pa={class:"pt-4 bg-[var(--espace-blanc)] max-h-full relative"},va={class:"relative overflow-y-scroll mx-auto px-4 sm:px-6 py-4 max-h-full"},ma={class:"fixed flex items-center overflow-x-auto space-x-2 mb-3 snap-x snap-mandatory z-5"},fa=["onClick","aria-label","aria-current"],ga={class:"fixed right-10 z-5 flex justify-end items-center mb-3"},xa=["aria-label","aria-expanded"],ba={key:0,class:"absolute -top-1 -right-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] text-[10px] rounded-full h-5 w-5 flex items-center justify-center"},ha={key:0,class:"bg-[var(--espace-blanc)] rounded-xl shadow-md p-4 mb-4 fixed top-0 left-0 right-0 z-50 sm:static sm:flex sm:items-center sm:gap-3 sm:flex-wrap"},ya={class:"flex-1 min-w-[120px]"},_a={class:"flex-1 min-w-[120px]"},wa=["value"],ka={class:"flex-1 min-w-[100px]"},$a={class:"flex-1 min-w-[100px]"},Ca={class:"flex-1 min-w-[120px]"},Aa=["value"],Pa={class:"flex-1 min-w-[100px]"},Sa=["aria-busy"],ja={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},Va=Y({__name:"Home",setup(z){const o=Ee(),h=re(),f=g([]),t=se(),c=g(!1),n=g({search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""}),v=g(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),u=g(null),a=g(null),x=async()=>{try{const M=await F.get("/categories");f.value=M.data.categories}catch(M){console.error("Erreur lors du chargement des catégories:",M),t.error("Erreur lors du chargement des catégories.")}},w=()=>{if(n.value.prix_min&&n.value.prix_max&&parseFloat(n.value.prix_min)>parseFloat(n.value.prix_max)){t.error("Le prix minimum doit être inférieur au prix maximum.");return}o.fetchProducts(n.value,!0),c.value=!1},P=()=>{n.value={search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""},o.fetchProducts({},!0)},b=M=>{o.setSort(M)},l=()=>Object.values(n.value).filter(M=>M!=="").length,y=M=>{L(M)},$=M=>{L(M)},L=async M=>{var I,te,W;const V=(I=h.user)==null?void 0:I.id,k=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),U=new Date().toISOString().split("T")[0],O=localStorage.getItem("lastResetDate");if((!O||O!==U)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",U)),!await k[M])try{setTimeout(async()=>{const d=await F.post("/record_view",{product_id:M,user_id:V??null});console.log(d.data),t.success(d.data.message)},1e3),k[M]=!0,localStorage.setItem("viewedProducts",JSON.stringify(k))}catch(d){console.error("Erreur lors de l'enregistrement de la vue:",d),t.error(((W=(te=d.response)==null?void 0:te.data)==null?void 0:W.message)||"Erreur lors de l'enregistrement de la vue.")}};return le(async()=>{try{await o.fetchProducts(),await x()}catch(M){console.error("Erreur lors du chargement des produits ou catégories:",M),t.error("Erreur lors du chargement des produits. Veuillez réessayer.")}u.value=new IntersectionObserver(M=>{M[0].isIntersecting&&!o.isLoading&&o.hasMore&&o.fetchProducts(n.value)},{threshold:.1}),a.value&&u.value.observe(a.value)}),we(()=>{u.value&&a.value&&u.value.unobserve(a.value)}),(M,V)=>(s(),r("div",pa,[D(ke,{isLoading:j(o).isLoading},null,8,["isLoading"]),e("div",va,[e("div",ma,[(s(),r(J,null,X([{id:"popular",label:"Populaire",icon:"fa-fire"},{id:"favorites",label:"Favoris",icon:"fa-heart"}],k=>e("button",{key:k.id,onClick:U=>b(k.id),class:H(["flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium font-poppins snap-center shrink-0 transition-all duration-200",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":j(o).sort===k.id,"bg-gray-100 text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":j(o).sort!==k.id}]),"aria-label":`Trier par ${k.label}`,"aria-current":j(o).sort===k.id?"true":void 0},[e("i",{class:H(["fas",k.icon])},null,2),C(" "+m(k.label),1)],10,fa)),64))]),e("div",ga,[e("button",{onClick:V[0]||(V[0]=k=>c.value=!c.value),class:"relative flex items-center justify-center w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition active:scale-95","aria-label":c.value?"Masquer les filtres":"Afficher les filtres","aria-expanded":c.value},[V[7]||(V[7]=e("i",{class:"fas fa-filter text-sm"},null,-1)),l()>0?(s(),r("span",ba,m(l()),1)):A("",!0)],8,xa)]),D(me,{name:"slide-up"},{default:K(()=>[c.value?(s(),r("div",ha,[e("form",{onSubmit:oe(w,["prevent"]),class:"grid grid-cols-2 gap-3 sm:flex sm:flex-row sm:gap-3"},[e("div",ya,[N(e("input",{"onUpdate:modelValue":V[1]||(V[1]=k=>n.value.search=k),id:"search",type:"text",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Rechercher...","aria-label":"Rechercher un produit"},null,512),[[B,n.value.search]])]),e("div",_a,[N(e("select",{"onUpdate:modelValue":V[2]||(V[2]=k=>n.value.category=k),id:"category",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[V[8]||(V[8]=e("option",{value:""},"Toutes les Catégories",-1)),(s(!0),r(J,null,X(f.value,k=>(s(),r("option",{key:k.id,value:k.id},m(k.nom),9,wa))),128))],512),[[ye,n.value.category]])]),e("div",ka,[N(e("input",{"onUpdate:modelValue":V[3]||(V[3]=k=>n.value.prix_min=k),id:"prix_min",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix min","aria-label":"Prix minimum"},null,512),[[B,n.value.prix_min]])]),e("div",$a,[N(e("input",{"onUpdate:modelValue":V[4]||(V[4]=k=>n.value.prix_max=k),id:"prix_max",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix max","aria-label":"Prix maximum"},null,512),[[B,n.value.prix_max]])]),e("div",Ca,[N(e("select",{"onUpdate:modelValue":V[5]||(V[5]=k=>n.value.ville=k),id:"ville",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[V[9]||(V[9]=e("option",{value:""},"Tous les villes",-1)),(s(!0),r(J,null,X(v.value,k=>(s(),r("option",{key:k,value:k},m(k),9,Aa))),128))],512),[[ye,n.value.ville]])]),e("div",Pa,[N(e("select",{"onUpdate:modelValue":V[6]||(V[6]=k=>n.value.collaboratif=k),id:"collaboratif",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},V[10]||(V[10]=[e("option",{value:""},"Collaboratif",-1),e("option",{value:"true"},"Oui",-1),e("option",{value:"false"},"Non",-1)]),512),[[ye,n.value.collaboratif]])]),e("div",{class:"flex gap-2 col-span-2 sm:col-span-1"},[V[12]||(V[12]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Appliquer les filtres"},[e("i",{class:"fas fa-check text-sm"})],-1)),e("button",{onClick:P,type:"button",class:"w-10 h-10 bg-[var(--espace-gris)] text-[var(--espace-blanc)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Réinitialiser les filtres"},V[11]||(V[11]=[e("i",{class:"fas fa-times text-sm"},null,-1)]))])],32)])):A("",!0)]),_:1}),D(Xe,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 pt-12"},{default:K(()=>[(s(!0),r(J,null,X(j(o).products,k=>(s(),ie(Le,{key:k.id,produit:k,onMouseover:U=>y(k.id),onTouchstart:U=>$(k.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:a,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":j(o).isLoading},[j(o).hasMore?A("",!0):(s(),r("p",ja," Aucun produit supplémentaire "))],8,Sa)])]))}}),fu=ee(Va,[["__scopeId","data-v-53ae2504"]]),Ma={class:"overflow-y-scroll bg-[var(--espace-blanc)] pt-16 pb-20 px-4 sm:px-6"},za={class:"container mx-auto max-w-5xl"},Ea={key:0,class:"text-center text-[var(--espace-gris)]"},Ia={key:1,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},La={class:"flex flex-col lg:flex-row gap-4 sm:gap-6"},Ta={class:"w-full lg:w-1/2 relative"},Fa={class:"relative w-full h-64 sm:h-80 lg:h-96 overflow-hidden rounded-lg"},Ra=["src","alt"],Da={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Na={key:0,class:"absolute top-3 left-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boosté"},Ua={key:1,class:"absolute top-3 right-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Oa={key:2,class:"absolute bottom-3 left-3 bg-[var(--espace-bleu)] text-[var(--espace-blanc)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Commerçant Pro"},qa={class:"w-full lg:w-1/2"},Ja={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"},Wa={class:"text-sm text-[var(--espace-gris)] mb-3"},Ha={class:"text-lg sm:text-xl font-semibold text-[var(--espace-or)] mb-3"},Ba={class:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 text-xs text-[var(--espace-gris)]"},Xa={class:"flex items-center gap-3"},Ga={class:"flex items-center gap-1"},Ka={class:"flex items-center gap-1"},Qa=["aria-label"],Za={class:"border-t pt-3 mt-3"},Ya={class:"text-xs text-[var(--espace-gris)] mb-1"},er={key:0,class:"ml-1 text-[var(--espace-or)]","aria-label":"Commerçant vérifié",title:"Commerçant vérifié"},tr={class:"text-xs text-[var(--espace-gris)] mb-1"},sr={class:"text-xs text-[var(--espace-gris)] mb-1"},or={class:"text-xs text-[var(--espace-gris)] mb-2"},ar={class:"flex flex-col sm:flex-row gap-3 mt-4"},rr=["disabled","aria-label"],lr={key:2,class:"text-center text-[var(--espace-gris)] text-sm font-poppins"},nr={class:"bg-[var(--espace-blanc)] rounded-lg p-4 sm:p-6 w-full max-w-md mx-4 shadow-lg"},ir={class:"text-base sm:text-lg font-semibold text-[var(--espace-vert)] mb-3 font-poppins"},ur={class:"text-xs text-[var(--espace-gris)] mb-3"},cr=["aria-label"],dr={key:0,class:"text-xs text-[var(--espace-gris)] mt-1"},pr={class:"bg-[var(--espace-blanc)] rounded-lg p-6 w-full max-w-md mx-4 shadow-lg border border-[var(--espace-or)]"},vr={class:"text-xs text-[var(--espace-gris)] mt-1 text-center"},mr={class:"text-xs text-[var(--espace-gris)] mt-1 text-center"},fr={class:"text-sm text-[var(--espace-gris)]"},gr={class:"text-[var(--espace-or)]"},xr={class:"flex gap-4"},br={key:0,class:"mt-6"},hr=["aria-busy"],yr={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},_r=Y({__name:"Produit",setup(z){const o=Ee(),h=_e(),f=ue(),t=re(),c=ze(),n=se();g([]);const v=g(!1),u=g(null),a=g(null),x=g(null),w=g(!1),P=g(1),b=g(0),l=g(5),y=[100,500,1e3,5e3,1e4],$=[5,15,25,50,75],L=async()=>{try{o.isLoading=!0,await o.viewProduct(h.params.id),o.isLoading=!1,o.product.photos&&!o.product.photo_url&&(o.product.photo_url=o.product.photos[0]),await o.fetchProducts({category:o.product.category_id,per_page:8},!0),console.log(o.product)}catch(T){n.error(T||"Erreur lors du chargement du produit"),f.push({name:"home"})}finally{o.isLoading=!1}},M=()=>{var Z,G;if(!t.user){n.error("Veuillez vous connecter pour contacter le commerçant"),f.push({name:"login"});return}const T=(Z=o.product.commercant)==null?void 0:Z.telephone,_=encodeURIComponent(`Bonjour ${(G=o.product.commercant)==null?void 0:G.nom}, je suis intéressé par ${o.product.nom}. Pouvez-vous me contacter ?`);window.open(`https://wa.me/${T}?text=${_}`,"_blank")},V=()=>{var T;if(!t.user){n.error("Veuillez vous connecter pour collaborer"),f.push({name:"login"});return}if(((T=t.user.commercant)==null?void 0:T.id)===o.product.commercant_id){n.error("Vous ne pouvez pas collaborer sur votre propre produit");return}if(!o.product.collaboratif){n.error("Ce produit n’est pas ouvert à la collaboration");return}u.value=o.product.prix+(o.product.marge_min||500),v.value=!0},k=async()=>{if(!u.value||u.value<o.product.prix+(o.product.marge_min||0)){n.error(`Le prix de revente doit être supérieur ou égal à ${o.product.prix+(o.product.marge_min||0)} XAF`);return}await c.addCollaboration({produit_id:o.product.id,prix_revente:u.value})&&(n.success("Demande de collaboration envoyée",{timeout:3e3}),v.value=!1,u.value=null)},U=()=>{v.value=!1,u.value=null},O=()=>{f.push({path:`/commercant/produits/${o.product.id}/edit`})},I=async()=>{var T,_,Z;if(!t.user||((T=t.user.commercant)==null?void 0:T.id)!==o.product.commercant_id){n.error("Seul le commerçant propriétaire peut booster ce produit");return}if(t.user.jetons<l.value){n.error(`Pas assez de Jetons. Il vous faut ${l.value} Jetons pour ce boost.`);return}try{const G=await F.post(`/produits/${o.product.id}/boost`,{duration_days:P.value,target_views:y[b.value]});t.user.jetons-=l.value,o.product.boosted_until=G.data.data.end_date,n.success(G.data.message||"Produit boosté avec succès !"),w.value=!1}catch(G){n.error(((Z=(_=G.response)==null?void 0:_.data)==null?void 0:Z.message)||"Erreur lors du boostage du produit")}},te=()=>{var T;if(!t.user||((T=t.user.commercant)==null?void 0:T.id)!==o.product.commercant_id){n.error("Seul le commerçant propriétaire peut booster ce produit");return}w.value=!0,W()},W=()=>{const T=P.value*5,_=$[b.value];l.value=Math.max(5,T+_)};ne([P,b],()=>{W()});const d=T=>{p(T)},i=T=>{p(T)},p=async T=>{var fe,ve,ge;const _=(fe=t.user)==null?void 0:fe.id;if(!_){n.error("Connexion requise pour enregistrer la vue.");return}const Z=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),G=new Date().toISOString().split("T")[0],ae=localStorage.getItem("lastResetDate");if((!ae||ae!==G)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",G)),!Z[T])try{setTimeout(async()=>{const xe=await F.post("/record_view",{product_id:T,user_id:_});n.success(xe.data.message)},1e3),Z[T]=!0,localStorage.setItem("viewedProducts",JSON.stringify(Z))}catch(xe){console.error("Erreur lors de l'enregistrement de la vue:",xe),n.error(((ge=(ve=xe.response)==null?void 0:ve.data)==null?void 0:ge.message)||"Erreur lors de l'enregistrement de la vue.")}},S=async()=>{var T,_;try{await o.toggleFavorite(o.product.id)}catch(Z){n.error(((_=(T=Z.response)==null?void 0:T.data)==null?void 0:_.message)||"Erreur lors de la mise à jour des favoris.")}},E=(T,_,Z)=>{var ae;if(!t.user){n.error("Veuillez vous connecter pour démarrer une conversation"),f.push({name:"login"});return}const G={id:T,name:_,commercant_id:o.product.commercant_id,name_user:((ae=t.user)==null?void 0:ae.nom)||"Inconnu"};localStorage.setItem("chatProduct",JSON.stringify(G)),f.push(`/messages/${Z}`)},R=g(0),Q=()=>{var _;const T=(((_=o.product.photos)==null?void 0:_.length)||1)-1;R.value=Math.min(R.value+1,T)},q=()=>{R.value=Math.max(R.value-1,0)};return le(()=>{L(),c.initializeState(),a.value=new IntersectionObserver(T=>{T[0].isIntersecting&&!o.isLoading&&o.hasMore&&o.fetchProducts({category:o.product.category_id,per_page:8},!1)},{threshold:.1}),x.value&&a.value.observe(x.value)}),we(()=>{a.value&&x.value&&a.value.unobserve(x.value)}),ne(()=>h.params.id,T=>{T&&(L(),R.value=0)}),ne(o.product,T=>{T&&(o.page=1,o.fetchProducts({category:T.category_id,per_page:4},!0),R.value=0)}),(T,_)=>{const Z=pe("router-link");return s(),r(J,null,[D(ke,{isLoading:j(o).isLoading},null,8,["isLoading"]),e("div",Ma,[e("div",za,[j(o).isLoading?(s(),r("div",Ea)):j(o).product?(s(),r("div",Ia,[D(me,{name:"slide-up"},{default:K(()=>{var G,ae,fe,ve,ge,xe,$e,Ce,Ae,Pe,Se,je,he,Ne,Ue,Oe,qe,Je,We;return[e("div",La,[e("div",Ta,[e("div",Fa,[e("div",{class:"flex w-full h-full slider-container",style:de({transform:`translateX(-${R.value*100}%)`})},[(s(!0),r(J,null,X(j(o).product.photos||[j(o).product.photo_url||"https://via.placeholder.com/300"],(Te,Ve)=>(s(),r("img",{key:Ve,src:Te,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${j(o).product.nom} - ${Ve+1}`},null,8,Ra))),128))],4),j(o).product.photos&&j(o).product.photos.length>1?(s(),r("button",{key:0,onClick:q,class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image précédente"},_[6]||(_[6]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))):A("",!0),j(o).product.photos&&j(o).product.photos.length>1?(s(),r("button",{key:1,onClick:Q,class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image suivante"},_[7]||(_[7]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))):A("",!0),j(o).product.photos&&j(o).product.photos.length>1?(s(),r("div",Da,[(s(!0),r(J,null,X(j(o).product.photos,(Te,Ve)=>(s(),r("span",{key:Ve,class:H(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":Ve===R.value}])},null,2))),128))])):A("",!0)]),j(o).product.boosted_until&&new Date(j(o).product.boosted_until)>new Date?(s(),r("span",Na," Boosté ")):A("",!0),j(o).product.collaboratif?(s(),r("span",Ua," Collaboratif ")):A("",!0),(G=j(t).user)!=null&&G.premium?(s(),r("span",Oa," Premium ")):A("",!0)]),e("div",qa,[e("h1",Ja,m(j(o).product.nom),1),e("p",Wa,m(j(o).product.description||"Aucune description disponible"),1),e("p",Ha,m(j(o).product.prix)+" XAF ",1),e("div",Ba,[e("p",null,[_[8]||(_[8]=e("strong",null,"Catégorie :",-1)),C(" "+m(((ae=j(o).product.category)==null?void 0:ae.nom)||"Non spécifiée"),1)]),e("p",null,[_[9]||(_[9]=e("strong",null,"Quantité :",-1)),C(" "+m(j(o).product.quantite),1)]),e("p",null,[_[10]||(_[10]=e("strong",null,"Ville :",-1)),C(" "+m(j(o).product.ville||"Non spécifiée"),1)]),e("p",null,[_[11]||(_[11]=e("strong",null,"Ajouté le :",-1)),C(" "+m(new Date(j(o).product.created_at).toLocaleDateString("fr-FR")),1)]),e("div",Xa,[e("div",Ga,[_[12]||(_[12]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,m((fe=j(o).product.counts)==null?void 0:fe.views_count)+" vues",1)]),e("div",Ka,[e("i",{class:H(["fas fa-heart text-[10px]",{"text-[var(--espace-or)]":j(o).product.is_favorited_by}])},null,2),e("span",null,m((ve=j(o).product.counts)==null?void 0:ve.favorites_count)+" favoris",1)])])]),e("button",{onClick:S,class:"w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm mb-3","aria-label":j(o).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:H(["fas fa-heart mr-2 text-sm",{"text-[var(--espace-or)]":j(o).product.is_favorited_by}])},null,2),C(" "+m(j(o).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"),1)],8,Qa),e("div",Za,[_[17]||(_[17]=e("h2",{class:"text-base font-semibold text-[var(--espace-vert)] mb-2 font-poppins"}," À propos du commerçant ",-1)),e("p",Ya,[e("strong",null,m((ge=j(o).product.commercant)==null?void 0:ge.nom),1),(xe=j(o).product.commercant)!=null&&xe.verified?(s(),r("span",er,_[13]||(_[13]=[e("i",{class:"fas fa-check-circle text-[10px]"},null,-1)]))):A("",!0)]),e("p",tr,m((($e=j(o).product.commercant)==null?void 0:$e.description)||"Aucune description disponible"),1),e("p",sr,[_[14]||(_[14]=e("strong",null,"Ville :",-1)),C(" "+m(((Ce=j(o).product.commercant)==null?void 0:Ce.ville)||"Nonspécifiée"),1)]),e("p",or,[_[15]||(_[15]=e("strong",null,"Note :",-1)),C(" "+m(Number((Ae=j(o).product.commercant)==null?void 0:Ae.rating).toFixed(1)||"Non évalué")+" / 5 ",1)]),D(Z,{to:`/commercants/${j(o).product.commercant_id}`,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline text-xs font-poppins","aria-label":"Voir le profil du commerçant"},{default:K(()=>_[16]||(_[16]=[C(" Voir le profil du commerçant ")])),_:1,__:[16]},8,["to"])]),e("div",ar,[((Se=(Pe=j(t).user)==null?void 0:Pe.commercant)==null?void 0:Se.id)!==j(o).product.commercant_id?(s(),r("button",{key:0,onClick:M,class:"flex-1 bg-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] text-white transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le commerçant"},_[18]||(_[18]=[e("i",{class:"fas fa-phone mr-2 text-sm"},null,-1),C(" Contacter le commerçant ")]))):A("",!0),j(o).product.collaboratif&&((he=(je=j(t).user)==null?void 0:je.commercant)==null?void 0:he.id)!==j(o).product.commercant_id?(s(),r("button",{key:1,onClick:V,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Collaborer sur ce produit"},_[19]||(_[19]=[e("i",{class:"fas fa-handshake mr-2 text-sm"},null,-1),C(" Collaborer ")]))):A("",!0),((Ue=(Ne=j(t).user)==null?void 0:Ne.commercant)==null?void 0:Ue.id)===j(o).product.commercant_id?(s(),r("button",{key:2,onClick:O,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Modifier le produit"},_[20]||(_[20]=[e("i",{class:"fas fa-edit mr-2 text-sm"},null,-1),C(" Modifier le produit ")]))):A("",!0),((qe=(Oe=j(t).user)==null?void 0:Oe.commercant)==null?void 0:qe.id)===j(o).product.commercant_id?(s(),r("button",{key:3,onClick:te,class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] flex items-center justify-center gap-1 font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm",disabled:!!j(o).product.boosted_until&&new Date(j(o).product.boosted_until)>new Date,"aria-label":j(o).product.boosted_until&&new Date(j(o).product.boosted_until)>new Date?"Boost déjà actif":"Personnaliser le boost"},_[21]||(_[21]=[e("span",{class:"md:flex"},"Boost",-1),e("i",{class:"fas fa-rocket mr-2 text-sm"},null,-1)]),8,rr)):A("",!0),((We=(Je=j(t).user)==null?void 0:Je.commercant)==null?void 0:We.id)!==j(o).product.commercant_id?(s(),r("button",{key:4,onClick:_[0]||(_[0]=Te=>E(j(o).product.id,j(o).product.nom,j(o).product.commercant.user.id)),class:"flex-1 bg-green-500 text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-green-600 transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le vendeur"},_[22]||(_[22]=[e("i",{class:"fas fa-comment mr-2 text-sm"},null,-1),C(" Contacter le vendeur ")]))):A("",!0)])])])]}),_:1})])):(s(),r("div",lr," Produit non trouvé. ")),D(me,{name:"fade"},{default:K(()=>[v.value?(s(),r("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:oe(U,["self"]),role:"dialog","aria-modal":"true","aria-label":"Proposer un prix de revente"},[e("div",nr,[e("h2",ir," Collaborer sur "+m(j(o).product.nom),1),e("p",ur," Proposez un prix de revente (minimum : "+m(j(o).product.prix+(j(o).product.marge_min||0))+" XAF) ",1),e("form",{onSubmit:oe(k,["prevent"]),class:"space-y-3"},[e("div",null,[_[23]||(_[23]=e("label",{for:"prix_revente",class:"text-xs text-[var(--espace-vert)] font-medium"},"Prix de revente (XAF)",-1)),N(e("input",{id:"prix_revente","onUpdate:modelValue":_[1]||(_[1]=G=>u.value=G),type:"number",min:"0",class:"w-full h-10 p-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition","aria-label":`Prix de revente pour ${j(o).product.nom}`,required:""},null,8,cr),[[B,u.value,void 0,{number:!0}]]),u.value?(s(),r("p",dr," Marge potentielle : "+m(u.value-j(o).product.prix)+" XAF ",1)):A("",!0)]),e("div",{class:"flex gap-3"},[_[24]||(_[24]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-xs","aria-label":"Envoyer la demande de collaboration"}," Envoyer ",-1)),e("button",{type:"button",onClick:U,class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):A("",!0)]),_:1}),D(me,{name:"fade"},{default:K(()=>[w.value?(s(),r("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:_[5]||(_[5]=oe(G=>w.value=!1,["self"])),role:"dialog","aria-modal":"true","aria-label":"Personnaliser le boost du produit"},[e("div",pr,[_[30]||(_[30]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4 font-poppins"}," Personnaliser le Boost ",-1)),e("form",{onSubmit:oe(I,["prevent"]),class:"space-y-6"},[e("div",null,[_[25]||(_[25]=e("label",{class:"text-sm text-[var(--espace-vert)] font-medium mb-2 block"},"Durée (jours)",-1)),N(e("input",{type:"range","onUpdate:modelValue":_[2]||(_[2]=G=>P.value=G),min:"1",max:"20",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--espace-or)]",onInput:W},null,544),[[B,P.value,void 0,{number:!0}]]),e("p",vr,m(P.value)+" jours ",1)]),e("div",null,[_[26]||(_[26]=e("label",{class:"text-sm text-[var(--espace-vert)] font-medium mb-2 block"},"Objectif de vues",-1)),N(e("input",{type:"range","onUpdate:modelValue":_[3]||(_[3]=G=>b.value=G),min:"0",max:"4",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[var(--espace-or)]",onInput:W},null,544),[[B,b.value,void 0,{number:!0}]]),e("p",mr,m(y[b.value])+" vues ",1)]),e("p",fr,[_[27]||(_[27]=C("Coût estimé : ")),e("strong",gr,m(l.value),1),_[28]||(_[28]=C(" Jetons"))]),e("div",xr,[_[29]||(_[29]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm"}," Confirmer ",-1)),e("button",{type:"button",onClick:_[4]||(_[4]=G=>w.value=!1),class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):A("",!0)]),_:1})]),j(o).products?(s(),r("div",br,[_[31]||(_[31]=e("h2",{class:"text-lg sm:text-xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"}," Produits similaires ",-1)),D(Xe,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},{default:K(()=>[(s(!0),r(J,null,X(j(o).products,G=>(s(),ie(Le,{key:G.id,produit:G,onMouseover:ae=>d(G.id),onTouchstart:ae=>i(G.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:x,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":j(o).isLoading},[j(o).hasMore?A("",!0):(s(),r("p",yr," Aucun produit supplémentaire "))],8,hr)])):A("",!0)])],64)}}}),gu=ee(_r,[["__scopeId","data-v-b8972ad8"]]),wr={class:"relative bg-green-500"},kr={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] fixed top-0 left-0 w-full z-50 shadow-md"},$r={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},Cr={class:"flex items-center gap-1 sm:gap-3"},Ar={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},Pr=["aria-label"],Sr={class:"flex items-center gap-2"},jr=["src"],Vr={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},Mr={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},zr={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},Er={class:"flex justify-around items-center py-2"},Ir=["aria-label"],Lr=Y({__name:"AppHeader",setup(z){var V;const o=re(),h=ze(),f=ue(),t=o.user;_e();const c=g(!1),n=g(!1),v=g(!1),u=g(""),a=Ee(),x=g(!1),w=g(null),P=g(!1),b=be(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...o.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...o.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:h.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),l=async()=>{if(o.user)try{const k=await F.get("/user/badges");h.saveCollaborationsToLocalStorage(k.data.collaborations_pending.map(U=>({produit_id:U.produit_id,prix_revente:U.prix_revente,status:U.status,created_at:U.created_at})))}catch(k){console.error("Erreur lors du chargement des badges:",k)}};ne(()=>o.user,k=>{k&&(l(),h.initializeState())},{immediate:!0}),ne(()=>h.collaborationsPending,()=>{h.collaborationsPending>0&&(n.value=!0,setTimeout(()=>n.value=!1,300))});const y=async()=>{if(u.value.trim())try{await a.fetchProducts({search:u.value.trim()},!0),u.value="",x.value=!1}catch(k){console.error("Erreur lors de la recherche:",k)}},$=k=>{if(P.value){P.value=!1;return}w.value&&!w.value.contains(k.target)&&(x.value=!1)},L=async()=>{x.value=!x.value,x.value&&(P.value=!0,await Re())},M=()=>{f.push("/messages")};return console.log("📩 header e reçu :"),(V=o.user)!=null&&V.id&&window.Echo.channel(`chat.${o.user.id}`).listen("MessageSent",k=>{var U;console.log("📩 header e reçu :",k.message),((U=o.user)==null?void 0:U.id)===k.receiver_id&&(console.log("📩 header e reçu :",k.message),h.saveUnreadMessagesToLocalStorage(k.unread_messages))}),le(()=>{o.user&&(l(),h.initializeState()),document.addEventListener("click",$)}),we(()=>{document.removeEventListener("click",$)}),(k,U)=>{const O=pe("RouterLink");return s(),r("div",wr,[e("header",kr,[e("div",$r,[e("div",Cr,[D(O,{to:"/","aria-label":"Retour à l'accueil"},{default:K(()=>U[2]||(U[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Ge,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),U[3]||(U[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"},null,-1))]),e("nav",Ar,[(s(!0),r(J,null,X(b.value,I=>(s(),ie(O,{key:I.to,to:I.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:K(()=>[e("i",{class:H(["fas",I.icon])},null,2),C(" "+m(I.label)+" ",1),I.badge>0?(s(),r("span",{key:0,class:H(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":I.to==="/panier"&&c.value||I.to==="/collaborations"&&n.value||I.to==="/commandes"&&v.value}]),"aria-label":I.to==="/panier"?"Nombre d'articles dans le panier":I.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},m(I.badge),11,Pr)):A("",!0)]),_:2},1032,["to"]))),128))]),D(Ke),e("div",Sr,[e("button",{onClick:L,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},U[4]||(U[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)])),e("button",{onClick:M,class:"text-[var(--espace-white)] px-1 rounded hover:bg-white transition"},U[5]||(U[5]=[e("i",{class:"fas fa-comment-dots text-2xl"},null,-1)])),(s(!0),r(J,null,X(b.value.filter(I=>j(o).user?I.to==="/profil":["/login","/register"].includes(I.to)),I=>(s(),ie(O,{key:I.to,to:I.to,class:"relative flex items-center justify-center","aria-label":I.label},{default:K(()=>{var te;return[(te=j(t))!=null&&te.photo?(s(),r("img",{key:0,src:`http://localhost:8000/storage/${j(t).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,jr)):(s(),r("div",Vr,[e("i",{class:H([`fas ${I.icon}`,"text-2xl text-gray-100"])},null,2)])),I.badge>0&&I.to==="/collaborations"?(s(),r("span",{key:2,class:H(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":I.to==="/collaborations"&&n.value}]),"aria-label":"Collaborations en attente"},m(I.badge),3)):A("",!0)]}),_:2},1032,["to","aria-label"]))),128))])]),x.value?(s(),r("div",{key:0,ref_key:"searchOverlayRef",ref:w,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",Mr,[N(e("input",{"onUpdate:modelValue":U[0]||(U[0]=I=>u.value=I),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Fe(y,["enter"])},null,544),[[B,u.value]]),e("button",{onClick:y,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},U[6]||(U[6]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:U[1]||(U[1]=I=>x.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},U[7]||(U[7]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):A("",!0)]),D(me,{name:"slide-up"},{default:K(()=>[e("nav",zr,[e("div",Er,[(s(!0),r(J,null,X(b.value,I=>(s(),ie(O,{key:I.to,to:I.to,"aria-label":I.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:K(()=>[e("i",{class:H(["fas text-lg",I.icon])},null,2),I.badge>0?(s(),r("span",{key:0,class:H(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":I.to==="/panier"&&c.value||I.to==="/collaborations"&&n.value||I.to==="/commandes"&&v.value}]),"aria-label":I.to==="/panier"?"Nombre d'articles dans le panier":I.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},m(I.badge),11,Ir)):A("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),Qe=ee(Lr,[["__scopeId","data-v-e17b2a25"]]),Tr={class:"min-h-screen bg-gray-100",style:{background:"url(/src/assets/images/bginsc.jpg) center/cover"}},Fr={class:"container mx-auto px-4 sm:px-6 py-6"},Rr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Dr={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Nr={key:0,class:"text-sm sm:text-base text-[var(--espace-gris)]"},Ur={key:1,class:"text-sm sm:text-base text-[var(--espace-gris)]"},Or={key:2,class:"text-sm text-[var(--espace-gris)] italic"},qr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Jr=["value"],Wr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Hr=["value"],Br={class:"flex items-center gap-2 text-sm col-span-2 sm:col-span-1"},Xr=["value"],Gr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 border border-gray-100"},Kr={key:0,class:"flex items-center gap-3 text-[var(--espace-vert)]"},Qr={key:1,class:"text-base text-[var(--espace-gris)] italic"},Zr={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Yr=["onClick"],el=Y({__name:"CommercantDashboard",setup(z){const o=se(),h=g([]),f=g([]),t=g(null),c=g(!1),n=g({nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}),v=g({nom:"",description:"",ville:""}),u=g(["Douala","Yaoundé","Bamenda","Buea","Garoua"]),a=async()=>{c.value=!0;try{const[b,l,y]=await Promise.all([F.get("/commercant/produits"),F.get("/categories"),F.get("/commercant/profil")]);c.value=!1,h.value=b.data.produits.map($=>{var L;return{...$,commercant_id:((L=t.value)==null?void 0:L.id)||""}}),f.value=l.data.categories,t.value=y.data.commercant,v.value={nom:t.value.nom,description:t.value.description||"",ville:t.value.ville||""}}catch{o.error("Erreur lors du chargement des données."),c.value=!1}},x=async()=>{try{const b=await F.post("/commercant/produits",n.value);o.success("Produit ajouté avec succès."),a(),n.value={nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}}catch{o.error("Erreur lors de l’ajout du produit.")}},w=async b=>{if(confirm("Voulez-vous supprimer ce produit ?"))try{await F.delete(`/commercant/produits/${b}`),o.success("Produit supprimé avec succès."),a()}catch{o.error("Erreur lors de la suppression du produit.")}},P=async()=>{try{await F.put("/commercant/profil",v.value),o.success("Profil mis à jour avec succès."),a()}catch{o.error("Erreur lors de la mise à jour du profil.")}};return le(()=>{a()}),(b,l)=>(s(),r("div",Tr,[D(Qe),e("div",Fr,[l[26]||(l[26]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] flex items-center gap-3 mb-6"},[e("i",{class:"fas fa-store text-xl"}),C(" Espace Commerçant ")],-1)),e("div",Rr,[l[14]||(l[14]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-3"},"Statistiques",-1)),e("div",Dr,[t.value?(s(),r("p",Nr,[l[12]||(l[12]=e("span",{class:"font-medium"},"Revenus :",-1)),C(" "+m(t.value.revenus)+" FCFA ",1)])):A("",!0),t.value?(s(),r("p",Ur,[l[13]||(l[13]=e("span",{class:"font-medium"},"Produits vendus :",-1)),C(" "+m(t.value.produits_vendus),1)])):(s(),r("p",Or,"Chargement..."))])]),e("div",qr,[l[17]||(l[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Profil Commerçant",-1)),e("form",{onSubmit:oe(P,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[N(e("input",{"onUpdate:modelValue":l[0]||(l[0]=y=>v.value.nom=y),type:"text",placeholder:"Nom du commerçant",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[B,v.value.nom]]),N(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=y=>v.value.description=y),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[B,v.value.description]]),N(e("select",{"onUpdate:modelValue":l[2]||(l[2]=y=>v.value.ville=y),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2 sm:col-span-1"},[l[15]||(l[15]=e("option",{value:""},"Ville",-1)),(s(!0),r(J,null,X(u.value,y=>(s(),r("option",{key:y,value:y},m(y),9,Jr))),128))],512),[[ye,v.value.ville]]),l[16]||(l[16]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-check"})],-1))],32)]),e("div",Wr,[l[22]||(l[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Ajouter un produit",-1)),e("form",{onSubmit:oe(x,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[N(e("input",{"onUpdate:modelValue":l[3]||(l[3]=y=>n.value.nom=y),type:"text",placeholder:"Nom du produit",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[B,n.value.nom]]),N(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=y=>n.value.description=y),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[B,n.value.description]]),N(e("input",{"onUpdate:modelValue":l[5]||(l[5]=y=>n.value.prix=y),type:"number",placeholder:"Prix",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[B,n.value.prix]]),N(e("input",{"onUpdate:modelValue":l[6]||(l[6]=y=>n.value.photo_url=y),type:"text",placeholder:"URL de la photo",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[B,n.value.photo_url]]),N(e("select",{"onUpdate:modelValue":l[7]||(l[7]=y=>n.value.category_id=y),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[l[18]||(l[18]=e("option",{value:""},"Catégorie",-1)),(s(!0),r(J,null,X(f.value,y=>(s(),r("option",{key:y.id,value:y.id},m(y.nom),9,Hr))),128))],512),[[ye,n.value.category_id]]),e("label",Br,[N(e("input",{"onUpdate:modelValue":l[8]||(l[8]=y=>n.value.collaboratif=y),type:"checkbox"},null,512),[[He,n.value.collaboratif]]),l[19]||(l[19]=C(" Collaboratif "))]),N(e("input",{"onUpdate:modelValue":l[9]||(l[9]=y=>n.value.marge_min=y),type:"number",placeholder:"Marge minimum",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[B,n.value.marge_min]]),N(e("input",{"onUpdate:modelValue":l[10]||(l[10]=y=>n.value.stock=y),type:"number",placeholder:"Stock",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[B,n.value.stock]]),N(e("select",{"onUpdate:modelValue":l[11]||(l[11]=y=>n.value.ville=y),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[l[20]||(l[20]=e("option",{value:""},"Ville",-1)),(s(!0),r(J,null,X(u.value,y=>(s(),r("option",{key:y,value:y},m(y),9,Xr))),128))],512),[[ye,n.value.ville]]),l[21]||(l[21]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-plus"})],-1))],32)]),e("div",Gr,[l[25]||(l[25]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Produits",-1)),c.value?(s(),r("div",Kr,l[23]||(l[23]=[e("i",{class:"fas fa-spinner animate-spin text-xl"},null,-1),e("span",{class:"text-base font-poppins"},"Chargement...",-1)]))):h.value.length===0?(s(),r("div",Qr," Aucun produit disponible. ")):(s(),r("div",Zr,[(s(!0),r(J,null,X(h.value,y=>(s(),r("div",{key:y.id,class:"relative"},[D(Le,{produit:y},null,8,["produit"]),e("button",{onClick:$=>w(y.id),class:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition flex items-center justify-center","aria-label":"Supprimer le produit"},l[24]||(l[24]=[e("i",{class:"fas fa-trash text-sm"},null,-1)]),8,Yr)]))),128))]))])])]))}}),xu=ee(el,[["__scopeId","data-v-98a2ca3d"]]),tl={class:"overflow-y-scroll bg-gray-100 pt-2 pb-12 px-4 sm:px-6"},sl={class:"container mx-auto max-w-4xl"},ol={class:"bg-white rounded-lg shadow-md p-6 mb-6"},al={key:0,class:"ml-2"},rl={class:"w-full bg-gray-200 rounded-full h-4"},ll={class:"text-[var(--espace-gris)] text-xs mt-2"},nl={key:0,class:"text-[var(--espace-gris)] text-xs mt-1"},il={class:"bg-white rounded-lg shadow-md p-6 mb-6"},ul={key:0,class:"mb-4"},cl={class:"text-sm text-[var(--espace-gris)]"},dl={class:"font-bold text-[var(--espace-or)]"},pl={class:"text-sm text-[var(--espace-gris)] truncate"},vl=["href"],ml={key:1,class:"mb-4"},fl=["placeholder"],gl={class:"flex flex-col sm:flex-row gap-2"},xl=["disabled"],bl={key:0},hl={key:1},yl=["disabled"],_l={key:0},wl={key:1},kl={key:2,class:"mt-4 flex flex-col sm:flex-row gap-2"},$l={class:"bg-white rounded-lg shadow-md p-6 mb-6"},Cl={class:"mb-4"},Al={key:0,class:"overflow-x-auto"},Pl={class:"w-full text-sm text-left text-[var(--espace-gris)]"},Sl=["onClick"],jl={class:"px-4 py-2"},Vl={class:"px-4 py-2"},Ml={key:1,class:"text-center text-[var(--espace-gris)] py-4"},zl={class:"bg-white rounded-lg shadow-md p-6 text-center"},El={class:"text-2xl sm:text-3xl font-bold text-[var(--espace-or)]"},Il={class:"text-[var(--espace-gris)] mt-2"},Ll=Y({__name:"Parrainage",setup(z){const o=re(),h=ue(),f=se(),t=g(""),c=g(""),n=g([]),v=g(0),u=g(""),a=g(""),x=g(!1),w=g(!1),P=g({}),b=g(null),l=g(0),y=g(0),$=g(0),L=g("all"),M=be(()=>{var W;return((W=P.value)==null?void 0:W.couleur)||"#6b7280"}),V=be(()=>L.value==="commercants"?n.value.filter(W=>W.est_commercant):L.value==="nonCommercants"?n.value.filter(W=>!W.est_commercant):n.value),k=async()=>{if(!o.user){f.error("Veuillez vous connecter pour accéder à cette page"),h.push("/login");return}try{const d=(await F.get("/parrainages/dashboard")).data;console.log(d),t.value=d.code||"",c.value=d.code?`http://localhost:4000/register/${d.code}`:"",n.value=d.parrainages||[],v.value=d.total_gains||0,P.value=d.niveau_actuel,b.value=d.niveau_suivant,l.value=d.progression,y.value=d.total_parrainages||0,$.value=d.total_parrainages_commercants||0}catch(W){f.error("Erreur lors de la récupération des données de parrainage"),console.error(W)}},U=async()=>{if(!o.user){f.error("Veuillez vous connecter");return}x.value=!0;try{const W=await F.post("/parrainages/generateCode");u.value=W.data.suggested_code,a.value=u.value,f.success("Nouveau code suggéré avec succès !")}catch(W){f.error("Erreur lors de la génération du code"),console.error(W)}finally{x.value=!1}},O=async()=>{var W,d;if(!o.user){f.error("Veuillez vous connecter");return}if(!a.value.trim()){f.error("Veuillez entrer un code valide");return}w.value=!0;try{const i=await F.post("/parrainages/createCode",{code:a.value.trim()});t.value=i.data.code,c.value=i.data.link||`http://localhost:4000/register/${i.data.code}`,f.success(i.data.message||"Code créé avec succès !"),await k()}catch(i){f.error(((d=(W=i.response)==null?void 0:W.data)==null?void 0:d.message)||"Erreur lors de la création du code"),console.error(i)}finally{w.value=!1}},I=W=>{if(!c.value){f.error("Aucun lien disponible pour le partage");return}let d="";const i=encodeURIComponent(`Rejoins-moi sur Espace Cameroun avec mon lien : ${c.value}`);switch(W){case"whatsapp":d=`https://api.whatsapp.com/send?text=${i}`;break;case"facebook":d=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(c.value)}`;break;default:f.error("Plateforme non prise en charge");return}window.open(d,"_blank")},te=W=>{W.est_commercant?h.push(`/commercants/${W.id}`):h.push({name:"public-profile",params:{id:W.id}})};return le(()=>{k()}),(W,d)=>{var i,p,S,E,R;return s(),r("div",tl,[e("div",sl,[e("div",ol,[e("h2",{class:"text-lg font-semibold mb-4",style:de({color:M.value})},"Niveaux de Parrainage",4),e("p",{class:"text-[var(--espace-gris)] text-sm mb-2 flex justify-between",style:de({color:M.value})},[e("div",null,[d[5]||(d[5]=C(" Votre niveau actuel : ")),e("strong",null,m(P.value?P.value.nom:"Pas de niveau")+" "+m((i=P.value)==null?void 0:i.emoji)+" ("+m($.value)+"/"+m(b.value?b.value.filleuls_requis:(p=P.value)==null?void 0:p.filleuls_requis)+" commerçants)",1)]),((S=b.value)==null?void 0:S.jetons_bonus)>0?(s(),r("span",al,"+"+m((E=b.value)==null?void 0:E.jetons_bonus)+" jetons ",1)):A("",!0)],4),e("div",rl,[e("div",{class:"h-4 rounded-full bg-[var(--espace-or)] transition-all duration-300",style:de({width:`${l.value}%`,background:`${M.value}`})},null,4)]),e("p",ll," Prochain niveau : "+m(b.value?b.value.nom:"Légende 🏆")+" à "+m(b.value?b.value.filleuls_requis:"1000+")+" commerçants ",1),(R=P.value.avantages)!=null&&R.length?(s(),r("p",nl," Avantages : "+m(P.value.avantages.join(", ")),1)):A("",!0),e("button",{onClick:d[0]||(d[0]=Q=>j(h).push("/parrainage/info")),class:"mt-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},d[6]||(d[6]=[e("i",{class:"fas fa-info-circle mr-2"},null,-1),C(" En savoir plus ")]))]),d[24]||(d[24]=e("div",{class:"bg-white rounded-lg shadow-md p-6 mb-6"},[e("p",{class:"text-[var(--espace-gris)] text-sm sm:text-base"}," Invitez des amis avec votre lien ou code unique et gagnez des récompenses ! Atteignez des niveaux supérieurs pour débloquer des jetons et des avantages. ")],-1)),e("div",il,[d[15]||(d[15]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Votre Code de Parrainage",-1)),t.value?(s(),r("div",ul,[e("p",cl,[d[7]||(d[7]=C(" Code : ")),e("span",dl,m(t.value),1)]),e("p",pl,[d[8]||(d[8]=C(" Lien : ")),e("a",{href:c.value,target:"_blank",class:"text-blue-500 underline hover:text-blue-700"},m(c.value),9,vl)])])):(s(),r("div",ml,[N(e("input",{"onUpdate:modelValue":d[1]||(d[1]=Q=>a.value=Q),type:"text",placeholder:u.value||"Entrez ou générez un code (ex: DOM2025)",class:"w-full p-2 border rounded mb-2 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",maxlength:"10"},null,8,fl),[[B,a.value]]),e("div",gl,[e("button",{onClick:U,disabled:x.value,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition flex-1 disabled:opacity-50"},[x.value?(s(),r("span",bl,d[9]||(d[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),C(" Génération... ")]))):(s(),r("span",hl,d[10]||(d[10]=[e("i",{class:"fas fa-magic mr-2"},null,-1),C(" Générer un code ")])))],8,xl),e("button",{onClick:O,disabled:w.value||!a.value.trim(),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1 disabled:opacity-50"},[w.value?(s(),r("span",_l,d[11]||(d[11]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),C(" Création... ")]))):(s(),r("span",wl,d[12]||(d[12]=[e("i",{class:"fas fa-check mr-2"},null,-1),C(" Créer le code ")])))],8,yl)])])),t.value?(s(),r("div",kl,[e("button",{onClick:d[2]||(d[2]=Q=>I("whatsapp")),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1"},d[13]||(d[13]=[e("i",{class:"fab fa-whatsapp mr-2"},null,-1),C(" Partager sur WhatsApp ")])),e("button",{onClick:d[3]||(d[3]=Q=>I("facebook")),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition flex-1"},d[14]||(d[14]=[e("i",{class:"fab fa-facebook-f mr-2"},null,-1),C(" Partager sur Facebook ")]))])):A("",!0)]),e("div",$l,[d[18]||(d[18]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Utilisateurs Parrainés",-1)),e("div",Cl,[N(e("select",{"onUpdate:modelValue":d[4]||(d[4]=Q=>L.value=Q),class:"w-full sm:w-1/3 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]"},d[16]||(d[16]=[e("option",{value:"all"},"Tous",-1),e("option",{value:"commercants"},"Commerçants",-1),e("option",{value:"nonCommercants"},"Non Commerçants",-1)]),512),[[ye,L.value]])]),V.value.length?(s(),r("div",Al,[e("table",Pl,[d[17]||(d[17]=e("thead",{class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)]"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Nom"),e("th",{class:"px-4 py-2"},"Date d'inscription"),e("th",{class:"px-4 py-2"},"Est commerçant")])],-1)),e("tbody",null,[(s(!0),r(J,null,X(V.value,Q=>(s(),r("tr",{key:Q.id,class:"border-b hover:bg-gray-50"},[e("td",{class:"px-4 py-2 cursor-pointer text-blue-500 hover:underline",onClick:q=>te(Q)},m(Q.filleul_nom||"Anonyme"),9,Sl),e("td",jl,m(new Date(Q.date_inscription).toLocaleDateString("fr-FR")),1),e("td",Vl,m(Q.est_commercant?"Oui":"Non"),1)]))),128))])])])):(s(),r("p",Ml," Aucun utilisateur parrainé correspondant au filtre. Commencez à inviter dès maintenant ! "))]),e("div",zl,[d[22]||(d[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2"},"Vos Gains",-1)),e("p",El,m(v.value)+" jetons ",1),e("p",Il,[d[19]||(d[19]=C(" 🎉 Vous avez invité ")),e("strong",null,m(y.value),1),d[20]||(d[20]=C(" utilisateurs, dont ")),e("strong",null,m($.value),1),d[21]||(d[21]=C(" sont commerçants ! "))]),d[23]||(d[23]=e("p",{class:"text-[var(--espace-gris)] mt-2"}," Débloquez plus de jetons et d'avantages en atteignant les niveaux supérieurs. ",-1))])])])}}}),bu=ee(Ll,[["__scopeId","data-v-cdb56975"]]),Tl={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Fl={class:"container mx-auto max-w-4xl"},Rl={class:"flex border-b border-gray-300 mb-6"},Dl={key:0},Nl={key:0,class:"grid grid-cols-1 gap-4"},Ul={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Ol=["onClick"],ql={class:"text-sm text-[var(--espace-gris)]"},Jl={class:"text-sm text-[var(--espace-gris)]"},Wl=["onClick"],Hl={class:"flex flex gap-2"},Bl=["onClick"],Xl=["onClick"],Gl=["onClick"],Kl={key:1,class:"text-center text-[var(--espace-gris)]"},Ql={key:1},Zl={key:0,class:"grid grid-cols-1 gap-4"},Yl={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},en=["onClick"],tn={class:"text-sm text-[var(--espace-gris)]"},sn={class:"text-sm text-[var(--espace-gris)]"},on=["onClick"],an=["onClick"],rn={key:1,class:"text-center text-[var(--espace-gris)]"},ln=Y({__name:"Collaborations",setup(z){const o=w=>{localStorage.setItem("pending_collaborations",JSON.stringify(w))},h=se(),f=ue(),t=g({sent_collaborations:[],received_collaborations:[]}),c=g(!0),n=g("received"),v=async()=>{try{const w=await F.get("/collaborations");console.log(w.data),t.value=w.data;const P=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");if(P.length>0){const b=new Set(t.value.sent_collaborations.map(y=>y.produit_id)),l=P.filter(y=>!b.has(y.produit_id));l.length!==P.length&&(o(l),console.log("Collaborations en attente nettoyées dans localStorage"))}}catch{h.error("Erreur lors du chargement des collaborations")}finally{c.value=!1}},u=w=>{f.push({path:`/produits/${w}`})},a=w=>{var b,l,y;const P=((b=w.commercant)==null?void 0:b.id)||((y=(l=w.produit)==null?void 0:l.commercant)==null?void 0:y.id);P?f.push({path:`/commercants/${P}`}):h.error("Profil du commerçant non disponible")},x=async(w,P)=>{var b;try{const l=await F.post(`/collaborations/${w}`,{statut:P});h.success(l.data.message),await v()}catch(l){console.log(l.response.data.message),h.error(`Erreur lors de la mise à jour de la collaboration${(b=l.response)==null?void 0:b.data.message}`)}};return le(()=>{c.value=!0,v()}),(w,P)=>(s(),r(J,null,[D(ke,{isLoading:c.value},null,8,["isLoading"]),e("div",Tl,[e("div",Fl,[P[4]||(P[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-handshake mr-2 text-[var(--espace-or)]"}),C(" Mes Collaborations ")],-1)),e("div",Rl,[e("button",{class:H(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":n.value==="received","text-[var(--espace-gris)]":n.value!=="received"}]),onClick:P[0]||(P[0]=b=>n.value="received")}," Collaborations reçues ",2),e("button",{class:H(["px-4 py-2 font-semibold",{"text-[var(--espace-vert)] border-b-2 border-[var(--espace-vert)]":n.value==="sent","text-[var(--espace-gris)]":n.value!=="sent"}]),onClick:P[1]||(P[1]=b=>n.value="sent")}," Collaborations envoyées ",2)]),n.value==="received"?(s(),r("div",Dl,[t.value.received_collaborations.length?(s(),r("div",Nl,[(s(!0),r(J,null,X(t.value.received_collaborations,b=>(s(),r("div",{key:b.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",Ul,[e("div",null,[e("h2",{onClick:l=>u(b.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},m(b.produit.nom),9,Ol),e("p",ql," Prix de revente proposé : "+m(b.prix_revente)+" FCFA ",1),e("p",Jl,[P[2]||(P[2]=C(" Statut : ")),e("span",{class:H({"text-green-600":b.statut==="valider","text-yellow-600":b.statut==="en_attente","text-red-600":b.statut==="refuser"})},m(b.statut==="en_attente"?"En attente":b.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:l=>a(b),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,Wl)]),e("div",Hl,[b.statut==="en_attente"?(s(),r("button",{key:0,onClick:l=>x(b.id,"valider"),class:"bg-green-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-green-700 transition text-xs sm:text-sm"}," Valider ",8,Bl)):A("",!0),b.statut==="en_attente"?(s(),r("button",{key:1,onClick:l=>x(b.id,"refuser"),class:"bg-red-600 text-white font-semibold px-3 py-1.5 rounded hover:bg-red-700 transition text-xs sm:text-sm"}," Rejeter ",8,Xl)):A("",!0),e("button",{onClick:l=>u(b.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,Gl)])])]))),128))])):(s(),r("p",Kl," Aucune collaboration reçue pour le moment. "))])):A("",!0),n.value==="sent"?(s(),r("div",Ql,[t.value.sent_collaborations.length?(s(),r("div",Zl,[(s(!0),r(J,null,X(t.value.sent_collaborations,b=>(s(),r("div",{key:b.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",Yl,[e("div",null,[e("h2",{onClick:l=>u(b.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},m(b.produit.nom),9,en),e("p",tn," Prix de revente proposé : "+m(b.prix_revente)+" FCFA ",1),e("p",sn,[P[3]||(P[3]=C(" Statut : ")),e("span",{class:H({"text-green-600":b.statut==="valider","text-yellow-600":b.statut==="en_attente","text-red-600":b.statut==="refuser"})},m(b.statut==="en_attente"?"En attente":b.statut==="valider"?"Valider":"Refusée"),3)]),e("button",{onClick:l=>a(b),class:"mt-2 text-sm text-[var(--espace-or)] hover:underline"}," Voir le profil du commerçant ",8,on)]),e("button",{onClick:l=>u(b.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs"}," Voir le produit ",8,an)])]))),128))])):(s(),r("p",rn," Aucune collaboration envoyée pour le moment. "))])):A("",!0)])])],64))}}),hu=ee(ln,[["__scopeId","data-v-61e28846"]]),nn={class:"overflow-y-scroll bg-gray-100"},un={class:"container mx-auto px-4 sm:px-6 py-8"},cn={key:0,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mb-8 border border-gray-100 overflow-hidden"},dn={class:"flex flex-col sm:flex-row items-center gap-6"},pn={class:"w-24 h-24 bg-[var(--espace-or)] rounded-full flex items-center justify-center overflow-hidden"},vn=["src"],mn={key:1,class:"fas fa-user text-3xl text-[var(--espace-vert)]"},fn={class:"flex-1"},gn={class:"text-3xl font-bold text-[var(--espace-vert)] mb-2 text-center"},xn={class:"text-sm text-[var(--espace-gris)] mb-1"},bn={class:"text-sm text-[var(--espace-gris)] mb-1"},hn={class:"text-sm text-[var(--espace-gris)]"},yn={key:0,class:"text-sm text-[var(--espace-gris)]"},_n={class:"mt-2 flex space-x-2 flex-col"},wn={class:"text-sm text-[var(--espace-gris)]"},kn={class:"text-xs text-[var(--espace-gris)]"},$n={class:"mt-4 flex flex-col sm:flex-row gap-4"},Cn={class:"mt-4 flex flex-wrap gap-4"},An={class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},Pn={key:0,class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},Sn={key:1,class:"text-base text-[var(--espace-gris)] italic"},jn={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Vn={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},Mn={class:"flex items-center space-x-2"},zn={key:3},En={key:4,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-4 border border-gray-100"},In={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},Ln={key:5,class:"text-base text-[var(--espace-gris)] italic"},Tn={key:6,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-8 border border-gray-100"},Fn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Rn={class:"text-sm text-[var(--espace-gris)]"},Dn={class:"text-sm text-[var(--espace-gris)]"},Nn=Y({__name:"CommercantDetails",setup(z){const o=_e(),h=se(),f=g(!1),t=g(null),c=g(null),n=g(0),v=g(0),u=g(!1),a=async()=>{f.value=!0;try{const b=await F.get(`/commercant/${o.params.commercantId}`);console.log(b.data),t.value=b.data.commercant,n.value=b.data.average_rating||0,v.value=b.data.vote_count||0,t.value.produits||console.warn("Aucun produit trouvé dans la réponse de l'API pour ce commerçant.")}catch{h.error("Erreur lors du chargement des détails du commerçant.")}finally{f.value=!1}},x=async()=>{var b,l;if(c.value===null||c.value<1||c.value>5){h.error("Veuillez sélectionner une note entre 1 et 5.");return}try{const y=await F.post(`/commercant/${o.params.commercantId}/rate`,{rating:c.value});n.value=y.data.average_rating||0,h.success("Merci pour votre note !"),c.value=null,u.value=!1,v.value=y.data.vote_count||v.value+1}catch(y){h.error(((l=(b=y.response)==null?void 0:b.data)==null?void 0:l.message)||"Erreur lors de la notation.")}},w=be(()=>{var b;return((b=t.value)==null?void 0:b.produits)||[]}),P=()=>{u.value=!0};return le(async()=>{a()}),(b,l)=>{const y=pe("router-link");return s(),r(J,null,[D(ke,{isLoading:f.value},null,8,["isLoading"]),e("div",nn,[D(Qe),e("div",un,[t.value?(s(),r("div",cn,[e("div",dn,[e("div",pn,[t.value.photo_url?(s(),r("img",{key:0,src:t.value.photo_url,alt:"Photo du commerçant",class:"w-full h-full object-cover"},null,8,vn)):(s(),r("i",mn))]),e("div",fn,[e("h1",gn," Commerçant : "+m(t.value.nom),1),e("p",xn,[l[2]||(l[2]=e("strong",null,"Ville :",-1)),C(" "+m(t.value.ville),1)]),e("p",bn,[l[3]||(l[3]=e("strong",null,"Inscrit depuis :",-1)),C(" "+m(new Date(t.value.created_at).toLocaleDateString()),1)]),e("p",hn,[l[4]||(l[4]=e("strong",null,"Contact :",-1)),C(" "+m(t.value.email||"Non disponible"),1)]),t.value.telephone?(s(),r("p",yn,[l[5]||(l[5]=e("strong",null,"Téléphone :",-1)),C(" "+m(t.value.telephone),1)])):A("",!0),e("div",_n,[e("div",{class:"flex items-center space-x-1 cursor-pointer",onClick:P},[(s(),r(J,null,X(5,$=>e("span",{key:$,class:"relative text-yellow-400 w-5 h-5"},[l[6]||(l[6]=e("i",{class:"far fa-star absolute left-0 top-0"},null,-1)),e("i",{class:"fas fa-star absolute left-0 top-0 overflow-hidden",style:de({width:$<=Math.floor(n.value)?"100%":$===Math.ceil(n.value)&&n.value%1!==0?`${n.value%1*100}%`:"0%"})},null,4)])),64)),e("p",wn,m(Number(n.value).toFixed(1))+"/5 ",1)]),e("span",kn,"("+m(v.value)+" votes)",1)])])]),e("div",$n,[D(y,{to:`/chat/${t.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:K(()=>l[7]||(l[7]=[e("i",{class:"fas fa-comment mr-2"},null,-1),C(" Envoyer un message ")])),_:1,__:[7]},8,["to"]),D(y,{to:`/public-profile/${t.value.user_id||t.value.id}`,class:"inline-flex items-center px-4 py-2 border-2 border-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-blanc)] transition-colors duration-200"},{default:K(()=>l[8]||(l[8]=[e("i",{class:"fas fa-user mr-2"},null,-1),C(" Voir Profil Public ")])),_:1,__:[8]},8,["to"])]),e("div",Cn,[e("span",An,"Produits : "+m(w.value.length),1),t.value.revenus?(s(),r("span",Pn,"Revenus : "+m(t.value.revenus)+" FCFA",1)):A("",!0)])])):f.value?A("",!0):(s(),r("div",Sn,"Commerçant non trouvé.")),u.value?(s(),r("div",jn,[e("div",Vn,[l[9]||(l[9]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Noter ce Commerçant",-1)),e("div",Mn,[N(e("input",{"onUpdate:modelValue":l[0]||(l[0]=$=>c.value=$),type:"number",min:"1",max:"5",step:"1",class:"w-16 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"1-5"},null,512),[[B,c.value,void 0,{number:!0}]]),e("button",{onClick:x,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Soumettre "),e("button",{onClick:l[1]||(l[1]=$=>u.value=!1),class:"bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors ml-2"}," Annuler ")])])])):A("",!0),f.value?(s(),r("div",zn)):w.value.length>0?(s(),r("div",En,[l[10]||(l[10]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-6"},"Produits du Commerçant",-1)),e("div",In,[(s(!0),r(J,null,X(w.value,$=>(s(),ie(Le,{key:$.id,produit:$},null,8,["produit"]))),128))])])):t.value&&w.value.length===0?(s(),r("div",Ln,"Aucun produit disponible pour ce commerçant.")):A("",!0),t.value&&t.value.statistiques?(s(),r("div",Tn,[l[13]||(l[13]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Statistiques",-1)),e("div",Fn,[e("p",Rn,[l[11]||(l[11]=e("strong",null,"Vues totales :",-1)),C(" "+m(t.value.statistiques.total_views),1)]),e("p",Dn,[l[12]||(l[12]=e("strong",null,"Produits populaires :",-1)),C(" "+m(t.value.statistiques.popular_products),1)])])])):A("",!0)])])],64)}}}),yu=ee(Nn,[["__scopeId","data-v-e97faea3"]]),Un={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},On={class:"container mx-auto max-w-2xl"},qn={class:"bg-white rounded-lg shadow-md p-6"},Jn={key:0,class:"text-red-500 text-xs"},Wn={key:0,class:"text-red-500 text-xs"},Hn={key:0,class:"text-red-500 text-xs"},Bn={key:0,class:"text-red-500 text-xs"},Xn={key:0,class:"text-red-500 text-xs"},Gn=["disabled"],Kn={key:0},Qn={key:1},Zn=Y({__name:"CommercantCreate",setup(z){const o=ue(),h=se(),f=g({nom:"",ville:"",email:"",telephone:"",photo:null}),t=g(!1),c=g({}),n=u=>{const a=u.target;a.files&&a.files[0]&&(f.value.photo=a.files[0])},v=async()=>{var u,a;t.value=!0,c.value={};try{const x=new FormData;x.append("nom",f.value.nom),x.append("ville",f.value.ville),x.append("email",f.value.email),x.append("telephone",f.value.telephone),f.value.photo&&x.append("photo",f.value.photo);const w=await F.post("/commercants",x,{headers:{"Content-Type":"multipart/form-data"}});console.log(w.data.message),h.success("Commerçant créé avec succès !"),o.push("/profil")}catch(x){(a=(u=x.response)==null?void 0:u.data)!=null&&a.errors?c.value=x.response.data.errors:h.error("Erreur lors de la création du commerçant"),console.error(x)}finally{t.value=!1}};return(u,a)=>(s(),r("div",Un,[e("div",On,[a[11]||(a[11]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-store mr-2 text-[var(--espace-or)]"}),C(" Créer un Commerçant ")],-1)),e("div",qn,[e("form",{onSubmit:oe(v,["prevent"]),class:"space-y-6"},[e("div",null,[a[4]||(a[4]=e("label",{for:"nom",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom *",-1)),N(e("input",{"onUpdate:modelValue":a[0]||(a[0]=x=>f.value.nom=x),id:"nom",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerçant",required:""},null,512),[[B,f.value.nom]]),c.value.nom?(s(),r("span",Jn,m(c.value.nom),1)):A("",!0)]),e("div",null,[a[5]||(a[5]=e("label",{for:"ville",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Ville *",-1)),N(e("input",{"onUpdate:modelValue":a[1]||(a[1]=x=>f.value.ville=x),id:"ville",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville",required:""},null,512),[[B,f.value.ville]]),c.value.ville?(s(),r("span",Wn,m(c.value.ville),1)):A("",!0)]),e("div",null,[a[6]||(a[6]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),N(e("input",{"onUpdate:modelValue":a[2]||(a[2]=x=>f.value.email=x),id:"email",type:"email",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"email@exemple.com"},null,512),[[B,f.value.email]]),c.value.email?(s(),r("span",Hn,m(c.value.email),1)):A("",!0)]),e("div",null,[a[7]||(a[7]=e("label",{for:"telephone",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Téléphone",-1)),N(e("input",{"onUpdate:modelValue":a[3]||(a[3]=x=>f.value.telephone=x),id:"telephone",type:"tel",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"+237 6XX XX XX XX"},null,512),[[B,f.value.telephone]]),c.value.telephone?(s(),r("span",Bn,m(c.value.telephone),1)):A("",!0)]),e("div",null,[a[8]||(a[8]=e("label",{for:"photo",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Photo (optionnel)",-1)),e("input",{id:"photo",type:"file",onChange:n,class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",accept:"image/*"},null,32),c.value.photo?(s(),r("span",Xn,m(c.value.photo),1)):A("",!0)]),e("div",null,[e("button",{type:"submit",disabled:t.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition disabled:opacity-50"},[t.value?(s(),r("span",Kn,a[9]||(a[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),C(" Création en cours... ")]))):(s(),r("span",Qn,a[10]||(a[10]=[e("i",{class:"fas fa-plus mr-2"},null,-1),C(" Créer le commerçant ")])))],8,Gn)])],32)])])]))}}),_u=ee(Zn,[["__scopeId","data-v-0c50a6f0"]]),Yn={class:"overflow-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},ei={class:"container mx-auto max-w-4xl"},ti={class:"text-md font-semibold text-white flex items-center"},si={class:"ml-2 text-sm text-white/80"},oi={class:"text-white/90 text-sm mt-2"},ai={key:0,class:"text-white/90 text-sm mt-1"},ri={class:"list-disc list-inside ml-4"},li=Y({__name:"ParrainageInfo",setup(z){const o=ue(),h=se(),f=g([]),t=async()=>{try{const n=await F.get("/parrainages/niveaux");f.value=n.data.niveaux}catch(n){h.error("Erreur lors de la récupération des niveaux de parrainage"),console.error(n)}},c=()=>{o.go(-1)};return le(()=>{t()}),(n,v)=>(s(),r("div",Yn,[e("div",ei,[v[4]||(v[4]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-info-circle mr-2 text-[var(--espace-or)]"}),C(" Tout Savoir sur le Parrainage ")],-1)),e("button",{onClick:c,class:"mb-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},v[0]||(v[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),C(" Retour ")])),v[5]||(v[5]=Me('<div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-9d89fe08><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-9d89fe08>Qu&#39;est-ce que le Parrainage ?</h2><p class="text-[var(--espace-gris)] text-sm sm:text-base" data-v-9d89fe08> Le système de parrainage d&#39;Espace Cameroun vous permet d&#39;inviter des amis avec votre code ou lien unique. Vos gains dépendent des <strong data-v-9d89fe08>niveaux de parrainage</strong>, débloqués par le nombre de commerçants parrainés, avec des bonus en jetons cumulatifs. Plus vous parrainez, plus vous montez de niveau ! Découvrez les détails ci-dessous. </p></div><div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-9d89fe08><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-9d89fe08>Comment ça fonctionne ?</h2><ol class="list-decimal list-inside text-[var(--espace-gris)] text-sm sm:text-base space-y-2" data-v-9d89fe08><li data-v-9d89fe08><strong data-v-9d89fe08>Obtenez votre code unique :</strong> Générez ou créez votre code de parrainage via la page &quot;Mon Parrainage&quot;.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Partagez avec vos amis :</strong> Diffusez votre lien ou code via WhatsApp, Facebook ou d&#39;autres moyens pour inviter des amis à s&#39;inscrire.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Attirez des commerçants :</strong> Encouragez vos filleuls à devenir des commerçants actifs sur la plateforme. Seuls les commerçants parrainés comptent pour débloquer les niveaux.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Montez de niveau :</strong> Chaque niveau nécessite un nombre spécifique de commerçants parrainés. Une fois le seuil atteint, vous débloquez un bonus en jetons correspondant à ce niveau, en plus des bonus des niveaux précédents.</li><li data-v-9d89fe08><strong data-v-9d89fe08>Suivez vos progrès :</strong> Consultez votre niveau actuel, vos jetons bonus et vos avantages exclusifs sur la page &quot;Mon Parrainage&quot;.</li></ol><p class="text-[var(--espace-gris)] text-sm mt-4" data-v-9d89fe08><strong data-v-9d89fe08>Note importante :</strong> Les jetons bonus sont cumulatifs et attribués en fonction des niveaux atteints, pas directement par parrainage individuel. Par exemple, si vous atteignez le niveau 2 avec 5 commerçants, vous recevez les bonus des niveaux 1 et 2. </p></div>',2)),(s(!0),r(J,null,X(f.value,u=>(s(),r("div",{key:u.id,class:"mb-6 p-4 border rounded-lg",style:de({backgroundColor:u.couleur||"#f0f0f0"})},[e("h3",ti,[C(m(u.nom)+" "+m(u.emoji)+" ",1),e("span",si,"("+m(u.filleuls_requis)+" commerçants requis)",1)]),e("p",oi,[v[1]||(v[1]=e("strong",null,"Bonus en jetons :",-1)),C(" "+m(u.jetons_bonus)+" jetons ",1)]),u.avantages.length?(s(),r("p",ai,[v[2]||(v[2]=e("strong",null,"Avantages exclusifs :",-1)),e("ul",ri,[(s(!0),r(J,null,X(u.avantages,a=>(s(),r("li",{key:a},m(a),1))),128))])])):A("",!0),v[3]||(v[3]=e("p",{class:"text-white/70 text-xs mt-1 italic"}," * Les jetons bonus sont crédités une fois le niveau atteint et cumulés avec les niveaux précédents. ",-1))],4))),128))])]))}}),wu=ee(li,[["__scopeId","data-v-9d89fe08"]]),ni={class:"w-full flex relative px-0"},ii=["onClick"],ui={class:"flex items-center"},ci=["onClick"],di=["src"],pi={class:"min-w-0"},vi={class:"font-semibold text-[var(--espace-vert)] truncate"},mi={class:"text-xs text-[var(--espace-gris)] truncate"},fi={class:"flex items-center"},gi={key:0,class:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center mr-2"},xi={class:"text-xs text-[var(--espace-gris)] ml-2 whitespace-nowrap"},bi={class:"w-full grid grid-rows-[10%_86%]"},hi={class:"flex border-b"},yi={key:1,class:"text-xl h-[10%] font-semibold text-[var(--espace-vert)] p-4"},_i={key:0,class:"h-full flex flex-col"},wi={class:"block text-[var(--espace-vert)]"},ki={class:"text-gray-800"},$i={class:"text-xs text-[var(--espace-gris)] text-right mr-2"},Ci={key:0,class:"text-center text-[var(--espace-gris)]"},Ai={class:"px-2 md:px-4 z-20"},Pi={class:"bg-white shadow-lg rounded-full flex items-center flex-wrap p-2 border max-w-3xl mx-auto gap-2"},Si={key:0,class:"bg-yellow-200 text-yellow-800 text-xs px-3 py-1 rounded-full flex items-center gap-2 ml-4"},ji={key:1,class:"flex items-center justify-center h-full"},Vi=Y({__name:"Messages",setup(z){const o=ue(),h=_e(),f=re(),t=se(),c=ze(),n=g([]),v=g([]),u=g(null),a=g(""),x=g(!0),w=g(0),P=g(!1),b=g(!1),l=g(null),y=g(null),$=g(window.innerWidth<768),L=()=>{Re(()=>{var p;(p=l.value)==null||p.scrollTo({top:l.value.scrollHeight,behavior:"smooth"})})},M=()=>{y.value=null,localStorage.removeItem("chatProduct")},V=async()=>{try{const p=await F.get("/conversations");n.value=p.data.conversations}catch(p){t.error("Erreur lors de la récupération des conversations"),console.error(p)}},k=async(p,S=!0)=>{var E,R,Q;if(!b.value){b.value=!0;try{S&&(w.value=0,v.value=[]),x.value=!1;const q=await F.get(`/chat/${p}?offset=${w.value}`);v.value=[...q.data.messages],console.log(q.data),P.value=q.data.hasMore;const T=localStorage.getItem("chatProduct"),_=n.value.find(ae=>ae.user_id===p);let Z="",G="/default-avatar.png";_?(Z=_.is_commercant?_.name:((E=q.data.user)==null?void 0:E.nom)||"",G=_.profile_photo):T?(Z=JSON.parse(T).commercant_name||((R=q.data.user)==null?void 0:R.nom)||"",G=(_==null?void 0:_.profile_photo)||"/default-avatar.png"):Z=((Q=q.data.user)==null?void 0:Q.nom)||"",u.value={user_id:p,name:Z,is_commercant:(_==null?void 0:_.is_commercant)||!1,profile_photo:G},T&&(y.value=JSON.parse(T)),await W(p),L()}catch(q){t.error("Erreur lors du chargement des messages"),console.error(q)}finally{b.value=!1}}},U=p=>{o.push({name:"messages",params:{receiverId:p}}),$.value&&(x.value=!1)},O=async()=>{var E,R,Q,q,T,_,Z,G,ae,fe;if(!a.value.trim()||!u.value){t.error("Veuillez sélectionner une conversation et écrire un message");return}const p=a.value.trim(),S={id:-Date.now(),sender_id:(E=f.user)==null?void 0:E.id,receiver_id:u.value.user_id,content:p,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_read:!1,product_id:((R=y.value)==null?void 0:R.id)||null,sender:{id:((Q=f.user)==null?void 0:Q.id)??0,nom:((q=f.user)==null?void 0:q.nom)??"",email:((T=f.user)==null?void 0:T.email)??"",telephone:((_=f.user)==null?void 0:_.telephone)??"",ville:((Z=f.user)==null?void 0:Z.ville)??"",premium:((G=f.user)==null?void 0:G.premium)??!1,parrain_id:((ae=f.user)==null?void 0:ae.parrain_id)??0},receiver:{id:u.value.user_id,nom:u.value.name,email:null,telephone:null,ville:null,premium:!1,parrain_id:null},product:y.value||null};v.value.push(S),a.value="",L();try{const ve=await F.post(`/chat/${u.value.user_id}`,{content:p,product_id:(fe=y.value)==null?void 0:fe.id});console.log(ve.data),y.value&&M()}catch(ve){t.error("Échec d'envoi"),console.error(ve),v.value=v.value.filter(ge=>ge.id!==S.id)}},I=()=>{!l.value||!P.value||b.value||l.value.scrollTop<=100&&(w.value+=30,k(u.value.user_id,!1))},te=()=>{$.value=window.innerWidth<768,x.value=window.innerWidth>=768},W=async p=>{try{const S=await F.put("/messages/mark-all-as-read");c.saveUnreadMessagesToLocalStorage(S.data.unread_messages)}catch(S){console.error("Erreur lors du marquage des messages comme lus:",S),t.error("Erreur lors de la mise à jour des messages lus")}},d=()=>{x.value=!x.value},i=(p,S)=>{const E=S?`/commercants/${p}`:`/users/${p}`;o.push(E)};return le(()=>{V(),h.params.receiverId&&k(parseInt(h.params.receiverId)),window.addEventListener("resize",te)}),we(()=>{window.removeEventListener("resize",te)}),ne(()=>h.params.receiverId,async p=>{p&&await k(parseInt(p))}),(p,S)=>{var R,Q;const E=pe("router-link");return s(),r("div",ni,[D(me,{name:"slide-fade"},{default:K(()=>[x.value||!$.value?(s(),r("div",{key:0,class:H(["bg-white pt-8 shadow-md p-4 overflow-y-auto transition-all",$.value?"absolute top-0 left-0 h-full z-30 w-full":"w-[400px]"])},[S[1]||(S[1]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Conversations",-1)),(s(!0),r(J,null,X(n.value,q=>(s(),r("div",{key:q.user_id,onClick:T=>U(q.user_id),class:"p-2 hover:bg-gray-100 cursor-pointer rounded flex items-center justify-between transition-colors"},[e("div",ui,[e("div",{onClick:oe(T=>i(q.user_id,q.is_commercant),["stop"]),class:"w-10 h-10 bg-[var(--espace-or)] rounded-full mr-2 flex items-center justify-center overflow-hidden cursor-pointer"},[e("img",{src:q.profile_photo,alt:"Photo de profil",class:"w-full h-full object-cover"},null,8,di)],8,ci),e("div",pi,[e("p",vi,m(q.name),1),e("p",mi,m(q.last_message),1)])]),e("div",fi,[q.unread_count>0?(s(),r("div",gi,m(q.unread_count),1)):A("",!0),e("div",xi,m(new Date(q.updated_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)])],8,ii))),128))],2)):A("",!0)]),_:1}),e("div",bi,[e("div",hi,[!x.value&&$.value&&u.value?(s(),r("button",{key:0,onClick:d,class:"text-green-900 p-2 rounded-full hover:bg-[var(--espace-or)] transition text-start"},S[2]||(S[2]=[e("i",{class:"fas fa-arrow-left text-2xl"},null,-1)]))):A("",!0),u.value?(s(),r("h2",yi,m(u.value.name),1)):A("",!0)]),e("div",{class:H(["bg-white shadow-md transition-all duration-300 flex flex-col flex-1 h-full overflow-hidden w-full",x.value&&!$.value?"":"rounded-r-lg"]),onScroll:I},[u.value?(s(),r("div",_i,[e("div",{ref_key:"messagesContainer",ref:l,class:"h-full flex-1 overflow-y-auto p-2 md:p-4 space-y-3 bg-gray-50 messages-container"},[(s(!0),r(J,null,X(v.value,q=>{var T,_,Z;return s(),r("div",{key:q.id,class:H(["p-3 rounded-full break-words",{"bg-blue-200 ml-auto max-w-[85%] md:max-w-[70%]":q.sender_id===((T=j(f).user)==null?void 0:T.id),"bg-gray-200 max-w-[85%] md:max-w-[70%]":q.sender_id!==((_=j(f).user)==null?void 0:_.id)}])},[e("strong",wi,m(q.sender.nom)+" :",1),e("p",ki,[(Z=q.product)!=null&&Z.id?(s(),ie(E,{key:0,to:{name:"produit",params:{id:q.product.id}},class:"text-blue-500 underline hover:text-blue-700 ml-1"},{default:K(()=>[C("[Produit "+m(q.product.nom)+"]",1)]),_:2},1032,["to"])):A("",!0),C(" "+m(q.content),1)]),e("p",$i,m(new Date(q.created_at).toLocaleTimeString()),1)],2)}),128)),b.value?(s(),r("div",Ci,"Chargement...")):A("",!0)],512),e("div",Ai,[e("div",Pi,[(R=y.value)!=null&&R.id?(s(),r("span",Si,[C(" Produit "+m((Q=y.value)==null?void 0:Q.nom)+" ",1),e("button",{onClick:M,class:"ml-2 text-yellow-800 hover:text-red-600 font-bold",title:"Retirer le tag"}," × ")])):A("",!0),N(e("input",{"onUpdate:modelValue":S[0]||(S[0]=q=>a.value=q),onKeyup:Fe(O,["enter"]),type:"text",placeholder:"Écrivez votre message...",class:"flex-1 px-4 py-2 rounded-full focus:outline-none text-gray-700 text-sm placeholder-gray-400 min-w-[100px] md:min-w[200px]"},null,544),[[B,a.value]]),e("button",{onClick:O,class:"ml-2 p-3 rounded-full bg-[var(--espace-vert)] text-white hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},S[3]||(S[3]=[e("i",{class:"fas fa-location-arrow text-lg"},null,-1)]))])])])):(s(),r("div",ji,S[4]||(S[4]=[e("p",{class:"text-[var(--espace-gris)] text-lg"},"Sélectionnez une conversation pour commencer.",-1)])))],34)])])}}}),ku=ee(Vi,[["__scopeId","data-v-caa700a1"]]),Mi={class:"mx-auto max-w-4xl py-5 px-4 flex flex-col gap-3"},zi={key:0,class:"overflow-y-scroll space-y-4"},Ei={class:"flex justify-between items-center"},Ii={class:"text-lg font-semibold"},Li={class:"text-gray-600"},Ti={class:"text-gray-600"},Fi={class:"text-gray-600"},Ri={class:"text-gray-600"},Di={class:"text-gray-600"},Ni={key:0,class:"text-gray-600"},Ui={class:"text-right"},Oi=["onClick"],qi={key:1,class:"text-gray-500"},Ji={class:"mt-6 flex gap-4"},Wi={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Hi=Y({__name:"JetonHistory",setup(z){const h=re().user,f=g([]),t=g(!1),c=se(),n=async()=>{try{const a=await F.get(`/jeton-transactions/${h==null?void 0:h.id}`);console.log(a.data),f.value=a.data}catch(a){console.error("Erreur lors du chargement des transactions:",a)}},v=a=>new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=async a=>{var x,w;if(console.log("Refaire la transaction:",a),!!confirm(`Refaire l'achat de ${a.nombre_jetons} jetons avec le même service (${a.methode_paiement}) ?`)){t.value=!0;try{const P=await F.post("/acheter-jetons",{nombre_jetons:a.nombre_jetons,payment_service:a.methode_paiement,phone_number:a.phone_number});c.success(P.data.message),n()}catch(P){c.error(((w=(x=P.response)==null?void 0:x.data)==null?void 0:w.message)||"Erreur lors de l'achat."),console.error(P)}finally{t.value=!1}}};return le(()=>{h&&n()}),(a,x)=>{const w=pe("router-link");return s(),r("div",Mi,[x[4]||(x[4]=e("h1",{class:"text-3xl font-bold text-[var(--espace-vert)]"},"Historique des Transactions de Jetons",-1)),f.value.length>0?(s(),r("div",zi,[(s(!0),r(J,null,X(f.value,P=>(s(),r("div",{key:P.id,class:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow"},[e("div",Ei,[e("div",null,[e("p",Ii,"Achat de "+m(P.nombre_jetons)+" jetons",1),e("p",Li,"Montant: "+m(P.montant)+" FCFA",1),e("p",Ti,"Méthode: "+m(P.methode_paiement),1),e("p",Fi,"Numéro: "+m(P.phone_number),1),e("p",Ri,"Statut: "+m(P.statut),1),e("p",Di,"Date: "+m(v(P.date_transaction)),1),P.transaction_id_mesomb?(s(),r("p",Ni," ID Transaction: "+m(P.transaction_id_mesomb),1)):A("",!0)]),e("div",Ui,[e("button",{onClick:b=>u(P),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] mr-2"},x[0]||(x[0]=[e("i",{class:"fas fa-redo"},null,-1),C(" Refaire ")]),8,Oi)])])]))),128))])):(s(),r("p",qi,"Aucune transaction trouvée.")),e("div",Ji,[D(w,{to:"/acheter-jetons",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:K(()=>x[1]||(x[1]=[C(" Acheter des Jetons ")])),_:1,__:[1]}),D(w,{to:"/commercant/produits",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:K(()=>x[2]||(x[2]=[C(" Booster un Produit ")])),_:1,__:[2]})]),t.value?(s(),r("div",Wi,x[3]||(x[3]=[Me('<div class="bg-white p-6 rounded-lg shadow-lg text-center" data-v-4d0a432e><p class="text-lg text-[var(--espace-vert)]" data-v-4d0a432e>Veuillez patienter...</p><svg class="animate-spin h-8 w-8 text-[var(--espace-vert)] mx-auto mt-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-4d0a432e><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-4d0a432e></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" data-v-4d0a432e></path></svg></div>',1)]))):A("",!0)])}}}),$u=ee(Hi,[["__scopeId","data-v-4d0a432e"]]),Bi={class:"min-h-screen bg-gray-100 py-8 sm:px-6"},Xi={class:"container mx-auto max-w-3xl bg-white rounded-lg shadow-md p-6"},Gi={class:"flex flex-col sm:flex-row items-center gap-6 mb-6"},Ki={class:"relative"},Qi=["src"],Zi={key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-xl p-1 rounded-full"},Yi={class:"flex-1"},eu={class:"text-gray-600"},tu={key:0,class:"text-sm text-gray-500"},su={class:"text-gray-600"},ou={class:"text-gray-600"},au=Y({__name:"ProfilePublic",setup(z){const o=_e(),h=ue(),f=se(),t=g(null),c=async()=>{try{const v=await F.get(`/profile/public/${o.params.id}`);t.value=v.data}catch(v){f.error("Erreur lors de la récupération du profil."),console.error(v)}},n=()=>{var v;(v=t.value)!=null&&v.id?h.push({name:"messages",params:{receiverId:t.value.id}}):f.error("Impossible d'accéder au chat. Profil invalide.")};return le(()=>{c()}),(v,u)=>{var a,x,w,P,b,l,y,$,L,M,V,k,U,O,I,te,W,d,i,p,S,E;return s(),r("div",Bi,[e("div",Xi,[e("div",Gi,[e("div",Ki,[(a=t.value)!=null&&a.photo?(s(),r("img",{key:0,src:`http://localhost:8000/storage/${(x=t.value)==null?void 0:x.photo}`,alt:"Photo de profil",class:"w-24 h-24 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,Qi)):(s(),r("div",{key:1,class:"w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",style:de({background:`${((l=(b=(P=(w=t.value)==null?void 0:w.niveaux_users)==null?void 0:P.at(-1))==null?void 0:b.parrainage_niveau)==null?void 0:l.couleur)||"#0af"}`})},u[0]||(u[0]=[e("i",{class:"fas fa-user-circle text-5xl"},null,-1)]),4)),(y=t.value)!=null&&y.premium?(s(),r("i",Zi)):A("",!0)]),e("div",Yi,[e("h1",{class:"text-3xl font-bold flex items-center gap-2",style:de({color:`${((V=(M=(L=($=t.value)==null?void 0:$.niveaux_users)==null?void 0:L.at(-1))==null?void 0:M.parrainage_niveau)==null?void 0:V.couleur)||"#0af"}`})},[C(m((k=t.value)==null?void 0:k.nom)+" ",1),(U=t.value)!=null&&U.premium?(s(),r("span",{key:0,class:"text-white text-sm px-2 py-1 rounded-full uppercase font-semibold",style:de({background:`${((W=(te=(I=(O=t.value)==null?void 0:O.niveaux_users)==null?void 0:I.at(-1))==null?void 0:te.parrainage_niveau)==null?void 0:W.couleur)||"#0af"}`})}," Premium ",4)):A("",!0)],4),e("p",eu,"Statut : "+m((d=t.value)!=null&&d.commercant?"Commerçant":"Utilisateur"),1),(i=t.value)!=null&&i.subscription_ends_at?(s(),r("p",tu," Abonnement Premium jusqu'au "+m(new Date((p=t.value)==null?void 0:p.subscription_ends_at).toLocaleDateString()),1)):A("",!0),e("p",su,"Ville : "+m((S=t.value)==null?void 0:S.ville),1),e("p",ou,"Téléphone : "+m((E=t.value)==null?void 0:E.telephone),1)]),e("div",{class:"mt-6 flex justify-center"},[e("button",{onClick:n,class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},u[1]||(u[1]=[e("i",{class:"fas fa-comments mr-2"},null,-1),C(" Discuter ")]))])]),u[2]||(u[2]=e("div",{class:"mt-6 text-center"},[e("p",{class:"text-gray-700"},"Ce profil affiche les informations publiques de l'utilisateur.")],-1))])])}}}),Cu=ee(au,[["__scopeId","data-v-eef19e07"]]);export{Xs as A,du as C,uu as F,iu as H,$u as J,cu as L,ku as M,vu as P,pu as R,fu as a,yu as b,_u as c,xu as d,mu as e,bu as f,wu as g,gu as h,hu as i,Cu as j,re as u};
