import{r as x,u as K,d as G,a as se,w as te,o as ae,b as ne,c as o,e as k,f as w,g as s,h as e,i as L,j as N,k as h,t as v,l as Pe,m as de,n as fe,F as R,p as q,q as Y,s as D,v as O,x as W,y as Le,z as Ve,T as ie,A as Q,B as ue,C as pe,D as Fe,E as Ce,G as Te,H as Ne,I as Re}from"./vue-DTxKeDEm.js";import{d as Me,g as We}from"./pinia-B4G5yhrU.js";import{a as Je}from"./axios-Dq7h7Pqt.js";const F=Je.create({baseURL:"http://localhost:8000/api/v1",headers:{Accept:"application/json","Content-Type":"application/json"}});F.interceptors.request.use(S=>{const t=localStorage.getItem("token");return console.log(t),t&&(S.headers.Authorization=t),S});const ve=Me("product",{state:()=>({product:{},products:[],isLoading:!1,hasMore:!0,page:1,sort:"random",userId:null,relatedProducts:[]}),actions:{async fetchProducts(S={},t=!1){var m,p;if(!(this.isLoading||!t&&!this.hasMore)){this.isLoading=!0,t&&(this.products=[],this.page=1,this.hasMore=!0);try{const l=await F.get("/produits",{params:{...S,page:this.page,sort:this.sort}});if(console.log(l.data.data),console.log(l.data),S.per_page==="all")this.products=t?l.data:[...this.products,...l.data];else{const n=l.data.data;this.products=t?n:[...this.products,...n],this.hasMore=l.data.current_page<l.data.last_page,this.page=l.data.current_page+1}}catch(l){throw((p=(m=l.response)==null?void 0:m.data)==null?void 0:p.message)||"Erreur lors du chargement des produits"}finally{this.isLoading=!1}}},async toggleFavorite(S){var t,m;try{const p=this.products.find(n=>n.id===S);return p&&(p.is_favorited_by=!p.is_favorited_by,p.favorites_count=p.is_favorited_by?p.favorites_count+1:p.favorites_count-1),this.product&&this.product.id===S&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.favorites_count=this.product.is_favorited_by?this.product.favorites_count+1:this.product.favorites_count-1),(await F.post(`/produits/${S}/favorite`)).data.message}catch(p){throw((m=(t=p.response)==null?void 0:t.data)==null?void 0:m.message)||"Erreur lors de la mise Ã  jour des favoris"}},async viewProduct(S){var t,m;try{console.log("jjj");const p=await F.get(`/produits/${S}`);this.product=p.data.produit;const l=this.products.findIndex(n=>n.id===S);l!==-1?this.products[l]={...this.products[l],...this.product}:this.products.push(this.product)}catch(p){throw((m=(t=p.response)==null?void 0:t.data)==null?void 0:m.message)||"Erreur lors du chargement du produit"}},setSort(S){this.sort=S,this.page=1,this.products=[],this.hasMore=!0,this.fetchProducts({},!0)},setUserId(S){this.userId=S}}}),He=()=>{if(!We())throw new Error("Pinia nâ€™est pas encore actif");return ve()},oe=Me("auth",{state:()=>{const S=localStorage.getItem("user"),t=S&&S!=="undefined"?JSON.parse(S):null,m=localStorage.getItem("token")||null;return{user:t,token:m}},actions:{async login(S){const t=await F.post("/login",S);this.user=t.data.user,this.token=t.data.token,this.token&&localStorage.setItem("token",this.token),this.user&&localStorage.setItem("user",JSON.stringify(this.user))},async register(S){const t=await F.post("/register",{nom:S.nom,telephone:S.telephone,email:S.email||null,ville:S.ville,mot_de_passe:S.mot_de_passe,parrain_id:S.parrain_id||null});this.user=t.data.user,this.token=t.data.token,this.token&&localStorage.setItem("token",this.token),this.user&&localStorage.setItem("user",JSON.stringify(this.user))},async checkAuth(){if(!this.token)return this.logout(),!1;try{const S=await F.get("/user");return this.user=S.data.user,this.user&&(localStorage.setItem("user",JSON.stringify(this.user)),He().setUserId(this.user.id)),!0}catch{return this.logout(),!1}},async updateJetons(){const S=await F.get("/user");this.user=S.data.user},logout(){F.post("/logout").catch(()=>{}),this.token=null,localStorage.removeItem("user"),localStorage.removeItem("token")}}}),Oe="/assets/logoOrangeweb-C9Cko1mf.webp",Se=Me("userState",()=>{const S=x(0),t=x(0),m=K(),p=()=>{const a=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");S.value=a.length;const d=localStorage.getItem("unread_messages");t.value=d?parseInt(d,10):0},l=a=>{localStorage.setItem("pending_collaborations",JSON.stringify(a)),S.value=a.length},n=a=>{localStorage.setItem("unread_messages",a.toString()),t.value=a},i=async a=>{var P;const d=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");d.push({produit_id:a.produit_id,prix_revente:a.prix_revente,status:"pending",created_at:new Date().toISOString()}),l(d);try{return await F.post("/collaborations",{produit_id:a.produit_id,prix_revente:a.prix_revente}),await b(),m.success("Demande de collaboration envoyÃ©e !"),!0}catch(V){const E=d.filter(c=>!(c.produit_id===a.produit_id&&c.prix_revente===a.prix_revente));return l(E),m.error(((P=V.response)==null?void 0:P.data.message)||"Erreur lors de la demande de collaboration"),!1}},b=async()=>{try{const a=await F.get("/user/badges");S.value=a.data.collaborations_pending,console.log(a.data),n(a.data.unread_messages||0)}catch(a){console.error("Erreur lors de la synchronisation des badges:",a)}};return{collaborationsPending:S,unreadMessages:t,initializeState:p,addCollaboration:i,syncCollaborationsWithBackend:b,clearState:()=>{localStorage.removeItem("pending_collaborations"),localStorage.removeItem("unread_messages"),S.value=0,t.value=0},saveCollaborationsToLocalStorage:l,saveUnreadMessagesToLocalStorage:n}}),Be={key:0,class:"fixed top-14 right-4 z-50 flex items-center gap-2 rounded-full px-4 py-2"},Ge={class:"text-sm font-semibold text-[var(--espace-vert)]"},Xe={class:"text-gray-800"},Ke=G({__name:"SoldeUser",setup(S){se();const t=oe(),m=x(0),p=async()=>{if(t.user)try{m.value=t.user.jetons,console.log(m.value)}catch(l){console.error("Erreur lors de la rÃ©cupÃ©ration des jetons:",l)}};return te(()=>t.user,()=>{p()}),ae(()=>{p()}),(l,n)=>{const i=ne("router-link");return w(t).user?(s(),o("div",Be,[n[1]||(n[1]=e("i",{class:"fas fa-coins text-[var(--espace-or)] text-lg"},null,-1)),e("span",Ge,[L(i,{to:"/jeton-history"},{default:N(()=>[n[0]||(n[0]=h(" Jetons : ")),e("span",Xe,v(m.value),1)]),_:1,__:[0]})])])):k("",!0)}}}),X=(S,t)=>{const m=S.__vccOpts||S;for(const[p,l]of t)m[p]=l;return m},De=X(Ke,[["__scopeId","data-v-12adcefd"]]),Qe={class:"relative"},Ze={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] top-0 left-0 w-full z-50 shadow-md"},Ye={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},et={class:"flex items-center gap-1 sm:gap-3"},tt={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},st=["aria-label"],at={class:"flex items-center gap-2"},ot=["src"],rt={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},lt={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},nt=G({__name:"HeaderBar",setup(S){const t=oe(),m=Se();se();const p=t.user;Pe();const l=x(!1),n=x(!1),i=x(""),b=ve(),r=x(!1),a=x(null),d=x(!1),P=de(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...t.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},{to:"/messages",label:"Messages",icon:"fa-comment-dots",badge:m.unreadMessages},...t.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:m.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),V=async()=>{if(t.user)try{await m.syncCollaborationsWithBackend()}catch(y){console.error("Erreur lors du chargement des badges:",y)}};te(()=>t.user,y=>{y&&(V(),m.initializeState())},{immediate:!0}),te(()=>m.collaborationsPending,y=>{y>-1&&(l.value=!0,setTimeout(()=>l.value=!1,300))}),te(()=>m.unreadMessages,y=>{y>-1&&(n.value=!0,setTimeout(()=>n.value=!1,300))});const E=async()=>{if(i.value.trim())try{await b.fetchProducts({search:i.value.trim()},!0),i.value="",r.value=!1}catch(y){console.error("Erreur lors de la recherche:",y)}},c=y=>{if(d.value){d.value=!1;return}a.value&&!a.value.contains(y.target)&&(r.value=!1)},f=async()=>{r.value=!r.value,r.value&&(d.value=!0,await Ve())};return ae(()=>{t.user&&(V(),m.initializeState()),document.addEventListener("click",c)}),fe(()=>{document.removeEventListener("click",c)}),(y,T)=>{const M=ne("RouterLink");return s(),o("div",Qe,[e("header",Ze,[e("div",Ye,[e("div",et,[L(M,{to:"/","aria-label":"Retour Ã  l'accueil"},{default:N(()=>T[2]||(T[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Oe,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),T[3]||(T[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ",-1))]),e("nav",tt,[(s(!0),o(R,null,q(P.value,$=>(s(),Y(M,{key:$.to,to:$.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:D(["fas",$.icon])},null,2),h(" "+v($.label)+" ",1),$.badge>-1?(s(),o("span",{key:0,class:D(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":$.to==="/collaborations"&&l.value||$.to==="/messages"&&n.value}]),"aria-label":$.to==="/collaborations"?"Collaborations en attente":$.to==="/messages"?"Messages non lus":""},v($.badge),11,st)):k("",!0)]),_:2},1032,["to"]))),128))]),L(De),e("div",at,[w(p)?(s(),o("button",{key:0,onClick:f,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},T[4]||(T[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)]))):k("",!0),w(t).user?(s(),Y(M,{key:1,to:"/profil",class:"relative flex items-center justify-center","aria-label":"Profil"},{default:N(()=>{var $;return[($=w(p))!=null&&$.photo?(s(),o("img",{key:0,src:`http://localhost:8000/storage/${w(p).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,ot)):(s(),o("div",rt,T[5]||(T[5]=[e("i",{class:"fas fa-user-circle text-2xl text-gray-100"},null,-1)])))]}),_:1})):k("",!0),w(t).user?(s(),Y(M,{key:2,to:"/messages",class:"relative flex items-center justify-center","aria-label":"Messages"},{default:N(()=>[T[6]||(T[6]=e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},[e("i",{class:"fas fa-comment-dots text-2xl text-gray-100"})],-1)),w(m).unreadMessages>-1?(s(),o("span",{key:0,class:D(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":n.value}]),"aria-label":"Messages non lus"},v(w(m).unreadMessages),3)):k("",!0)]),_:1,__:[6]})):k("",!0)])]),r.value?(s(),o("div",{key:0,ref_key:"searchOverlayRef",ref:a,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",lt,[O(e("input",{"onUpdate:modelValue":T[0]||(T[0]=$=>i.value=$),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Le(E,["enter"])},null,544),[[W,i.value]]),e("button",{onClick:E,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},T[7]||(T[7]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:T[1]||(T[1]=$=>r.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},T[8]||(T[8]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):k("",!0)])])}}}),_i=X(nt,[["__scopeId","data-v-88fc8ffa"]]),it={class:"relative"},ut={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},dt={class:"flex justify-around items-center py-2"},ct=["aria-label"],pt=G({__name:"FooterBar",setup(S){const t=oe(),m=Se();se();const p=x(!1),l=x(!1),n=de(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...t.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...t.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:m.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0},{to:"/messages",label:"Messages",icon:"fa-comment-dots",badge:m.unreadMessages}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]);return te(()=>m.collaborationsPending,i=>{i>0&&(p.value=!0,setTimeout(()=>p.value=!1,300))}),te(()=>m.unreadMessages,i=>{i>0&&(l.value=!0,setTimeout(()=>l.value=!1,300))}),(i,b)=>{const r=ne("RouterLink");return s(),o("div",it,[L(ie,{name:"slide-up"},{default:N(()=>[e("nav",ut,[e("div",dt,[(s(!0),o(R,null,q(n.value,a=>(s(),Y(r,{key:a.to,to:a.to,"aria-label":a.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:D(["fas text-lg",a.icon])},null,2),a.badge>-1?(s(),o("span",{key:0,class:D(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":a.to==="/collaborations"&&p.value||a.to==="/messages"&&l.value}]),"aria-label":a.to==="/collaborations"?"Collaborations en attente":a.to==="/messages"?"Messages non lus":""},v(a.badge),11,ct)):k("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),wi=X(pt,[["__scopeId","data-v-24921963"]]),vt={class:"mb-4"},mt={class:"block text-sm sm:text-base font-medium mb-1 text-[var(--espace-gris)]"},ft={class:"relative"},gt={class:"absolute inset-y-0 left-3 flex items-center text-[var(--espace-or)]"},xt=["type","value","required","placeholder"],bt={key:0,class:"text-red-500 text-sm mt-1"},ee=G({__name:"Form",props:{label:String,icon:String,type:{type:String,default:"text"},modelValue:[String,Number],required:Boolean,placeholder:String,error:String},emits:["update:modelValue"],setup(S){return(t,m)=>(s(),o("div",vt,[e("label",mt,v(S.label),1),e("div",ft,[e("span",gt,[e("i",{class:D(`fas ${S.icon}`)},null,2)]),e("input",{type:S.type,value:S.modelValue,onInput:m[0]||(m[0]=p=>t.$emit("update:modelValue",p.target.value)),required:S.required,placeholder:S.placeholder,class:D(["w-full pl-10 pr-4 py-3 rounded-xl border text-sm sm:text-base transition","focus:outline-none focus:ring-2",S.error?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-[var(--espace-or)]"])},null,42,xt)]),S.error?(s(),o("p",bt,v(S.error),1)):k("",!0)]))}}),ht={class:"overflow-y-scroll bg-gray-100 flex items-center justify-center px-4 py-8"},yt={class:"w-full max-w-lg bg-[rgba(255,255,255,0.85)] rounded-2xl shadow-xl p-6 sm:p-10"},_t={class:"text-center text-sm text-gray-600 mt-6"},wt=G({__name:"Login",setup(S){const t=x({login:"",mot_de_passe:""}),m=x({}),p=se(),l=K(),n=oe(),i=async()=>{var b,r,a;try{await n.login({login:t.value.login,mot_de_passe:t.value.mot_de_passe}),l.success("Connexion rÃ©ussie !"),p.push(n.user.commercant?{name:"commercant"}:{name:"profil"})}catch(d){console.error("Erreur lors de la connexion:",d);const P=((r=(b=d.response)==null?void 0:b.data)==null?void 0:r.message)||"Erreur lors de la connexion. Veuillez vÃ©rifier vos informations.";l.error(P),((a=d.response)==null?void 0:a.status)===422&&(m.value=d.response.data.errors||{})}};return(b,r)=>{const a=ne("router-link");return s(),o("div",ht,[e("div",yt,[r[5]||(r[5]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-sign-in-alt mr-2 text-[var(--espace-or)]"}),h(" Connexion ")],-1)),r[6]||(r[6]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[h(" Connectez-vous Ã  "),e("strong",null,"Espace Cameroun"),h(" pour accÃ©der Ã  vos achats et votre espace commerÃ§ant. ")],-1)),e("form",{onSubmit:Q(i,["prevent"]),class:"space-y-5"},[L(ee,{label:"Email",icon:"fa-envelope",modelValue:t.value.login,"onUpdate:modelValue":r[0]||(r[0]=d=>t.value.login=d),type:"email",required:"",error:m.value.email},null,8,["modelValue","error"]),L(ee,{label:"Mot de passe",icon:"fa-lock",modelValue:t.value.mot_de_passe,"onUpdate:modelValue":r[1]||(r[1]=d=>t.value.mot_de_passe=d),type:"password",required:"",error:m.value.mot_de_passe},null,8,["modelValue","error"]),r[2]||(r[2]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-sign-in-alt mr-2"}),h(" Se connecter ")],-1))],32),e("p",_t,[r[4]||(r[4]=h(" Pas de compte ? ")),L(a,{to:"/register",class:"text-[var(--espace-vert)] font-medium hover:text-[var(--espace-or)] hover:underline"},{default:N(()=>r[3]||(r[3]=[h(" Inscrivez-vous ici ")])),_:1,__:[3]})])])])}}}),ki=X(wt,[["__scopeId","data-v-cc80bf6d"]]),kt="/assets/logo-ba4eAQQi.png",$t={key:0,class:"fixed inset-0 bg-[var(--espace-white)] bg-opacity-50 flex items-center justify-center z-50","aria-label":"Chargement en cours",role:"status"},At=G({__name:"Loader",props:{isLoading:{type:Boolean}},setup(S){return(t,m)=>(s(),Y(ie,{name:"fade"},{default:N(()=>[t.isLoading?(s(),o("div",$t,m[0]||(m[0]=[e("div",{class:"relative p-6"},[e("img",{src:kt,alt:"Logo Espace Cameroun",class:"h-12 w-12 object-contain animate-spin-pulse"}),e("div",{class:"absolute inset-0 rounded-full border-4 border-[var(--espace-or)] border-t-transparent animate-spin"})],-1)]))):k("",!0)]),_:1}))}}),ge=X(At,[["__scopeId","data-v-f60cc94a"]]),Ct={class:"h-full bg-gray-100 pt-5 px-4 sm:px-2"},Pt={class:"h-full w-full"},St={key:0},jt={key:1,class:"grid grid-cols-1 pt-4 pb-16 lg:pb-12 md:grid-cols-3 sm:grid-cols-2 overflow-y-scroll pt-4 h-full lg:grid-cols-4 gap-6"},Vt={class:"relative w-full h-40 overflow-hidden rounded-t-lg mb-2"},Mt=["src"],zt=["onClick"],Et=["onClick"],Ut={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},It={class:"p-2"},Lt={class:"text-lg font-semibold flex justify-between text-[var(--espace-vert)] truncate"},Ft=["onClick"],Tt={class:"text-sm text-[var(--espace-gris)] line-clamp-2"},Rt={class:"text-md font-bold text-[var(--espace-or)] mt-2"},Ot={class:"text-sm text-[var(--espace-gris)]"},Dt={class:"text-sm text-[var(--espace-gris)] mt-2"},qt={class:"ml-4"},Nt={class:"absolute bottom-5 right-2 flex gap-2"},Wt=["onClick"],Jt=["onClick"],Ht={key:2,class:"text-center text-[var(--espace-gris)]"},Bt={class:"bg-white rounded-lg p-6 sm:p-8 w-full max-w-md mx-4 shadow-lg"},Gt={class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},Xt={key:0,class:"mt-2 flex gap-2 flex-wrap"},Kt=["src"],Qt=["value"],Zt={key:0,class:"flex items-center gap-2"},Yt={key:1,class:"flex items-center gap-2"},es={class:"flex gap-4 pt-2"},ts={type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition"},ss=G({__name:"CommercantProduits",setup(S){const t=oe(),m=se(),p=K(),l=x(!1),n=x([]),i=x([]),b=x(!1),r=x(!1),a=x(null),d=x({}),P=x({nom:"",description:"",prix:0,stock:0,photos:[],category_id:"",collaboratif:!1,marge_min:0}),V=x([]),E=async()=>{l.value=!0;try{const U=await F.get("/commercant/produits");n.value=U.data.produits.map(A=>({...A,photo_url:A.photos&&A.photos.length>0?A.photos[0]:"https://via.placeholder.com/150"})),n.value.forEach(A=>{d.value[A.id]||(d.value[A.id]=0)})}catch{p.error("Erreur lors du chargement des produits")}finally{l.value=!1}},c=async()=>{l.value=!0;try{const U=await F.get("/categories");i.value=U.data.categories}catch{p.error("Erreur lors de la chargement des catÃ©gories")}finally{l.value=!1}},f=()=>{P.value={nom:"",description:"",prix:0,stock:0,photos:[],category_id:"",collaboratif:!1,marge_min:0},V.value=[],b.value=!0},y=U=>{a.value=U,P.value={nom:U.nom,description:U.description||"",prix:U.prix,stock:U.quantite,photos:[],category_id:U.category_id,collaboratif:!!U.collaboratif,marge_min:U.marge_min||0},console.log(P.value),V.value=U.photos||[],d.value[U.id]||(d.value[U.id]=0),r.value=!0},T=U=>{const A=U.target;if(A.files){const j=Array.from(A.files);P.value.photos=j,V.value=j.map(u=>URL.createObjectURL(u))}},M=async U=>{if(confirm("Voulez-vous vraiment supprimer ce produit ?")){l.value=!0;try{await F.delete(`/commercant/produits/${U}`),n.value=n.value.filter(A=>A.id!==U),delete d.value[U],p.success("Produit supprimÃ©")}catch{p.error("Erreur lors de la suppression")}finally{l.value=!1}}},$=async()=>{var A,j;l.value=!0;const U=new FormData;U.append("nom",P.value.nom),U.append("description",P.value.description),U.append("prix",P.value.prix.toString()),U.append("stock",P.value.stock.toString()),U.append("category_id",P.value.category_id),U.append("collaboratif",P.value.collaboratif?"1":"0"),P.value.marge_min!==null&&U.append("marge_min",P.value.marge_min.toString()),P.value.photos.forEach(u=>U.append("photos[]",u)),console.log(U),console.log(P.value);try{if(b.value){const u=await F.post("/commercant/produits",P.value,{headers:{"Content-Type":"multipart/form-data"}});console.log(u.data),p.success("Produit ajoutÃ© avec succÃ¨s")}else{console.log(P.value);const u=await F.post(`/commercant/produits/${(A=a.value)==null?void 0:A.id}`,U,{headers:{"Content-Type":"multipart/form-data"}});console.log(u.data),p.success("Produit modifiÃ© avec succÃ¨s")}await E(),g()}catch(u){p.error(((j=u.response)==null?void 0:j.data.message)||"Erreur lors de la sauvegarde du produit")}finally{l.value=!1}},g=()=>{b.value=!1,r.value=!1,a.value=null,V.value=[]},_=de(()=>U=>d.value[U]||0),C=U=>{var u;const A=n.value.find(z=>z.id===U),j=(u=A==null?void 0:A.photos)!=null&&u.length?A.photos.length-1:0;d.value[U]=Math.min((d.value[U]||0)+1,j)},J=U=>{d.value[U]=Math.max((d.value[U]||0)-1,0)};return ae(()=>{var U;if(!((U=t.user)!=null&&U.commercant)){p.error("AccÃ¨s rÃ©servÃ© aux commerÃ§ants"),m.push("/");return}E(),c()}),(U,A)=>{const j=ne("router-link");return s(),o(R,null,[L(ge,{isLoading:l.value},null,8,["isLoading"]),e("div",Ct,[e("div",Pt,[e("div",{class:"flex justify-between items-center"},[A[7]||(A[7]=e("h1",{class:"text-1xl md:text-2xl font-bold text-[var(--espace-vert)] text-md mb-2 font-poppins"},[e("i",{class:"fas fa-box-open mr-1 text-[var(--espace-or)] text-md!important"}),h(" Mes Produits ")],-1)),e("button",{onClick:f,class:"mb-2 md:text-xl text-[var(--espace-vert)] font-semibold px-2 py-1 rounded hover:bg-[var(--espace-vert)] hover:text-white transition inline-flex items-center"},A[6]||(A[6]=[e("i",{class:"fas fa-plus mr-2"},null,-1),h(" Ajouter un produit ")]))]),l.value?(s(),o("div",St,A[8]||(A[8]=[e("div",{class:"flex items-center justify-center py-10"},[e("i",{class:"fas fa-spinner animate-spin text-2xl text-[var(--espace-vert)]"})],-1)]))):n.value.length?(s(),o("div",jt,[(s(!0),o(R,null,q(n.value,u=>(s(),o("div",{key:u.id,class:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition relative"},[L(j,{to:`/produits/${u.id}`,class:"block relative"},{default:N(()=>[e("div",Vt,[e("div",{class:"flex w-full h-full slider-container",style:ue({transform:`translateX(-${_.value(u.id)*100}%)`})},[(s(!0),o(R,null,q(u.photos,(z,I)=>(s(),o("img",{key:I,src:z,class:"h-40 object-contain flex-shrink-0 mx-auto",alt:"Photo du produit"},null,8,Mt))),128))],4),u.photos&&u.photos.length>1?(s(),o("button",{key:0,onClick:z=>J(u.id),class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},A[9]||(A[9]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,zt)):k("",!0),u.photos&&u.photos.length>1?(s(),o("button",{key:1,onClick:z=>C(u.id),class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},A[10]||(A[10]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,Et)):k("",!0),u.photos&&u.photos.length>1?(s(),o("div",Ut,[(s(!0),o(R,null,q(u.photos,(z,I)=>(s(),o("span",{key:I,class:D(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":I===_.value(u.id)}])},null,2))),128))])):k("",!0)]),e("div",It,[e("h2",Lt,[h(v(u.nom)+" ",1),e("button",{onClick:z=>y(u),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},A[11]||(A[11]=[e("i",{class:"fas fa-pencil text-sm"},null,-1)]),8,Ft)]),e("p",Tt,v(u.description||"Aucune"),1),e("p",Rt,v(u.prix)+" FCFA",1),e("p",Ot,"Stock: "+v(u.quantite),1),e("div",Dt,[e("span",null,[A[12]||(A[12]=e("i",{class:"fas fa-eye mr-1"},null,-1)),h(" "+v(u.raw_views_count||0)+" vues",1)]),e("span",qt,[A[13]||(A[13]=e("i",{class:"fas fa-heart mr-1"},null,-1)),h(" "+v(u.favorites_count||0)+" favoris",1)])])]),e("div",Nt,[e("button",{onClick:z=>y(u),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},A[14]||(A[14]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Wt),e("button",{onClick:Q(z=>M(u.id),["stop"]),class:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-gray-100 transition"},A[15]||(A[15]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Jt)])]),_:2},1032,["to"])]))),128))])):(s(),o("p",Ht,"Aucun produit pour le moment."))]),L(ie,{name:"fade"},{default:N(()=>[b.value||r.value?(s(),o("div",{key:0,class:"overflow-y-scroll fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:Q(g,["self"])},[e("div",Bt,[e("h2",Gt,v(b.value?"Ajouter un produit":"Modifier le produit"),1),e("form",{onSubmit:Q($,["prevent"]),class:"space-y-4"},[e("div",null,[A[16]||(A[16]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Nom",-1)),O(e("input",{"onUpdate:modelValue":A[0]||(A[0]=u=>P.value.nom=u),type:"text",required:"",class:"input-style"},null,512),[[W,P.value.nom]])]),e("div",null,[A[17]||(A[17]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Description",-1)),O(e("textarea",{"onUpdate:modelValue":A[1]||(A[1]=u=>P.value.description=u),rows:"3",class:"input-style"},null,512),[[W,P.value.description]])]),e("div",null,[A[18]||(A[18]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Prix (FCFA)",-1)),O(e("input",{"onUpdate:modelValue":A[2]||(A[2]=u=>P.value.prix=u),type:"number",min:"0",required:"",class:"input-style"},null,512),[[W,P.value.prix,void 0,{number:!0}]])]),e("div",null,[A[19]||(A[19]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Stock",-1)),O(e("input",{"onUpdate:modelValue":A[3]||(A[3]=u=>P.value.stock=u),type:"number",min:"0",required:"",class:"input-style"},null,512),[[W,P.value.stock,void 0,{number:!0}]])]),e("div",null,[A[20]||(A[20]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Photos",-1)),e("input",{type:"file",multiple:"",onChange:T,class:"input-style",accept:"image/*"},null,32),V.value.length?(s(),o("div",Xt,[(s(!0),o(R,null,q(V.value,(u,z)=>(s(),o("img",{key:z,src:u,class:"w-16 h-16 object-cover rounded",alt:"PrÃ©visualisation"},null,8,Kt))),128))])):k("",!0)]),e("div",null,[A[22]||(A[22]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"CatÃ©gorie",-1)),O(e("select",{"onUpdate:modelValue":A[4]||(A[4]=u=>P.value.category_id=u),required:"",class:"input-style"},[A[21]||(A[21]=e("option",{value:""},"SÃ©lectionner une catÃ©gorie",-1)),(s(!0),o(R,null,q(i.value,u=>(s(),o("option",{key:u.id,value:u.id},v(u.nom),9,Qt))),128))],512),[[pe,P.value.category_id]])]),P.value.collaboratif||r.value?(s(),o("div",Zt)):(s(),o("div",Yt,[O(e("input",{id:"collaboratif",type:"checkbox","onUpdate:modelValue":A[5]||(A[5]=u=>P.value.collaboratif=u)},null,512),[[Fe,P.value.collaboratif]]),A[23]||(A[23]=e("label",{for:"collaboratif",class:"text-sm text-[var(--espace-vert)]"},"Collaboratif",-1))])),e("div",es,[e("button",ts,v(b.value?"Ajouter":"Modifier"),1),e("button",{type:"button",onClick:g,class:"flex-1 bg-[var(--espace-gris)] text-white font-semibold px-4 py-2 rounded hover:bg-gray-700 transition"}," Annuler ")])],32)])])):k("",!0)]),_:1})])],64)}}}),$i=X(ss,[["__scopeId","data-v-a3a2b3ba"]]),as={class:"overflow-y-scroll bg-white flex justify-center px-4"},os={class:"flex flex-col w-full max-w-lg rounded-2xl pb-16 sm:p-10"},rs={class:"text-center text-sm text-gray-600 mt-6"},ls=G({__name:"Register",setup(S){const t=x({nom:"",telephone:"",email:"",ville:"",mot_de_passe:"",parrain_id:""}),m=x({}),p=se(),l=K(),n=oe(),i=async()=>{var b,r,a;try{console.log("Envoi des donnÃ©es d'inscription:",t.value),await n.register(t.value),l.success("Inscription rÃ©ussie !"),p.push({name:"home"})}catch(d){console.error("Erreur lors de l'inscription:",d);const P=((r=(b=d.response)==null?void 0:b.data)==null?void 0:r.message)||"Erreur lors de l'inscription. Veuillez vÃ©rifier vos informations.";l.error(P),((a=d.response)==null?void 0:a.status)===422&&(m.value=d.response.data.errors)}};return(b,r)=>{const a=ne("router-link");return s(),o("div",as,[e("div",os,[r[9]||(r[9]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-user-plus mr-2 text-[var(--espace-or)]"}),h(" CrÃ©ez votre compte ")],-1)),r[10]||(r[10]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[h(" Rejoignez "),e("strong",null,"Espace Cameroun"),h(" et profitez dâ€™une expÃ©rience dâ€™achat unique. Vos informations resteront confidentielles. ")],-1)),e("form",{onSubmit:Q(i,["prevent"]),class:"space-y-5"},[L(ee,{label:"Nom",icon:"fa-user",modelValue:t.value.nom,"onUpdate:modelValue":r[0]||(r[0]=d=>t.value.nom=d),type:"text",required:"",error:m.value.nom},null,8,["modelValue","error"]),L(ee,{label:"TÃ©lÃ©phone",icon:"fa-phone",modelValue:t.value.telephone,"onUpdate:modelValue":r[1]||(r[1]=d=>t.value.telephone=d),type:"tel",required:"",error:m.value.telephone},null,8,["modelValue","error"]),L(ee,{label:"Email (optionnel)",icon:"fa-envelope",modelValue:t.value.email,"onUpdate:modelValue":r[2]||(r[2]=d=>t.value.email=d),type:"email",error:m.value.email},null,8,["modelValue","error"]),L(ee,{label:"Ville",icon:"fa-city",modelValue:t.value.ville,"onUpdate:modelValue":r[3]||(r[3]=d=>t.value.ville=d),type:"text",required:"",error:m.value.ville},null,8,["modelValue","error"]),L(ee,{label:"Mot de passe",icon:"fa-lock",modelValue:t.value.mot_de_passe,"onUpdate:modelValue":r[4]||(r[4]=d=>t.value.mot_de_passe=d),type:"password",required:"",error:m.value.mot_de_passe},null,8,["modelValue","error"]),L(ee,{label:"Code de parrainage (optionnel)",icon:"fa-users",modelValue:t.value.parrain_id,"onUpdate:modelValue":r[5]||(r[5]=d=>t.value.parrain_id=d),type:"text",error:m.value.parrain_id},null,8,["modelValue","error"]),r[6]||(r[6]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-user-plus mr-2"}),h(" S'inscrire ")],-1))],32),e("p",rs,[r[8]||(r[8]=h(" Vous avez dÃ©jÃ  un compte ? ")),L(a,{to:"/login",class:"text-[var(--espace-vert)] font-medium hover:underline"},{default:N(()=>r[7]||(r[7]=[h(" Connectez-vous ici ")])),_:1,__:[7]})]),r[11]||(r[11]=e("p",{class:"text-center text-xs text-gray-400 mt-2 pb-4"},[h(" En vous inscrivant, vous acceptez nos "),e("a",{href:"/conditions",class:"hover:underline text-[var(--espace-vert)]"},"conditions d'utilisation"),h(" et notre "),e("a",{href:"/confidentialite",class:"hover:underline text-[var(--espace-vert)]"},"politique de confidentialitÃ©"),h(". ")],-1))])])}}}),Ai=X(ls,[["__scopeId","data-v-df9d2990"]]),ns={key:0,class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-4"},is={class:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-y-auto animate-fade-in max-h-[90vh]"},us={class:"p-6"},ds={key:0,class:"grid md:grid-cols-3 gap-6"},cs={key:1,class:"flex flex-col md:flex-row max-w-3xl mx-auto p-8 bg-white rounded-xl shadow-lg"},ps={class:"md:w-1/3 mb-6 md:mb-0 pr-6 border-r border-gray-200"},vs={class:"font-extrabold text-lg mb-2"},ms={class:"mb-2 text-sm opacity-90"},fs={class:"text-3xl font-extrabold"},gs={class:"flex flex-col text-sm font-medium text-gray-700"},xs={key:0,class:"text-xs text-red-600 mt-1"},bs={class:"flex gap-4"},hs=["value"],ys=["src"],_s={key:0,class:"text-xs text-red-600 mt-1 block"},ws=["disabled"],ks={class:"text-xs text-gray-400 mt-4 text-center"},$s=G({__name:"SubscriptionModal",props:{isOpen:{type:Boolean}},emits:["close","upgraded"],setup(S,{emit:t}){const m=t,p=K(),l=x(""),n=x(""),i=x(""),b=x(!1),r=x(!1),a=x(!1),d=E=>{l.value=E,b.value=!1,r.value=!1,n.value="",i.value=""},P=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],V=async()=>{if(b.value=!i.value,r.value=!n.value,b.value||r.value){p.error("Veuillez remplir tous les champs correctement.");return}a.value=!0;try{console.log({subscription_type:l.value,payment_service:n.value,phone_number:i.value});const E=await F.post("/upgrade-to-premium",{subscription_type:l.value,payment_service:n.value,phone_number:i.value});a.value=!1,p.success(E.data.message),m("upgraded"),m("close")}catch(E){E.response&&E.response.data?(E.response.data,p.error("Paiement Ã©chouÃ© :Verifiez vos informations et rÃ©essayer")):p.error("Verifiez vos informations et rÃ©essayer."),console.error(E)}finally{a.value=!1}};return(E,c)=>E.isOpen?(s(),o("div",ns,[e("div",is,[c[17]||(c[17]=e("div",{class:"bg-gradient-to-r from-[var(--espace-vert)] to-[var(--espace-or)] p-6 text-center"},[e("h2",{class:"text-3xl font-bold text-white"},"ğŸš€ Passez Ã  Premium"),e("p",{class:"text-white/90 mt-1"}," Comparez et choisissez le plan qui boostera votre business ")],-1)),e("div",us,[l.value?(s(),o("div",cs,[e("div",ps,[c[11]||(c[11]=e("h3",{class:"text-xl font-bold mb-4"},"Votre abonnement",-1)),e("div",{class:D([{"bg-green-600 text-white":l.value==="monthly","bg-yellow-400 text-gray-900":l.value==="yearly"},"rounded-lg p-4"])},[e("h4",vs,v(l.value==="monthly"?"Premium Mensuel":"Premium Annuel"),1),e("p",ms,v(l.value==="monthly"?"AccÃ¨s complet Ã  toutes les fonctionnalitÃ©s.":"Payez moins, profitez plus avec 16% dâ€™Ã©conomie !"),1),e("div",fs,v(l.value==="monthly"?"5 000 FCFA":"50 000 FCFA"),1)],2)]),e("form",{onSubmit:Q(V,["prevent"]),class:"md:w-2/3 flex flex-col gap-6",novalidate:""},[c[15]||(c[15]=e("h3",{class:"text-xl font-bold mb-2"},"DÃ©tails du paiement",-1)),e("label",gs,[c[12]||(c[12]=h(" NumÃ©ro de tÃ©lÃ©phone ")),O(e("input",{"onUpdate:modelValue":c[4]||(c[4]=f=>i.value=f),type:"tel",placeholder:"Ex: 696428651",class:D(["mt-1 rounded-lg border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",{"border-red-500":b.value}]),onInput:c[5]||(c[5]=f=>b.value=!i.value),required:""},null,34),[[W,i.value]]),b.value?(s(),o("span",xs,"Veuillez entrer un numÃ©ro valide.")):k("",!0)]),c[16]||(c[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Service de paiement ",-1)),e("div",bs,[(s(),o(R,null,q(P,f=>e("label",{key:f.value,class:D(["flex items-center gap-2 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":n.value===f.value,"border-gray-300 bg-white":n.value!==f.value,"border-red-500":r.value&&!n.value}])},[O(e("input",{type:"radio",value:f.value,"onUpdate:modelValue":c[6]||(c[6]=y=>n.value=y),class:"hidden"},null,8,hs),[[Te,n.value]]),e("img",{src:f.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,ys),e("span",{class:D([{"text-[var(--espace-vert)]":n.value===f.value,"text-gray-700":n.value!==f.value},"font-semibold select-none"])},v(f.label),3)],2)),64))]),r.value&&!n.value?(s(),o("span",_s," Veuillez sÃ©lectionner un service. ")):k("",!0),e("button",{type:"submit",disabled:a.value||!i.value||!n.value,class:"w-full py-3 rounded-lg bg-[var(--espace-vert)] text-white font-bold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[a.value?(s(),o(R,{key:0},[c[13]||(c[13]=e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1)),c[14]||(c[14]=h(" Veuillez patienter... "))],64)):(s(),o(R,{key:1},[h(" Payer & Souscrire ")],64))],8,ws),e("button",{type:"button",onClick:c[7]||(c[7]=f=>l.value=""),class:"w-full text-center text-gray-500 hover:text-[var(--espace-vert)] transition"}," â† Retour aux plans "),e("p",ks," ğŸ”’ Paiement sÃ©curisÃ© via "+v(n.value||"votre service"),1)],32)])):(s(),o("div",ds,[c[10]||(c[10]=Ce('<div class="border border-gray-200 bg-gray-50 rounded-xl p-6 flex flex-col justify-between" data-v-7e8d0671><div data-v-7e8d0671><h3 class="text-xl font-bold text-gray-800" data-v-7e8d0671>Gratuit (Base)</h3><p class="text-sm text-gray-500 mb-4" data-v-7e8d0671>Pour dÃ©buter sans frais</p><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 10 produits max </li><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 5 collaborations max </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>âŒ</span> Pas de statistiques dÃ©taillÃ©es </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>âŒ</span> Pas de badge Premium </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>âŒ</span> Position prioritaire </li></ul></div><button disabled class="mt-6 w-full py-2 rounded-lg bg-gray-300 text-gray-600 font-semibold cursor-not-allowed" data-v-7e8d0671> Actuel </button></div>',1)),e("div",{class:"relative bg-gradient-to-br from-[var(--espace-vert)] to-green-500 rounded-xl text-white p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 scale-103 transition cursor-pointer",onClick:c[1]||(c[1]=f=>d("monthly"))},[c[8]||(c[8]=Ce('<span class="absolute top-1 right-3 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>â­ Populaire</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Mensuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671> AccÃ¨s complet Ã  toutes les fonctionnalitÃ©s </p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>5000 FCFA / mois </div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Produits illimitÃ©s</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Collaborations illimitÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Statistiques dÃ©taillÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Badge â€œPremiumâ€</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:c[0]||(c[0]=Q(f=>d("monthly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-vert)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")]),e("div",{class:"relative bg-gradient-to-br from-yellow-400 to-[var(--espace-or)] rounded-xl text-gray-900 p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 transition cursor-pointer",onClick:c[3]||(c[3]=f=>d("yearly"))},[c[9]||(c[9]=Ce('<span class="absolute top-1 right-3 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>-16% Ã‰conomie</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Annuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671>Payez moins, profitez plus</p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>50 000 FCFA / an</div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Produits illimitÃ©s</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Collaborations illimitÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Statistiques dÃ©taillÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Badge â€œPremiumâ€</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:c[2]||(c[2]=Q(f=>d("yearly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-or)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")])]))])])])):k("",!0)}}),As=X($s,[["__scopeId","data-v-7e8d0671"]]),Cs={class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Ps={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 space-y-6 animate-fade-in max-h-[90vh] overflow-auto"},Ss={class:"flex justify-center gap-3 mb-4"},js=["onClick"],Vs={key:0,class:"text-xs text-red-600 mt-1"},Ms={class:"flex gap-4"},zs=["value"],Es=["src"],Us={key:1,class:"text-xs text-red-600 mt-1"},Is={class:"text-center text-lg font-bold mt-6"},Ls={class:"text-[var(--espace-vert)]"},Fs=["disabled"],Ts={key:0},Rs={key:1},Os={key:2,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ds={class:"w-full mt-2 text-center text-gray-500 hover:text-[var(--espace-vert)] transition"},qs=G({__name:"AchatJetonModal",props:{isOpen:{type:Boolean}},emits:["close","purchased"],setup(S,{emit:t}){const m=t,p=K(),l=x(10),n=x(""),i=x(""),b=x(l.value*25),r=x(!1),a=x(!1),d=x(!1),P=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],V=[10,20,50,100],E=de(()=>l.value>=10&&n.value.trim().length===9&&/^6\d{8}$/.test(n.value)&&i.value!==""),c=()=>{b.value=l.value*25},f=$=>{l.value=$,c()},y=()=>{c()},T=()=>{d.value=!(n.value.trim().length===9&&/^6\d{8}$/.test(n.value))},M=async()=>{if(a.value=!i.value,!E.value){p.error("Veuillez remplir tous les champs correctement.");return}r.value=!0;try{const $=await F.post("/acheter-jetons",{nombre_jetons:l.value,payment_service:i.value,phone_number:n.value});p.success($.data.message),m("purchased",l.value),m("close")}catch($){if($.response&&$.response.data){const g=$.response.data;p.error(`Erreur: ${g.error_message||"Achat Ã©chouÃ©"}. DÃ©tails: ${g.details||"Aucun dÃ©tail."}`)}else p.error("Erreur lors de l'achat. Veuillez rÃ©essayer.");console.error($)}finally{r.value=!1}};return te(n,()=>{T()}),($,g)=>{const _=ne("router-link");return s(),o("div",Cs,[e("div",Ps,[g[7]||(g[7]=e("h2",{class:"text-3xl font-extrabold text-[var(--espace-vert)] text-center"}," ğŸ« Acheter des Jetons ",-1)),g[8]||(g[8]=e("p",{class:"text-center text-gray-600 text-sm mb-6"},"1 jeton = 25 FCFA",-1)),e("div",Ss,[(s(),o(R,null,q(V,C=>e("button",{key:C,type:"button",onClick:J=>f(C),class:D(["rounded-full px-4 py-2 border font-semibold transition",l.value===C?"bg-[var(--espace-vert)] text-white border-[var(--espace-vert)]":"bg-white text-gray-700 border-gray-300 hover:bg-[var(--espace-vert)] hover:text-white"])},v(C),11,js)),64))]),g[9]||(g[9]=e("label",{class:"block text-gray-700 font-semibold mb-1",for:"jetonQuantity"},[h(" Nombre de jetons "),e("span",{class:"text-sm text-gray-500"},"(min 10)")],-1)),O(e("input",{id:"jetonQuantity","onUpdate:modelValue":g[0]||(g[0]=C=>l.value=C),type:"number",min:"10",placeholder:"Ex: 10",onInput:y,class:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition"},null,544),[[W,l.value,void 0,{number:!0}]]),g[10]||(g[10]=e("label",{class:"block text-gray-700 font-semibold mb-1 mt-4",for:"phoneNumber"},[h(" NumÃ©ro de tÃ©lÃ©phone "),e("span",{class:"text-sm text-red-500"},"*")],-1)),O(e("input",{id:"phoneNumber","onUpdate:modelValue":g[1]||(g[1]=C=>n.value=C),type:"tel",placeholder:"Ex: 696428651",onInput:T,class:D(["w-full rounded-lg border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",d.value?"border-red-500":"border-gray-300"])},null,34),[[W,n.value]]),d.value?(s(),o("p",Vs," Veuillez entrer un numÃ©ro valide (9 chiffres, commenÃ§ant par 6). ")):k("",!0),g[11]||(g[11]=e("label",{class:"block text-gray-700 font-semibold mb-2 mt-4",for:"paymentService"}," Service de paiement ",-1)),e("div",Ms,[(s(),o(R,null,q(P,C=>e("label",{key:C.value,class:D(["flex items-center gap-3 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":i.value===C.value,"border-gray-300 bg-white":i.value!==C.value}])},[O(e("input",{type:"radio",value:C.value,"onUpdate:modelValue":g[2]||(g[2]=J=>i.value=J),class:"hidden"},null,8,zs),[[Te,i.value]]),e("img",{src:C.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Es),e("span",{class:D({"text-[var(--espace-vert)] font-bold":i.value===C.value,"text-gray-700":i.value!==C.value})},v(C.label),3)],2)),64))]),a.value&&!i.value?(s(),o("p",Us," Veuillez sÃ©lectionner un service. ")):k("",!0),e("div",Is,[g[4]||(g[4]=h(" Montant total : ")),e("span",Ls,v(b.value)+" FCFA",1)]),e("button",{onClick:M,disabled:!E.value||r.value,class:"w-full mt-4 bg-[var(--espace-vert)] text-white py-3 rounded-lg font-semibold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-3"},[r.value?(s(),o("span",Rs,"veuillez patientez")):(s(),o("span",Ts,"Acheter")),r.value?(s(),o("svg",Os,g[5]||(g[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))):k("",!0)],8,Fs),e("button",Ds,[L(_,{to:"/jeton-history",onClick:g[3]||(g[3]=C=>m("close"))},{default:N(()=>g[6]||(g[6]=[h("Annuler")])),_:1,__:[6]})])])])}}}),Ns=X(qs,[["__scopeId","data-v-dd0cd514"]]),Ws={class:"space-y-6"},Js={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},Hs={key:0,class:"space-y-2 text-[var(--espace-gris)]"},Bs={class:"flex gap-2"},Gs={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},Xs={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-[var(--espace-gris)]"},Ks=G({__name:"userProfile",props:{user:Object},setup(S){const t=S;console.log(t);const m=oe(),p=K(),l=x(!1),n=m.user||t.user,i=x({nom:n.nom||"",telephone:n.telephone||"",email:n.email||"",ville:n.ville||""}),b=async()=>{var r;try{const a=await F.put("/profile",i.value);n.nom=a.data.user.nom,n.telephone=a.data.user.telephone,n.email=a.data.user.email,n.ville=a.data.user.ville,m.user=n,l.value=!1,p.success("Profil mis Ã  jour avec succÃ¨s.")}catch(a){p.error(((r=a.response)==null?void 0:r.data.message)||"Erreur lors de la mise Ã  jour.")}};return te(()=>n,r=>{i.value={nom:r.nom||"",telephone:r.telephone||"",email:r.email||"",ville:r.ville||""}},{immediate:!0}),(r,a)=>(s(),o("div",Ws,[e("section",Js,[a[16]||(a[16]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations personnelles",-1)),l.value?(s(),o("form",{key:1,onSubmit:Q(b,["prevent"]),class:"space-y-4"},[e("div",null,[a[11]||(a[11]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom"},"Nom",-1)),O(e("input",{"onUpdate:modelValue":a[1]||(a[1]=d=>i.value.nom=d),id:"nom",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre nom"},null,512),[[W,i.value.nom]])]),e("div",null,[a[12]||(a[12]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone"},"TÃ©lÃ©phone",-1)),O(e("input",{"onUpdate:modelValue":a[2]||(a[2]=d=>i.value.telephone=d),id:"telephone",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre tÃ©lÃ©phone"},null,512),[[W,i.value.telephone]])]),e("div",null,[a[13]||(a[13]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email"},"Email",-1)),O(e("input",{"onUpdate:modelValue":a[3]||(a[3]=d=>i.value.email=d),id:"email",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre email (optionnel)"},null,512),[[W,i.value.email]])]),e("div",null,[a[14]||(a[14]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville"},"Ville",-1)),O(e("input",{"onUpdate:modelValue":a[4]||(a[4]=d=>i.value.ville=d),id:"ville",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre ville"},null,512),[[W,i.value.ville]])]),e("div",Bs,[a[15]||(a[15]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Enregistrer les modifications"}," Enregistrer ",-1)),e("button",{onClick:a[5]||(a[5]=d=>l.value=!1),class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Annuler"}," Annuler ")])],32)):(s(),o("div",Hs,[e("p",null,[a[6]||(a[6]=e("strong",null,"Nom :",-1)),h(" "+v(w(n).nom),1)]),e("p",null,[a[7]||(a[7]=e("strong",null,"TÃ©lÃ©phone :",-1)),h(" "+v(w(n).telephone),1)]),e("p",null,[a[8]||(a[8]=e("strong",null,"Email :",-1)),h(" "+v(w(n).email||"Non dÃ©fini"),1)]),e("p",null,[a[9]||(a[9]=e("strong",null,"Ville :",-1)),h(" "+v(w(n).ville),1)]),e("p",null,[a[10]||(a[10]=e("strong",null,"Statut Premium :",-1)),h(" "+v(w(n).premium?"Actif":"Inactif"),1)]),e("button",{onClick:a[0]||(a[0]=d=>l.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Modifier le profil"}," Modifier ")]))]),e("section",Gs,[a[18]||(a[18]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Statistiques",-1)),e("div",Xs,[e("p",null,[a[17]||(a[17]=e("strong",null,"DerniÃ¨re connexion :",-1)),h(" "+v(w(n).last_login||"Non disponible"),1)])])]),a[19]||(a[19]=e("section",{class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},[e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Mon Parrainage")],-1))]))}}),Qs=X(Ks,[["__scopeId","data-v-6daa6d5b"]]),Zs={class:"space-y-6"},Ys={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},ea={key:0,class:"space-y-2 text-[var(--espace-gris)]"},ta={key:1},sa={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},aa={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},oa={key:1,class:"text-[var(--espace-gris)]"},ra=G({__name:"MerchantProfile",props:{user:Object},setup(S){const t=K(),m=x(null),p=x([]);return ae(async()=>{try{console.log("DonnÃ©es du commerÃ§ant");const l=await F.get("/commercant/profil");console.log("DonnÃ©es du commerÃ§ant:",l.data),m.value=l.data.commercant,p.value=l.data.produits||[]}catch(l){t.error("Erreur lors du chargement des donnÃ©es du commerÃ§ant."+l)}}),(l,n)=>(s(),o("div",Zs,[e("section",Ys,[n[4]||(n[4]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations du Commerce",-1)),m.value?(s(),o("div",ea,[e("p",null,[n[0]||(n[0]=e("strong",null,"Nom :",-1)),h(" "+v(m.value.nom),1)]),e("p",null,[n[1]||(n[1]=e("strong",null,"Ville :",-1)),h(" "+v(m.value.ville),1)]),n[2]||(n[2]=e("p",null,[e("strong",null,"Produits actifs :")],-1))])):(s(),o("div",ta,n[3]||(n[3]=[e("p",{class:"text-[var(--espace-gris)]"},"Aucune information de commerce disponible.",-1)])))]),e("section",sa,[n[8]||(n[8]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Mes Produits",-1)),p.value.length?(s(),o("div",aa,[(s(!0),o(R,null,q(p.value,i=>(s(),o("div",{key:i.id,class:"border rounded-md p-3 text-[var(--espace-gris)]"},[e("p",null,[n[5]||(n[5]=e("strong",null,"Nom :",-1)),h(" "+v(i.nom),1)]),e("p",null,[n[6]||(n[6]=e("strong",null,"Prix :",-1)),h(" "+v(i.prix)+" FCFA",1)]),e("p",null,[n[7]||(n[7]=e("strong",null,"Stock :",-1)),h(" "+v(i.quantite),1)])]))),128))])):(s(),o("p",oa,"Aucun produit enregistrÃ©."))])]))}}),la=X(ra,[["__scopeId","data-v-3430da16"]]),na={class:"overflow-y-auto min-h-screen relative bg-gray-100 py-8 sm:px-6"},ia={class:"flex flex-col sm:flex-row items-center justify-between mb-8 gap-4"},ua={class:"flex items-center space-x-4 relative w-full gap-1 px-3"},da={class:"relative"},ca=["src"],pa={key:1,class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-gray-500"},va={key:3,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-36 bg-white border rounded-md shadow z-10"},ma={class:"space-y-1"},fa={key:0,class:"text-sm text-gray-500"},ga={key:0,class:"ml-4 flex items-center gap-2"},xa=["src"],ba=["disabled"],ha={class:"flex flex-col sm:flex-row gap-2 items-center"},ya={class:"container mx-auto max-w-4xl"},_a={key:2,class:"fixed inset-0 bg-black bg-opacity-0 flex items-center justify-center z-50"},wa={class:"bg-white rounded-lg p-4 relative w-full max-w-md"},ka=G({__name:"Profile",setup(S){const t=se(),m=K(),p=oe(),l=x(p.user);console.log(l.value);const n=x(!1),i=x(!1),b=x(null),r=x(null),a=x(!1),d=x(!1),P=x(!1),V=de(()=>d.value?la:Qs),E=x(null),c=x(null),f=x(!1);let y=null;const T=()=>{var j;(j=E.value)==null||j.click(),n.value=!1},M=j=>{const u=j.target;if(u.files&&u.files[0]){const z=u.files[0];if(!z.type.startsWith("image/")){m.error("Veuillez sÃ©lectionner une image.");return}if(z.size>2*1024*1024){m.error("Image trop volumineuse (max 2Mo).");return}r.value=z,b.value=URL.createObjectURL(z)}},$=async()=>{try{y=await navigator.mediaDevices.getUserMedia({video:!0}),f.value=!0,n.value=!1,setTimeout(()=>{c.value&&(c.value.srcObject=y)},100)}catch(j){m.error("Impossible d'accÃ©der Ã  la camÃ©ra."),console.error(j)}},g=()=>{if(!c.value)return;const j=c.value,u=document.createElement("canvas");u.width=j.videoWidth,u.height=j.videoHeight;const z=u.getContext("2d");z&&(z.drawImage(j,0,0,u.width,u.height),u.toBlob(I=>{I&&(r.value=new File([I],"photo.jpg",{type:"image/jpeg"}),b.value=URL.createObjectURL(r.value),_())},"image/jpeg"))},_=()=>{y&&(y.getTracks().forEach(j=>j.stop()),y=null),f.value=!1},C=()=>{r.value=null,b.value=null},J=async()=>{var j,u;if(r.value){i.value=!0;try{const z=new FormData;z.append("photo",r.value);const I=await F.post("/profile/photo",z,{headers:{"Content-Type":"multipart/form-data"}});I.data.photo&&(l.value.photo=I.data.photo,p.user=l.value,m.success("Photo mise Ã  jour."),C())}catch(z){m.error(((u=(j=z.response)==null?void 0:j.data)==null?void 0:u.message)||"Erreur lors de l'envoi.")}finally{i.value=!1}}},U=async()=>{a.value=!1},A=j=>{m.success(`Vous avez achetÃ© ${j} jetons !`)};return te(()=>p.user,j=>{l.value=j||{}},{immediate:!0}),ae(()=>{}),fe(()=>{b.value&&URL.revokeObjectURL(b.value),y&&y.getTracks().forEach(j=>j.stop())}),(j,u)=>{var z,I,H,Z,le,B,re,xe,be,he,ye,_e,we,ke,$e,me,ce,ze,Ee,Ue,Ie;return s(),o("div",na,[e("div",ia,[e("div",ua,[e("div",da,[(z=l.value)!=null&&z.photo?(s(),o("img",{key:0,src:`http://localhost:8000/storage/${(I=l.value)==null?void 0:I.photo}`,alt:"Photo de profil",class:"w-16 h-16 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,ca)):(s(),o("div",pa,u[6]||(u[6]=[e("i",{class:"fas fa-user-circle text-4xl"},null,-1)]))),(H=l.value)!=null&&H.premium?(s(),o("i",{key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-lg p-1 rounded-full",style:ue({color:`${(B=(le=(Z=l.value)==null?void 0:Z.niveaux_users[0])==null?void 0:le.parrainage_niveau)==null?void 0:B.couleur}`})},null,4)):k("",!0),e("button",{onClick:u[0]||(u[0]=Ae=>n.value=!n.value),class:"absolute bottom-0 right-0 w-6 h-6 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full flex items-center justify-center hover:bg-[var(--espace-vert)] hover:text-white",style:ue({background:`${(be=(xe=(re=l.value)==null?void 0:re.niveaux_users[0])==null?void 0:xe.parrainage_niveau)==null?void 0:be.couleur}`})},u[7]||(u[7]=[e("i",{class:"fas fa-pencil-alt text-xs"},null,-1)]),4),n.value?(s(),o("div",va,[e("button",{onClick:$,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," CamÃ©ra "),e("button",{onClick:T,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Galerie ")])):k("",!0)]),e("input",{ref_key:"galleryInput",ref:E,type:"file",accept:"image/*",class:"hidden",onChange:M},null,544),e("div",ma,[u[8]||(u[8]=h("rr ")),e("h1",{class:"text-2xl sm:text-3xl font-bold flex items-center gap-2 text-blue-500",style:ue({color:`${(_e=(ye=(he=l.value)==null?void 0:he.niveaux_users[0])==null?void 0:ye.parrainage_niveau)==null?void 0:_e.couleur}`})},[h(v((we=l.value)==null?void 0:we.nom)+" ",1),(ke=l.value)!=null&&ke.premium?(s(),o("span",{key:0,class:"text-black text-xs px-3 py-1 rounded-full uppercase font-bold",style:ue({background:`${(ce=(me=($e=l.value)==null?void 0:$e.niveaux_users[0])==null?void 0:me.parrainage_niveau)==null?void 0:ce.couleur}`})}," Premium ",4)):k("",!0)],4),(ze=l.value)!=null&&ze.subscription_ends_at?(s(),o("span",fa," Jusqu'au "+v(new Date((Ee=l.value)==null?void 0:Ee.subscription_ends_at).toLocaleDateString()),1)):k("",!0)]),b.value?(s(),o("div",ga,[e("img",{src:b.value,alt:"Preview",class:"w-12 h-12 rounded-full object-cover"},null,8,xa),e("button",{onClick:J,disabled:i.value,class:D(["bg-[var(--espace-vert)] text-white px-3 py-1 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]",{"opacity-50 cursor-not-allowed":i.value}])},v(i.value?"Upload...":"Confirmer"),11,ba),e("button",{onClick:C,class:"text-red-500 hover:text-red-700"}," Annuler ")])):k("",!0)]),e("div",ha,[(Ue=l.value)!=null&&Ue.commercant?(s(),o("button",{key:0,onClick:u[1]||(u[1]=Ae=>d.value=!d.value),class:"text-[var(--espace-or)] hover:text-[var(--espace-vert)] font-medium flex items-center gap-1"},u[9]||(u[9]=[e("i",{class:"fas fa-store"},null,-1),h(" Compte CommerÃ§ant ")]))):(s(),o("button",{key:1,onClick:u[2]||(u[2]=Ae=>w(t).push("/commercant/create")),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-vert)] hover:text-white"}," Devenir commerÃ§ant ")),(Ie=l.value)!=null&&Ie.premium?k("",!0):(s(),o("button",{key:2,onClick:u[3]||(u[3]=Ae=>a.value=!0),class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"}," Passer Premium "))])]),e("div",ya,[(s(),Y(Ne(V.value)))]),a.value?(s(),Y(As,{key:0,"is-open":a.value,onClose:u[4]||(u[4]=Ae=>a.value=!1),onUpgraded:U},null,8,["is-open"])):k("",!0),P.value?(s(),Y(Ns,{key:1,"is-open":P.value,onClose:u[5]||(u[5]=Ae=>P.value=!1),onPurchased:A},null,8,["is-open"])):k("",!0),f.value?(s(),o("div",_a,[e("div",wa,[e("video",{ref_key:"videoRef",ref:c,autoplay:"",playsinline:"",class:"rounded w-full"},null,512),e("div",{class:"mt-2 flex justify-between"},[e("button",{onClick:g,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Capturer "),e("button",{onClick:_,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Annuler ")])])])):k("",!0)])}}}),Ci=X(ka,[["__scopeId","data-v-654f8017"]]),$a={class:"min-h-screen bg-gray-100 pt-16 pb-20 px-4 sm:px-6 flex flex-col lg:flex-row gap-4"},Aa={class:"hidden lg:block w-full max-w-xs bg-[var(--espace-blanc)] rounded-lg shadow-md p-4"},Ca={class:"space-y-2"},Pa=["onClick"],Sa={class:"font-poppins"},ja={class:"flex-1 bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Va={class:"lg:hidden mb-4"},Ma={class:"flex overflow-x-auto space-x-2 border-b border-[var(--espace-gris)]"},za=["onClick"],Ea={key:0,class:"space-y-6"},Ua={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ia={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},La={class:"flex items-center gap-4 mb-4"},Fa=["src"],Ta={class:"text-[var(--espace-vert)] font-semibold"},Ra={class:"text-sm text-[var(--espace-gris)]"},Oa={class:"text-sm text-[var(--espace-gris)]"},Da={class:"text-sm text-[var(--espace-gris)]"},qa={key:0,class:"space-y-6"},Na={key:0,class:"space-y-6"},Wa={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ja={class:"text-base font-medium font-poppins"},Ha={class:"text-sm text-[var(--espace-gris)]"},Ba=G({__name:"Parametres",setup(S){const t=x(!1),m=oe(),p=se(),l=K(),n=m.user,i=x("profile"),b=x({nom:(n==null?void 0:n.nom)||"",email:(n==null?void 0:n.email)||"",telephone:(n==null?void 0:n.telephone)||"",ville:(n==null?void 0:n.ville)||""}),r=x({current_password:"",new_password:"",confirm_password:""});x({});const a=x(""),d=de(()=>[...n!=null&&n.commercant?[{to:"/commercant",label:"Espace CommerÃ§ant",icon:"fa-store-alt",description:"GÃ©rez votre boutique et vos produits"}]:[],{to:"/parrainage",label:"Parrainage",icon:"fa-users",description:"Invitez des amis et gagnez des rÃ©compenses"},{to:"/abonnements",label:"Abonnements",icon:"fa-star",description:"GÃ©rez vos abonnements premium"},{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",description:"GÃ©rez vos collaborations sur des produits"}]),P=async()=>{var f,y;t.value=!0;try{await F.put("/user/profile",b.value),m.user={...m.user,...b.value},localStorage.setItem("user",JSON.stringify(m.user)),l.success("Profil mis Ã  jour avec succÃ¨s",{timeout:3e3})}catch(T){l.error(((y=(f=T.response)==null?void 0:f.data)==null?void 0:y.message)||"Erreur lors de la mise Ã  jour du profil")}finally{t.value=!1}},V=async()=>{var f,y;t.value=!0;try{if(r.value.new_password!==r.value.confirm_password){l.error("Les mots de passe ne correspondent pas");return}if(a.value==="weak"){l.error("Le mot de passe est trop faible. Utilisez au moins 8 caractÃ¨res avec des lettres, chiffres et symboles.");return}await F.put("/user/password",r.value),l.success("Mot de passe mis Ã  jour avec succÃ¨s",{timeout:3e3}),r.value={current_password:"",new_password:"",confirm_password:""},a.value=""}catch(T){l.error(((y=(f=T.response)==null?void 0:f.data)==null?void 0:y.message)||"Erreur lors de la mise Ã  jour du mot de passe")}finally{t.value=!1}},E=()=>{m.logout(),p.push({name:"login"})},c=()=>{const f=r.value.new_password;f.length===0?a.value="":f.length<8||!/[A-Za-z]/.test(f)||!/[0-9]/.test(f)?a.value="weak":/[!@#$%^&*]/.test(f)?a.value="strong":a.value="medium"};return te(()=>r.value.new_password,c),(f,y)=>{const T=ne("RouterLink");return s(),o(R,null,[L(ge,{isLoading:t.value},null,8,["isLoading"]),e("div",$a,[e("aside",Aa,[y[7]||(y[7]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4 font-poppins"},"ParamÃ¨tres",-1)),e("nav",Ca,[(s(),o(R,null,q([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"SÃ©curitÃ©",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres options",icon:"fa-cog"},{id:"logout",label:"DÃ©connexion",icon:"fa-sign-out-alt"}],M=>e("button",{key:M.id,onClick:$=>M.id==="logout"?E():i.value=M.id,class:D(["w-full flex items-center gap-3 p-3 rounded-lg transition-colors duration-300",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":i.value===M.id,"text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":i.value!==M.id}])},[e("i",{class:D(["fas",M.icon])},null,2),e("span",Sa,v(M.label),1)],10,Pa)),64))])]),e("main",ja,[e("div",Va,[e("div",Ma,[(s(),o(R,null,q([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"SÃ©curitÃ©",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres",icon:"fa-cog"},{id:"logout",label:"DÃ©connexion",icon:"fa-sign-out-alt"}],M=>e("button",{key:M.id,onClick:$=>M.id==="logout"?E():i.value=M.id,class:D(["flex items-center gap-2 px-4 py-2 text-sm font-medium font-poppins transition-colors duration-300",{"border-b-2 border-[var(--espace-or)] text-[var(--espace-vert)]":i.value===M.id,"text-[var(--espace-gris)] hover:text-[var(--espace-vert)]":i.value!==M.id}])},[e("i",{class:D(["fas",M.icon])},null,2),h(" "+v(M.label),1)],10,za)),64))])]),L(ie,{name:"slide"},{default:N(()=>{var M,$;return[i.value==="profile"?(s(),o("section",Ea,[y[10]||(y[10]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Profil",-1)),e("div",Ua,[e("form",{onSubmit:Q(P,["prevent"]),class:"space-y-4"},[L(ee,{label:"Nom",icon:"fa-user",modelValue:b.value.nom,"onUpdate:modelValue":y[0]||(y[0]=g=>b.value.nom=g),type:"text",required:"",placeholder:"Votre nom"},null,8,["modelValue"]),L(ee,{label:"Email",icon:"fa-envelope",modelValue:b.value.email,"onUpdate:modelValue":y[1]||(y[1]=g=>b.value.email=g),type:"email",placeholder:"Votre email"},null,8,["modelValue"]),L(ee,{label:"TÃ©lÃ©phone",icon:"fa-phone",modelValue:b.value.telephone,"onUpdate:modelValue":y[2]||(y[2]=g=>b.value.telephone=g),type:"tel",required:"",placeholder:"Votre numÃ©ro de tÃ©lÃ©phone"},null,8,["modelValue"]),L(ee,{label:"Ville",icon:"fa-city",modelValue:b.value.ville,"onUpdate:modelValue":y[3]||(y[3]=g=>b.value.ville=g),type:"text",required:"",placeholder:"Votre ville"},null,8,["modelValue"]),y[8]||(y[8]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Mettre Ã  jour ",-1))],32),e("div",Ia,[y[9]||(y[9]=e("h3",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2 font-poppins"},"AperÃ§u",-1)),e("div",La,[e("img",{src:(($=(M=w(n))==null?void 0:M.commercant)==null?void 0:$.logo)||"https://via.placeholder.com/50",alt:"Photo de profil",class:"w-12 h-12 rounded-full object-cover"},null,8,Fa),e("div",null,[e("p",Ta,v(b.value.nom||"Nonni"),1),e("p",Ra,v(b.value.email||"Non dÃ©fini"),1)])]),e("p",Oa,"TÃ©lÃ©phone: "+v(b.value.telephone||"Nonni"),1),e("p",Da,"Ville: "+v(b.value.ville||"Non dÃ©fini"),1)])])])):k("",!0)]}),_:1}),L(ie,{name:"slide"},{default:N(()=>[i.value==="security"?(s(),o("section",qa,[y[12]||(y[12]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"SÃ©curitÃ©",-1)),e("form",{onSubmit:Q(V,["prevent"]),class:"space-y-4"},[L(ee,{label:"Mot de passe actuel",icon:"fa-lock",modelValue:r.value.current_password,"onUpdate:modelValue":y[4]||(y[4]=M=>r.value.current_password=M),type:"password",required:"",placeholder:"Mot de passe actuel"},null,8,["modelValue"]),L(ee,{label:"Nouveau mot de passe",icon:"fa-lock",modelValue:r.value.new_password,"onUpdate:modelValue":y[5]||(y[5]=M=>r.value.new_password=M),type:"password",required:"",placeholder:"Nouveau mot de passe",onInput:c},null,8,["modelValue"]),a.value?(s(),o("div",{key:0,class:D(["text-sm",{"text-red-500":a.value==="weak","text-yellow-500":a.value==="medium","text-green-500":a.value==="strong"}])}," Force du mot de passe : "+v(a.value==="weak"?"Faible":a.value==="medium"?"Moyen":"Fort"),3)):k("",!0),L(ee,{label:"Confirmer le nouveau mot de passe",icon:"fa-lock",modelValue:r.value.confirm_password,"onUpdate:modelValue":y[6]||(y[6]=M=>r.value.confirm_password=M),type:"password",required:"",placeholder:"Confirmer le mot de passe"},null,8,["modelValue"]),y[11]||(y[11]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Changer le mot de passe ",-1))],32)])):k("",!0)]),_:1}),L(ie,{name:"slide"},{default:N(()=>[i.value==="links"?(s(),o("section",Na,[y[13]||(y[13]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Autres options",-1)),e("div",Wa,[(s(!0),o(R,null,q(d.value,M=>(s(),Y(T,{key:M.to,to:M.to,class:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"},{default:N(()=>[e("i",{class:D(["fas",M.icon])},null,2),e("div",null,[e("h3",Ja,v(M.label),1),e("p",Ha,v(M.description),1)])]),_:2},1032,["to"]))),128))])])):k("",!0)]),_:1})])])],64)}}}),Pi=X(Ba,[["__scopeId","data-v-cdcd7779"]]),Ga={class:"bg-[var(--espace-blanc)] border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200"},Xa={class:"relative w-full h-32 overflow-hidden rounded-lg mb-2"},Ka=["src","alt"],Qa={key:0,class:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex space-x-1"},Za={key:0,class:"absolute top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Ya={key:1,class:"absolute top-2 right-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boostÃ©"},eo={class:"text-sm font-semibold text-[var(--espace-vert)] font-poppins truncate"},to={class:"text-xs text-[var(--espace-gris)] truncate"},so={class:"text-sm font-medium text-[var(--espace-or)]"},ao={class:"flex items-center justify-between mt-2 text-xs text-[var(--espace-gris)]"},oo={class:"flex items-center gap-1"},ro={class:"flex items-center gap-1"},lo=["aria-label"],no=G({__name:"ProductCard",props:{produit:{}},emits:["toggle-favorite","handleToggleFavorite"],setup(S,{emit:t}){const m=S,p=t,l=K(),n=ve();console.log(m.produit);const i=x(0),b=async()=>{var r,a;try{await n.toggleFavorite(m.produit.id),p("toggle-favorite",m.produit.id)}catch(d){l.error(((a=(r=d.response)==null?void 0:r.data)==null?void 0:a.message)||"Erreur lors de la mise Ã  jour des favoris.")}};return(r,a)=>{const d=ne("router-link");return s(),o("div",Ga,[L(d,{to:`/produits/${r.produit.id}`,class:"block relative"},{default:N(()=>[e("div",Xa,[e("div",{class:"flex w-full h-full slider-container",style:ue({transform:`translateX(-${i.value*100}%)`})},[(s(!0),o(R,null,q(r.produit.photos||[r.produit.photo_url||"https://via.placeholder.com/150"],(P,V)=>(s(),o("img",{key:V,src:P,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${r.produit.nom} - ${V+1}`},null,8,Ka))),128))],4),r.produit.photos&&r.produit.photos.length>1?(s(),o("div",Qa,[(s(!0),o(R,null,q(r.produit.photos,(P,V)=>(s(),o("span",{key:V,class:D(["w-1.5 h-1.5 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":V===i.value}])},null,2))),128))])):k("",!0)]),r.produit.collaboratif?(s(),o("span",Za," Collaboratif ")):k("",!0),r.produit.boosted_until&&new Date(r.produit.boosted_until)>new Date?(s(),o("span",Ya," BoostÃ© ")):k("",!0),e("h3",eo,v(r.produit.nom),1),e("p",to,v(r.produit.description||"Aucune description"),1),e("p",so,v(r.produit.prix)+" XAF",1)]),_:1},8,["to"]),e("div",ao,[e("div",oo,[a[0]||(a[0]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(r.produit.raw_views_count||r.produit.raw_views_count)+" vues",1)]),e("div",ro,[e("button",{onClick:b,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] transition active:scale-95 focus:outline-none","aria-label":r.produit.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:D(["fas fa-bookmark text-sm",{"text-[var(--espace-or)]":r.produit.is_favorited_by}])},null,2)],8,lo),e("span",null,v(r.produit.favorites_count)+" favoris",1)])])])}}}),je=X(no,[["__scopeId","data-v-f75e7e0d"]]),io={class:"pt-4 bg-[var(--espace-blanc)] max-h-full relative"},uo={class:"relative overflow-y-scroll mx-auto px-4 sm:px-6 py-4 max-h-full"},co={class:"fixed flex items-center overflow-x-auto space-x-2 mb-3 snap-x snap-mandatory z-5"},po=["onClick","aria-label","aria-current"],vo={class:"fixed right-10 z-5 flex justify-end items-center mb-3"},mo=["aria-label","aria-expanded"],fo={key:0,class:"absolute -top-1 -right-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] text-[10px] rounded-full h-5 w-5 flex items-center justify-center"},go={key:0,class:"bg-[var(--espace-blanc)] rounded-xl shadow-md p-4 mb-4 fixed bottom-0 left-0 right-0 z-50 sm:static sm:flex sm:items-center sm:gap-3 sm:flex-wrap"},xo={class:"flex-1 min-w-[120px]"},bo={class:"flex-1 min-w-[120px]"},ho=["value"],yo={class:"flex-1 min-w-[100px]"},_o={class:"flex-1 min-w-[100px]"},wo={class:"flex-1 min-w-[120px]"},ko=["value"],$o={class:"flex-1 min-w-[100px]"},Ao=["aria-busy"],Co={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},Po=G({__name:"Home",setup(S){const t=ve(),m=oe(),p=x([]),l=K(),n=x(!1),i=x({search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""}),b=x(["Douala","YaoundÃ©","Bamenda","Buea","Garoua"]),r=x(null),a=x(null),d=async()=>{try{const M=await F.get("/categories");p.value=M.data.categories}catch(M){console.error("Erreur lors du chargement des catÃ©gories:",M),l.error("Erreur lors du chargement des catÃ©gories.")}},P=()=>{if(i.value.prix_min&&i.value.prix_max&&parseFloat(i.value.prix_min)>parseFloat(i.value.prix_max)){l.error("Le prix minimum doit Ãªtre infÃ©rieur au prix maximum.");return}t.fetchProducts(i.value,!0),n.value=!1},V=()=>{i.value={search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""},t.fetchProducts({},!0)},E=M=>{t.setSort(M)},c=()=>Object.values(i.value).filter(M=>M!=="").length,f=M=>{T(M)},y=M=>{T(M)},T=async M=>{var J,U,A;const $=(J=m.user)==null?void 0:J.id;if(!$){l.error("Connexion requise pour enregistrer la vue.");return}const g=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),_=new Date().toISOString().split("T")[0],C=localStorage.getItem("lastResetDate");if((!C||C!==_)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",_)),!await g[M]){console.log(g);try{setTimeout(async()=>{const j=await F.post("/record_view",{product_id:M,user_id:$});l.success(j.data.message)},1e3),g[M]=!0,localStorage.setItem("viewedProducts",JSON.stringify(g))}catch(j){console.error("Erreur lors de l'enregistrement de la vue:",j),l.error(((A=(U=j.response)==null?void 0:U.data)==null?void 0:A.message)||"Erreur lors de l'enregistrement de la vue.")}}};return ae(async()=>{try{await t.fetchProducts(),await d()}catch(M){console.error("Erreur lors du chargement des produits ou catÃ©gories:",M),l.error("Erreur lors du chargement des produits. Veuillez rÃ©essayer.")}r.value=new IntersectionObserver(M=>{M[0].isIntersecting&&!t.isLoading&&t.hasMore&&t.fetchProducts(i.value)},{threshold:.1}),a.value&&r.value.observe(a.value)}),fe(()=>{r.value&&a.value&&r.value.unobserve(a.value)}),(M,$)=>(s(),o("div",io,[L(ge,{isLoading:w(t).isLoading},null,8,["isLoading"]),e("div",uo,[e("div",co,[(s(),o(R,null,q([{id:"popular",label:"Populaire",icon:"fa-fire"},{id:"favorites",label:"Favoris",icon:"fa-heart"}],g=>e("button",{key:g.id,onClick:_=>E(g.id),class:D(["flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium font-poppins snap-center shrink-0 transition-all duration-200",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":w(t).sort===g.id,"bg-gray-100 text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":w(t).sort!==g.id}]),"aria-label":`Trier par ${g.label}`,"aria-current":w(t).sort===g.id?"true":void 0},[e("i",{class:D(["fas",g.icon])},null,2),h(" "+v(g.label),1)],10,po)),64))]),e("div",vo,[e("button",{onClick:$[0]||($[0]=g=>n.value=!n.value),class:"relative flex items-center justify-center w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition active:scale-95","aria-label":n.value?"Masquer les filtres":"Afficher les filtres","aria-expanded":n.value},[$[7]||($[7]=e("i",{class:"fas fa-filter text-sm"},null,-1)),c()>0?(s(),o("span",fo,v(c()),1)):k("",!0)],8,mo)]),L(ie,{name:"slide-up"},{default:N(()=>[n.value?(s(),o("div",go,[e("form",{onSubmit:Q(P,["prevent"]),class:"grid grid-cols-2 gap-3 sm:flex sm:flex-row sm:gap-3"},[e("div",xo,[O(e("input",{"onUpdate:modelValue":$[1]||($[1]=g=>i.value.search=g),id:"search",type:"text",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Rechercher...","aria-label":"Rechercher un produit"},null,512),[[W,i.value.search]])]),e("div",bo,[O(e("select",{"onUpdate:modelValue":$[2]||($[2]=g=>i.value.category=g),id:"category",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[$[8]||($[8]=e("option",{value:""},"CatÃ©gorie",-1)),(s(!0),o(R,null,q(p.value,g=>(s(),o("option",{key:g.id,value:g.id},v(g.nom),9,ho))),128))],512),[[pe,i.value.category]])]),e("div",yo,[O(e("input",{"onUpdate:modelValue":$[3]||($[3]=g=>i.value.prix_min=g),id:"prix_min",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix min","aria-label":"Prix minimum"},null,512),[[W,i.value.prix_min]])]),e("div",_o,[O(e("input",{"onUpdate:modelValue":$[4]||($[4]=g=>i.value.prix_max=g),id:"prix_max",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix max","aria-label":"Prix maximum"},null,512),[[W,i.value.prix_max]])]),e("div",wo,[O(e("select",{"onUpdate:modelValue":$[5]||($[5]=g=>i.value.ville=g),id:"ville",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[$[9]||($[9]=e("option",{value:""},"Ville",-1)),(s(!0),o(R,null,q(b.value,g=>(s(),o("option",{key:g,value:g},v(g),9,ko))),128))],512),[[pe,i.value.ville]])]),e("div",$o,[O(e("select",{"onUpdate:modelValue":$[6]||($[6]=g=>i.value.collaboratif=g),id:"collaboratif",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},$[10]||($[10]=[e("option",{value:""},"Collaboratif",-1),e("option",{value:"true"},"Oui",-1),e("option",{value:"false"},"Non",-1)]),512),[[pe,i.value.collaboratif]])]),e("div",{class:"flex gap-2 col-span-2 sm:col-span-1"},[$[12]||($[12]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Appliquer les filtres"},[e("i",{class:"fas fa-check text-sm"})],-1)),e("button",{onClick:V,type:"button",class:"w-10 h-10 bg-[var(--espace-gris)] text-[var(--espace-blanc)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"RÃ©initialiser les filtres"},$[11]||($[11]=[e("i",{class:"fas fa-times text-sm"},null,-1)]))])],32)])):k("",!0)]),_:1}),L(Re,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 pt-12"},{default:N(()=>[(s(!0),o(R,null,q(w(t).products,g=>(s(),Y(je,{key:g.id,produit:g,onMouseover:_=>f(g.id),onTouchstart:_=>y(g.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:a,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":w(t).isLoading},[w(t).hasMore?k("",!0):(s(),o("p",Co," Aucun produit supplÃ©mentaire "))],8,Ao)])]))}}),Si=X(Po,[["__scopeId","data-v-618cfe33"]]),So={class:"overflow-y-scroll bg-[var(--espace-blanc)] pt-16 pb-20 px-4 sm:px-6"},jo={class:"container mx-auto max-w-5xl"},Vo={key:0,class:"text-center text-[var(--espace-gris)]"},Mo={key:1,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},zo={class:"flex flex-col lg:flex-row gap-4 sm:gap-6"},Eo={class:"w-full lg:w-1/2 relative"},Uo={class:"relative w-full h-64 sm:h-80 lg:h-96 overflow-hidden rounded-lg"},Io=["src","alt"],Lo={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Fo={key:0,class:"absolute top-3 left-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boostÃ©"},To={key:1,class:"absolute top-3 right-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Ro={key:2,class:"absolute bottom-3 left-3 bg-[var(--espace-bleu)] text-[var(--espace-blanc)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"CommerÃ§ant Pro"},Oo={class:"w-full lg:w-1/2"},Do={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"},qo={class:"text-sm text-[var(--espace-gris)] mb-3"},No={class:"text-lg sm:text-xl font-semibold text-[var(--espace-or)] mb-3"},Wo={class:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 text-xs text-[var(--espace-gris)]"},Jo={class:"flex items-center gap-3"},Ho={class:"flex items-center gap-1"},Bo={class:"flex items-center gap-1"},Go=["aria-label"],Xo={class:"border-t pt-3 mt-3"},Ko={class:"text-xs text-[var(--espace-gris)] mb-1"},Qo={key:0,class:"ml-1 text-[var(--espace-or)]","aria-label":"CommerÃ§ant vÃ©rifiÃ©",title:"CommerÃ§ant vÃ©rifiÃ©"},Zo={class:"text-xs text-[var(--espace-gris)] mb-1"},Yo={class:"text-xs text-[var(--espace-gris)] mb-1"},er={class:"text-xs text-[var(--espace-gris)] mb-2"},tr={class:"flex flex-col sm:flex-row gap-3 mt-4"},sr=["disabled","aria-label"],ar={key:2,class:"text-center text-[var(--espace-gris)] text-sm font-poppins"},or={class:"bg-[var(--espace-blanc)] rounded-lg p-4 sm:p-6 w-full max-w-md mx-4 shadow-lg"},rr={class:"text-base sm:text-lg font-semibold text-[var(--espace-vert)] mb-3 font-poppins"},lr={class:"text-xs text-[var(--espace-gris)] mb-3"},nr=["aria-label"],ir={key:0,class:"text-xs text-[var(--espace-gris)] mt-1"},ur={key:0,class:"mt-6"},dr=["aria-busy"],cr={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},pr=G({__name:"Produit",setup(S){const t=ve(),m=Pe(),p=se(),l=oe(),n=Se(),i=K();x([]);const b=x(!1),r=x(null),a=x(null),d=x(null),P=async()=>{try{t.isLoading=!0,await t.viewProduct(m.params.id),t.isLoading=!1,t.product.photos&&!t.product.photo_url&&(t.product.photo_url=t.product.photos[0]),await t.fetchProducts({category:t.product.category_id,per_page:8},!0),console.log(t.product)}catch(j){i.error(j||"Erreur lors du chargement du produit"),p.push({name:"home"})}finally{t.isLoading=!1}},V=()=>{var z,I;if(!l.user){i.error("Veuillez vous connecter pour contacter le commerÃ§ant"),p.push({name:"login"});return}const j=(z=t.product.commercant)==null?void 0:z.telephone,u=encodeURIComponent(`Bonjour ${(I=t.product.commercant)==null?void 0:I.nom}, je suis intÃ©ressÃ© par ${t.product.nom}. Pouvez-vous me contacter ?`);window.open(`https://wa.me/${j}?text=${u}`,"_blank")},E=()=>{var j;if(!l.user){i.error("Veuillez vous connecter pour collaborer"),p.push({name:"login"});return}if(((j=l.user.commercant)==null?void 0:j.id)===t.product.commercant_id){i.error("Vous ne pouvez pas collaborer sur votre propre produit");return}if(!t.product.collaboratif){i.error("Ce produit nâ€™est pas ouvert Ã  la collaboration");return}r.value=t.product.prix+(t.product.marge_min||500),b.value=!0},c=async()=>{if(!r.value||r.value<t.product.prix+(t.product.marge_min||0)){i.error(`Le prix de revente doit Ãªtre supÃ©rieur ou Ã©gal Ã  ${t.product.prix+(t.product.marge_min||0)} XAF`);return}await n.addCollaboration({produit_id:t.product.id,prix_revente:r.value})&&(i.success("Demande de collaboration envoyÃ©e",{timeout:3e3}),b.value=!1,r.value=null)},f=()=>{b.value=!1,r.value=null},y=()=>{p.push({path:`/commercant/produits/${t.product.id}/edit`})},T=async()=>{var u,z,I;if(!l.user||((u=l.user.commercant)==null?void 0:u.id)!==t.product.commercant_id){i.error("Seul le commerÃ§ant propriÃ©taire peut booster ce produit");return}const j=50;if(l.user.jetons<j){i.error(`Pas assez de Jetons. Il vous faut ${j} Jetons pour booster ce produit.`);return}try{const H=await F.post(`/produits/${t.product.id}/boost`);l.user.jetons-=j,t.product.boosted_until=H.data.data.end_date,i.success(H.data.message||"Produit boostÃ© avec succÃ¨s !")}catch(H){i.error(((I=(z=H.response)==null?void 0:z.data)==null?void 0:I.message)||"Erreur lors du boostage du produit")}},M=j=>{g(j)},$=j=>{g(j)},g=async j=>{var Z,le,B;const u=(Z=l.user)==null?void 0:Z.id;if(!u){i.error("Connexion requise pour enregistrer la vue.");return}const z=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),I=new Date().toISOString().split("T")[0],H=localStorage.getItem("lastResetDate");if((!H||H!==I)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",I)),!z[j])try{setTimeout(async()=>{const re=await F.post("/record_view",{product_id:j,user_id:u});i.success(re.data.message)},1e3),z[j]=!0,localStorage.setItem("viewedProducts",JSON.stringify(z))}catch(re){console.error("Erreur lors de l'enregistrement de la vue:",re),i.error(((B=(le=re.response)==null?void 0:le.data)==null?void 0:B.message)||"Erreur lors de l'enregistrement de la vue.")}},_=async()=>{var j,u;try{await t.toggleFavorite(t.product.id)}catch(z){i.error(((u=(j=z.response)==null?void 0:j.data)==null?void 0:u.message)||"Erreur lors de la mise Ã  jour des favoris.")}},C=(j,u,z)=>{const I={id:j,name:u};localStorage.setItem("chatProduct",JSON.stringify(I)),p.push(`/messages/${z}`)},J=x(0),U=()=>{var u;const j=(((u=t.product.photos)==null?void 0:u.length)||1)-1;J.value=Math.min(J.value+1,j)},A=()=>{J.value=Math.max(J.value-1,0)};return ae(()=>{P(),n.initializeState(),a.value=new IntersectionObserver(j=>{j[0].isIntersecting&&!t.isLoading&&t.hasMore&&t.fetchProducts({category:t.product.category_id,per_page:8},!1)},{threshold:.1}),d.value&&a.value.observe(d.value)}),fe(()=>{a.value&&d.value&&a.value.unobserve(d.value)}),te(()=>m.params.id,j=>{j&&(P(),J.value=0)}),te(t.product,j=>{j&&(t.page=1,t.fetchProducts({category:j.category_id,per_page:4},!0),J.value=0)}),(j,u)=>{const z=ne("router-link");return s(),o(R,null,[L(ge,{isLoading:w(t).isLoading},null,8,["isLoading"]),e("div",So,[e("div",jo,[w(t).isLoading?(s(),o("div",Vo)):w(t).product?(s(),o("div",Mo,[L(ie,{name:"slide-up"},{default:N(()=>{var I,H,Z,le,B,re,xe,be,he,ye,_e,we,ke,$e;return[e("div",zo,[e("div",Eo,[e("div",Uo,[e("div",{class:"flex w-full h-full slider-container",style:ue({transform:`translateX(-${J.value*100}%)`})},[(s(!0),o(R,null,q(w(t).product.photos||[w(t).product.photo_url||"https://via.placeholder.com/300"],(me,ce)=>(s(),o("img",{key:ce,src:me,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${w(t).product.nom} - ${ce+1}`},null,8,Io))),128))],4),w(t).product.photos&&w(t).product.photos.length>1?(s(),o("button",{key:0,onClick:A,class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image prÃ©cÃ©dente"},u[2]||(u[2]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))):k("",!0),w(t).product.photos&&w(t).product.photos.length>1?(s(),o("button",{key:1,onClick:U,class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image suivante"},u[3]||(u[3]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))):k("",!0),w(t).product.photos&&w(t).product.photos.length>1?(s(),o("div",Lo,[(s(!0),o(R,null,q(w(t).product.photos,(me,ce)=>(s(),o("span",{key:ce,class:D(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":ce===J.value}])},null,2))),128))])):k("",!0)]),w(t).product.boosted_until&&new Date(w(t).product.boosted_until)>new Date?(s(),o("span",Fo," BoostÃ© ")):k("",!0),w(t).product.collaboratif?(s(),o("span",To," Collaboratif ")):k("",!0),w(l).user.premium?(s(),o("span",Ro," Premium ")):k("",!0)]),e("div",Oo,[e("h1",Do,v(w(t).product.nom),1),e("p",qo,v(w(t).product.description||"Aucune description disponible"),1),e("p",No,v(w(t).product.prix)+" XAF ",1),e("div",Wo,[e("p",null,[u[4]||(u[4]=e("strong",null,"CatÃ©gorie :",-1)),h(" "+v(((I=w(t).product.category)==null?void 0:I.nom)||"Non spÃ©cifiÃ©e"),1)]),e("p",null,[u[5]||(u[5]=e("strong",null,"QuantitÃ© :",-1)),h(" "+v(w(t).product.quantite),1)]),e("p",null,[u[6]||(u[6]=e("strong",null,"Ville :",-1)),h(" "+v(w(t).product.ville||"Non spÃ©cifiÃ©e"),1)]),e("p",null,[u[7]||(u[7]=e("strong",null,"AjoutÃ© le :",-1)),h(" "+v(new Date(w(t).product.created_at).toLocaleDateString("fr-FR")),1)]),e("div",Jo,[e("div",Ho,[u[8]||(u[8]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(w(t).product.raw_views_count)+" vues",1)]),e("div",Bo,[e("i",{class:D(["fas fa-heart text-[10px]",{"text-[var(--espace-or)]":w(t).product.is_favorited_by}])},null,2),e("span",null,v(w(t).product.favorites_count)+" favoris",1)])])]),e("button",{onClick:_,class:"w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm mb-3","aria-label":w(t).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:D(["fas fa-heart mr-2 text-sm",{"text-[var(--espace-or)]":w(t).product.is_favorited_by}])},null,2),h(" "+v(w(t).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"),1)],8,Go),e("div",Xo,[u[13]||(u[13]=e("h2",{class:"text-base font-semibold text-[var(--espace-vert)] mb-2 font-poppins"}," Ã€ propos du commerÃ§ant ",-1)),e("p",Ko,[e("strong",null,v((H=w(t).product.commercant)==null?void 0:H.nom),1),(Z=w(t).product.commercant)!=null&&Z.verified?(s(),o("span",Qo,u[9]||(u[9]=[e("i",{class:"fas fa-check-circle text-[10px]"},null,-1)]))):k("",!0)]),e("p",Zo,v(((le=w(t).product.commercant)==null?void 0:le.description)||"Aucune description disponible"),1),e("p",Yo,[u[10]||(u[10]=e("strong",null,"Ville :",-1)),h(" "+v(((B=w(t).product.commercant)==null?void 0:B.ville)||"NonspÃ©cifiÃ©e"),1)]),e("p",er,[u[11]||(u[11]=e("strong",null,"Note :",-1)),h(" "+v(((re=w(t).product.commercant)==null?void 0:re.rating)||"Non Ã©valuÃ©")+" / 5 ",1)]),L(z,{to:`/commercants/${w(t).product.commercant_id}`,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline text-xs font-poppins","aria-label":"Voir le profil du commerÃ§ant"},{default:N(()=>u[12]||(u[12]=[h(" Voir le profil du commerÃ§ant ")])),_:1,__:[12]},8,["to"])]),e("div",tr,[((be=(xe=w(l).user)==null?void 0:xe.commercant)==null?void 0:be.id)!==w(t).product.commercant_id?(s(),o("button",{key:0,onClick:V,class:"flex-1 bg-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] text-white transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le commerÃ§ant"},u[14]||(u[14]=[e("i",{class:"fas fa-phone mr-2 text-sm"},null,-1),h(" Contacter le commerÃ§ant ")]))):k("",!0),w(t).product.collaboratif&&((ye=(he=w(l).user)==null?void 0:he.commercant)==null?void 0:ye.id)!==w(t).product.commercant_id?(s(),o("button",{key:1,onClick:E,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Collaborer sur ce produit"},u[15]||(u[15]=[e("i",{class:"fas fa-handshake mr-2 text-sm"},null,-1),h(" Collaborer ")]))):k("",!0),((we=(_e=w(l).user)==null?void 0:_e.commercant)==null?void 0:we.id)===w(t).product.commercant_id?(s(),o("button",{key:2,onClick:y,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Modifier le produit"},u[16]||(u[16]=[e("i",{class:"fas fa-edit mr-2 text-sm"},null,-1),h(" Modifier le produit ")]))):k("",!0),(($e=(ke=w(l).user)==null?void 0:ke.commercant)==null?void 0:$e.id)===w(t).product.commercant_id?(s(),o("button",{key:3,onClick:T,class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm",disabled:!!w(t).product.boosted_until&&new Date(w(t).product.boosted_until)>new Date,"aria-label":w(t).product.boosted_until&&new Date(w(t).product.boosted_until)>new Date?"Boost dÃ©jÃ  actif":"Booster ce produit"},u[17]||(u[17]=[e("i",{class:"fas fa-rocket mr-2 text-sm"},null,-1)]),8,sr)):k("",!0),e("button",{onClick:u[0]||(u[0]=me=>C(w(t).product.id,w(t).product.nom,w(t).product.commercant.user.id)),class:"flex-1 bg-green-500 text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-green-600 transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le vendeur"},u[18]||(u[18]=[e("i",{class:"fas fa-comment mr-2 text-sm"},null,-1),h(" Contacter le vendeur ")]))])])])]}),_:1})])):(s(),o("div",ar," Produit non trouvÃ©. ")),L(ie,{name:"fade"},{default:N(()=>[b.value?(s(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:Q(f,["self"]),role:"dialog","aria-modal":"true","aria-label":"Proposer un prix de revente"},[e("div",or,[e("h2",rr," Collaborer sur "+v(w(t).product.nom),1),e("p",lr," Proposez un prix de revente (minimum : "+v(w(t).product.prix+(w(t).product.marge_min||0))+" XAF) ",1),e("form",{onSubmit:Q(c,["prevent"]),class:"space-y-3"},[e("div",null,[u[19]||(u[19]=e("label",{for:"prix_revente",class:"text-xs text-[var(--espace-vert)] font-medium"},"Prix de revente (XAF)",-1)),O(e("input",{id:"prix_revente","onUpdate:modelValue":u[1]||(u[1]=I=>r.value=I),type:"number",min:"0",class:"w-full h-10 p-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition","aria-label":`Prix de revente pour ${w(t).product.nom}`,required:""},null,8,nr),[[W,r.value,void 0,{number:!0}]]),r.value?(s(),o("p",ir," Marge potentielle : "+v(r.value-w(t).product.prix)+" XAF ",1)):k("",!0)]),e("div",{class:"flex gap-3"},[u[20]||(u[20]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-xs","aria-label":"Envoyer la demande de collaboration"}," Envoyer ",-1)),e("button",{type:"button",onClick:f,class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):k("",!0)]),_:1})]),w(t).products?(s(),o("div",ur,[u[21]||(u[21]=e("h2",{class:"text-lg sm:text-xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"}," Produits similaires ",-1)),L(Re,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},{default:N(()=>[(s(!0),o(R,null,q(w(t).products,I=>(s(),Y(je,{key:I.id,produit:I,onMouseover:H=>M(I.id),onTouchstart:H=>$(I.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:d,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":w(t).isLoading},[w(t).hasMore?k("",!0):(s(),o("p",cr," Aucun produit supplÃ©mentaire "))],8,dr)])):k("",!0)])],64)}}}),ji=X(pr,[["__scopeId","data-v-841f2cff"]]),vr={class:"relative bg-green-500"},mr={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] fixed top-0 left-0 w-full z-50 shadow-md"},fr={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},gr={class:"flex items-center gap-1 sm:gap-3"},xr={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},br=["aria-label"],hr={class:"flex items-center gap-2"},yr=["src"],_r={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},wr={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},kr={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},$r={class:"flex justify-around items-center py-2"},Ar=["aria-label"],Cr=G({__name:"AppHeader",setup(S){const t=oe(),m=Se(),p=se(),l=t.user;Pe();const n=x(!1),i=x(!1),b=x(!1),r=x(""),a=ve(),d=x(!1),P=x(null),V=x(!1),E=de(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...t.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...t.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:m.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),c=async()=>{if(t.user)try{const $=await F.get("/user/badges");m.saveCollaborationsToLocalStorage($.data.collaborations_pending.map(g=>({produit_id:g.produit_id,prix_revente:g.prix_revente,status:g.status,created_at:g.created_at})))}catch($){console.error("Erreur lors du chargement des badges:",$)}};te(()=>t.user,$=>{$&&(c(),m.initializeState())},{immediate:!0}),te(()=>m.collaborationsPending,()=>{m.collaborationsPending>0&&(i.value=!0,setTimeout(()=>i.value=!1,300))});const f=async()=>{if(r.value.trim())try{await a.fetchProducts({search:r.value.trim()},!0),r.value="",d.value=!1}catch($){console.error("Erreur lors de la recherche:",$)}},y=$=>{if(V.value){V.value=!1;return}P.value&&!P.value.contains($.target)&&(d.value=!1)},T=async()=>{d.value=!d.value,d.value&&(V.value=!0,await Ve())},M=()=>{p.push("/messages")};return ae(()=>{t.user&&(c(),m.initializeState()),document.addEventListener("click",y)}),fe(()=>{document.removeEventListener("click",y)}),($,g)=>{const _=ne("RouterLink");return s(),o("div",vr,[e("header",mr,[e("div",fr,[e("div",gr,[L(_,{to:"/","aria-label":"Retour Ã  l'accueil"},{default:N(()=>g[2]||(g[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Oe,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),g[3]||(g[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ",-1))]),e("nav",xr,[(s(!0),o(R,null,q(E.value,C=>(s(),Y(_,{key:C.to,to:C.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:D(["fas",C.icon])},null,2),h(" "+v(C.label)+" ",1),C.badge>0?(s(),o("span",{key:0,class:D(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":C.to==="/panier"&&n.value||C.to==="/collaborations"&&i.value||C.to==="/commandes"&&b.value}]),"aria-label":C.to==="/panier"?"Nombre d'articles dans le panier":C.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(C.badge),11,br)):k("",!0)]),_:2},1032,["to"]))),128))]),L(De),e("div",hr,[e("button",{onClick:T,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},g[4]||(g[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)])),e("button",{onClick:M,class:"text-[var(--espace-white)] px-1 rounded hover:bg-white transition"},g[5]||(g[5]=[e("i",{class:"fas fa-comment-dots text-2xl"},null,-1)])),(s(!0),o(R,null,q(E.value.filter(C=>w(t).user?C.to==="/profil":["/login","/register"].includes(C.to)),C=>(s(),Y(_,{key:C.to,to:C.to,class:"relative flex items-center justify-center","aria-label":C.label},{default:N(()=>{var J;return[(J=w(l))!=null&&J.photo?(s(),o("img",{key:0,src:`http://localhost:8000/storage/${w(l).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,yr)):(s(),o("div",_r,[e("i",{class:D([`fas ${C.icon}`,"text-2xl text-gray-100"])},null,2)])),C.badge>0&&C.to==="/collaborations"?(s(),o("span",{key:2,class:D(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":C.to==="/collaborations"&&i.value}]),"aria-label":"Collaborations en attente"},v(C.badge),3)):k("",!0)]}),_:2},1032,["to","aria-label"]))),128))])]),d.value?(s(),o("div",{key:0,ref_key:"searchOverlayRef",ref:P,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",wr,[O(e("input",{"onUpdate:modelValue":g[0]||(g[0]=C=>r.value=C),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:Le(f,["enter"])},null,544),[[W,r.value]]),e("button",{onClick:f,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},g[6]||(g[6]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:g[1]||(g[1]=C=>d.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},g[7]||(g[7]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):k("",!0)]),L(ie,{name:"slide-up"},{default:N(()=>[e("nav",kr,[e("div",$r,[(s(!0),o(R,null,q(E.value,C=>(s(),Y(_,{key:C.to,to:C.to,"aria-label":C.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:D(["fas text-lg",C.icon])},null,2),C.badge>0?(s(),o("span",{key:0,class:D(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":C.to==="/panier"&&n.value||C.to==="/collaborations"&&i.value||C.to==="/commandes"&&b.value}]),"aria-label":C.to==="/panier"?"Nombre d'articles dans le panier":C.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(C.badge),11,Ar)):k("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),qe=X(Cr,[["__scopeId","data-v-7e2b9e46"]]),Pr={class:"min-h-screen bg-gray-100",style:{background:"url(/src/assets/images/bginsc.jpg) center/cover"}},Sr={class:"container mx-auto px-4 sm:px-6 py-6"},jr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Vr={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Mr={key:0,class:"text-sm sm:text-base text-[var(--espace-gris)]"},zr={key:1,class:"text-sm sm:text-base text-[var(--espace-gris)]"},Er={key:2,class:"text-sm text-[var(--espace-gris)] italic"},Ur={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Ir=["value"],Lr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Fr=["value"],Tr={class:"flex items-center gap-2 text-sm col-span-2 sm:col-span-1"},Rr=["value"],Or={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 border border-gray-100"},Dr={key:0,class:"flex items-center gap-3 text-[var(--espace-vert)]"},qr={key:1,class:"text-base text-[var(--espace-gris)] italic"},Nr={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Wr=["onClick"],Jr=G({__name:"CommercantDashboard",setup(S){const t=K(),m=x([]),p=x([]),l=x(null),n=x(!1),i=x({nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}),b=x({nom:"",description:"",ville:""}),r=x(["Douala","YaoundÃ©","Bamenda","Buea","Garoua"]),a=async()=>{n.value=!0;try{const[E,c,f]=await Promise.all([F.get("/commercant/produits"),F.get("/categories"),F.get("/commercant/profil")]);n.value=!1,m.value=E.data.produits.map(y=>{var T;return{...y,commercant_id:((T=l.value)==null?void 0:T.id)||""}}),p.value=c.data.categories,l.value=f.data.commercant,b.value={nom:l.value.nom,description:l.value.description||"",ville:l.value.ville||""}}catch{t.error("Erreur lors du chargement des donnÃ©es."),n.value=!1}},d=async()=>{try{const E=await F.post("/commercant/produits",i.value);t.success("Produit ajoutÃ© avec succÃ¨s."),a(),i.value={nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}}catch{t.error("Erreur lors de lâ€™ajout du produit.")}},P=async E=>{if(confirm("Voulez-vous supprimer ce produit ?"))try{await F.delete(`/commercant/produits/${E}`),t.success("Produit supprimÃ© avec succÃ¨s."),a()}catch{t.error("Erreur lors de la suppression du produit.")}},V=async()=>{try{await F.put("/commercant/profil",b.value),t.success("Profil mis Ã  jour avec succÃ¨s."),a()}catch{t.error("Erreur lors de la mise Ã  jour du profil.")}};return ae(()=>{a()}),(E,c)=>(s(),o("div",Pr,[L(qe),e("div",Sr,[c[26]||(c[26]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] flex items-center gap-3 mb-6"},[e("i",{class:"fas fa-store text-xl"}),h(" Espace CommerÃ§ant ")],-1)),e("div",jr,[c[14]||(c[14]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-3"},"Statistiques",-1)),e("div",Vr,[l.value?(s(),o("p",Mr,[c[12]||(c[12]=e("span",{class:"font-medium"},"Revenus :",-1)),h(" "+v(l.value.revenus)+" FCFA ",1)])):k("",!0),l.value?(s(),o("p",zr,[c[13]||(c[13]=e("span",{class:"font-medium"},"Produits vendus :",-1)),h(" "+v(l.value.produits_vendus),1)])):(s(),o("p",Er,"Chargement..."))])]),e("div",Ur,[c[17]||(c[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Profil CommerÃ§ant",-1)),e("form",{onSubmit:Q(V,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[O(e("input",{"onUpdate:modelValue":c[0]||(c[0]=f=>b.value.nom=f),type:"text",placeholder:"Nom du commerÃ§ant",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,b.value.nom]]),O(e("textarea",{"onUpdate:modelValue":c[1]||(c[1]=f=>b.value.description=f),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[W,b.value.description]]),O(e("select",{"onUpdate:modelValue":c[2]||(c[2]=f=>b.value.ville=f),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2 sm:col-span-1"},[c[15]||(c[15]=e("option",{value:""},"Ville",-1)),(s(!0),o(R,null,q(r.value,f=>(s(),o("option",{key:f,value:f},v(f),9,Ir))),128))],512),[[pe,b.value.ville]]),c[16]||(c[16]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-check"})],-1))],32)]),e("div",Lr,[c[22]||(c[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Ajouter un produit",-1)),e("form",{onSubmit:Q(d,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[O(e("input",{"onUpdate:modelValue":c[3]||(c[3]=f=>i.value.nom=f),type:"text",placeholder:"Nom du produit",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,i.value.nom]]),O(e("textarea",{"onUpdate:modelValue":c[4]||(c[4]=f=>i.value.description=f),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[W,i.value.description]]),O(e("input",{"onUpdate:modelValue":c[5]||(c[5]=f=>i.value.prix=f),type:"number",placeholder:"Prix",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,i.value.prix]]),O(e("input",{"onUpdate:modelValue":c[6]||(c[6]=f=>i.value.photo_url=f),type:"text",placeholder:"URL de la photo",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[W,i.value.photo_url]]),O(e("select",{"onUpdate:modelValue":c[7]||(c[7]=f=>i.value.category_id=f),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[c[18]||(c[18]=e("option",{value:""},"CatÃ©gorie",-1)),(s(!0),o(R,null,q(p.value,f=>(s(),o("option",{key:f.id,value:f.id},v(f.nom),9,Fr))),128))],512),[[pe,i.value.category_id]]),e("label",Tr,[O(e("input",{"onUpdate:modelValue":c[8]||(c[8]=f=>i.value.collaboratif=f),type:"checkbox"},null,512),[[Fe,i.value.collaboratif]]),c[19]||(c[19]=h(" Collaboratif "))]),O(e("input",{"onUpdate:modelValue":c[9]||(c[9]=f=>i.value.marge_min=f),type:"number",placeholder:"Marge minimum",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[W,i.value.marge_min]]),O(e("input",{"onUpdate:modelValue":c[10]||(c[10]=f=>i.value.stock=f),type:"number",placeholder:"Stock",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,i.value.stock]]),O(e("select",{"onUpdate:modelValue":c[11]||(c[11]=f=>i.value.ville=f),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[c[20]||(c[20]=e("option",{value:""},"Ville",-1)),(s(!0),o(R,null,q(r.value,f=>(s(),o("option",{key:f,value:f},v(f),9,Rr))),128))],512),[[pe,i.value.ville]]),c[21]||(c[21]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-plus"})],-1))],32)]),e("div",Or,[c[25]||(c[25]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Produits",-1)),n.value?(s(),o("div",Dr,c[23]||(c[23]=[e("i",{class:"fas fa-spinner animate-spin text-xl"},null,-1),e("span",{class:"text-base font-poppins"},"Chargement...",-1)]))):m.value.length===0?(s(),o("div",qr," Aucun produit disponible. ")):(s(),o("div",Nr,[(s(!0),o(R,null,q(m.value,f=>(s(),o("div",{key:f.id,class:"relative"},[L(je,{produit:f},null,8,["produit"]),e("button",{onClick:y=>P(f.id),class:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition flex items-center justify-center","aria-label":"Supprimer le produit"},c[24]||(c[24]=[e("i",{class:"fas fa-trash text-sm"},null,-1)]),8,Wr)]))),128))]))])])]))}}),Vi=X(Jr,[["__scopeId","data-v-98a2ca3d"]]),Hr={class:"overflow-y-scroll bg-gray-100 pt-2 pb-12 px-4 sm:px-6"},Br={class:"container mx-auto max-w-4xl"},Gr={class:"bg-white rounded-lg shadow-md p-6 mb-6"},Xr={key:0,class:"ml-2"},Kr={class:"w-full bg-gray-200 rounded-full h-4"},Qr={class:"text-[var(--espace-gris)] text-xs mt-2"},Zr={key:0,class:"text-[var(--espace-gris)] text-xs mt-1"},Yr={class:"bg-white rounded-lg shadow-md p-6 mb-6"},el={key:0,class:"mb-4"},tl={class:"text-sm text-[var(--espace-gris)]"},sl={class:"font-bold text-[var(--espace-or)]"},al={class:"text-sm text-[var(--espace-gris)] truncate"},ol=["href"],rl={key:1,class:"mb-4"},ll=["placeholder"],nl={class:"flex flex-col sm:flex-row gap-2"},il=["disabled"],ul={key:0},dl={key:1},cl=["disabled"],pl={key:0},vl={key:1},ml={key:2,class:"mt-4 flex flex-col sm:flex-row gap-2"},fl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},gl={key:0,class:"overflow-x-auto"},xl={class:"w-full text-sm text-left text-[var(--espace-gris)]"},bl={class:"px-4 py-2"},hl={class:"px-4 py-2"},yl={class:"px-4 py-2"},_l={key:1,class:"text-center text-[var(--espace-gris)] py-4"},wl={class:"bg-white rounded-lg shadow-md p-6 text-center"},kl={class:"text-2xl sm:text-3xl font-bold text-[var(--espace-or)]"},$l={class:"text-[var(--espace-gris)] mt-2"},Al=G({__name:"Parrainage",setup(S){const t=oe(),m=se(),p=K(),l=x(""),n=x(""),i=x([]),b=x(0),r=x(""),a=x(""),d=x(!1),P=x(!1),V=x({}),E=x(null),c=x(0),f=de(()=>{var g;return((g=V.value)==null?void 0:g.couleur)||"#6b7280"}),y=async()=>{if(!t.user){p.error("Veuillez vous connecter pour accÃ©der Ã  cette page"),m.push("/login");return}try{const _=(await F.get("/parrainages/dashboard")).data;l.value=_.code||"",console.log(_),n.value=_.code?`https://espacecameroun.cm/invite/${_.code}`:"",i.value=_.parrainages||[],b.value=_.total_gains||0,V.value=_.niveau_actuel,console.log(V.value),E.value=_.niveau_suivant,c.value=_.progression}catch(g){p.error("Erreur lors de la rÃ©cupÃ©ration des donnÃ©es de parrainage"),console.error(g)}},T=async()=>{if(!t.user){p.error("Veuillez vous connecter");return}d.value=!0;try{const g=await F.post("/parrainages/generateCode");r.value=g.data.suggested_code,a.value=r.value,p.success("Nouveau code suggÃ©rÃ© avec succÃ¨s !")}catch(g){p.error("Erreur lors de la gÃ©nÃ©ration du code"),console.error(g)}finally{d.value=!1}},M=async()=>{var g,_;if(!t.user){p.error("Veuillez vous connecter");return}if(!a.value.trim()){p.error("Veuillez entrer un code valide");return}P.value=!0;try{const C=await F.post("/parrainages/create-code",{code:a.value.trim()});l.value=C.data.code,n.value=C.data.link||`https://espacecameroun.cm/invite/${C.data.code}`,p.success(C.data.message||"Code crÃ©Ã© avec succÃ¨s !"),await y()}catch(C){p.error(((_=(g=C.response)==null?void 0:g.data)==null?void 0:_.message)||"Erreur lors de la crÃ©ation du code"),console.error(C)}finally{P.value=!1}},$=g=>{if(!n.value){p.error("Aucun lien disponible pour le partage");return}let _="";const C=encodeURIComponent(`Rejoins-moi sur Espace Cameroun avec mon lien : ${n.value}`);switch(g){case"whatsapp":_=`https://api.whatsapp.com/send?text=${C}`;break;case"facebook":_=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(n.value)}`;break;default:p.error("Plateforme non prise en charge");return}window.open(_,"_blank")};return ae(()=>{y()}),(g,_)=>{var C,J,U,A,j;return s(),o("div",Hr,[e("div",Br,[e("div",Gr,[_[6]||(_[6]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Niveaux de Parrainage",-1)),e("p",{class:"text-[var(--espace-gris)] text-sm mb-2",style:ue({color:f.value})},[_[4]||(_[4]=h(" Votre niveau actuel : ")),e("strong",null,v(V.value?V.value.nom:"pas niveau")+" "+v((C=V.value)==null?void 0:C.emoji)+" ("+v(i.value.length)+"/"+v(E.value?E.value.filleuls_requis:(J=V.value)==null?void 0:J.filleuls_requis)+")",1),((U=V.value)==null?void 0:U.jetons_bonus)>0?(s(),o("span",Xr,"+"+v((A=V.value)==null?void 0:A.jetons_bonus)+" jetons bonus",1)):k("",!0)],4),e("div",Kr,[e("div",{class:"h-4 rounded-full bg-[var(--espace-or)] transition-all duration-300",style:ue({width:`${c.value}%`,background:`${f.value}`})},null,4)]),e("p",Qr," Prochain niveau : "+v(E.value?E.value.nom:"LÃ©gende ğŸ†")+" Ã  "+v(E.value?E.value.filleuls_requis:"1000+")+" parrainages ",1),(j=V.value.avantages)!=null&&j.length?(s(),o("p",Zr," Avantages : "+v(V.value.avantages.join(", ")),1)):k("",!0),e("button",{onClick:_[0]||(_[0]=u=>w(m).push("/parrainage/info")),class:"mt-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},_[5]||(_[5]=[e("i",{class:"fas fa-info-circle mr-2"},null,-1),h(" En savoir plus ")]))]),_[23]||(_[23]=e("div",{class:"bg-white rounded-lg shadow-md p-6 mb-6"},[e("p",{class:"text-[var(--espace-gris)] text-sm sm:text-base"},[h(" Invitez des amis avec votre lien ou code unique et gagnez des rÃ©compenses ! Recevez "),e("strong",null,"1 jeton"),h(" pour chaque commerÃ§ant actif parrainÃ©. ")])],-1)),e("div",Yr,[_[15]||(_[15]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Votre Code de Parrainage",-1)),l.value?(s(),o("div",el,[e("p",tl,[_[7]||(_[7]=h(" Code : ")),e("span",sl,v(l.value),1)]),e("p",al,[_[8]||(_[8]=h(" Lien : ")),e("a",{href:n.value,target:"_blank",class:"text-blue-500 underline hover:text-blue-700"},v(n.value),9,ol)])])):(s(),o("div",rl,[O(e("input",{"onUpdate:modelValue":_[1]||(_[1]=u=>a.value=u),type:"text",placeholder:r.value||"Entrez ou gÃ©nÃ©rez un code (ex: DOM2025)",class:"w-full p-2 border rounded mb-2 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",maxlength:"10"},null,8,ll),[[W,a.value]]),e("div",nl,[e("button",{onClick:T,disabled:d.value,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition flex-1 disabled:opacity-50"},[d.value?(s(),o("span",ul,_[9]||(_[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),h(" GÃ©nÃ©ration... ")]))):(s(),o("span",dl,_[10]||(_[10]=[e("i",{class:"fas fa-magic mr-2"},null,-1),h(" GÃ©nÃ©rer un code ")])))],8,il),e("button",{onClick:M,disabled:P.value||!a.value.trim(),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1 disabled:opacity-50"},[P.value?(s(),o("span",pl,_[11]||(_[11]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),h(" CrÃ©ation... ")]))):(s(),o("span",vl,_[12]||(_[12]=[e("i",{class:"fas fa-check mr-2"},null,-1),h(" CrÃ©er le code ")])))],8,cl)])])),l.value?(s(),o("div",ml,[e("button",{onClick:_[2]||(_[2]=u=>$("whatsapp")),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1"},_[13]||(_[13]=[e("i",{class:"fab fa-whatsapp mr-2"},null,-1),h(" Partager sur WhatsApp ")])),e("button",{onClick:_[3]||(_[3]=u=>$("facebook")),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition flex-1"},_[14]||(_[14]=[e("i",{class:"fab fa-facebook-f mr-2"},null,-1),h(" Partager sur Facebook ")]))])):k("",!0)]),e("div",fl,[_[17]||(_[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Utilisateurs ParrainÃ©s",-1)),i.value.length?(s(),o("div",gl,[e("table",xl,[_[16]||(_[16]=e("thead",{class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)]"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Nom"),e("th",{class:"px-4 py-2"},"Date d'inscription"),e("th",{class:"px-4 py-2"},"Est commerÃ§ant")])],-1)),e("tbody",null,[(s(!0),o(R,null,q(i.value,u=>(s(),o("tr",{key:u.id,class:"border-b hover:bg-gray-50"},[e("td",bl,v(u.filleul_nom||"Anonyme"),1),e("td",hl,v(new Date(u.date_inscription).toLocaleDateString("fr-FR")),1),e("td",yl,v(u.est_commerÃ§ant?"Oui":"Non"),1)]))),128))])])])):(s(),o("p",_l," Aucun utilisateur parrainÃ© pour le moment. Commencez Ã  inviter dÃ¨s maintenant ! "))]),e("div",wl,[_[21]||(_[21]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2"},"Vos Gains",-1)),e("p",kl,v(b.value)+" jetons ",1),e("p",$l,[_[18]||(_[18]=h(" ğŸ‰ Vous avez invitÃ© ")),e("strong",null,v(i.value.length),1),_[19]||(_[19]=h(" utilisateurs, dont ")),e("strong",null,v(i.value.filter(u=>u.est_commerÃ§ant).length),1),_[20]||(_[20]=h(" sont commerÃ§ants ! "))]),_[22]||(_[22]=e("p",{class:"text-[var(--espace-gris)]"},[h("â¬‡ï¸ Gagnez "),e("strong",null,"1 jeton"),h(" par commerÃ§ant actif parrainÃ©. ")],-1))])])])}}}),Mi=X(Al,[["__scopeId","data-v-948a6d84"]]),Cl={class:"min-h-screen bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Pl={class:"container mx-auto max-w-4xl"},Sl={key:0,class:"grid grid-cols-1 gap-4"},jl={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Vl=["onClick"],Ml={class:"text-sm text-[var(--espace-gris)]"},zl={class:"text-sm text-[var(--espace-gris)]"},El=["onClick"],Ul={key:1,class:"text-center text-[var(--espace-gris)]"},Il=G({__name:"Collaborations",setup(S){const t=K(),m=se(),p=x([]),l=x(!0),n=async()=>{try{const b=await F.get("/collaborations");console.log(b.data),p.value=b.data.collaborations}catch{t.error("Erreur lors du chargement des collaborations")}finally{l.value=!1}},i=b=>{m.push({path:`/produits/${b}`})};return ae(()=>{l.value=!0,n()}),(b,r)=>(s(),o(R,null,[L(ge,{isLoading:l.value},null,8,["isLoading"]),e("div",Cl,[e("div",Pl,[r[1]||(r[1]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-handshake mr-2 text-[var(--espace-or)]"}),h(" Mes Collaborations ")],-1)),!l.value&&p.value.length?(s(),o("div",Sl,[(s(!0),o(R,null,q(p.value,a=>(s(),o("div",{key:a.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",jl,[e("div",null,[e("h2",{onClick:d=>i(a.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},v(a.produit.nom),9,Vl),e("p",Ml," Prix de revente : "+v(a.prix_revente)+" FCFA ",1),e("p",zl,[r[0]||(r[0]=h(" Statut : ")),e("span",{class:D({"text-green-600":a.statut==="accepted","text-yellow-600":a.statut==="pending","text-red-600":a.statut==="rejected"})},v(a.statut==="pending"?"En attente":a.statut==="accepted"?"AcceptÃ©e":"RejetÃ©e"),3)])]),e("button",{onClick:d=>i(a.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs","aria-label":"Voir le produit"}," Voir le produit ",8,El)])]))),128))])):l.value?k("",!0):(s(),o("p",Ul," Aucune collaboration pour le moment. "))])])],64))}}),zi=X(Il,[["__scopeId","data-v-1fb45e53"]]),Ll={class:"min-h-screen bg-gray-100"},Fl={class:"container mx-auto px-4 sm:px-6 py-8"},Tl={key:0,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mb-8 border border-gray-100 overflow-hidden"},Rl={class:"flex flex-col sm:flex-row items-center gap-6"},Ol={class:"w-24 h-24 bg-[var(--espace-or)] rounded-full flex items-center justify-center overflow-hidden"},Dl=["src"],ql={key:1,class:"fas fa-user text-3xl text-[var(--espace-vert)]"},Nl={class:"flex-1"},Wl={class:"text-3xl font-bold text-[var(--espace-vert)] mb-2"},Jl={class:"text-sm text-[var(--espace-gris)] mb-1"},Hl={class:"text-sm text-[var(--espace-gris)] mb-1"},Bl={class:"text-sm text-[var(--espace-gris)]"},Gl={key:0,class:"text-sm text-[var(--espace-gris)]"},Xl={class:"mt-2 flex space-x-2 flex-col"},Kl={class:"text-sm text-[var(--espace-gris)]"},Ql={class:"text-xs text-[var(--espace-gris)]"},Zl={class:"mt-4 flex flex-wrap gap-4"},Yl={class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},en={key:0,class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},tn={key:1,class:"text-base text-[var(--espace-gris)] italic"},sn={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},an={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},on={class:"flex items-center space-x-2"},rn={key:3},ln={key:4,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-4 border border-gray-100"},nn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},un={key:5,class:"text-base text-[var(--espace-gris)] italic"},dn={key:6,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-8 border border-gray-100"},cn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},pn={class:"text-sm text-[var(--espace-gris)]"},vn={class:"text-sm text-[var(--espace-gris)]"},mn=G({__name:"CommercantDetails",setup(S){const t=Pe(),m=K(),p=x(!1),l=x(null),n=x(null),i=x(0),b=x(0),r=x(!1),a=ve(),d=async()=>{p.value=!0;try{const c=await F.get(`/commercant/${t.params.commercantId}`);console.log(c.data),l.value=c.data.commercant,i.value=c.data.average_rating||0,b.value=c.data.vote_count||0,a.products.length===0&&await a.fetchProducts({per_page:"all"})}catch{m.error("Erreur lors du chargement des dÃ©tails du commerÃ§ant.")}finally{p.value=!1}},P=async()=>{var c,f;if(n.value===null||n.value<1||n.value>5){m.error("Veuillez sÃ©lectionner une note entre 1 et 5.");return}try{const y=await F.post(`/commercant/${t.params.commercantId}/rate`,{rating:n.value});i.value=y.data.average_rating||0,m.success("Merci pour votre note !"),n.value=null,r.value=!1,b.value=y.data.vote_count||b.value+1}catch(y){m.error(((f=(c=y.response)==null?void 0:c.data)==null?void 0:f.message)||"Erreur lors de la notation.")}},V=de(()=>a.products.filter(c=>c.commercant_id===t.params.commercantId)),E=()=>{r.value=!0};return ae(async()=>{d()}),(c,f)=>(s(),o(R,null,[L(ge,{isLoading:p.value},null,8,["isLoading"]),e("div",Ll,[L(qe),e("div",Fl,[l.value?(s(),o("div",Tl,[e("div",Rl,[e("div",Ol,[l.value.photo_url?(s(),o("img",{key:0,src:l.value.photo_url,alt:"Photo du commerÃ§ant",class:"w-full h-full object-cover"},null,8,Dl)):(s(),o("i",ql))]),e("div",Nl,[e("h1",Wl,v(l.value.nom),1),e("p",Jl,[f[2]||(f[2]=e("strong",null,"Ville :",-1)),h(" "+v(l.value.ville),1)]),e("p",Hl,[f[3]||(f[3]=e("strong",null,"Inscrit depuis :",-1)),h(" "+v(new Date(l.value.created_at).toLocaleDateString()),1)]),e("p",Bl,[f[4]||(f[4]=e("strong",null,"Contact :",-1)),h(" "+v(l.value.email||"Non disponible"),1)]),l.value.telephone?(s(),o("p",Gl,[f[5]||(f[5]=e("strong",null,"TÃ©lÃ©phone :",-1)),h(" "+v(l.value.telephone),1)])):k("",!0),e("div",Xl,[e("div",{class:"flex items-center space-x-1 cursor-pointer",onClick:E},[(s(),o(R,null,q(5,y=>e("span",{key:y,class:"text-yellow-400"},[e("i",{class:D(y<=Math.round(i.value)?"fas fa-star":"far fa-star")},null,2)])),64)),e("p",Kl,v(i.value.toFixed(1))+"/5 ",1)]),e("span",Ql,"("+v(b.value)+" votes)",1)])])]),e("div",Zl,[e("span",Yl,"Produits : "+v(V.value.length),1),l.value.revenus?(s(),o("span",en,"Revenus : "+v(l.value.revenus)+" FCFA",1)):k("",!0)])])):p.value?k("",!0):(s(),o("div",tn,"CommerÃ§ant non trouvÃ©.")),r.value?(s(),o("div",sn,[e("div",an,[f[6]||(f[6]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Noter ce CommerÃ§ant",-1)),e("div",on,[O(e("input",{"onUpdate:modelValue":f[0]||(f[0]=y=>n.value=y),type:"number",min:"1",max:"5",step:"1",class:"w-16 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"1-5"},null,512),[[W,n.value,void 0,{number:!0}]]),e("button",{onClick:P,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Soumettre "),e("button",{onClick:f[1]||(f[1]=y=>r.value=!1),class:"bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors ml-2"}," Annuler ")])])])):k("",!0),p.value?(s(),o("div",rn)):V.value.length>0?(s(),o("div",ln,[f[7]||(f[7]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-6"},"Produits du CommerÃ§ant",-1)),e("div",nn,[(s(!0),o(R,null,q(V.value,y=>(s(),Y(je,{key:y.id,produit:y},null,8,["produit"]))),128))])])):l.value&&V.value.length===0?(s(),o("div",un,"Aucun produit disponible pour ce commerÃ§ant.")):k("",!0),l.value&&l.value.statistiques?(s(),o("div",dn,[f[10]||(f[10]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Statistiques",-1)),e("div",cn,[e("p",pn,[f[8]||(f[8]=e("strong",null,"Vues totales :",-1)),h(" "+v(l.value.statistiques.total_views),1)]),e("p",vn,[f[9]||(f[9]=e("strong",null,"Produits populaires :",-1)),h(" "+v(l.value.statistiques.popular_products),1)])])])):k("",!0)])])],64))}}),Ei=X(mn,[["__scopeId","data-v-b4ed11a4"]]),fn={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},gn={class:"container mx-auto max-w-2xl"},xn={class:"bg-white rounded-lg shadow-md p-6"},bn={key:0,class:"text-red-500 text-xs"},hn={key:0,class:"text-red-500 text-xs"},yn={key:0,class:"text-red-500 text-xs"},_n={key:0,class:"text-red-500 text-xs"},wn={key:0,class:"text-red-500 text-xs"},kn=["disabled"],$n={key:0},An={key:1},Cn=G({__name:"CommercantCreate",setup(S){const t=se(),m=K(),p=x({nom:"",ville:"",email:"",telephone:"",photo:null}),l=x(!1),n=x({}),i=r=>{const a=r.target;a.files&&a.files[0]&&(p.value.photo=a.files[0])},b=async()=>{var r,a;l.value=!0,n.value={};try{const d=new FormData;d.append("nom",p.value.nom),d.append("ville",p.value.ville),d.append("email",p.value.email),d.append("telephone",p.value.telephone),p.value.photo&&d.append("photo",p.value.photo);const P=await F.post("/commercants",d,{headers:{"Content-Type":"multipart/form-data"}});console.log(P.data.message),m.success("CommerÃ§ant crÃ©Ã© avec succÃ¨s !"),t.push("/profil")}catch(d){(a=(r=d.response)==null?void 0:r.data)!=null&&a.errors?n.value=d.response.data.errors:m.error("Erreur lors de la crÃ©ation du commerÃ§ant"),console.error(d)}finally{l.value=!1}};return(r,a)=>(s(),o("div",fn,[e("div",gn,[a[11]||(a[11]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-store mr-2 text-[var(--espace-or)]"}),h(" CrÃ©er un CommerÃ§ant ")],-1)),e("div",xn,[e("form",{onSubmit:Q(b,["prevent"]),class:"space-y-6"},[e("div",null,[a[4]||(a[4]=e("label",{for:"nom",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom *",-1)),O(e("input",{"onUpdate:modelValue":a[0]||(a[0]=d=>p.value.nom=d),id:"nom",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerÃ§ant",required:""},null,512),[[W,p.value.nom]]),n.value.nom?(s(),o("span",bn,v(n.value.nom),1)):k("",!0)]),e("div",null,[a[5]||(a[5]=e("label",{for:"ville",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Ville *",-1)),O(e("input",{"onUpdate:modelValue":a[1]||(a[1]=d=>p.value.ville=d),id:"ville",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville",required:""},null,512),[[W,p.value.ville]]),n.value.ville?(s(),o("span",hn,v(n.value.ville),1)):k("",!0)]),e("div",null,[a[6]||(a[6]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),O(e("input",{"onUpdate:modelValue":a[2]||(a[2]=d=>p.value.email=d),id:"email",type:"email",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"email@exemple.com"},null,512),[[W,p.value.email]]),n.value.email?(s(),o("span",yn,v(n.value.email),1)):k("",!0)]),e("div",null,[a[7]||(a[7]=e("label",{for:"telephone",class:"block text-sm font-medium text-[var(--espace-vert)]"},"TÃ©lÃ©phone",-1)),O(e("input",{"onUpdate:modelValue":a[3]||(a[3]=d=>p.value.telephone=d),id:"telephone",type:"tel",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"+237 6XX XX XX XX"},null,512),[[W,p.value.telephone]]),n.value.telephone?(s(),o("span",_n,v(n.value.telephone),1)):k("",!0)]),e("div",null,[a[8]||(a[8]=e("label",{for:"photo",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Photo (optionnel)",-1)),e("input",{id:"photo",type:"file",onChange:i,class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",accept:"image/*"},null,32),n.value.photo?(s(),o("span",wn,v(n.value.photo),1)):k("",!0)]),e("div",null,[e("button",{type:"submit",disabled:l.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition disabled:opacity-50"},[l.value?(s(),o("span",$n,a[9]||(a[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),h(" CrÃ©ation en cours... ")]))):(s(),o("span",An,a[10]||(a[10]=[e("i",{class:"fas fa-plus mr-2"},null,-1),h(" CrÃ©er le commerÃ§ant ")])))],8,kn)])],32)])])]))}}),Ui=X(Cn,[["__scopeId","data-v-0c50a6f0"]]),Pn={class:"overflow-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Sn={class:"container mx-auto max-w-4xl"},jn={class:"bg-white rounded-lg shadow-md p-6"},Vn={class:"text-md font-semibold text-[var(--espace-vert)] flex items-center"},Mn={class:"ml-2 text-sm text-[var(--espace-gris)]"},zn={class:"text-[var(--espace-gris)] text-sm mt-2"},En={key:0,class:"text-[var(--espace-gris)] text-sm mt-1"},Un={class:"list-disc list-inside ml-4"},In=G({__name:"ParrainageInfo",setup(S){const t=se(),m=K(),p=x([]),l=async()=>{try{const i=await F.get("/parrainages/niveaux");p.value=i.data.niveaux}catch(i){m.error("Erreur lors de la rÃ©cupÃ©ration des niveaux de parrainage"),console.error(i)}},n=()=>{t.go(-1)};return ae(()=>{l()}),(i,b)=>(s(),o("div",Pn,[e("div",Sn,[b[6]||(b[6]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-info-circle mr-2 text-[var(--espace-or)]"}),h(" Tout Savoir sur le Parrainage ")],-1)),e("button",{onClick:n,class:"mb-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},b[0]||(b[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),h(" Retour ")])),b[7]||(b[7]=Ce('<div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-c86d6ea1><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-c86d6ea1>Qu&#39;est-ce que le Parrainage ?</h2><p class="text-[var(--espace-gris)] text-sm sm:text-base" data-v-c86d6ea1> Le systÃ¨me de parrainage d&#39;Espace Cameroun vous permet d&#39;inviter des amis Ã  rejoindre la plateforme en utilisant votre code ou lien unique. Pour chaque commerÃ§ant actif que vous parrainez, vous recevez <strong data-v-c86d6ea1>1 jeton </strong>. En plus de cela, vous pouvez dÃ©bloquer des niveaux en fonction du nombre total de parrainages, chacun offrant des bonus en jetons et des avantages exclusifs. Voici les Ã©tapes et dÃ©tails complets : </p></div><div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-c86d6ea1><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-c86d6ea1>Comment Ã§a fonctionne ?</h2><ol class="list-decimal list-inside text-[var(--espace-gris)] text-sm sm:text-base space-y-2" data-v-c86d6ea1><li data-v-c86d6ea1>Obtenez votre code de parrainage unique via la page &quot;Mon Parrainage&quot;.</li><li data-v-c86d6ea1>Partagez votre lien ou code avec vos amis via WhatsApp, Facebook, ou autre.</li><li data-v-c86d6ea1>Lorsqu&#39;un ami s&#39;inscrit avec votre code et devient un commerÃ§ant actif, vous gagnez 1 jeton. </li><li data-v-c86d6ea1>Accumulez des parrainages pour progresser dans les niveaux et dÃ©bloquer des bonus supplÃ©mentaires.</li><li data-v-c86d6ea1>Consultez vos gains et votre niveau actuel sur la page &quot;Mon Parrainage&quot;.</li></ol></div>',2)),e("div",jn,[b[4]||(b[4]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"DÃ©tails des Niveaux",-1)),(s(!0),o(R,null,q(p.value,r=>(s(),o("div",{key:r.id,class:"mb-6 p-4 border rounded-lg bg-gray-50"},[e("h3",Vn,[h(v(r.nom)+" "+v(r.emoji)+" ",1),e("span",Mn,"("+v(r.filleuls_requis)+" parrainages requis)",1)]),e("p",zn,[b[1]||(b[1]=e("strong",null,"Bonus en jetons :",-1)),h(" "+v(r.jetons_bonus)+" jetons ",1)]),r.avantages.length?(s(),o("p",En,[b[2]||(b[2]=e("strong",null,"Avantages exclusifs :",-1)),e("ul",Un,[(s(!0),o(R,null,q(r.avantages,a=>(s(),o("li",{key:a},v(a),1))),128))])])):k("",!0),b[3]||(b[3]=e("p",{class:"text-[var(--espace-gris)] text-xs mt-1 italic"}," * Les jetons bonus sont crÃ©ditÃ©s une fois le niveau atteint et cumulables avec les jetons gagnÃ©s par commerÃ§ant. ",-1))]))),128)),b[5]||(b[5]=e("p",{class:"text-[var(--espace-gris)] text-sm mt-4"},[e("strong",null,"Note importante :"),h(' Le niveau maximum ("LÃ©gende ğŸ›¡ï¸") est atteint Ã  1000 parrainages. Continuez Ã  inviter pour maximiser vos rÃ©compenses ! ')],-1))])])]))}}),Ii=X(In,[["__scopeId","data-v-c86d6ea1"]]),Ln={class:"w-full flex relative px-0"},Fn=["onClick"],Tn={class:"w-10 h-10 bg-[var(--espace-or)] rounded-full mr-2 flex items-center justify-center"},Rn={class:"text-white font-bold"},On={class:"min-w-0"},Dn={class:"font-semibold text-[var(--espace-vert)] truncate"},qn={class:"text-xs text-[var(--espace-gris)] truncate"},Nn={class:"w-full grid grid-rows-[10%_86%]"},Wn={class:"flex border-b"},Jn={key:1,class:"text-xl h-[10%] font-semibold text-[var(--espace-vert)] p-4 md:z-0"},Hn={key:0,class:"h-full flex flex-col"},Bn={class:"block text-[var(--espace-vert)]"},Gn={class:"text-gray-800"},Xn={class:"text-xs text-[var(--espace-gris)] text-right"},Kn={key:0,class:"text-center text-[var(--espace-gris)]"},Qn={class:"px-2 md:px-4 z-20"},Zn={class:"bg-white shadow-lg rounded-full flex items-center flex-wrap p-2 border max-w-3xl mx-auto gap-2"},Yn={key:0,class:"bg-yellow-200 text-yellow-800 text-xs px-3 py-1 rounded-full flex items-center gap-2 ml-4"},ei={key:1,class:"flex items-center justify-center h-full"},ti=G({__name:"Messages",setup(S){const t=se(),m=Pe(),p=oe(),l=K(),n=Se(),i=x([]),b=x([]),r=x(null),a=x(""),d=x(!0),P=x(0),V=x(!1),E=x(!1),c=x(null),f=x(null),y=x(window.innerWidth<768),T=x(null),M=()=>{Ve(()=>{var z;(z=c.value)==null||z.scrollTo({top:c.value.scrollHeight,behavior:"smooth"})})},$=()=>{f.value=null,T.value=null,window.localStorage.removeItem("chatProductId")},g=async()=>{try{const z=await F.get("/conversations");i.value=z.data.conversations}catch(z){l.error("Erreur lors de la rÃ©cupÃ©ration des conversations"),console.error(z)}},_=async(z,I=!0)=>{if(!E.value){E.value=!0;try{I&&(P.value=0,b.value=[]),d.value=!1;const H=await F.get(`/chat/${z}?offset=${P.value}`);b.value=[...H.data.messages],console.log(H.data),V.value=H.data.hasMore,r.value=i.value.find(le=>le.user_id===z)||{user_id:z,name:`Utilisateur #${z}`};const Z=localStorage.getItem("chatProductId");Z&&(f.value=parseInt(Z)),await u(z),M()}catch(H){l.error("Erreur lors du chargement des messages"),console.error(H)}finally{E.value=!1}}},C=z=>{t.push({name:"messages",params:{receiverId:z}}),y.value&&(d.value=!1)},J=async()=>{var H;if(!a.value.trim()||!r.value){l.error("Veuillez sÃ©lectionner une conversation et Ã©crire un message");return}const z=a.value.trim(),I={id:-Date.now(),sender_id:p.user.id,receiver_id:r.value.user_id,content:z,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_read:0,product_id:((H=f.value)==null?void 0:H.toString())||"",sender:{id:p.user.id,nom:p.user.nom,email:p.user.email,telephone:p.user.telephone,ville:p.user.ville,premium:p.user.premium,parrain_id:p.user.parrain_id},receiver:{id:r.value.user_id,nom:r.value.name,email:null,telephone:"",ville:null,premium:!1,parrain_id:null}};b.value.push(I),a.value="",M();try{await F.post(`/chat/${r.value.user_id}`,{content:z,product_id:f.value}),f.value&&(localStorage.removeItem("chatProductId"),f.value=null),await _(r.value.user_id)}catch(Z){l.error("Ã‰chec d'envoi"),console.error(Z)}},U=()=>{!c.value||!V.value||E.value||c.value.scrollTop<=100&&(P.value+=30,_(r.value.user_id,!1))},A=()=>{y.value=window.innerWidth<768,d.value=window.innerWidth>768},j=()=>{d.value=!d.value},u=async z=>{try{console.log(z);const I=await F.put("/messages/mark-all-as-read");console.log(I.data),n.saveUnreadMessagesToLocalStorage(I.data.unread_messages)}catch(I){console.error("Erreur lors du marquage des messages comme lus:",I),l.error("Erreur lors de la mise Ã  jour des messages lus")}};return te(()=>m.params.receiverId,async z=>{z&&await _(parseInt(z))}),ae(()=>{g(),m.params.receiverId&&_(parseInt(m.params.receiverId)),window.addEventListener("resize",A)}),fe(()=>{window.removeEventListener("resize",A)}),(z,I)=>{var Z,le;const H=ne("router-link");return s(),o("div",Ln,[L(ie,{name:"slide-fade"},{default:N(()=>[d.value||!y.value?(s(),o("div",{key:0,class:D(["bg-white pt-8 shadow-md p-4 overflow-y-auto transition-all",y.value?"absolute top-0 left-0 h-full z-30 w-full":"w-[400px]"])},[I[2]||(I[2]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Conversations",-1)),(s(!0),o(R,null,q(i.value,B=>(s(),o("div",{key:B.user_id,onClick:re=>C(B.user_id),class:"p-2 hover:bg-gray-100 cursor-pointer rounded flex items-center transition-colors"},[e("div",Tn,[e("span",Rn,v(B.name.charAt(0)),1)]),e("div",On,[e("p",Dn,v(B.name),1),e("p",qn,v(B.last_message),1)])],8,Fn))),128))],2)):k("",!0)]),_:1}),e("div",Nn,[e("div",Wn,[!d.value&&y.value&&r.value?(s(),o("button",{key:0,onClick:j,class:"text-green-900 p-2 rounded-full hover:bg-[var(--espace-or)] transition text-start md:hidden"},I[3]||(I[3]=[e("i",{class:"fas fa-arrow-left text-2xl"},null,-1)]))):k("",!0),r.value?(s(),o("h2",Jn,v(r.value.name),1)):k("",!0)]),e("div",{class:D(["bg-white shadow-md transition-all duration-300 flex flex-col flex-1 h-full overflow-hidden w-full",d.value&&!y.value?"":"rounded-r-lg"]),onScroll:U},[r.value?(s(),o("div",Hn,[e("div",{ref_key:"messagesContainer",ref:c,class:"h-full flex-1 overflow-y-auto p-2 md:p-4 space-y-3 bg-gray-50 messages-container"},[(s(!0),o(R,null,q(b.value,B=>{var re;return s(),o("div",{key:B.id,class:D(["p-3 rounded-lg break-words",{"bg-blue-200 ml-auto max-w-[85%] md:max-w-[70%]":B.sender_id===w(p).user.id,"bg-gray-200 max-w-[85%] md:max-w-[70%]":B.sender_id!==w(p).user.id}])},[e("strong",Bn,v(B.sender.nom)+" :",1),e("p",Gn,[(re=B.product)!=null&&re.id?(s(),Y(H,{key:0,to:{name:"produit",params:{id:B.product.id}},class:"text-blue-500 underline hover:text-blue-700 ml-1"},{default:N(()=>[h("[Produit "+v(B.product.nom)+"]",1)]),_:2},1032,["to"])):k("",!0),h(" "+v(B.content),1)]),e("p",Xn,v(new Date(B.created_at).toLocaleTimeString()),1)],2)}),128)),E.value?(s(),o("div",Kn,"Chargement...")):k("",!0)],512),e("div",Qn,[e("div",Zn,[(Z=T.value)!=null&&Z.id?(s(),o("span",Yn,[h(" Produit "+v((le=T.value)==null?void 0:le.nom)+" ",1),e("button",{onClick:I[0]||(I[0]=()=>$()),class:"ml-2 text-yellow-800 hover:text-red-600 font-bold",title:"Retirer le tag"}," Ã— ")])):k("",!0),O(e("input",{"onUpdate:modelValue":I[1]||(I[1]=B=>a.value=B),type:"text",placeholder:"Ã‰crivez votre message...",class:"flex-1 px-4 py-2 rounded-full focus:outline-none text-gray-700 text-sm placeholder-gray-400 min-w-[100px] md:min-w-[200px]"},null,512),[[W,a.value]]),e("button",{onClick:J,class:"ml-2 p-3 rounded-full bg-[var(--espace-vert)] text-white hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},I[4]||(I[4]=[e("i",{class:"fas fa-location-arrow text-lg"},null,-1)]))])])])):(s(),o("div",ei,I[5]||(I[5]=[e("p",{class:"text-[var(--espace-gris)] text-lg"},"SÃ©lectionnez une conversation pour commencer.",-1)])))],34)])])}}}),Li=X(ti,[["__scopeId","data-v-e774f31b"]]),si={class:"mx-auto max-w-4xl py-5 px-4 flex flex-col gap-3"},ai={key:0,class:"overflow-scroll space-y-4"},oi={class:"flex justify-between items-center"},ri={class:"text-lg font-semibold"},li={class:"text-gray-600"},ni={class:"text-gray-600"},ii={class:"text-gray-600"},ui={class:"text-gray-600"},di={class:"text-gray-600"},ci={key:0,class:"text-gray-600"},pi={class:"text-right"},vi=["onClick"],mi={key:1,class:"text-gray-500"},fi={class:"mt-6 flex gap-4"},gi={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xi=G({__name:"JetonHistory",setup(S){const m=oe().user,p=x([]),l=x(!1),n=K(),i=async()=>{try{const a=await F.get(`/jeton-transactions/${m.id}`);console.log(a.data),p.value=a.data}catch(a){console.error("Erreur lors du chargement des transactions:",a)}},b=a=>new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),r=async a=>{var d,P;if(console.log("Refaire la transaction:",a),!!confirm(`Refaire l'achat de ${a.nombre_jetons} jetons avec le mÃªme service (${a.methode_paiement}) ?`)){l.value=!0;try{const V=await F.post("/acheter-jetons",{nombre_jetons:a.nombre_jetons,payment_service:a.methode_paiement,phone_number:a.phone_number});n.success(V.data.message),i()}catch(V){n.error(((P=(d=V.response)==null?void 0:d.data)==null?void 0:P.message)||"Erreur lors de l'achat."),console.error(V)}finally{l.value=!1}}};return ae(()=>{m&&i()}),(a,d)=>{const P=ne("router-link");return s(),o("div",si,[d[4]||(d[4]=e("h1",{class:"text-3xl font-bold text-[var(--espace-vert)]"},"Historique des Transactions de Jetons",-1)),p.value.length>0?(s(),o("div",ai,[(s(!0),o(R,null,q(p.value,V=>(s(),o("div",{key:V.id,class:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow"},[e("div",oi,[e("div",null,[e("p",ri,"Achat de "+v(V.nombre_jetons)+" jetons",1),e("p",li,"Montant: "+v(V.montant)+" FCFA",1),e("p",ni,"MÃ©thode: "+v(V.methode_paiement),1),e("p",ii,"NumÃ©ro: "+v(V.phone_number),1),e("p",ui,"Statut: "+v(V.statut),1),e("p",di,"Date: "+v(b(V.date_transaction)),1),V.transaction_id_mesomb?(s(),o("p",ci," ID Transaction: "+v(V.transaction_id_mesomb),1)):k("",!0)]),e("div",pi,[e("button",{onClick:E=>r(V),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] mr-2"},d[0]||(d[0]=[e("i",{class:"fas fa-redo"},null,-1),h(" Refaire ")]),8,vi)])])]))),128))])):(s(),o("p",mi,"Aucune transaction trouvÃ©e.")),e("div",fi,[L(P,{to:"/acheter-jetons",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:N(()=>d[1]||(d[1]=[h(" Acheter des Jetons ")])),_:1,__:[1]}),L(P,{to:"/commercant/produits",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:N(()=>d[2]||(d[2]=[h(" Booster un Produit ")])),_:1,__:[2]})]),l.value?(s(),o("div",gi,d[3]||(d[3]=[Ce('<div class="bg-white p-6 rounded-lg shadow-lg text-center" data-v-d4ec4573><p class="text-lg text-[var(--espace-vert)]" data-v-d4ec4573>Veuillez patienter...</p><svg class="animate-spin h-8 w-8 text-[var(--espace-vert)] mx-auto mt-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-d4ec4573><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-d4ec4573></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" data-v-d4ec4573></path></svg></div>',1)]))):k("",!0)])}}}),Fi=X(xi,[["__scopeId","data-v-d4ec4573"]]);export{Fi as A,$i as C,wi as F,_i as H,ki as L,Li as M,Ci as P,Ai as R,Si as a,Ei as b,Ui as c,Vi as d,Pi as e,Mi as f,Ii as g,ji as h,zi as i,oe as u};
