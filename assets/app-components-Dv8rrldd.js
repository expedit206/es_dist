import{r as x,u as Q,d as X,a as oe,w as ae,o as re,b as ne,c as a,e as C,f as A,g as t,h as e,i as U,j as N,k as _,t as v,l as Se,m as me,n as we,F as T,p as O,q as te,s as q,v as R,x as W,y as ze,z as Ee,T as ce,A as ee,B as ve,C as ye,D as Oe,E as Pe,G as Ne,H as Xe,I as We}from"./vue-DTxKeDEm.js";import{d as Ie}from"./pinia-eoHnihP1.js";import{a as je}from"./axios-Dq7h7Pqt.js";je.defaults.withCredentials=!0;je.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";je.defaults.withXSRFToken=!0;const F=je.create({withCredentials:!0,baseURL:"http://localhost:8000/api/v1",headers:{Accept:"application/json","Content-Type":"application/json"}});F.interceptors.request.use(E=>(localStorage.getItem("auth_token"),E));const le=Ie("auth",{state:()=>({user:null,token:localStorage.getItem("token")||null}),actions:{async login(E){await je.get("http://localhost:8000/sanctum/csrf-cookie",{withCredentials:!0});const s=await F.post("/login",E);this.user=s.data.user,this.token=s.data.token,localStorage.setItem("token",this.token??""),F.defaults.headers.common.Authorization=`Bearer ${this.token}`},async register(E){const s=await F.post("/register",E);this.user=s.data.user,this.token=s.data.token,localStorage.setItem("token",this.token??""),F.defaults.headers.common.Authorization=`Bearer ${this.token}`},async checkAuth(){if(!this.token)return!1;try{F.defaults.headers.common.Authorization=`Bearer ${this.token}`;const E=await F.get("/user");return this.user=E.data.user,!0}catch{return this.user=null,this.token=null,localStorage.removeItem("token"),!1}},async logout(){try{this.token&&(F.defaults.headers.common.Authorization=`Bearer ${this.token}`,await F.post("/logout"))}catch{}this.user=null,this.token=null,localStorage.removeItem("token"),delete F.defaults.headers.common.Authorization}}}),Je="/assets/logoOrangeweb-C9Cko1mf.webp",Ve=Ie("userState",()=>{const E=x(0),s=x(0),g=Q(),c=()=>{const l=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");E.value=l.length;const m=localStorage.getItem("unread_messages");s.value=m?parseInt(m,10):0},o=l=>{localStorage.setItem("pending_collaborations",JSON.stringify(l)),E.value=l.length},n=l=>{localStorage.setItem("unread_messages",l.toString()),s.value=l},i=async l=>{var S;const m=JSON.parse(localStorage.getItem("pending_collaborations")||"[]");m.push({produit_id:l.produit_id,prix_revente:l.prix_revente,status:"pending",created_at:new Date().toISOString()}),o(m);try{return await F.post("/collaborations",{produit_id:l.produit_id,prix_revente:l.prix_revente}),await b(),g.success("Demande de collaboration envoyÃ©e !"),!0}catch(k){const h=m.filter(d=>!(d.produit_id===l.produit_id&&d.prix_revente===l.prix_revente));return o(h),g.error(((S=k.response)==null?void 0:S.data.message)||"Erreur lors de la demande de collaboration"),!1}},b=async()=>{try{const l=await F.get("/user/badges");E.value=l.data.collaborations_pending,console.log(l.data),n(l.data.unread_messages||0)}catch(l){console.error("Erreur lors de la synchronisation des badges:",l)}};return{collaborationsPending:E,unreadMessages:s,initializeState:c,addCollaboration:i,syncCollaborationsWithBackend:b,clearState:()=>{localStorage.removeItem("pending_collaborations"),localStorage.removeItem("unread_messages"),E.value=0,s.value=0},saveCollaborationsToLocalStorage:o,saveUnreadMessagesToLocalStorage:n}}),ke=Ie("product",{state:()=>({product:{},products:[],isLoading:!1,hasMore:!0,page:1,sort:"random",userId:null,relatedProducts:[]}),actions:{async fetchProducts(E={},s=!1){var g,c;if(!(this.isLoading||!s&&!this.hasMore)){this.isLoading=!0,s&&(this.products=[],this.page=1,this.hasMore=!0);try{const o=await F.get("/produits",{params:{...E,page:this.page,sort:this.sort}});if(console.log(o.data.data),console.log(o.data),E.per_page==="all")this.products=s?o.data:[...this.products,...o.data];else{const n=o.data.data;this.products=s?n:[...this.products,...n],this.hasMore=o.data.current_page<o.data.last_page,this.page=o.data.current_page+1}}catch(o){throw((c=(g=o.response)==null?void 0:g.data)==null?void 0:c.message)||"Erreur lors du chargement des produits"}finally{this.isLoading=!1}}},async toggleFavorite(E){var s,g;try{const c=this.products.find(n=>n.id===E);return c&&(c.is_favorited_by=!c.is_favorited_by,c.favorites_count=c.is_favorited_by?c.favorites_count+1:c.favorites_count-1),this.product&&this.product.id===E&&(this.product.is_favorited_by=!this.product.is_favorited_by,this.product.favorites_count=this.product.is_favorited_by?this.product.favorites_count+1:this.product.favorites_count-1),(await F.post(`/produits/${E}/favorite`)).data.message}catch(c){throw((g=(s=c.response)==null?void 0:s.data)==null?void 0:g.message)||"Erreur lors de la mise Ã  jour des favoris"}},async viewProduct(E){var s,g;try{console.log("jjj");const c=await F.get(`/produits/${E}`);this.product=c.data.produit;const o=this.products.findIndex(n=>n.id===E);o!==-1?this.products[o]={...this.products[o],...this.product}:this.products.push(this.product)}catch(c){throw((g=(s=c.response)==null?void 0:s.data)==null?void 0:g.message)||"Erreur lors du chargement du produit"}},setSort(E){this.sort=E,this.page=1,this.products=[],this.hasMore=!0,this.fetchProducts({},!0)},setUserId(E){this.userId=E}}}),Ge={key:0,class:"fixed top-14 right-4 z-50 flex items-center gap-2 rounded-full px-4 py-2"},Ke={class:"text-sm font-semibold text-[var(--espace-vert)]"},Qe={class:"text-gray-800"},Ze=X({__name:"SoldeUser",setup(E){oe();const s=le(),g=x(0),c=async()=>{if(s.user)try{g.value=s.user.jetons,console.log(g.value)}catch(o){console.error("Erreur lors de la rÃ©cupÃ©ration des jetons:",o)}};return ae(()=>s.user,()=>{c()}),re(()=>{c()}),(o,n)=>{const i=ne("router-link");return A(s).user?(t(),a("div",Ge,[n[1]||(n[1]=e("i",{class:"fas fa-coins text-[var(--espace-or)] text-lg"},null,-1)),e("span",Ke,[U(i,{to:"/jeton-history"},{default:N(()=>[n[0]||(n[0]=_(" Jetons : ")),e("span",Qe,v(g.value),1)]),_:1,__:[0]})])])):C("",!0)}}}),G=(E,s)=>{const g=E.__vccOpts||E;for(const[c,o]of s)g[c]=o;return g},He=G(Ze,[["__scopeId","data-v-12adcefd"]]),Ye={class:"relative"},et={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] top-0 left-0 w-full z-50 shadow-md"},tt={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},st={class:"flex items-center gap-1 sm:gap-3"},at={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},ot=["aria-label"],rt={class:"flex items-center gap-2"},lt=["src"],nt={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},it={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},ut=X({__name:"HeaderBar",setup(E){const s=le(),g=Ve();oe();const c=s.user;Se();const o=x(!1),n=x(!1),i=x(""),b=ke(),r=x(!1),l=x(null),m=x(!1),S=me(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...s.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},{to:"/messages",label:"Messages",icon:"fa-comment-dots",badge:g.unreadMessages},...s.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:g.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]);ae(()=>s.user,p=>{p&&g.initializeState()},{immediate:!0}),ae(()=>g.collaborationsPending,p=>{p>-1&&(o.value=!0,setTimeout(()=>o.value=!1,300))}),ae(()=>g.unreadMessages,p=>{p>-1&&(n.value=!0,setTimeout(()=>n.value=!1,300))});const k=async()=>{if(i.value.trim())try{await b.fetchProducts({search:i.value.trim()},!0),i.value="",r.value=!1}catch(p){console.error("Erreur lors de la recherche:",p)}},h=p=>{if(m.value){m.value=!1;return}l.value&&!l.value.contains(p.target)&&(r.value=!1)},d=async()=>{r.value=!r.value,r.value&&(m.value=!0,await Ee())};return re(()=>{s.user&&g.initializeState(),document.addEventListener("click",h)}),we(()=>{document.removeEventListener("click",h)}),(p,y)=>{const D=ne("RouterLink");return t(),a("div",Ye,[e("header",et,[e("div",tt,[e("div",st,[U(D,{to:"/","aria-label":"Retour Ã  l'accueil"},{default:N(()=>y[2]||(y[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Je,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),y[3]||(y[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ",-1))]),e("nav",at,[(t(!0),a(T,null,O(S.value,$=>(t(),te(D,{key:$.to,to:$.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:q(["fas",$.icon])},null,2),_(" "+v($.label)+" ",1),$.badge>-1?(t(),a("span",{key:0,class:q(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":$.to==="/collaborations"&&o.value||$.to==="/messages"&&n.value}]),"aria-label":$.to==="/collaborations"?"Collaborations en attente":$.to==="/messages"?"Messages non lus":""},v($.badge),11,ot)):C("",!0)]),_:2},1032,["to"]))),128))]),U(He),e("div",rt,[A(c)?(t(),a("button",{key:0,onClick:d,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},y[4]||(y[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)]))):C("",!0),A(s).user?(t(),te(D,{key:1,to:"/profil",class:"relative flex items-center justify-center","aria-label":"Profil"},{default:N(()=>{var $;return[($=A(c))!=null&&$.photo?(t(),a("img",{key:0,src:`http://localhost:8000/storage/${A(c).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,lt)):(t(),a("div",nt,y[5]||(y[5]=[e("i",{class:"fas fa-user-circle text-2xl text-gray-100"},null,-1)])))]}),_:1})):C("",!0),A(s).user?(t(),te(D,{key:2,to:"/messages",class:"relative flex items-center justify-center","aria-label":"Messages"},{default:N(()=>[y[6]||(y[6]=e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},[e("i",{class:"fas fa-comment-dots text-2xl text-gray-100"})],-1)),A(g).unreadMessages>-1?(t(),a("span",{key:0,class:q(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":n.value}]),"aria-label":"Messages non lus"},v(A(g).unreadMessages),3)):C("",!0)]),_:1,__:[6]})):C("",!0)])]),r.value?(t(),a("div",{key:0,ref_key:"searchOverlayRef",ref:l,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",it,[R(e("input",{"onUpdate:modelValue":y[0]||(y[0]=$=>i.value=$),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:ze(k,["enter"])},null,544),[[W,i.value]]),e("button",{onClick:k,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},y[7]||(y[7]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:y[1]||(y[1]=$=>r.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},y[8]||(y[8]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):C("",!0)])])}}}),ki=G(ut,[["__scopeId","data-v-b78e3a10"]]),dt={class:"relative"},ct={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},pt={class:"flex justify-around items-center py-2"},vt=["aria-label"],mt=X({__name:"FooterBar",setup(E){const s=le(),g=Ve();oe();const c=x(!1),o=x(!1),n=me(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...s.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...s.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:g.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0},{to:"/messages",label:"Messages",icon:"fa-comment-dots",badge:g.unreadMessages}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]);return ae(()=>g.collaborationsPending,i=>{i>0&&(c.value=!0,setTimeout(()=>c.value=!1,300))}),ae(()=>g.unreadMessages,i=>{i>0&&(o.value=!0,setTimeout(()=>o.value=!1,300))}),(i,b)=>{const r=ne("RouterLink");return t(),a("div",dt,[U(ce,{name:"slide-up"},{default:N(()=>[e("nav",ct,[e("div",pt,[(t(!0),a(T,null,O(n.value,l=>(t(),te(r,{key:l.to,to:l.to,"aria-label":l.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:q(["fas text-lg",l.icon])},null,2),l.badge>-1?(t(),a("span",{key:0,class:q(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":l.to==="/collaborations"&&c.value||l.to==="/messages"&&o.value}]),"aria-label":l.to==="/collaborations"?"Collaborations en attente":l.to==="/messages"?"Messages non lus":""},v(l.badge),11,vt)):C("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),$i=G(mt,[["__scopeId","data-v-24921963"]]),ft={class:"mb-4"},gt={class:"block text-sm sm:text-base font-medium mb-1 text-[var(--espace-gris)]"},xt={class:"relative"},bt={class:"absolute inset-y-0 left-3 flex items-center text-[var(--espace-or)]"},ht=["type","value","required","placeholder"],yt={key:0,class:"text-red-500 text-sm mt-1"},se=X({__name:"Form",props:{label:String,icon:String,type:{type:String,default:"text"},modelValue:[String,Number],required:Boolean,placeholder:String,error:String},emits:["update:modelValue"],setup(E){return(s,g)=>(t(),a("div",ft,[e("label",gt,v(E.label),1),e("div",xt,[e("span",bt,[e("i",{class:q(`fas ${E.icon}`)},null,2)]),e("input",{type:E.type,value:E.modelValue,onInput:g[0]||(g[0]=c=>s.$emit("update:modelValue",c.target.value)),required:E.required,placeholder:E.placeholder,class:q(["w-full pl-10 pr-4 py-3 rounded-xl border text-sm sm:text-base transition","focus:outline-none focus:ring-2",E.error?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-[var(--espace-or)]"])},null,42,ht)]),E.error?(t(),a("p",yt,v(E.error),1)):C("",!0)]))}}),_t={class:"overflow-y-scroll bg-gray-100 flex items-center justify-center px-4 py-8"},wt={class:"w-full max-w-lg bg-[rgba(255,255,255,0.85)] rounded-2xl shadow-xl p-6 sm:p-10"},kt={class:"text-center text-sm text-gray-600 mt-6"},$t=X({__name:"Login",setup(E){const s=x({login:"",mot_de_passe:""}),g=x({}),c=oe(),o=Q(),n=le(),i=async()=>{var b,r;try{await n.login({login:s.value.login,mot_de_passe:s.value.mot_de_passe}),o.success("Connexion rÃ©ussie !"),c.push((b=n.user)!=null&&b.commercant?{name:"commercant"}:{name:"profil"})}catch(l){console.error("Erreur lors de la connexion:",l);const m=l.message||"Erreur lors de la connexion. Veuillez vÃ©rifier vos informations.";o.error(m),((r=l.response)==null?void 0:r.status)===422&&(g.value=l.response.data.errors||{})}};return(b,r)=>{const l=ne("router-link");return t(),a("div",_t,[e("div",wt,[r[5]||(r[5]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-sign-in-alt mr-2 text-[var(--espace-or)]"}),_(" Connexion ")],-1)),r[6]||(r[6]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[_(" Connectez-vous Ã  "),e("strong",null,"Espace Cameroun"),_(" pour accÃ©der Ã  vos achats et votre espace commerÃ§ant. ")],-1)),e("form",{onSubmit:ee(i,["prevent"]),class:"space-y-5"},[U(se,{label:"Email ou TÃ©lÃ©phone",icon:"fa-envelope",modelValue:s.value.login,"onUpdate:modelValue":r[0]||(r[0]=m=>s.value.login=m),type:"text",required:"",error:g.value.login},null,8,["modelValue","error"]),U(se,{label:"Mot de passe",icon:"fa-lock",modelValue:s.value.mot_de_passe,"onUpdate:modelValue":r[1]||(r[1]=m=>s.value.mot_de_passe=m),type:"password",required:"",error:g.value.mot_de_passe},null,8,["modelValue","error"]),r[2]||(r[2]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-sign-in-alt mr-2"}),_(" Se connecter ")],-1))],32),e("p",kt,[r[4]||(r[4]=_(" Pas de compte ? ")),U(l,{to:"/register",class:"text-[var(--espace-vert)] font-medium hover:text-[var(--espace-or)] hover:underline"},{default:N(()=>r[3]||(r[3]=[_(" Inscrivez-vous ici ")])),_:1,__:[3]})])])])}}}),Ai=G($t,[["__scopeId","data-v-3b18d20d"]]),At="/assets/logo-ba4eAQQi.png",Ct={key:0,class:"fixed inset-0 bg-[var(--espace-white)] bg-opacity-50 flex items-center justify-center z-50","aria-label":"Chargement en cours",role:"status"},Pt=X({__name:"Loader",props:{isLoading:{type:Boolean}},setup(E){return(s,g)=>(t(),te(ce,{name:"fade"},{default:N(()=>[s.isLoading?(t(),a("div",Ct,g[0]||(g[0]=[e("div",{class:"relative p-6"},[e("img",{src:At,alt:"Logo Espace Cameroun",class:"h-12 w-12 object-contain animate-spin-pulse"}),e("div",{class:"absolute inset-0 rounded-full border-4 border-[var(--espace-or)] border-t-transparent animate-spin"})],-1)]))):C("",!0)]),_:1}))}}),$e=G(Pt,[["__scopeId","data-v-f60cc94a"]]),St={class:"h-full bg-gray-100 pt-5 px-4 sm:px-2"},jt={class:"h-full w-full"},Vt={key:0},Mt={key:1,class:"grid grid-cols-1 pt-4 pb-16 lg:pb-12 md:grid-cols-3 sm:grid-cols-2 overflow-y-scroll pt-4 h-full lg:grid-cols-4 gap-6"},zt={class:"relative w-full h-40 overflow-hidden rounded-t-lg mb-2"},Et=["src"],It=["onClick"],Lt=["onClick"],Ft={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Ut={class:"p-2"},Tt={class:"text-lg font-semibold flex justify-between text-[var(--espace-vert)] truncate"},Rt=["onClick"],qt={class:"text-sm text-[var(--espace-gris)] line-clamp-2"},Dt={class:"text-md font-bold text-[var(--espace-or)] mt-2"},Ot={class:"text-sm text-[var(--espace-gris)]"},Nt={class:"text-sm text-[var(--espace-gris)] mt-2"},Wt={class:"ml-4"},Jt={class:"absolute bottom-5 right-2 flex gap-2"},Ht=["onClick"],Bt=["onClick"],Xt={key:2,class:"text-center text-[var(--espace-gris)]"},Gt={class:"bg-white rounded-lg p-6 sm:p-8 w-full max-w-md mx-4 shadow-lg"},Kt={class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},Qt={key:0,class:"mt-2 flex gap-2 flex-wrap"},Zt=["src"],Yt=["value"],es={key:0,class:"flex items-center gap-2"},ts={key:1,class:"flex items-center gap-2"},ss={class:"flex gap-4 pt-2"},as={type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition"},os=X({__name:"CommercantProduits",setup(E){const s=le(),g=oe(),c=Q(),o=x(!1),n=x([]),i=x([]),b=x(!1),r=x(!1),l=x(null),m=x({}),S=x({nom:"",description:"",prix:0,stock:0,photos:[],category_id:"",collaboratif:!1,marge_min:0}),k=x([]),h=async()=>{o.value=!0;try{const L=await F.get("/commercant/produits");n.value=L.data.produits.map(P=>({...P,photo_url:P.photos&&P.photos.length>0?P.photos[0]:"https://via.placeholder.com/150"})),n.value.forEach(P=>{m.value[P.id]||(m.value[P.id]=0)})}catch{c.error("Erreur lors du chargement des produits")}finally{o.value=!1}},d=async()=>{o.value=!0;try{const L=await F.get("/categories");i.value=L.data.categories}catch{c.error("Erreur lors de la chargement des catÃ©gories")}finally{o.value=!1}},p=()=>{S.value={nom:"",description:"",prix:0,stock:0,photos:[],category_id:"",collaboratif:!1,marge_min:0},k.value=[],b.value=!0},y=L=>{l.value=L,S.value={nom:L.nom,description:L.description||"",prix:L.prix,stock:L.quantite,photos:[],category_id:L.category_id,collaboratif:!!L.collaboratif,marge_min:L.marge_min||0},console.log(S.value),k.value=L.photos||[],m.value[L.id]||(m.value[L.id]=0),r.value=!0},D=L=>{const P=L.target;if(P.files){const V=Array.from(P.files);S.value.photos=V,k.value=V.map(u=>URL.createObjectURL(u))}},$=async L=>{if(confirm("Voulez-vous vraiment supprimer ce produit ?")){o.value=!0;try{await F.delete(`/commercant/produits/${L}`),n.value=n.value.filter(P=>P.id!==L),delete m.value[L],c.success("Produit supprimÃ©")}catch{c.error("Erreur lors de la suppression")}finally{o.value=!1}}},z=async()=>{var P,V;o.value=!0;const L=new FormData;L.append("nom",S.value.nom),L.append("description",S.value.description),L.append("prix",S.value.prix.toString()),L.append("stock",S.value.stock.toString()),L.append("category_id",S.value.category_id),L.append("collaboratif",S.value.collaboratif?"1":"0"),S.value.marge_min!==null&&L.append("marge_min",S.value.marge_min.toString()),S.value.photos.forEach(u=>L.append("photos[]",u)),console.log(L),console.log(S.value);try{if(b.value){const u=await F.post("/commercant/produits",S.value,{headers:{"Content-Type":"multipart/form-data"}});console.log(u.data),c.success("Produit ajoutÃ© avec succÃ¨s")}else{console.log(S.value);const u=await F.post(`/commercant/produits/${(P=l.value)==null?void 0:P.id}`,L,{headers:{"Content-Type":"multipart/form-data"}});console.log(u.data),c.success("Produit modifiÃ© avec succÃ¨s")}await h(),f()}catch(u){c.error(((V=u.response)==null?void 0:V.data.message)||"Erreur lors de la sauvegarde du produit")}finally{o.value=!1}},f=()=>{b.value=!1,r.value=!1,l.value=null,k.value=[]},w=me(()=>L=>m.value[L]||0),j=L=>{var u;const P=n.value.find(M=>M.id===L),V=(u=P==null?void 0:P.photos)!=null&&u.length?P.photos.length-1:0;m.value[L]=Math.min((m.value[L]||0)+1,V)},B=L=>{m.value[L]=Math.max((m.value[L]||0)-1,0)};return re(()=>{var L;if(!((L=s.user)!=null&&L.commercant)){c.error("AccÃ¨s rÃ©servÃ© aux commerÃ§ants"),g.push("/");return}h(),d()}),(L,P)=>{const V=ne("router-link");return t(),a(T,null,[U($e,{isLoading:o.value},null,8,["isLoading"]),e("div",St,[e("div",jt,[e("div",{class:"flex justify-between items-center"},[P[7]||(P[7]=e("h1",{class:"text-1xl md:text-2xl font-bold text-[var(--espace-vert)] text-md mb-2 font-poppins"},[e("i",{class:"fas fa-box-open mr-1 text-[var(--espace-or)] text-md!important"}),_(" Mes Produits ")],-1)),e("button",{onClick:p,class:"mb-2 md:text-xl text-[var(--espace-vert)] font-semibold px-2 py-1 rounded hover:bg-[var(--espace-vert)] hover:text-white transition inline-flex items-center"},P[6]||(P[6]=[e("i",{class:"fas fa-plus mr-2"},null,-1),_(" Ajouter un produit ")]))]),o.value?(t(),a("div",Vt,P[8]||(P[8]=[e("div",{class:"flex items-center justify-center py-10"},[e("i",{class:"fas fa-spinner animate-spin text-2xl text-[var(--espace-vert)]"})],-1)]))):n.value.length?(t(),a("div",Mt,[(t(!0),a(T,null,O(n.value,u=>(t(),a("div",{key:u.id,class:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition relative"},[U(V,{to:`/produits/${u.id}`,class:"block relative"},{default:N(()=>[e("div",zt,[e("div",{class:"flex w-full h-full slider-container",style:ve({transform:`translateX(-${w.value(u.id)*100}%)`})},[(t(!0),a(T,null,O(u.photos,(M,I)=>(t(),a("img",{key:I,src:M,class:"h-40 object-contain flex-shrink-0 mx-auto",alt:"Photo du produit"},null,8,Et))),128))],4),u.photos&&u.photos.length>1?(t(),a("button",{key:0,onClick:M=>B(u.id),class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},P[9]||(P[9]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,It)):C("",!0),u.photos&&u.photos.length>1?(t(),a("button",{key:1,onClick:M=>j(u.id),class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block"},P[10]||(P[10]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,Lt)):C("",!0),u.photos&&u.photos.length>1?(t(),a("div",Ft,[(t(!0),a(T,null,O(u.photos,(M,I)=>(t(),a("span",{key:I,class:q(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":I===w.value(u.id)}])},null,2))),128))])):C("",!0)]),e("div",Ut,[e("h2",Tt,[_(v(u.nom)+" ",1),e("button",{onClick:M=>y(u),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},P[11]||(P[11]=[e("i",{class:"fas fa-pencil text-sm"},null,-1)]),8,Rt)]),e("p",qt,v(u.description||"Aucune"),1),e("p",Dt,v(u.prix)+" FCFA",1),e("p",Ot,"Stock: "+v(u.quantite),1),e("div",Nt,[e("span",null,[P[12]||(P[12]=e("i",{class:"fas fa-eye mr-1"},null,-1)),_(" "+v(u.raw_views_count||0)+" vues",1)]),e("span",Wt,[P[13]||(P[13]=e("i",{class:"fas fa-heart mr-1"},null,-1)),_(" "+v(u.favorites_count||0)+" favoris",1)])])]),e("div",Jt,[e("button",{onClick:M=>y(u),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] p-1 rounded-full hover:bg-gray-100 transition"},P[14]||(P[14]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Ht),e("button",{onClick:ee(M=>$(u.id),["stop"]),class:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-gray-100 transition"},P[15]||(P[15]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Bt)])]),_:2},1032,["to"])]))),128))])):(t(),a("p",Xt,"Aucun produit pour le moment."))]),U(ce,{name:"fade"},{default:N(()=>[b.value||r.value?(t(),a("div",{key:0,class:"overflow-y-scroll fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ee(f,["self"])},[e("div",Gt,[e("h2",Kt,v(b.value?"Ajouter un produit":"Modifier le produit"),1),e("form",{onSubmit:ee(z,["prevent"]),class:"space-y-4"},[e("div",null,[P[16]||(P[16]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Nom",-1)),R(e("input",{"onUpdate:modelValue":P[0]||(P[0]=u=>S.value.nom=u),type:"text",required:"",class:"input-style"},null,512),[[W,S.value.nom]])]),e("div",null,[P[17]||(P[17]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Description",-1)),R(e("textarea",{"onUpdate:modelValue":P[1]||(P[1]=u=>S.value.description=u),rows:"3",class:"input-style"},null,512),[[W,S.value.description]])]),e("div",null,[P[18]||(P[18]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Prix (FCFA)",-1)),R(e("input",{"onUpdate:modelValue":P[2]||(P[2]=u=>S.value.prix=u),type:"number",min:"0",required:"",class:"input-style"},null,512),[[W,S.value.prix,void 0,{number:!0}]])]),e("div",null,[P[19]||(P[19]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Stock",-1)),R(e("input",{"onUpdate:modelValue":P[3]||(P[3]=u=>S.value.stock=u),type:"number",min:"0",required:"",class:"input-style"},null,512),[[W,S.value.stock,void 0,{number:!0}]])]),e("div",null,[P[20]||(P[20]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"Photos",-1)),e("input",{type:"file",multiple:"",onChange:D,class:"input-style",accept:"image/*"},null,32),k.value.length?(t(),a("div",Qt,[(t(!0),a(T,null,O(k.value,(u,M)=>(t(),a("img",{key:M,src:u,class:"w-16 h-16 object-cover rounded",alt:"PrÃ©visualisation"},null,8,Zt))),128))])):C("",!0)]),e("div",null,[P[22]||(P[22]=e("label",{class:"text-sm text-[var(--espace-vert)]"},"CatÃ©gorie",-1)),R(e("select",{"onUpdate:modelValue":P[4]||(P[4]=u=>S.value.category_id=u),required:"",class:"input-style"},[P[21]||(P[21]=e("option",{value:""},"SÃ©lectionner une catÃ©gorie",-1)),(t(!0),a(T,null,O(i.value,u=>(t(),a("option",{key:u.id,value:u.id},v(u.nom),9,Yt))),128))],512),[[ye,S.value.category_id]])]),S.value.collaboratif||r.value?(t(),a("div",es)):(t(),a("div",ts,[R(e("input",{id:"collaboratif",type:"checkbox","onUpdate:modelValue":P[5]||(P[5]=u=>S.value.collaboratif=u)},null,512),[[Oe,S.value.collaboratif]]),P[23]||(P[23]=e("label",{for:"collaboratif",class:"text-sm text-[var(--espace-vert)]"},"Collaboratif",-1))])),e("div",ss,[e("button",as,v(b.value?"Ajouter":"Modifier"),1),e("button",{type:"button",onClick:f,class:"flex-1 bg-[var(--espace-gris)] text-white font-semibold px-4 py-2 rounded hover:bg-gray-700 transition"}," Annuler ")])],32)])])):C("",!0)]),_:1})])],64)}}}),Ci=G(os,[["__scopeId","data-v-a3a2b3ba"]]),rs={class:"overflow-y-scroll bg-white flex justify-center px-4"},ls={class:"flex flex-col w-full max-w-lg rounded-2xl pb-16 sm:p-10"},ns={class:"text-center text-sm text-gray-600 mt-6"},is=X({__name:"Register",setup(E){const s=x({nom:"",telephone:"",email:"",ville:"",mot_de_passe:"",parrain_id:""}),g=x({}),c=oe(),o=Q(),n=le(),i=async()=>{var b,r,l;try{console.log("Envoi des donnÃ©es d'inscription:",s.value),await n.register(s.value),o.success("Inscription rÃ©ussie !"),c.push({name:"home"})}catch(m){console.error("Erreur lors de l'inscription:",m);const S=((r=(b=m.response)==null?void 0:b.data)==null?void 0:r.message)||"Erreur lors de l'inscription. Veuillez vÃ©rifier vos informations.";o.error(S),((l=m.response)==null?void 0:l.status)===422&&(g.value=m.response.data.errors)}};return(b,r)=>{const l=ne("router-link");return t(),a("div",rs,[e("div",ls,[r[9]||(r[9]=e("h1",{class:"text-3xl sm:text-4xl font-bold text-center text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-user-plus mr-2 text-[var(--espace-or)]"}),_(" CrÃ©ez votre compte ")],-1)),r[10]||(r[10]=e("p",{class:"text-center text-sm sm:text-base text-gray-600 mb-6"},[_(" Rejoignez "),e("strong",null,"Espace Cameroun"),_(" et profitez dâ€™une expÃ©rience dâ€™achat unique. Vos informations resteront confidentielles. ")],-1)),e("form",{onSubmit:ee(i,["prevent"]),class:"space-y-5"},[U(se,{label:"Nom",icon:"fa-user",modelValue:s.value.nom,"onUpdate:modelValue":r[0]||(r[0]=m=>s.value.nom=m),type:"text",required:"",error:g.value.nom},null,8,["modelValue","error"]),U(se,{label:"TÃ©lÃ©phone",icon:"fa-phone",modelValue:s.value.telephone,"onUpdate:modelValue":r[1]||(r[1]=m=>s.value.telephone=m),type:"tel",required:"",error:g.value.telephone},null,8,["modelValue","error"]),U(se,{label:"Email (optionnel)",icon:"fa-envelope",modelValue:s.value.email,"onUpdate:modelValue":r[2]||(r[2]=m=>s.value.email=m),type:"email",error:g.value.email},null,8,["modelValue","error"]),U(se,{label:"Ville",icon:"fa-city",modelValue:s.value.ville,"onUpdate:modelValue":r[3]||(r[3]=m=>s.value.ville=m),type:"text",required:"",error:g.value.ville},null,8,["modelValue","error"]),U(se,{label:"Mot de passe",icon:"fa-lock",modelValue:s.value.mot_de_passe,"onUpdate:modelValue":r[4]||(r[4]=m=>s.value.mot_de_passe=m),type:"password",required:"",error:g.value.mot_de_passe},null,8,["modelValue","error"]),U(se,{label:"Code de parrainage (optionnel)",icon:"fa-users",modelValue:s.value.parrain_id,"onUpdate:modelValue":r[5]||(r[5]=m=>s.value.parrain_id=m),type:"text",error:g.value.parrain_id},null,8,["modelValue","error"]),r[6]||(r[6]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold p-3 rounded-xl hover:bg-[var(--espace-vert)] hover:text-white transition flex items-center justify-center shadow-md"},[e("i",{class:"fas fa-user-plus mr-2"}),_(" S'inscrire ")],-1))],32),e("p",ns,[r[8]||(r[8]=_(" Vous avez dÃ©jÃ  un compte ? ")),U(l,{to:"/login",class:"text-[var(--espace-vert)] font-medium hover:underline"},{default:N(()=>r[7]||(r[7]=[_(" Connectez-vous ici ")])),_:1,__:[7]})]),r[11]||(r[11]=e("p",{class:"text-center text-xs text-gray-400 mt-2 pb-4"},[_(" En vous inscrivant, vous acceptez nos "),e("a",{href:"/conditions",class:"hover:underline text-[var(--espace-vert)]"},"conditions d'utilisation"),_(" et notre "),e("a",{href:"/confidentialite",class:"hover:underline text-[var(--espace-vert)]"},"politique de confidentialitÃ©"),_(". ")],-1))])])}}}),Pi=G(is,[["__scopeId","data-v-df9d2990"]]),us={key:0,class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-4"},ds={class:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-y-auto animate-fade-in max-h-[90vh]"},cs={class:"p-6"},ps={key:0,class:"grid md:grid-cols-3 gap-6"},vs={key:1,class:"flex flex-col md:flex-row max-w-3xl mx-auto p-8 bg-white rounded-xl shadow-lg"},ms={class:"md:w-1/3 mb-6 md:mb-0 pr-6 border-r border-gray-200"},fs={class:"font-extrabold text-lg mb-2"},gs={class:"mb-2 text-sm opacity-90"},xs={class:"text-3xl font-extrabold"},bs={class:"flex flex-col text-sm font-medium text-gray-700"},hs={key:0,class:"text-xs text-red-600 mt-1"},ys={class:"flex gap-4"},_s=["value"],ws=["src"],ks={key:0,class:"text-xs text-red-600 mt-1 block"},$s=["disabled"],As={class:"text-xs text-gray-400 mt-4 text-center"},Cs=X({__name:"SubscriptionModal",props:{isOpen:{type:Boolean}},emits:["close","upgraded"],setup(E,{emit:s}){const g=s,c=Q(),o=x(""),n=x(""),i=x(""),b=x(!1),r=x(!1),l=x(!1),m=h=>{o.value=h,b.value=!1,r.value=!1,n.value="",i.value=""},S=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],k=async()=>{if(b.value=!i.value,r.value=!n.value,b.value||r.value){c.error("Veuillez remplir tous les champs correctement.");return}l.value=!0;try{console.log({subscription_type:o.value,payment_service:n.value,phone_number:i.value});const h=await F.post("/upgrade-to-premium",{subscription_type:o.value,payment_service:n.value,phone_number:i.value});l.value=!1,c.success(h.data.message),g("upgraded"),g("close")}catch(h){h.response&&h.response.data?(h.response.data,c.error("Paiement Ã©chouÃ© :Verifiez vos informations et rÃ©essayer")):c.error("Verifiez vos informations et rÃ©essayer."),console.error(h)}finally{l.value=!1}};return(h,d)=>h.isOpen?(t(),a("div",us,[e("div",ds,[d[17]||(d[17]=e("div",{class:"bg-gradient-to-r from-[var(--espace-vert)] to-[var(--espace-or)] p-6 text-center"},[e("h2",{class:"text-3xl font-bold text-white"},"ğŸš€ Passez Ã  Premium"),e("p",{class:"text-white/90 mt-1"}," Comparez et choisissez le plan qui boostera votre business ")],-1)),e("div",cs,[o.value?(t(),a("div",vs,[e("div",ms,[d[11]||(d[11]=e("h3",{class:"text-xl font-bold mb-4"},"Votre abonnement",-1)),e("div",{class:q([{"bg-green-600 text-white":o.value==="monthly","bg-yellow-400 text-gray-900":o.value==="yearly"},"rounded-lg p-4"])},[e("h4",fs,v(o.value==="monthly"?"Premium Mensuel":"Premium Annuel"),1),e("p",gs,v(o.value==="monthly"?"AccÃ¨s complet Ã  toutes les fonctionnalitÃ©s.":"Payez moins, profitez plus avec 16% dâ€™Ã©conomie !"),1),e("div",xs,v(o.value==="monthly"?"5 000 FCFA":"50 000 FCFA"),1)],2)]),e("form",{onSubmit:ee(k,["prevent"]),class:"md:w-2/3 flex flex-col gap-6",novalidate:""},[d[15]||(d[15]=e("h3",{class:"text-xl font-bold mb-2"},"DÃ©tails du paiement",-1)),e("label",bs,[d[12]||(d[12]=_(" NumÃ©ro de tÃ©lÃ©phone ")),R(e("input",{"onUpdate:modelValue":d[4]||(d[4]=p=>i.value=p),type:"tel",placeholder:"Ex: 696428651",class:q(["mt-1 rounded-lg border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",{"border-red-500":b.value}]),onInput:d[5]||(d[5]=p=>b.value=!i.value),required:""},null,34),[[W,i.value]]),b.value?(t(),a("span",hs,"Veuillez entrer un numÃ©ro valide.")):C("",!0)]),d[16]||(d[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Service de paiement ",-1)),e("div",ys,[(t(),a(T,null,O(S,p=>e("label",{key:p.value,class:q(["flex items-center gap-2 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":n.value===p.value,"border-gray-300 bg-white":n.value!==p.value,"border-red-500":r.value&&!n.value}])},[R(e("input",{type:"radio",value:p.value,"onUpdate:modelValue":d[6]||(d[6]=y=>n.value=y),class:"hidden"},null,8,_s),[[Ne,n.value]]),e("img",{src:p.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,ws),e("span",{class:q([{"text-[var(--espace-vert)]":n.value===p.value,"text-gray-700":n.value!==p.value},"font-semibold select-none"])},v(p.label),3)],2)),64))]),r.value&&!n.value?(t(),a("span",ks," Veuillez sÃ©lectionner un service. ")):C("",!0),e("button",{type:"submit",disabled:l.value||!i.value||!n.value,class:"w-full py-3 rounded-lg bg-[var(--espace-vert)] text-white font-bold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[l.value?(t(),a(T,{key:0},[d[13]||(d[13]=e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1)),d[14]||(d[14]=_(" Veuillez patienter... "))],64)):(t(),a(T,{key:1},[_(" Payer & Souscrire ")],64))],8,$s),e("button",{type:"button",onClick:d[7]||(d[7]=p=>o.value=""),class:"w-full text-center text-gray-500 hover:text-[var(--espace-vert)] transition"}," â† Retour aux plans "),e("p",As," ğŸ”’ Paiement sÃ©curisÃ© via "+v(n.value||"votre service"),1)],32)])):(t(),a("div",ps,[d[10]||(d[10]=Pe('<div class="border border-gray-200 bg-gray-50 rounded-xl p-6 flex flex-col justify-between" data-v-7e8d0671><div data-v-7e8d0671><h3 class="text-xl font-bold text-gray-800" data-v-7e8d0671>Gratuit (Base)</h3><p class="text-sm text-gray-500 mb-4" data-v-7e8d0671>Pour dÃ©buter sans frais</p><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 10 produits max </li><li class="flex items-center gap-2 text-gray-700" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 5 collaborations max </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>âŒ</span> Pas de statistiques dÃ©taillÃ©es </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>âŒ</span> Pas de badge Premium </li><li class="flex items-center gap-2 text-gray-400" data-v-7e8d0671><span data-v-7e8d0671>âŒ</span> Position prioritaire </li></ul></div><button disabled class="mt-6 w-full py-2 rounded-lg bg-gray-300 text-gray-600 font-semibold cursor-not-allowed" data-v-7e8d0671> Actuel </button></div>',1)),e("div",{class:"relative bg-gradient-to-br from-[var(--espace-vert)] to-green-500 rounded-xl text-white p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 scale-103 transition cursor-pointer",onClick:d[1]||(d[1]=p=>m("monthly"))},[d[8]||(d[8]=Pe('<span class="absolute top-1 right-3 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>â­ Populaire</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Mensuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671> AccÃ¨s complet Ã  toutes les fonctionnalitÃ©s </p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>5000 FCFA / mois </div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Produits illimitÃ©s</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Collaborations illimitÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Statistiques dÃ©taillÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Badge â€œPremiumâ€</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:d[0]||(d[0]=ee(p=>m("monthly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-vert)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")]),e("div",{class:"relative bg-gradient-to-br from-yellow-400 to-[var(--espace-or)] rounded-xl text-gray-900 p-6 flex flex-col justify-between shadow-lg transform hover:scale-105 transition cursor-pointer",onClick:d[3]||(d[3]=p=>m("yearly"))},[d[9]||(d[9]=Pe('<span class="absolute top-1 right-3 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow" data-v-7e8d0671>-16% Ã‰conomie</span><div data-v-7e8d0671><h3 class="text-xl font-bold" data-v-7e8d0671>Premium - Annuel</h3><p class="text-sm opacity-90 mb-4" data-v-7e8d0671>Payez moins, profitez plus</p><div class="text-3xl font-extrabold mb-2" data-v-7e8d0671>50 000 FCFA / an</div><ul class="space-y-2 text-sm" data-v-7e8d0671><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Produits illimitÃ©s</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Collaborations illimitÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> 20 jetons gratuits/mois </li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Statistiques dÃ©taillÃ©es</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Badge â€œPremiumâ€</li><li class="flex items-center gap-2" data-v-7e8d0671><span data-v-7e8d0671>âœ”</span> Position prioritaire</li></ul></div>',2)),e("button",{onClick:d[2]||(d[2]=ee(p=>m("yearly"),["stop"])),class:"mt-6 w-full py-2 rounded-lg bg-white text-[var(--espace-or)] font-bold hover:bg-gray-100 transition"}," Choisir ce plan ")])]))])])])):C("",!0)}}),Ps=G(Cs,[["__scopeId","data-v-7e8d0671"]]),Ss={class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},js={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 space-y-6 animate-fade-in max-h-[90vh] overflow-auto"},Vs={class:"flex justify-center gap-3 mb-4"},Ms=["onClick"],zs={key:0,class:"text-xs text-red-600 mt-1"},Es={class:"flex gap-4"},Is=["value"],Ls=["src"],Fs={key:1,class:"text-xs text-red-600 mt-1"},Us={class:"text-center text-lg font-bold mt-6"},Ts={class:"text-[var(--espace-vert)]"},Rs=["disabled"],qs={key:0},Ds={key:1},Os={key:2,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ns={class:"w-full mt-2 text-center text-gray-500 hover:text-[var(--espace-vert)] transition"},Ws=X({__name:"AchatJetonModal",props:{isOpen:{type:Boolean}},emits:["close","purchased"],setup(E,{emit:s}){const g=s,c=Q(),o=x(10),n=x(""),i=x(""),b=x(o.value*25),r=x(!1),l=x(!1),m=x(!1),S=[{value:"ORANGE",label:"Orange Money",logo:new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX/eQD/////dgD/dAD/bgD/cwD/cAD/cQD/lVH/kEf/7OP/rH//llT/9vH/t47/awD/sIb/+ff/ijf/6Nv/4ND/3cr/pXD/8+z/kkz/2MT/nmP/vpv/r4L/z7X/5df/qHb/xab/fhn/yq7/jUD/mlz/fRL/hS3/ZAD/omv/zrT/gST/izr/hTD/waD/vJY57ZCcAAAH70lEQVR4nO2a6XKjOhCF0QIaOxjF8b7hFSfjOHn/x7ss2tgyMHeqJuM6358EEEJHarVaLXseAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMeBKrL/zK2/2qI/zC38kbOkSRhe81vXMEz+cqv+IOyJKOQ7IROe3uIxIcsHGsXkfr+S6fF+pS9kQa6psiT9O3gghdk8JDNOvVThYXwSnr8h0WMpTCGzwMsUnj4I9+RouH5YhT8TMhch2b49rMLd6yR+XRE+f1yFfE8SspL7x1UoOBmSpXhkheJEFpJ1U0j/odCHTDOF72QlUpmRnyr81YrPAum9DM5HzkW1JCvIb1MhvZvzjIr0heR2ZJILVquUMmaKSeHzpjJFHdw8MyGnW8IPuDjeEqeCJDF/aJKVPn4pjwZeNB0XkdDw9EOW2nGLnjOit3SFletVWmyrn/syPMT6vd1eiFKzJTvv51lRJsPTMCuzWO15VWP2MF6MFvHPeZC+Ty9hysUdEMpvn6p1i9WWCa8/4rYiLou9tB+gA3V3GvBl3k7yVLSS8WhUeo+c9JilM2Q1yRo15Gm3PC1skfGl3EK+dh5+cHZWTeCmRPA+LX+ENhnCl8hPUmVyNLUYhbPXg/qvUBiE49p7JFTtp6G6wflyUS7y5Erklb71VVQ9NArlgVRZB/0E8mmtipSlX1W4Mo3JFfJ6v2Rc1Gz6oa6vp1oRx+kFk8qzyaGisLF1z9zrQbbxaGKgncSg9ihTyD+aXyNJWWEDzvjUmz8ul5Gzxirmfk1Hu8CfbQ2pjmFJIYvs5WS1W1lL3IlfKSRnNYjCqWQ4LBVRCp0Ss4/Pgx2MW+d1jV3cauPYmVpT/oVCOlBfW+wFD0QgB8bp8LrC3VsS0L253KgRSPSN8TxdLaTrc5RCU2LqceELftNWPe1sp9LUOt5my5IcWMMJaYPC8WQ6XWcJErnONB30ysJMY3JH7ypceUFWSJz1jVnhKcROXY8K78gcoy0UCm1gM6kMSmqJ546DyN50lQvqqzrMBIt5VeHkyZM8CIrK08XCnfJmPu9ZWeFal5G6hBogpku86NZyYwhKob60nv2m7uw6LovWUyWmT+zkPlYUbsuhgOdTZ8IH+rWnssLEvCO03x/lzWdbPcamm2yH5wqZNuyfVo5pcUcz9XWNH7YOetQ3I1ZS+NFWKWUi4K8tCqUpZrxTodB0ydoanNR+IFco9Pq0tj3rb9S9bmZK16annbumm/L5YhU2hrbU5/K8PU2tl2hX+FxSKHUJx97M1MwVcl0plVwj5+rec6fIxnTI0B2ecl9bhWFdoS/fN9X1tKtC7ZqcAM0WyRtkLGzsou6dOk1E02WleWtbJ75WGHibSkTWQyHV61TsKtRGlSlMt0VfsOoUugXaHjelGME4/uNXChltDhY6KjRuZOo01YSzucKQfEHcydVwvbpEJaM21vFO2xXyee2j/RTqq5JCPbCZQutZm5j0U1ietmYZOrcrLMWl8WF+f+2rUM92dzCoa6V/RKH2Ep8lK6W6lnurQidgjPd+uvWmxjX2HUPXyxnTza1Uyx09R3XmnXypWZIOJU9z1a3Lr5oU0ru+OVqqMKC3Qi1m7Cj09ZYsV6i/vJB+nW7bYBv3uY7JWkfrahHotXgR6C/1VWimHHFMw9SbD2xSr6Mvdg/k1mGiq2GrQjNTrzbY66nQtt+JWMoxDdcluu+VqjTPManj313bemjaP7Tt763QqNnZuNSM61CfCtoqbff2kcj1V2LbEN9s5ObluNQqNHPIse7eCgMb4euKpdkGFzGNDrli18TYro9GMxHtPshu9Eje/EaF+hTWumxuur+rQnuUOyxSjFTqEEtPEOPP1tbXZ5vIj6BzFsMJjD5l6vKZLwdmm19Efo1WaiN2tVd0MmJdFdrJTBbrLKYOnbRUsYSY9Zq8KGNhPB/58baz83GyeaPD/LKOnNyQUtM0V804T9J+8YWcO/Fpd4VunrAxT2P9Ldl46dab87n2ESM38/4lCWkjEu0Kzb6GjDbbaFdKnHZWaKPDOioMcHOJi+nMGeRuYWn+lbbQaKpTI00K3VRble4KS2kw9ais0PNaPjLusX7w5sYOtb9qXlF4w7apt0IveK6+rPtbK2zZQY17rZB831CFXQaaFZqMkGH36yxGTWHt23v9MTOG7Fo5G8mYeP1CAHGv5taJ46pa9hbsVhrF2Vlq599Hoeff3LT3G3f3h+r7QfVcoIcjNZXItfud0cZ3lht6XgxzFuU8DZVPJj0bJTx9RkYZ40o20appUuhRfj8UbnT4yRitK0xHIPlwenM2rx3QdYFxb3+apjLiVXSW5eWU6iRQ7eSUi8HlskykWn9VMXU0IwtKCaCGe8VJo3dL3/adLEbZVfo8eYs2h000f5HB7+grPi+C/CTW72PitdPa/4kZ5loWhqXLrq8Oov8pslSrE2WaAOTwOye93w7GuRc+n2K7t7DZhbfftsVvBNvrQO1FDRgzJxukx/ng98U5vIm8PKm9NrFpt2Tot4c7wfZ4OHHX19/f1H8r2nPa0UP4Ga896j/0+iHCt0YsG36wQvaPIzALM2o/6TiwR1goHAR/22mPM4oPF/4oU9CBCc6Tl/P9GDT8avBx+Jd++AkAAJ73H6GobYBzD++QAAAAAElFTkSuQmCC",import.meta.url).href},{value:"MTN",label:"MTN Mobile Money",logo:new URL("/assets/mtn-BYIQIUOR.jpg",import.meta.url).href}],k=[10,20,50,100],h=me(()=>o.value>=10&&n.value.trim().length===9&&/^6\d{8}$/.test(n.value)&&i.value!==""),d=()=>{b.value=o.value*25},p=z=>{o.value=z,d()},y=()=>{d()},D=()=>{m.value=!(n.value.trim().length===9&&/^6\d{8}$/.test(n.value))},$=async()=>{if(l.value=!i.value,!h.value){c.error("Veuillez remplir tous les champs correctement.");return}r.value=!0;try{const z=await F.post("/acheter-jetons",{nombre_jetons:o.value,payment_service:i.value,phone_number:n.value});c.success(z.data.message),g("purchased",o.value),g("close")}catch(z){if(z.response&&z.response.data){const f=z.response.data;c.error(`Erreur: ${f.error_message||"Achat Ã©chouÃ©"}. DÃ©tails: ${f.details||"Aucun dÃ©tail."}`)}else c.error("Erreur lors de l'achat. Veuillez rÃ©essayer.");console.error(z)}finally{r.value=!1}};return ae(n,()=>{D()}),(z,f)=>{const w=ne("router-link");return t(),a("div",Ss,[e("div",js,[f[7]||(f[7]=e("h2",{class:"text-3xl font-extrabold text-[var(--espace-vert)] text-center"}," ğŸ« Acheter des Jetons ",-1)),f[8]||(f[8]=e("p",{class:"text-center text-gray-600 text-sm mb-6"},"1 jeton = 25 FCFA",-1)),e("div",Vs,[(t(),a(T,null,O(k,j=>e("button",{key:j,type:"button",onClick:B=>p(j),class:q(["rounded-full px-4 py-2 border font-semibold transition",o.value===j?"bg-[var(--espace-vert)] text-white border-[var(--espace-vert)]":"bg-white text-gray-700 border-gray-300 hover:bg-[var(--espace-vert)] hover:text-white"])},v(j),11,Ms)),64))]),f[9]||(f[9]=e("label",{class:"block text-gray-700 font-semibold mb-1",for:"jetonQuantity"},[_(" Nombre de jetons "),e("span",{class:"text-sm text-gray-500"},"(min 10)")],-1)),R(e("input",{id:"jetonQuantity","onUpdate:modelValue":f[0]||(f[0]=j=>o.value=j),type:"number",min:"10",placeholder:"Ex: 10",onInput:y,class:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition"},null,544),[[W,o.value,void 0,{number:!0}]]),f[10]||(f[10]=e("label",{class:"block text-gray-700 font-semibold mb-1 mt-4",for:"phoneNumber"},[_(" NumÃ©ro de tÃ©lÃ©phone "),e("span",{class:"text-sm text-red-500"},"*")],-1)),R(e("input",{id:"phoneNumber","onUpdate:modelValue":f[1]||(f[1]=j=>n.value=j),type:"tel",placeholder:"Ex: 696428651",onInput:D,class:q(["w-full rounded-lg border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)] transition",m.value?"border-red-500":"border-gray-300"])},null,34),[[W,n.value]]),m.value?(t(),a("p",zs," Veuillez entrer un numÃ©ro valide (9 chiffres, commenÃ§ant par 6). ")):C("",!0),f[11]||(f[11]=e("label",{class:"block text-gray-700 font-semibold mb-2 mt-4",for:"paymentService"}," Service de paiement ",-1)),e("div",Es,[(t(),a(T,null,O(S,j=>e("label",{key:j.value,class:q(["flex items-center gap-3 cursor-pointer rounded-lg border p-3 flex-1 transition hover:border-[var(--espace-vert)]",{"border-[var(--espace-vert)] bg-[var(--espace-vert)]/10":i.value===j.value,"border-gray-300 bg-white":i.value!==j.value}])},[R(e("input",{type:"radio",value:j.value,"onUpdate:modelValue":f[2]||(f[2]=B=>i.value=B),class:"hidden"},null,8,Is),[[Ne,i.value]]),e("img",{src:j.logo,alt:"",class:"h-8 w-8 object-contain"},null,8,Ls),e("span",{class:q({"text-[var(--espace-vert)] font-bold":i.value===j.value,"text-gray-700":i.value!==j.value})},v(j.label),3)],2)),64))]),l.value&&!i.value?(t(),a("p",Fs," Veuillez sÃ©lectionner un service. ")):C("",!0),e("div",Us,[f[4]||(f[4]=_(" Montant total : ")),e("span",Ts,v(b.value)+" FCFA",1)]),e("button",{onClick:$,disabled:!h.value||r.value,class:"w-full mt-4 bg-[var(--espace-vert)] text-white py-3 rounded-lg font-semibold hover:bg-[var(--espace-or)] transition disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-3"},[r.value?(t(),a("span",Ds,"veuillez patientez")):(t(),a("span",qs,"Acheter")),r.value?(t(),a("svg",Os,f[5]||(f[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))):C("",!0)],8,Rs),e("button",Ns,[U(w,{to:"/jeton-history",onClick:f[3]||(f[3]=j=>g("close"))},{default:N(()=>f[6]||(f[6]=[_("Annuler")])),_:1,__:[6]})])])])}}}),Js=G(Ws,[["__scopeId","data-v-dd0cd514"]]),Hs={class:"space-y-6"},Bs={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},Xs={key:0,class:"space-y-2 text-[var(--espace-gris)]"},Gs={class:"flex gap-2"},Ks={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},Qs={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-[var(--espace-gris)]"},Zs=X({__name:"userProfile",props:{user:Object},setup(E){var r,l,m,S;const s=E;console.log(s);const g=le(),c=Q(),o=x(!1),n=x(g.user||s.user),i=x({nom:((r=g.user)==null?void 0:r.nom)||"",telephone:((l=g.user)==null?void 0:l.telephone)||"",email:((m=g.user)==null?void 0:m.email)||"",ville:((S=g.user)==null?void 0:S.ville)||""}),b=async()=>{var k;try{const h=await F.put("/profile",i.value);n.value&&(n.value.nom=h.data.user.nom||"",n.value.telephone=h.data.user.telephone||"",n.value.email=h.data.user.email||"",n.value.ville=h.data.user.ville||""),g.user=h.data.user,o.value=!1,c.success("Profil mis Ã  jour avec succÃ¨s.")}catch(h){c.error(((k=h.response)==null?void 0:k.data.message)||"Erreur lors de la mise Ã  jour.")}};return ae(()=>n,k=>{var h,d,p,y;i.value={nom:((h=k==null?void 0:k.value)==null?void 0:h.nom)||"",telephone:((d=k==null?void 0:k.value)==null?void 0:d.telephone)||"",email:((p=k==null?void 0:k.value)==null?void 0:p.email)||"",ville:((y=k==null?void 0:k.value)==null?void 0:y.ville)||""}},{immediate:!0}),(k,h)=>{var d,p,y,D,$,z;return t(),a("div",Hs,[e("section",Bs,[h[16]||(h[16]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations personnelles",-1)),o.value?(t(),a("form",{key:1,onSubmit:ee(b,["prevent"]),class:"space-y-4"},[e("div",null,[h[11]||(h[11]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"nom"},"Nom",-1)),R(e("input",{"onUpdate:modelValue":h[1]||(h[1]=f=>i.value.nom=f),id:"nom",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre nom"},null,512),[[W,i.value.nom]])]),e("div",null,[h[12]||(h[12]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"telephone"},"TÃ©lÃ©phone",-1)),R(e("input",{"onUpdate:modelValue":h[2]||(h[2]=f=>i.value.telephone=f),id:"telephone",type:"tel",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre tÃ©lÃ©phone"},null,512),[[W,i.value.telephone]])]),e("div",null,[h[13]||(h[13]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"email"},"Email",-1)),R(e("input",{"onUpdate:modelValue":h[3]||(h[3]=f=>i.value.email=f),id:"email",type:"email",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre email (optionnel)"},null,512),[[W,i.value.email]])]),e("div",null,[h[14]||(h[14]=e("label",{class:"block text-[var(--espace-gris)] text-sm font-medium",for:"ville"},"Ville",-1)),R(e("input",{"onUpdate:modelValue":h[4]||(h[4]=f=>i.value.ville=f),id:"ville",type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Votre ville"},null,512),[[W,i.value.ville]])]),e("div",Gs,[h[15]||(h[15]=e("button",{type:"submit",class:"w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Enregistrer les modifications"}," Enregistrer ",-1)),e("button",{onClick:h[5]||(h[5]=f=>o.value=!1),class:"w-full sm:w-auto bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Annuler"}," Annuler ")])],32)):(t(),a("div",Xs,[e("p",null,[h[6]||(h[6]=e("strong",null,"Nom :",-1)),_(" "+v((d=n.value)==null?void 0:d.nom),1)]),e("p",null,[h[7]||(h[7]=e("strong",null,"TÃ©lÃ©phone :",-1)),_(" "+v((p=n.value)==null?void 0:p.telephone),1)]),e("p",null,[h[8]||(h[8]=e("strong",null,"Email :",-1)),_(" "+v(((y=n.value)==null?void 0:y.email)||"Non dÃ©fini"),1)]),e("p",null,[h[9]||(h[9]=e("strong",null,"Ville :",-1)),_(" "+v((D=n.value)==null?void 0:D.ville),1)]),e("p",null,[h[10]||(h[10]=e("strong",null,"Statut Premium :",-1)),_(" "+v(($=n.value)!=null&&$.premium?"Actif":"Inactif"),1)]),e("button",{onClick:h[0]||(h[0]=f=>o.value=!0),class:"mt-2 w-full sm:w-auto bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors","aria-label":"Modifier le profil"}," Modifier ")]))]),e("section",Ks,[h[18]||(h[18]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Statistiques",-1)),e("div",Qs,[e("p",null,[h[17]||(h[17]=e("strong",null,"DerniÃ¨re connexion :",-1)),_(" "+v(((z=n.value)==null?void 0:z.last_login)||"Non disponible"),1)])])]),h[19]||(h[19]=e("section",{class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},[e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Mon Parrainage")],-1))])}}}),Ys=G(Zs,[["__scopeId","data-v-f7a88476"]]),ea={class:"space-y-6"},ta={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},sa={key:0,class:"space-y-2 text-[var(--espace-gris)]"},aa={key:1},oa={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 space-y-4"},ra={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},la={key:1,class:"text-[var(--espace-gris)]"},na=X({__name:"MerchantProfile",props:{user:Object},setup(E){const s=Q(),g=x(null),c=x([]);return re(async()=>{try{console.log("DonnÃ©es du commerÃ§ant");const o=await F.get("/commercant/profil");console.log("DonnÃ©es du commerÃ§ant:",o.data),g.value=o.data.commercant,c.value=o.data.produits||[]}catch(o){s.error("Erreur lors du chargement des donnÃ©es du commerÃ§ant."+o)}}),(o,n)=>(t(),a("div",ea,[e("section",ta,[n[4]||(n[4]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Informations du Commerce",-1)),g.value?(t(),a("div",sa,[e("p",null,[n[0]||(n[0]=e("strong",null,"Nom :",-1)),_(" "+v(g.value.nom),1)]),e("p",null,[n[1]||(n[1]=e("strong",null,"Ville :",-1)),_(" "+v(g.value.ville),1)]),n[2]||(n[2]=e("p",null,[e("strong",null,"Produits actifs :")],-1))])):(t(),a("div",aa,n[3]||(n[3]=[e("p",{class:"text-[var(--espace-gris)]"},"Aucune information de commerce disponible.",-1)])))]),e("section",oa,[n[8]||(n[8]=e("h2",{class:"text-lg sm:text-xl font-semibold text-[var(--espace-vert)]"},"Mes Produits",-1)),c.value.length?(t(),a("div",ra,[(t(!0),a(T,null,O(c.value,i=>(t(),a("div",{key:i.id,class:"border rounded-md p-3 text-[var(--espace-gris)]"},[e("p",null,[n[5]||(n[5]=e("strong",null,"Nom :",-1)),_(" "+v(i.nom),1)]),e("p",null,[n[6]||(n[6]=e("strong",null,"Prix :",-1)),_(" "+v(i.prix)+" FCFA",1)]),e("p",null,[n[7]||(n[7]=e("strong",null,"Stock :",-1)),_(" "+v(i.quantite),1)])]))),128))])):(t(),a("p",la,"Aucun produit enregistrÃ©."))])]))}}),ia=G(na,[["__scopeId","data-v-3430da16"]]),ua={class:"overflow-y-auto min-h-screen relative bg-gray-100 py-8 sm:px-6"},da={class:"flex flex-col sm:flex-row items-center justify-between mb-8 gap-4"},ca={class:"flex items-center space-x-4 relative w-full gap-1 px-3"},pa={class:"relative"},va=["src"],ma={key:1,class:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-gray-500"},fa={key:3,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-36 bg-white border rounded-md shadow z-10"},ga={class:"space-y-1"},xa={key:0,class:"text-sm text-gray-500"},ba={key:0,class:"ml-4 flex items-center gap-2"},ha=["src"],ya=["disabled"],_a={class:"flex flex-col sm:flex-row gap-2 items-center"},wa={class:"container mx-auto max-w-4xl"},ka={key:2,class:"fixed inset-0 bg-black bg-opacity-0 flex items-center justify-center z-50"},$a={class:"bg-white rounded-lg p-4 relative w-full max-w-md"},Aa=X({__name:"Profile",setup(E){const s=oe(),g=Q(),c=le(),o=x(c.user);console.log(o==null?void 0:o.value);const n=x(!1),i=x(!1),b=x(null),r=x(null),l=x(!1),m=x(!1),S=x(!1),k=me(()=>m.value?ia:Ys),h=x(null),d=x(null),p=x(!1);let y=null;const D=()=>{var V;(V=h.value)==null||V.click(),n.value=!1},$=V=>{const u=V.target;if(u.files&&u.files[0]){const M=u.files[0];if(!M.type.startsWith("image/")){g.error("Veuillez sÃ©lectionner une image.");return}if(M.size>2*1024*1024){g.error("Image trop volumineuse (max 2Mo).");return}r.value=M,b.value=URL.createObjectURL(M)}},z=async()=>{try{y=await navigator.mediaDevices.getUserMedia({video:!0}),p.value=!0,n.value=!1,setTimeout(()=>{d.value&&(d.value.srcObject=y)},100)}catch(V){g.error("Impossible d'accÃ©der Ã  la camÃ©ra."),console.error(V)}},f=()=>{if(!d.value)return;const V=d.value,u=document.createElement("canvas");u.width=V.videoWidth,u.height=V.videoHeight;const M=u.getContext("2d");M&&(M.drawImage(V,0,0,u.width,u.height),u.toBlob(I=>{I&&(r.value=new File([I],"photo.jpg",{type:"image/jpeg"}),b.value=URL.createObjectURL(r.value),w())},"image/jpeg"))},w=()=>{y&&(y.getTracks().forEach(V=>V.stop()),y=null),p.value=!1},j=()=>{r.value=null,b.value=null},B=async()=>{var V,u;if(r.value){i.value=!0;try{const M=new FormData;M.append("photo",r.value);const I=await F.post("/profile/photo",M,{headers:{"Content-Type":"multipart/form-data"}});I.data.photo&&(o.value&&(o.value.photo=I.data.photo,c.user=o.value),g.success("Photo mise Ã  jour."),j())}catch(M){g.error(((u=(V=M.response)==null?void 0:V.data)==null?void 0:u.message)||"Erreur lors de l'envoi.")}finally{i.value=!1}}},L=async()=>{l.value=!1},P=V=>{g.success(`Vous avez achetÃ© ${V} jetons !`)};return ae(()=>c.user,V=>{o.value=V||null},{immediate:!0}),re(()=>{}),we(()=>{b.value&&URL.revokeObjectURL(b.value),y&&y.getTracks().forEach(V=>V.stop())}),(V,u)=>{var M,I,J,Z,K,H,Y,ie,ue,fe,ge,xe,pe,de,be,Ae,_e,he,Le,Fe,Ue,Te,Re,qe,De;return t(),a("div",ua,[e("div",da,[e("div",ca,[e("div",pa,[(M=o.value)!=null&&M.photo?(t(),a("img",{key:0,src:`http://localhost:8000/storage/${(I=o.value)==null?void 0:I.photo}`,alt:"Photo de profil",class:"w-16 h-16 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,va)):(t(),a("div",ma,u[6]||(u[6]=[e("i",{class:"fas fa-user-circle text-4xl"},null,-1)]))),(J=o.value)!=null&&J.premium?(t(),a("i",{key:2,class:"fas fa-crown text-yellow-400 absolute -top-2 -right-2 text-lg p-1 rounded-full",style:ve({color:`${((Y=(H=(K=(Z=o.value)==null?void 0:Z.niveaux_users)==null?void 0:K.at(-1))==null?void 0:H.parrainage_niveau)==null?void 0:Y.couleur)||"#000"}`})},null,4)):C("",!0),e("button",{onClick:u[0]||(u[0]=Ce=>n.value=!n.value),class:"absolute bottom-0 right-0 w-6 h-6 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full flex items-center justify-center hover:bg-[var(--espace-vert)] hover:text-white",style:ve({background:`${((ge=(fe=(ue=(ie=o.value)==null?void 0:ie.niveaux_users)==null?void 0:ue.at(-1))==null?void 0:fe.parrainage_niveau)==null?void 0:ge.couleur)||"#000"}`})},u[7]||(u[7]=[e("i",{class:"fas fa-pencil-alt text-xs"},null,-1)]),4),n.value?(t(),a("div",fa,[e("button",{onClick:z,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," CamÃ©ra "),e("button",{onClick:D,class:"w-full text-left px-4 py-2 hover:bg-gray-100"}," Galerie ")])):C("",!0)]),e("input",{ref_key:"galleryInput",ref:h,type:"file",accept:"image/*",class:"hidden",onChange:$},null,544),e("div",ga,[u[8]||(u[8]=_("rr ")),e("h1",{class:"text-2xl sm:text-3xl font-bold flex items-center gap-2 text-blue-500",style:ve({color:`${((be=(de=(pe=(xe=o.value)==null?void 0:xe.niveaux_users)==null?void 0:pe.at(-1))==null?void 0:de.parrainage_niveau)==null?void 0:be.couleur)||"#000"}`})},[_(v((Ae=o.value)==null?void 0:Ae.nom)+" ",1),(_e=o.value)!=null&&_e.premium?(t(),a("span",{key:0,class:"text-black text-xs px-3 py-1 rounded-full uppercase font-bold",style:ve({background:`${((Ue=(Fe=(Le=(he=o.value)==null?void 0:he.niveaux_users)==null?void 0:Le.at(-1))==null?void 0:Fe.parrainage_niveau)==null?void 0:Ue.couleur)||"#000"}`})}," Premium ",4)):C("",!0)],4),(Te=o.value)!=null&&Te.subscription_ends_at?(t(),a("span",xa," Jusqu'au "+v(new Date((Re=o.value)==null?void 0:Re.subscription_ends_at).toLocaleDateString()),1)):C("",!0)]),b.value?(t(),a("div",ba,[e("img",{src:b.value,alt:"Preview",class:"w-12 h-12 rounded-full object-cover"},null,8,ha),e("button",{onClick:B,disabled:i.value,class:q(["bg-[var(--espace-vert)] text-white px-3 py-1 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]",{"opacity-50 cursor-not-allowed":i.value}])},v(i.value?"Upload...":"Confirmer"),11,ya),e("button",{onClick:j,class:"text-red-500 hover:text-red-700"}," Annuler ")])):C("",!0)]),e("div",_a,[(qe=o.value)!=null&&qe.commercant?(t(),a("button",{key:0,onClick:u[1]||(u[1]=Ce=>m.value=!m.value),class:"text-[var(--espace-or)] hover:text-[var(--espace-vert)] font-medium flex items-center gap-1"},u[9]||(u[9]=[e("i",{class:"fas fa-store"},null,-1),_(" Compte CommerÃ§ant ")]))):(t(),a("button",{key:1,onClick:u[2]||(u[2]=Ce=>A(s).push("/commercant/create")),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-vert)] hover:text-white"}," Devenir commerÃ§ant ")),(De=o.value)!=null&&De.premium?C("",!0):(t(),a("button",{key:2,onClick:u[3]||(u[3]=Ce=>l.value=!0),class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"}," Passer Premium "))])]),e("div",wa,[(t(),te(Xe(k.value)))]),l.value?(t(),te(Ps,{key:0,"is-open":l.value,onClose:u[4]||(u[4]=Ce=>l.value=!1),onUpgraded:L},null,8,["is-open"])):C("",!0),S.value?(t(),te(Js,{key:1,"is-open":S.value,onClose:u[5]||(u[5]=Ce=>S.value=!1),onPurchased:P},null,8,["is-open"])):C("",!0),p.value?(t(),a("div",ka,[e("div",$a,[e("video",{ref_key:"videoRef",ref:d,autoplay:"",playsinline:"",class:"rounded w-full"},null,512),e("div",{class:"mt-2 flex justify-between"},[e("button",{onClick:f,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Capturer "),e("button",{onClick:w,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Annuler ")])])])):C("",!0)])}}}),Si=G(Aa,[["__scopeId","data-v-531d24c8"]]),Ca={class:"min-h-screen bg-gray-100 pt-16 pb-20 px-4 sm:px-6 flex flex-col lg:flex-row gap-4"},Pa={class:"hidden lg:block w-full max-w-xs bg-[var(--espace-blanc)] rounded-lg shadow-md p-4"},Sa={class:"space-y-2"},ja=["onClick"],Va={class:"font-poppins"},Ma={class:"flex-1 bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},za={class:"lg:hidden mb-4"},Ea={class:"flex overflow-x-auto space-x-2 border-b border-[var(--espace-gris)]"},Ia=["onClick"],La={key:0,class:"space-y-6"},Fa={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ua={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Ta={class:"flex items-center gap-4 mb-4"},Ra=["src"],qa={class:"text-[var(--espace-vert)] font-semibold"},Da={class:"text-sm text-[var(--espace-gris)]"},Oa={class:"text-sm text-[var(--espace-gris)]"},Na={class:"text-sm text-[var(--espace-gris)]"},Wa={key:0,class:"space-y-6"},Ja={key:0,class:"space-y-6"},Ha={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ba={class:"text-base font-medium font-poppins"},Xa={class:"text-sm text-[var(--espace-gris)]"},Ga=X({__name:"Parametres",setup(E){const s=x(!1),g=le(),c=oe(),o=Q(),n=g.user,i=x("profile"),b=x({id:(n==null?void 0:n.id)??0,nom:(n==null?void 0:n.nom)??"",email:(n==null?void 0:n.email)??"",telephone:(n==null?void 0:n.telephone)??"",ville:(n==null?void 0:n.ville)??""});g.user={...g.user,...b.value};const r=x({current_password:"",new_password:"",confirm_password:""});x({});const l=x(""),m=me(()=>[...n!=null&&n.commercant?[{to:"/commercant",label:"Espace CommerÃ§ant",icon:"fa-store-alt",description:"GÃ©rez votre boutique et vos produits"}]:[],{to:"/parrainage",label:"Parrainage",icon:"fa-users",description:"Invitez des amis et gagnez des rÃ©compenses"},{to:"/abonnements",label:"Abonnements",icon:"fa-star",description:"GÃ©rez vos abonnements premium"},{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",description:"GÃ©rez vos collaborations sur des produits"}]),S=async()=>{var p,y;s.value=!0;try{await F.put("/user/profile",b.value),localStorage.setItem("user",JSON.stringify(g.user)),o.success("Profil mis Ã  jour avec succÃ¨s",{timeout:3e3})}catch(D){o.error(((y=(p=D.response)==null?void 0:p.data)==null?void 0:y.message)||"Erreur lors de la mise Ã  jour du profil")}finally{s.value=!1}},k=async()=>{var p,y;s.value=!0;try{if(r.value.new_password!==r.value.confirm_password){o.error("Les mots de passe ne correspondent pas");return}if(l.value==="weak"){o.error("Le mot de passe est trop faible. Utilisez au moins 8 caractÃ¨res avec des lettres, chiffres et symboles.");return}await F.put("/user/password",r.value),o.success("Mot de passe mis Ã  jour avec succÃ¨s",{timeout:3e3}),r.value={current_password:"",new_password:"",confirm_password:""},l.value=""}catch(D){o.error(((y=(p=D.response)==null?void 0:p.data)==null?void 0:y.message)||"Erreur lors de la mise Ã  jour du mot de passe")}finally{s.value=!1}},h=()=>{g.logout(),c.push({name:"login"})},d=()=>{const p=r.value.new_password;p.length===0?l.value="":p.length<8||!/[A-Za-z]/.test(p)||!/[0-9]/.test(p)?l.value="weak":/[!@#$%^&*]/.test(p)?l.value="strong":l.value="medium"};return ae(()=>r.value.new_password,d),(p,y)=>{const D=ne("RouterLink");return t(),a(T,null,[U($e,{isLoading:s.value},null,8,["isLoading"]),e("div",Ca,[e("aside",Pa,[y[7]||(y[7]=e("h2",{class:"text-xl font-semibold text-[var(--espace-vert)] mb-4 font-poppins"},"ParamÃ¨tres",-1)),e("nav",Sa,[(t(),a(T,null,O([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"SÃ©curitÃ©",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres options",icon:"fa-cog"},{id:"logout",label:"DÃ©connexion",icon:"fa-sign-out-alt"}],$=>e("button",{key:$.id,onClick:z=>$.id==="logout"?h():i.value=$.id,class:q(["w-full flex items-center gap-3 p-3 rounded-lg transition-colors duration-300",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":i.value===$.id,"text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":i.value!==$.id}])},[e("i",{class:q(["fas",$.icon])},null,2),e("span",Va,v($.label),1)],10,ja)),64))])]),e("main",Ma,[e("div",za,[e("div",Ea,[(t(),a(T,null,O([{id:"profile",label:"Profil",icon:"fa-user"},{id:"security",label:"SÃ©curitÃ©",icon:"fa-lock"},{id:"notifications",label:"Notifications",icon:"fa-bell"},{id:"links",label:"Autres",icon:"fa-cog"},{id:"logout",label:"DÃ©connexion",icon:"fa-sign-out-alt"}],$=>e("button",{key:$.id,onClick:z=>$.id==="logout"?h():i.value=$.id,class:q(["flex items-center gap-2 px-4 py-2 text-sm font-medium font-poppins transition-colors duration-300",{"border-b-2 border-[var(--espace-or)] text-[var(--espace-vert)]":i.value===$.id,"text-[var(--espace-gris)] hover:text-[var(--espace-vert)]":i.value!==$.id}])},[e("i",{class:q(["fas",$.icon])},null,2),_(" "+v($.label),1)],10,Ia)),64))])]),U(ce,{name:"slide"},{default:N(()=>{var $,z;return[i.value==="profile"?(t(),a("section",La,[y[10]||(y[10]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Profil",-1)),e("div",Fa,[e("form",{onSubmit:ee(S,["prevent"]),class:"space-y-4"},[U(se,{label:"Nom",icon:"fa-user",modelValue:b.value.nom,"onUpdate:modelValue":y[0]||(y[0]=f=>b.value.nom=f),type:"text",required:"",placeholder:"Votre nom"},null,8,["modelValue"]),U(se,{label:"Email",icon:"fa-envelope",modelValue:b.value.email,"onUpdate:modelValue":y[1]||(y[1]=f=>b.value.email=f),type:"email",placeholder:"Votre email"},null,8,["modelValue"]),U(se,{label:"TÃ©lÃ©phone",icon:"fa-phone",modelValue:b.value.telephone,"onUpdate:modelValue":y[2]||(y[2]=f=>b.value.telephone=f),type:"tel",required:"",placeholder:"Votre numÃ©ro de tÃ©lÃ©phone"},null,8,["modelValue"]),U(se,{label:"Ville",icon:"fa-city",modelValue:b.value.ville,"onUpdate:modelValue":y[3]||(y[3]=f=>b.value.ville=f),type:"text",required:"",placeholder:"Votre ville"},null,8,["modelValue"]),y[8]||(y[8]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Mettre Ã  jour ",-1))],32),e("div",Ua,[y[9]||(y[9]=e("h3",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2 font-poppins"},"AperÃ§u",-1)),e("div",Ta,[e("img",{src:((z=($=A(n))==null?void 0:$.commercant)==null?void 0:z.logo)||"https://via.placeholder.com/50",alt:"Photo de profil",class:"w-12 h-12 rounded-full object-cover"},null,8,Ra),e("div",null,[e("p",qa,v(b.value.nom||"Nonni"),1),e("p",Da,v(b.value.email||"Non dÃ©fini"),1)])]),e("p",Oa,"TÃ©lÃ©phone: "+v(b.value.telephone||"Nonni"),1),e("p",Na,"Ville: "+v(b.value.ville||"Non dÃ©fini"),1)])])])):C("",!0)]}),_:1}),U(ce,{name:"slide"},{default:N(()=>[i.value==="security"?(t(),a("section",Wa,[y[12]||(y[12]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"SÃ©curitÃ©",-1)),e("form",{onSubmit:ee(k,["prevent"]),class:"space-y-4"},[U(se,{label:"Mot de passe actuel",icon:"fa-lock",modelValue:r.value.current_password,"onUpdate:modelValue":y[4]||(y[4]=$=>r.value.current_password=$),type:"password",required:"",placeholder:"Mot de passe actuel"},null,8,["modelValue"]),U(se,{label:"Nouveau mot de passe",icon:"fa-lock",modelValue:r.value.new_password,"onUpdate:modelValue":y[5]||(y[5]=$=>r.value.new_password=$),type:"password",required:"",placeholder:"Nouveau mot de passe",onInput:d},null,8,["modelValue"]),l.value?(t(),a("div",{key:0,class:q(["text-sm",{"text-red-500":l.value==="weak","text-yellow-500":l.value==="medium","text-green-500":l.value==="strong"}])}," Force du mot de passe : "+v(l.value==="weak"?"Faible":l.value==="medium"?"Moyen":"Fort"),3)):C("",!0),U(se,{label:"Confirmer le nouveau mot de passe",icon:"fa-lock",modelValue:r.value.confirm_password,"onUpdate:modelValue":y[6]||(y[6]=$=>r.value.confirm_password=$),type:"password",required:"",placeholder:"Confirmer le mot de passe"},null,8,["modelValue"]),y[11]||(y[11]=e("button",{type:"submit",class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"}," Changer le mot de passe ",-1))],32)])):C("",!0)]),_:1}),U(ce,{name:"slide"},{default:N(()=>[i.value==="links"?(t(),a("section",Ja,[y[13]||(y[13]=e("h2",{class:"text-2xl font-bold text-[var(--espace-vert)] font-poppins"},"Autres options",-1)),e("div",Ha,[(t(!0),a(T,null,O(m.value,$=>(t(),te(D,{key:$.to,to:$.to,class:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-transform hover:scale-105"},{default:N(()=>[e("i",{class:q(["fas",$.icon])},null,2),e("div",null,[e("h3",Ba,v($.label),1),e("p",Xa,v($.description),1)])]),_:2},1032,["to"]))),128))])])):C("",!0)]),_:1})])])],64)}}}),ji=G(Ga,[["__scopeId","data-v-34fd2bf9"]]),Ka={class:"bg-[var(--espace-blanc)] border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200"},Qa={class:"relative w-full h-32 overflow-hidden rounded-lg mb-2"},Za=["src","alt"],Ya={key:0,class:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex space-x-1"},eo={key:0,class:"absolute top-2 left-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},to={key:1,class:"absolute top-2 right-2 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boostÃ©"},so={class:"text-sm font-semibold text-[var(--espace-vert)] font-poppins truncate"},ao={class:"text-xs text-[var(--espace-gris)] truncate"},oo={class:"text-sm font-medium text-[var(--espace-or)]"},ro={class:"flex items-center justify-between mt-2 text-xs text-[var(--espace-gris)]"},lo={class:"flex items-center gap-1"},no={class:"flex items-center gap-1"},io=["aria-label"],uo=X({__name:"ProductCard",props:{produit:{}},emits:["toggle-favorite","handleToggleFavorite"],setup(E,{emit:s}){const g=E,c=s,o=Q(),n=ke();console.log(g.produit);const i=x(0),b=async()=>{var r,l;try{await n.toggleFavorite(g.produit.id),c("toggle-favorite",g.produit.id)}catch(m){o.error(((l=(r=m.response)==null?void 0:r.data)==null?void 0:l.message)||"Erreur lors de la mise Ã  jour des favoris.")}};return(r,l)=>{const m=ne("router-link");return t(),a("div",Ka,[U(m,{to:`/produits/${r.produit.id}`,class:"block relative"},{default:N(()=>[e("div",Qa,[e("div",{class:"flex w-full h-full slider-container",style:ve({transform:`translateX(-${i.value*100}%)`})},[(t(!0),a(T,null,O(r.produit.photos||[r.produit.photo_url||"https://via.placeholder.com/150"],(S,k)=>(t(),a("img",{key:k,src:S,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${r.produit.nom} - ${k+1}`},null,8,Za))),128))],4),r.produit.photos&&r.produit.photos.length>1?(t(),a("div",Ya,[(t(!0),a(T,null,O(r.produit.photos,(S,k)=>(t(),a("span",{key:k,class:q(["w-1.5 h-1.5 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":k===i.value}])},null,2))),128))])):C("",!0)]),r.produit.collaboratif?(t(),a("span",eo," Collaboratif ")):C("",!0),r.produit.boosted_until&&new Date(r.produit.boosted_until)>new Date?(t(),a("span",to," BoostÃ© ")):C("",!0),e("h3",so,v(r.produit.nom),1),e("p",ao,v(r.produit.description||"Aucune description"),1),e("p",oo,v(r.produit.prix)+" XAF",1)]),_:1},8,["to"]),e("div",ro,[e("div",lo,[l[0]||(l[0]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(r.produit.raw_views_count||r.produit.raw_views_count)+" vues",1)]),e("div",no,[e("button",{onClick:b,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] transition active:scale-95 focus:outline-none","aria-label":r.produit.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:q(["fas fa-bookmark text-sm",{"text-[var(--espace-or)]":r.produit.is_favorited_by}])},null,2)],8,io),e("span",null,v(r.produit.favorites_count)+" favoris",1)])])])}}}),Me=G(uo,[["__scopeId","data-v-f75e7e0d"]]),co={class:"pt-4 bg-[var(--espace-blanc)] max-h-full relative"},po={class:"relative overflow-y-scroll mx-auto px-4 sm:px-6 py-4 max-h-full"},vo={class:"fixed flex items-center overflow-x-auto space-x-2 mb-3 snap-x snap-mandatory z-5"},mo=["onClick","aria-label","aria-current"],fo={class:"fixed right-10 z-5 flex justify-end items-center mb-3"},go=["aria-label","aria-expanded"],xo={key:0,class:"absolute -top-1 -right-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] text-[10px] rounded-full h-5 w-5 flex items-center justify-center"},bo={key:0,class:"bg-[var(--espace-blanc)] rounded-xl shadow-md p-4 mb-4 fixed bottom-0 left-0 right-0 z-50 sm:static sm:flex sm:items-center sm:gap-3 sm:flex-wrap"},ho={class:"flex-1 min-w-[120px]"},yo={class:"flex-1 min-w-[120px]"},_o=["value"],wo={class:"flex-1 min-w-[100px]"},ko={class:"flex-1 min-w-[100px]"},$o={class:"flex-1 min-w-[120px]"},Ao=["value"],Co={class:"flex-1 min-w-[100px]"},Po=["aria-busy"],So={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},jo=X({__name:"Home",setup(E){const s=ke(),g=le(),c=x([]),o=Q(),n=x(!1),i=x({search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""}),b=x(["Douala","YaoundÃ©","Bamenda","Buea","Garoua"]),r=x(null),l=x(null),m=async()=>{try{const $=await F.get("/categories");c.value=$.data.categories}catch($){console.error("Erreur lors du chargement des catÃ©gories:",$),o.error("Erreur lors du chargement des catÃ©gories.")}},S=()=>{if(i.value.prix_min&&i.value.prix_max&&parseFloat(i.value.prix_min)>parseFloat(i.value.prix_max)){o.error("Le prix minimum doit Ãªtre infÃ©rieur au prix maximum.");return}s.fetchProducts(i.value,!0),n.value=!1},k=()=>{i.value={search:"",category:"",prix_min:"",prix_max:"",ville:"",collaboratif:""},s.fetchProducts({},!0)},h=$=>{s.setSort($)},d=()=>Object.values(i.value).filter($=>$!=="").length,p=$=>{D($)},y=$=>{D($)},D=async $=>{var B,L,P;const z=(B=g.user)==null?void 0:B.id;if(!z){o.error("Connexion requise pour enregistrer la vue.");return}const f=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),w=new Date().toISOString().split("T")[0],j=localStorage.getItem("lastResetDate");if((!j||j!==w)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",w)),!await f[$]){console.log(f);try{setTimeout(async()=>{const V=await F.post("/record_view",{product_id:$,user_id:z});o.success(V.data.message)},1e3),f[$]=!0,localStorage.setItem("viewedProducts",JSON.stringify(f))}catch(V){console.error("Erreur lors de l'enregistrement de la vue:",V),o.error(((P=(L=V.response)==null?void 0:L.data)==null?void 0:P.message)||"Erreur lors de l'enregistrement de la vue.")}}};return re(async()=>{try{await s.fetchProducts(),await m()}catch($){console.error("Erreur lors du chargement des produits ou catÃ©gories:",$),o.error("Erreur lors du chargement des produits. Veuillez rÃ©essayer.")}r.value=new IntersectionObserver($=>{$[0].isIntersecting&&!s.isLoading&&s.hasMore&&s.fetchProducts(i.value)},{threshold:.1}),l.value&&r.value.observe(l.value)}),we(()=>{r.value&&l.value&&r.value.unobserve(l.value)}),($,z)=>(t(),a("div",co,[U($e,{isLoading:A(s).isLoading},null,8,["isLoading"]),e("div",po,[e("div",vo,[(t(),a(T,null,O([{id:"popular",label:"Populaire",icon:"fa-fire"},{id:"favorites",label:"Favoris",icon:"fa-heart"}],f=>e("button",{key:f.id,onClick:w=>h(f.id),class:q(["flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium font-poppins snap-center shrink-0 transition-all duration-200",{"bg-[var(--espace-vert)] text-[var(--espace-blanc)]":A(s).sort===f.id,"bg-gray-100 text-[var(--espace-vert)] hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]":A(s).sort!==f.id}]),"aria-label":`Trier par ${f.label}`,"aria-current":A(s).sort===f.id?"true":void 0},[e("i",{class:q(["fas",f.icon])},null,2),_(" "+v(f.label),1)],10,mo)),64))]),e("div",fo,[e("button",{onClick:z[0]||(z[0]=f=>n.value=!n.value),class:"relative flex items-center justify-center w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition active:scale-95","aria-label":n.value?"Masquer les filtres":"Afficher les filtres","aria-expanded":n.value},[z[7]||(z[7]=e("i",{class:"fas fa-filter text-sm"},null,-1)),d()>0?(t(),a("span",xo,v(d()),1)):C("",!0)],8,go)]),U(ce,{name:"slide-up"},{default:N(()=>[n.value?(t(),a("div",bo,[e("form",{onSubmit:ee(S,["prevent"]),class:"grid grid-cols-2 gap-3 sm:flex sm:flex-row sm:gap-3"},[e("div",ho,[R(e("input",{"onUpdate:modelValue":z[1]||(z[1]=f=>i.value.search=f),id:"search",type:"text",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Rechercher...","aria-label":"Rechercher un produit"},null,512),[[W,i.value.search]])]),e("div",yo,[R(e("select",{"onUpdate:modelValue":z[2]||(z[2]=f=>i.value.category=f),id:"category",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[z[8]||(z[8]=e("option",{value:""},"CatÃ©gorie",-1)),(t(!0),a(T,null,O(c.value,f=>(t(),a("option",{key:f.id,value:f.id},v(f.nom),9,_o))),128))],512),[[ye,i.value.category]])]),e("div",wo,[R(e("input",{"onUpdate:modelValue":z[3]||(z[3]=f=>i.value.prix_min=f),id:"prix_min",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix min","aria-label":"Prix minimum"},null,512),[[W,i.value.prix_min]])]),e("div",ko,[R(e("input",{"onUpdate:modelValue":z[4]||(z[4]=f=>i.value.prix_max=f),id:"prix_max",type:"number",min:"0",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]",placeholder:"Prix max","aria-label":"Prix maximum"},null,512),[[W,i.value.prix_max]])]),e("div",$o,[R(e("select",{"onUpdate:modelValue":z[5]||(z[5]=f=>i.value.ville=f),id:"ville",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},[z[9]||(z[9]=e("option",{value:""},"Ville",-1)),(t(!0),a(T,null,O(b.value,f=>(t(),a("option",{key:f,value:f},v(f),9,Ao))),128))],512),[[ye,i.value.ville]])]),e("div",Co,[R(e("select",{"onUpdate:modelValue":z[6]||(z[6]=f=>i.value.collaboratif=f),id:"collaboratif",class:"w-full h-10 pl-3 pr-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition bg-[var(--espace-blanc)]"},z[10]||(z[10]=[e("option",{value:""},"Collaboratif",-1),e("option",{value:"true"},"Oui",-1),e("option",{value:"false"},"Non",-1)]),512),[[ye,i.value.collaboratif]])]),e("div",{class:"flex gap-2 col-span-2 sm:col-span-1"},[z[12]||(z[12]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"Appliquer les filtres"},[e("i",{class:"fas fa-check text-sm"})],-1)),e("button",{onClick:k,type:"button",class:"w-10 h-10 bg-[var(--espace-gris)] text-[var(--espace-blanc)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center active:scale-95","aria-label":"RÃ©initialiser les filtres"},z[11]||(z[11]=[e("i",{class:"fas fa-times text-sm"},null,-1)]))])],32)])):C("",!0)]),_:1}),U(We,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 pt-12"},{default:N(()=>[(t(!0),a(T,null,O(A(s).products,f=>(t(),te(Me,{key:f.id,produit:f,onMouseover:w=>p(f.id),onTouchstart:w=>y(f.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:l,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":A(s).isLoading},[A(s).hasMore?C("",!0):(t(),a("p",So," Aucun produit supplÃ©mentaire "))],8,Po)])]))}}),Vi=G(jo,[["__scopeId","data-v-618cfe33"]]),Vo={class:"overflow-y-scroll bg-[var(--espace-blanc)] pt-16 pb-20 px-4 sm:px-6"},Mo={class:"container mx-auto max-w-5xl"},zo={key:0,class:"text-center text-[var(--espace-gris)]"},Eo={key:1,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 sm:p-6"},Io={class:"flex flex-col lg:flex-row gap-4 sm:gap-6"},Lo={class:"w-full lg:w-1/2 relative"},Fo={class:"relative w-full h-64 sm:h-80 lg:h-96 overflow-hidden rounded-lg"},Uo=["src","alt"],To={key:2,class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2"},Ro={key:0,class:"absolute top-3 left-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit boostÃ©"},qo={key:1,class:"absolute top-3 right-3 bg-[var(--espace-or)] text-[var(--espace-vert)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"Produit collaboratif"},Do={key:2,class:"absolute bottom-3 left-3 bg-[var(--espace-bleu)] text-[var(--espace-blanc)] text-[10px] font-semibold px-2 py-1 rounded-full font-poppins","aria-label":"CommerÃ§ant Pro"},Oo={class:"w-full lg:w-1/2"},No={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"},Wo={class:"text-sm text-[var(--espace-gris)] mb-3"},Jo={class:"text-lg sm:text-xl font-semibold text-[var(--espace-or)] mb-3"},Ho={class:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 text-xs text-[var(--espace-gris)]"},Bo={class:"flex items-center gap-3"},Xo={class:"flex items-center gap-1"},Go={class:"flex items-center gap-1"},Ko=["aria-label"],Qo={class:"border-t pt-3 mt-3"},Zo={class:"text-xs text-[var(--espace-gris)] mb-1"},Yo={key:0,class:"ml-1 text-[var(--espace-or)]","aria-label":"CommerÃ§ant vÃ©rifiÃ©",title:"CommerÃ§ant vÃ©rifiÃ©"},er={class:"text-xs text-[var(--espace-gris)] mb-1"},tr={class:"text-xs text-[var(--espace-gris)] mb-1"},sr={class:"text-xs text-[var(--espace-gris)] mb-2"},ar={class:"flex flex-col sm:flex-row gap-3 mt-4"},or=["disabled","aria-label"],rr={key:2,class:"text-center text-[var(--espace-gris)] text-sm font-poppins"},lr={class:"bg-[var(--espace-blanc)] rounded-lg p-4 sm:p-6 w-full max-w-md mx-4 shadow-lg"},nr={class:"text-base sm:text-lg font-semibold text-[var(--espace-vert)] mb-3 font-poppins"},ir={class:"text-xs text-[var(--espace-gris)] mb-3"},ur=["aria-label"],dr={key:0,class:"text-xs text-[var(--espace-gris)] mt-1"},cr={key:0,class:"mt-6"},pr=["aria-busy"],vr={key:0,class:"text-[var(--espace-gris)] text-xs font-poppins"},mr=X({__name:"Produit",setup(E){const s=ke(),g=Se(),c=oe(),o=le(),n=Ve(),i=Q();x([]);const b=x(!1),r=x(null),l=x(null),m=x(null),S=async()=>{try{s.isLoading=!0,await s.viewProduct(g.params.id),s.isLoading=!1,s.product.photos&&!s.product.photo_url&&(s.product.photo_url=s.product.photos[0]),await s.fetchProducts({category:s.product.category_id,per_page:8},!0),console.log(s.product)}catch(V){i.error(V||"Erreur lors du chargement du produit"),c.push({name:"home"})}finally{s.isLoading=!1}},k=()=>{var M,I;if(!o.user){i.error("Veuillez vous connecter pour contacter le commerÃ§ant"),c.push({name:"login"});return}const V=(M=s.product.commercant)==null?void 0:M.telephone,u=encodeURIComponent(`Bonjour ${(I=s.product.commercant)==null?void 0:I.nom}, je suis intÃ©ressÃ© par ${s.product.nom}. Pouvez-vous me contacter ?`);window.open(`https://wa.me/${V}?text=${u}`,"_blank")},h=()=>{var V;if(!o.user){i.error("Veuillez vous connecter pour collaborer"),c.push({name:"login"});return}if(((V=o.user.commercant)==null?void 0:V.id)===s.product.commercant_id){i.error("Vous ne pouvez pas collaborer sur votre propre produit");return}if(!s.product.collaboratif){i.error("Ce produit nâ€™est pas ouvert Ã  la collaboration");return}r.value=s.product.prix+(s.product.marge_min||500),b.value=!0},d=async()=>{if(!r.value||r.value<s.product.prix+(s.product.marge_min||0)){i.error(`Le prix de revente doit Ãªtre supÃ©rieur ou Ã©gal Ã  ${s.product.prix+(s.product.marge_min||0)} XAF`);return}await n.addCollaboration({produit_id:s.product.id,prix_revente:r.value})&&(i.success("Demande de collaboration envoyÃ©e",{timeout:3e3}),b.value=!1,r.value=null)},p=()=>{b.value=!1,r.value=null},y=()=>{c.push({path:`/commercant/produits/${s.product.id}/edit`})},D=async()=>{var u,M,I;if(!o.user||((u=o.user.commercant)==null?void 0:u.id)!==s.product.commercant_id){i.error("Seul le commerÃ§ant propriÃ©taire peut booster ce produit");return}const V=50;if(o.user.jetons<V){i.error(`Pas assez de Jetons. Il vous faut ${V} Jetons pour booster ce produit.`);return}try{const J=await F.post(`/produits/${s.product.id}/boost`);o.user.jetons-=V,s.product.boosted_until=J.data.data.end_date,i.success(J.data.message||"Produit boostÃ© avec succÃ¨s !")}catch(J){i.error(((I=(M=J.response)==null?void 0:M.data)==null?void 0:I.message)||"Erreur lors du boostage du produit")}},$=V=>{f(V)},z=V=>{f(V)},f=async V=>{var Z,K,H;const u=(Z=o.user)==null?void 0:Z.id;if(!u){i.error("Connexion requise pour enregistrer la vue.");return}const M=JSON.parse(localStorage.getItem("viewedProducts")||"{}"),I=new Date().toISOString().split("T")[0],J=localStorage.getItem("lastResetDate");if((!J||J!==I)&&(localStorage.removeItem("viewedProducts"),localStorage.setItem("lastResetDate",I)),!M[V])try{setTimeout(async()=>{const Y=await F.post("/record_view",{product_id:V,user_id:u});i.success(Y.data.message)},1e3),M[V]=!0,localStorage.setItem("viewedProducts",JSON.stringify(M))}catch(Y){console.error("Erreur lors de l'enregistrement de la vue:",Y),i.error(((H=(K=Y.response)==null?void 0:K.data)==null?void 0:H.message)||"Erreur lors de l'enregistrement de la vue.")}},w=async()=>{var V,u;try{await s.toggleFavorite(s.product.id)}catch(M){i.error(((u=(V=M.response)==null?void 0:V.data)==null?void 0:u.message)||"Erreur lors de la mise Ã  jour des favoris.")}},j=(V,u,M)=>{const I={id:V,name:u};localStorage.setItem("chatProduct",JSON.stringify(I)),c.push(`/messages/${M}`)},B=x(0),L=()=>{var u;const V=(((u=s.product.photos)==null?void 0:u.length)||1)-1;B.value=Math.min(B.value+1,V)},P=()=>{B.value=Math.max(B.value-1,0)};return re(()=>{S(),n.initializeState(),l.value=new IntersectionObserver(V=>{V[0].isIntersecting&&!s.isLoading&&s.hasMore&&s.fetchProducts({category:s.product.category_id,per_page:8},!1)},{threshold:.1}),m.value&&l.value.observe(m.value)}),we(()=>{l.value&&m.value&&l.value.unobserve(m.value)}),ae(()=>g.params.id,V=>{V&&(S(),B.value=0)}),ae(s.product,V=>{V&&(s.page=1,s.fetchProducts({category:V.category_id,per_page:4},!0),B.value=0)}),(V,u)=>{const M=ne("router-link");return t(),a(T,null,[U($e,{isLoading:A(s).isLoading},null,8,["isLoading"]),e("div",Vo,[e("div",Mo,[A(s).isLoading?(t(),a("div",zo)):A(s).product?(t(),a("div",Eo,[U(ce,{name:"slide-up"},{default:N(()=>{var I,J,Z,K,H,Y,ie,ue,fe,ge,xe,pe,de,be,Ae;return[e("div",Io,[e("div",Lo,[e("div",Fo,[e("div",{class:"flex w-full h-full slider-container",style:ve({transform:`translateX(-${B.value*100}%)`})},[(t(!0),a(T,null,O(A(s).product.photos||[A(s).product.photo_url||"https://via.placeholder.com/300"],(_e,he)=>(t(),a("img",{key:he,src:_e,class:"w-full h-full object-contain flex-shrink-0 mx-auto",alt:`Image de ${A(s).product.nom} - ${he+1}`},null,8,Uo))),128))],4),A(s).product.photos&&A(s).product.photos.length>1?(t(),a("button",{key:0,onClick:P,class:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image prÃ©cÃ©dente"},u[2]||(u[2]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))):C("",!0),A(s).product.photos&&A(s).product.photos.length>1?(t(),a("button",{key:1,onClick:L,class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-75 hidden md:block","aria-label":"Image suivante"},u[3]||(u[3]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))):C("",!0),A(s).product.photos&&A(s).product.photos.length>1?(t(),a("div",To,[(t(!0),a(T,null,O(A(s).product.photos,(_e,he)=>(t(),a("span",{key:he,class:q(["w-2 h-2 rounded-full bg-gray-400",{"bg-[var(--espace-or)]":he===B.value}])},null,2))),128))])):C("",!0)]),A(s).product.boosted_until&&new Date(A(s).product.boosted_until)>new Date?(t(),a("span",Ro," BoostÃ© ")):C("",!0),A(s).product.collaboratif?(t(),a("span",qo," Collaboratif ")):C("",!0),(I=A(o).user)!=null&&I.premium?(t(),a("span",Do," Premium ")):C("",!0)]),e("div",Oo,[e("h1",No,v(A(s).product.nom),1),e("p",Wo,v(A(s).product.description||"Aucune description disponible"),1),e("p",Jo,v(A(s).product.prix)+" XAF ",1),e("div",Ho,[e("p",null,[u[4]||(u[4]=e("strong",null,"CatÃ©gorie :",-1)),_(" "+v(((J=A(s).product.category)==null?void 0:J.nom)||"Non spÃ©cifiÃ©e"),1)]),e("p",null,[u[5]||(u[5]=e("strong",null,"QuantitÃ© :",-1)),_(" "+v(A(s).product.quantite),1)]),e("p",null,[u[6]||(u[6]=e("strong",null,"Ville :",-1)),_(" "+v(A(s).product.ville||"Non spÃ©cifiÃ©e"),1)]),e("p",null,[u[7]||(u[7]=e("strong",null,"AjoutÃ© le :",-1)),_(" "+v(new Date(A(s).product.created_at).toLocaleDateString("fr-FR")),1)]),e("div",Bo,[e("div",Xo,[u[8]||(u[8]=e("i",{class:"fas fa-eye text-[10px]"},null,-1)),e("span",null,v(A(s).product.raw_views_count)+" vues",1)]),e("div",Go,[e("i",{class:q(["fas fa-heart text-[10px]",{"text-[var(--espace-or)]":A(s).product.is_favorited_by}])},null,2),e("span",null,v(A(s).product.favorites_count)+" favoris",1)])])]),e("button",{onClick:w,class:"w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm mb-3","aria-label":A(s).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"},[e("i",{class:q(["fas fa-heart mr-2 text-sm",{"text-[var(--espace-or)]":A(s).product.is_favorited_by}])},null,2),_(" "+v(A(s).product.is_favorited_by?"Retirer des favoris":"Ajouter aux favoris"),1)],8,Ko),e("div",Qo,[u[13]||(u[13]=e("h2",{class:"text-base font-semibold text-[var(--espace-vert)] mb-2 font-poppins"}," Ã€ propos du commerÃ§ant ",-1)),e("p",Zo,[e("strong",null,v((Z=A(s).product.commercant)==null?void 0:Z.nom),1),(K=A(s).product.commercant)!=null&&K.verified?(t(),a("span",Yo,u[9]||(u[9]=[e("i",{class:"fas fa-check-circle text-[10px]"},null,-1)]))):C("",!0)]),e("p",er,v(((H=A(s).product.commercant)==null?void 0:H.description)||"Aucune description disponible"),1),e("p",tr,[u[10]||(u[10]=e("strong",null,"Ville :",-1)),_(" "+v(((Y=A(s).product.commercant)==null?void 0:Y.ville)||"NonspÃ©cifiÃ©e"),1)]),e("p",sr,[u[11]||(u[11]=e("strong",null,"Note :",-1)),_(" "+v(((ie=A(s).product.commercant)==null?void 0:ie.rating)||"Non Ã©valuÃ©")+" / 5 ",1)]),U(M,{to:`/commercants/${A(s).product.commercant_id}`,class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline text-xs font-poppins","aria-label":"Voir le profil du commerÃ§ant"},{default:N(()=>u[12]||(u[12]=[_(" Voir le profil du commerÃ§ant ")])),_:1,__:[12]},8,["to"])]),e("div",ar,[((fe=(ue=A(o).user)==null?void 0:ue.commercant)==null?void 0:fe.id)!==A(s).product.commercant_id?(t(),a("button",{key:0,onClick:k,class:"flex-1 bg-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] text-white transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le commerÃ§ant"},u[14]||(u[14]=[e("i",{class:"fas fa-phone mr-2 text-sm"},null,-1),_(" Contacter le commerÃ§ant ")]))):C("",!0),A(s).product.collaboratif&&((xe=(ge=A(o).user)==null?void 0:ge.commercant)==null?void 0:xe.id)!==A(s).product.commercant_id?(t(),a("button",{key:1,onClick:h,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Collaborer sur ce produit"},u[15]||(u[15]=[e("i",{class:"fas fa-handshake mr-2 text-sm"},null,-1),_(" Collaborer ")]))):C("",!0),((de=(pe=A(o).user)==null?void 0:pe.commercant)==null?void 0:de.id)===A(s).product.commercant_id?(t(),a("button",{key:2,onClick:y,class:"flex-1 bg-[var(--espace-vert)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition-all duration-200 active:scale-95 text-sm","aria-label":"Modifier le produit"},u[16]||(u[16]=[e("i",{class:"fas fa-edit mr-2 text-sm"},null,-1),_(" Modifier le produit ")]))):C("",!0),((Ae=(be=A(o).user)==null?void 0:be.commercant)==null?void 0:Ae.id)===A(s).product.commercant_id?(t(),a("button",{key:3,onClick:D,class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-sm",disabled:!!A(s).product.boosted_until&&new Date(A(s).product.boosted_until)>new Date,"aria-label":A(s).product.boosted_until&&new Date(A(s).product.boosted_until)>new Date?"Boost dÃ©jÃ  actif":"Booster ce produit"},u[17]||(u[17]=[e("i",{class:"fas fa-rocket mr-2 text-sm"},null,-1)]),8,or)):C("",!0),e("button",{onClick:u[0]||(u[0]=_e=>j(A(s).product.id,A(s).product.nom,A(s).product.commercant.user.id)),class:"flex-1 bg-green-500 text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-green-600 transition-all duration-200 active:scale-95 text-sm","aria-label":"Contacter le vendeur"},u[18]||(u[18]=[e("i",{class:"fas fa-comment mr-2 text-sm"},null,-1),_(" Contacter le vendeur ")]))])])])]}),_:1})])):(t(),a("div",rr," Produit non trouvÃ©. ")),U(ce,{name:"fade"},{default:N(()=>[b.value?(t(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ee(p,["self"]),role:"dialog","aria-modal":"true","aria-label":"Proposer un prix de revente"},[e("div",lr,[e("h2",nr," Collaborer sur "+v(A(s).product.nom),1),e("p",ir," Proposez un prix de revente (minimum : "+v(A(s).product.prix+(A(s).product.marge_min||0))+" XAF) ",1),e("form",{onSubmit:ee(d,["prevent"]),class:"space-y-3"},[e("div",null,[u[19]||(u[19]=e("label",{for:"prix_revente",class:"text-xs text-[var(--espace-vert)] font-medium"},"Prix de revente (XAF)",-1)),R(e("input",{id:"prix_revente","onUpdate:modelValue":u[1]||(u[1]=I=>r.value=I),type:"number",min:"0",class:"w-full h-10 p-2 text-xs border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-[var(--espace-or)] transition","aria-label":`Prix de revente pour ${A(s).product.nom}`,required:""},null,8,ur),[[W,r.value,void 0,{number:!0}]]),r.value?(t(),a("p",dr," Marge potentielle : "+v(r.value-A(s).product.prix)+" XAF ",1)):C("",!0)]),e("div",{class:"flex gap-3"},[u[20]||(u[20]=e("button",{type:"submit",class:"flex-1 bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-4 py-2 rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-all duration-200 active:scale-95 text-xs","aria-label":"Envoyer la demande de collaboration"}," Envoyer ",-1)),e("button",{type:"button",onClick:p,class:"flex-1 bg-[var(--espace-gris)] text-[var(--espace-blanc)] font-semibold px-4 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 active:scale-95 text-sm","aria-label":"Annuler"}," Annuler ")])],32)])])):C("",!0)]),_:1})]),A(s).products?(t(),a("div",cr,[u[21]||(u[21]=e("h2",{class:"text-lg sm:text-xl font-bold text-[var(--espace-vert)] mb-3 font-poppins"}," Produits similaires ",-1)),U(We,{name:"fade",tag:"div",class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},{default:N(()=>[(t(!0),a(T,null,O(A(s).products,I=>(t(),te(Me,{key:I.id,produit:I,onMouseover:J=>$(I.id),onTouchstart:J=>z(I.id)},null,8,["produit","onMouseover","onTouchstart"]))),128))]),_:1}),e("div",{ref_key:"loadMoreTrigger",ref:m,class:"h-10 flex items-center justify-center","aria-live":"polite","aria-busy":A(s).isLoading},[A(s).hasMore?C("",!0):(t(),a("p",vr," Aucun produit supplÃ©mentaire "))],8,pr)])):C("",!0)])],64)}}}),Mi=G(mr,[["__scopeId","data-v-cd3fe6c3"]]),fr={class:"relative bg-green-500"},gr={class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)] fixed top-0 left-0 w-full z-50 shadow-md"},xr={class:"container mx-auto px-2 sm:px-3 py-2 flex justify-between items-center gap-4"},br={class:"flex items-center gap-1 sm:gap-3"},hr={class:"hidden lg:flex items-center space-x-4 sm:space-x-6 font-poppins text-sm sm:text-base"},yr=["aria-label"],_r={class:"flex items-center gap-2"},wr=["src"],kr={key:1,class:"w-10 h-10 rounded-full flex items-center justify-center text-[var(--espace-gris)]"},$r={class:"relative w-full max-w-md bg-[var(--espace-blanc)] rounded-lg p-4 shadow-lg"},Ar={class:"lg:hidden fixed bottom-0 left-0 w-full bg-[var(--espace-vert)] text-[var(--espace-blanc)] shadow-md z-40"},Cr={class:"flex justify-around items-center py-2"},Pr=["aria-label"],Sr=X({__name:"AppHeader",setup(E){const s=le(),g=Ve(),c=oe(),o=s.user;Se();const n=x(!1),i=x(!1),b=x(!1),r=x(""),l=ke(),m=x(!1),S=x(null),k=x(!1),h=me(()=>[{to:"/",label:"Accueil",icon:"fa-home",badge:0},...s.user?[{to:"/profil",label:"Profil",icon:"fa-user-circle",badge:0},...s.user.commercant?[{to:"/commercant/produits",label:"Mes Produits",icon:"fa-box-open",badge:0}]:[],{to:"/collaborations",label:"Collaborations",icon:"fa-handshake",badge:g.collaborationsPending},{to:"/parrainage",label:"Mon Parrainage",icon:"fa-users",badge:0}]:[{to:"/login",label:"Connexion",icon:"fa-sign-in-alt",badge:0},{to:"/register",label:"Inscription",icon:"fa-user-plus",badge:0}]]),d=async()=>{if(s.user)try{const z=await F.get("/user/badges");g.saveCollaborationsToLocalStorage(z.data.collaborations_pending.map(f=>({produit_id:f.produit_id,prix_revente:f.prix_revente,status:f.status,created_at:f.created_at})))}catch(z){console.error("Erreur lors du chargement des badges:",z)}};ae(()=>s.user,z=>{z&&(d(),g.initializeState())},{immediate:!0}),ae(()=>g.collaborationsPending,()=>{g.collaborationsPending>0&&(i.value=!0,setTimeout(()=>i.value=!1,300))});const p=async()=>{if(r.value.trim())try{await l.fetchProducts({search:r.value.trim()},!0),r.value="",m.value=!1}catch(z){console.error("Erreur lors de la recherche:",z)}},y=z=>{if(k.value){k.value=!1;return}S.value&&!S.value.contains(z.target)&&(m.value=!1)},D=async()=>{m.value=!m.value,m.value&&(k.value=!0,await Ee())},$=()=>{c.push("/messages")};return re(()=>{s.user&&(d(),g.initializeState()),document.addEventListener("click",y)}),we(()=>{document.removeEventListener("click",y)}),(z,f)=>{const w=ne("RouterLink");return t(),a("div",fr,[e("header",gr,[e("div",xr,[e("div",br,[U(w,{to:"/","aria-label":"Retour Ã  l'accueil"},{default:N(()=>f[2]||(f[2]=[e("div",{class:"rounded-full pb-1 pt-1"},[e("img",{src:Je,alt:"Logo Espace Cameroun",class:"h-10 w-10 object-contain transition-transform duration-300 hover:scale-105 shadow-sm hover:shadow-md"})],-1)])),_:1,__:[2]}),f[3]||(f[3]=e("h1",{class:"text-lg sm:text-xl font-bold font-poppins text-[var(--espace-blanc)]"}," Espace Cameroun ",-1))]),e("nav",hr,[(t(!0),a(T,null,O(h.value,j=>(t(),te(w,{key:j.to,to:j.to,class:"hover:text-[var(--espace-or)] flex items-center gap-1 sm:gap-2 transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:q(["fas",j.icon])},null,2),_(" "+v(j.label)+" ",1),j.badge>0?(t(),a("span",{key:0,class:q(["cart-badge bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":j.to==="/panier"&&n.value||j.to==="/collaborations"&&i.value||j.to==="/commandes"&&b.value}]),"aria-label":j.to==="/panier"?"Nombre d'articles dans le panier":j.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(j.badge),11,yr)):C("",!0)]),_:2},1032,["to"]))),128))]),U(He),e("div",_r,[e("button",{onClick:D,class:"text-[var(--espace-blanc)] hover:text-[var(--espace-or)] transition-colors duration-300","aria-label":"Ouvrir la recherche"},f[4]||(f[4]=[e("i",{class:"fas fa-search text-2xl"},null,-1)])),e("button",{onClick:$,class:"text-[var(--espace-white)] px-1 rounded hover:bg-white transition"},f[5]||(f[5]=[e("i",{class:"fas fa-comment-dots text-2xl"},null,-1)])),(t(!0),a(T,null,O(h.value.filter(j=>A(s).user?j.to==="/profil":["/login","/register"].includes(j.to)),j=>(t(),te(w,{key:j.to,to:j.to,class:"relative flex items-center justify-center","aria-label":j.label},{default:N(()=>{var B;return[(B=A(o))!=null&&B.photo?(t(),a("img",{key:0,src:`http://localhost:8000/storage/${A(o).photo}`,alt:"Photo de profil",class:"w-10 h-10 rounded-full object-cover border-2 border-[var(--espace-vert)]"},null,8,wr)):(t(),a("div",kr,[e("i",{class:q([`fas ${j.icon}`,"text-2xl text-gray-100"])},null,2)])),j.badge>0&&j.to==="/collaborations"?(t(),a("span",{key:2,class:q(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":j.to==="/collaborations"&&i.value}]),"aria-label":"Collaborations en attente"},v(j.badge),3)):C("",!0)]}),_:2},1032,["to","aria-label"]))),128))])]),m.value?(t(),a("div",{key:0,ref_key:"searchOverlayRef",ref:S,class:"fixed bg-[var(--espace-vert)] bg-opacity-50 flex items-center top-10 w-full justify-center z-50 p-4"},[e("div",$r,[R(e("input",{"onUpdate:modelValue":f[0]||(f[0]=j=>r.value=j),type:"text",placeholder:"Rechercher un produit...",class:"w-full px-4 py-2 rounded-full text-[var(--espace-vert)] focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] text-base",onKeyup:ze(p,["enter"])},null,544),[[W,r.value]]),e("button",{onClick:p,class:"absolute right-6 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]"},f[6]||(f[6]=[e("i",{class:"fas fa-search text-lg"},null,-1)])),e("button",{onClick:f[1]||(f[1]=j=>m.value=!1),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--espace-vert)] hover:text-[var(--espace-or)]","aria-label":"Fermer la recherche"},f[7]||(f[7]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))])],512)):C("",!0)]),U(ce,{name:"slide-up"},{default:N(()=>[e("nav",Ar,[e("div",Cr,[(t(!0),a(T,null,O(h.value,j=>(t(),te(w,{key:j.to,to:j.to,"aria-label":j.label,class:"relative flex items-center justify-center w-10 h-10 hover:text-[var(--espace-or)] transition-colors duration-300","active-class":"text-[var(--espace-or)]"},{default:N(()=>[e("i",{class:q(["fas text-lg",j.icon])},null,2),j.badge>0?(t(),a("span",{key:0,class:q(["cart-badge absolute top-0 right-0 bg-[var(--espace-or)] text-[var(--espace-vert)] text-xs rounded-full h-5 w-5 flex items-center justify-center",{"animate-scale":j.to==="/panier"&&n.value||j.to==="/collaborations"&&i.value||j.to==="/commandes"&&b.value}]),"aria-label":j.to==="/panier"?"Nombre d'articles dans le panier":j.to==="/collaborations"?"Collaborations en attente":"Commandes en attente"},v(j.badge),11,Pr)):C("",!0)]),_:2},1032,["to","aria-label"]))),128))])])]),_:1})])}}}),Be=G(Sr,[["__scopeId","data-v-7e2b9e46"]]),jr={class:"min-h-screen bg-gray-100",style:{background:"url(/src/assets/images/bginsc.jpg) center/cover"}},Vr={class:"container mx-auto px-4 sm:px-6 py-6"},Mr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},zr={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Er={key:0,class:"text-sm sm:text-base text-[var(--espace-gris)]"},Ir={key:1,class:"text-sm sm:text-base text-[var(--espace-gris)]"},Lr={key:2,class:"text-sm text-[var(--espace-gris)] italic"},Fr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Ur=["value"],Tr={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},Rr=["value"],qr={class:"flex items-center gap-2 text-sm col-span-2 sm:col-span-1"},Dr=["value"],Or={class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-5 border border-gray-100"},Nr={key:0,class:"flex items-center gap-3 text-[var(--espace-vert)]"},Wr={key:1,class:"text-base text-[var(--espace-gris)] italic"},Jr={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Hr=["onClick"],Br=X({__name:"CommercantDashboard",setup(E){const s=Q(),g=x([]),c=x([]),o=x(null),n=x(!1),i=x({nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}),b=x({nom:"",description:"",ville:""}),r=x(["Douala","YaoundÃ©","Bamenda","Buea","Garoua"]),l=async()=>{n.value=!0;try{const[h,d,p]=await Promise.all([F.get("/commercant/produits"),F.get("/categories"),F.get("/commercant/profil")]);n.value=!1,g.value=h.data.produits.map(y=>{var D;return{...y,commercant_id:((D=o.value)==null?void 0:D.id)||""}}),c.value=d.data.categories,o.value=p.data.commercant,b.value={nom:o.value.nom,description:o.value.description||"",ville:o.value.ville||""}}catch{s.error("Erreur lors du chargement des donnÃ©es."),n.value=!1}},m=async()=>{try{const h=await F.post("/commercant/produits",i.value);s.success("Produit ajoutÃ© avec succÃ¨s."),l(),i.value={nom:"",description:"",prix:"",photo_url:"",category_id:"",collaboratif:!1,marge_min:"",stock:"",ville:""}}catch{s.error("Erreur lors de lâ€™ajout du produit.")}},S=async h=>{if(confirm("Voulez-vous supprimer ce produit ?"))try{await F.delete(`/commercant/produits/${h}`),s.success("Produit supprimÃ© avec succÃ¨s."),l()}catch{s.error("Erreur lors de la suppression du produit.")}},k=async()=>{try{await F.put("/commercant/profil",b.value),s.success("Profil mis Ã  jour avec succÃ¨s."),l()}catch{s.error("Erreur lors de la mise Ã  jour du profil.")}};return re(()=>{l()}),(h,d)=>(t(),a("div",jr,[U(Be),e("div",Vr,[d[26]||(d[26]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] flex items-center gap-3 mb-6"},[e("i",{class:"fas fa-store text-xl"}),_(" Espace CommerÃ§ant ")],-1)),e("div",Mr,[d[14]||(d[14]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-3"},"Statistiques",-1)),e("div",zr,[o.value?(t(),a("p",Er,[d[12]||(d[12]=e("span",{class:"font-medium"},"Revenus :",-1)),_(" "+v(o.value.revenus)+" FCFA ",1)])):C("",!0),o.value?(t(),a("p",Ir,[d[13]||(d[13]=e("span",{class:"font-medium"},"Produits vendus :",-1)),_(" "+v(o.value.produits_vendus),1)])):(t(),a("p",Lr,"Chargement..."))])]),e("div",Fr,[d[17]||(d[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Profil CommerÃ§ant",-1)),e("form",{onSubmit:ee(k,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[R(e("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>b.value.nom=p),type:"text",placeholder:"Nom du commerÃ§ant",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,b.value.nom]]),R(e("textarea",{"onUpdate:modelValue":d[1]||(d[1]=p=>b.value.description=p),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[W,b.value.description]]),R(e("select",{"onUpdate:modelValue":d[2]||(d[2]=p=>b.value.ville=p),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2 sm:col-span-1"},[d[15]||(d[15]=e("option",{value:""},"Ville",-1)),(t(!0),a(T,null,O(r.value,p=>(t(),a("option",{key:p,value:p},v(p),9,Ur))),128))],512),[[ye,b.value.ville]]),d[16]||(d[16]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-check"})],-1))],32)]),e("div",Tr,[d[22]||(d[22]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Ajouter un produit",-1)),e("form",{onSubmit:ee(m,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[R(e("input",{"onUpdate:modelValue":d[3]||(d[3]=p=>i.value.nom=p),type:"text",placeholder:"Nom du produit",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,i.value.nom]]),R(e("textarea",{"onUpdate:modelValue":d[4]||(d[4]=p=>i.value.description=p),placeholder:"Description",class:"h-24 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition col-span-2"},null,512),[[W,i.value.description]]),R(e("input",{"onUpdate:modelValue":d[5]||(d[5]=p=>i.value.prix=p),type:"number",placeholder:"Prix",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,i.value.prix]]),R(e("input",{"onUpdate:modelValue":d[6]||(d[6]=p=>i.value.photo_url=p),type:"text",placeholder:"URL de la photo",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[W,i.value.photo_url]]),R(e("select",{"onUpdate:modelValue":d[7]||(d[7]=p=>i.value.category_id=p),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[d[18]||(d[18]=e("option",{value:""},"CatÃ©gorie",-1)),(t(!0),a(T,null,O(c.value,p=>(t(),a("option",{key:p.id,value:p.id},v(p.nom),9,Rr))),128))],512),[[ye,i.value.category_id]]),e("label",qr,[R(e("input",{"onUpdate:modelValue":d[8]||(d[8]=p=>i.value.collaboratif=p),type:"checkbox"},null,512),[[Oe,i.value.collaboratif]]),d[19]||(d[19]=_(" Collaboratif "))]),R(e("input",{"onUpdate:modelValue":d[9]||(d[9]=p=>i.value.marge_min=p),type:"number",placeholder:"Marge minimum",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition"},null,512),[[W,i.value.marge_min]]),R(e("input",{"onUpdate:modelValue":d[10]||(d[10]=p=>i.value.stock=p),type:"number",placeholder:"Stock",min:"0",class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},null,512),[[W,i.value.stock]]),R(e("select",{"onUpdate:modelValue":d[11]||(d[11]=p=>i.value.ville=p),class:"h-10 p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--espace-or)] transition",required:""},[d[20]||(d[20]=e("option",{value:""},"Ville",-1)),(t(!0),a(T,null,O(r.value,p=>(t(),a("option",{key:p,value:p},v(p),9,Dr))),128))],512),[[ye,i.value.ville]]),d[21]||(d[21]=e("button",{type:"submit",class:"w-10 h-10 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-lg hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition flex items-center justify-center col-span-2 sm:col-span-1"},[e("i",{class:"fas fa-plus"})],-1))],32)]),e("div",Or,[d[25]||(d[25]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Produits",-1)),n.value?(t(),a("div",Nr,d[23]||(d[23]=[e("i",{class:"fas fa-spinner animate-spin text-xl"},null,-1),e("span",{class:"text-base font-poppins"},"Chargement...",-1)]))):g.value.length===0?(t(),a("div",Wr," Aucun produit disponible. ")):(t(),a("div",Jr,[(t(!0),a(T,null,O(g.value,p=>(t(),a("div",{key:p.id,class:"relative"},[U(Me,{produit:p},null,8,["produit"]),e("button",{onClick:y=>S(p.id),class:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition flex items-center justify-center","aria-label":"Supprimer le produit"},d[24]||(d[24]=[e("i",{class:"fas fa-trash text-sm"},null,-1)]),8,Hr)]))),128))]))])])]))}}),zi=G(Br,[["__scopeId","data-v-98a2ca3d"]]),Xr={class:"overflow-y-scroll bg-gray-100 pt-2 pb-12 px-4 sm:px-6"},Gr={class:"container mx-auto max-w-4xl"},Kr={class:"bg-white rounded-lg shadow-md p-6 mb-6"},Qr={key:0,class:"ml-2"},Zr={class:"w-full bg-gray-200 rounded-full h-4"},Yr={class:"text-[var(--espace-gris)] text-xs mt-2"},el={key:0,class:"text-[var(--espace-gris)] text-xs mt-1"},tl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},sl={key:0,class:"mb-4"},al={class:"text-sm text-[var(--espace-gris)]"},ol={class:"font-bold text-[var(--espace-or)]"},rl={class:"text-sm text-[var(--espace-gris)] truncate"},ll=["href"],nl={key:1,class:"mb-4"},il=["placeholder"],ul={class:"flex flex-col sm:flex-row gap-2"},dl=["disabled"],cl={key:0},pl={key:1},vl=["disabled"],ml={key:0},fl={key:1},gl={key:2,class:"mt-4 flex flex-col sm:flex-row gap-2"},xl={class:"bg-white rounded-lg shadow-md p-6 mb-6"},bl={key:0,class:"overflow-x-auto"},hl={class:"w-full text-sm text-left text-[var(--espace-gris)]"},yl={class:"px-4 py-2"},_l={class:"px-4 py-2"},wl={class:"px-4 py-2"},kl={key:1,class:"text-center text-[var(--espace-gris)] py-4"},$l={class:"bg-white rounded-lg shadow-md p-6 text-center"},Al={class:"text-2xl sm:text-3xl font-bold text-[var(--espace-or)]"},Cl={class:"text-[var(--espace-gris)] mt-2"},Pl=X({__name:"Parrainage",setup(E){const s=le(),g=oe(),c=Q(),o=x(""),n=x(""),i=x([]),b=x(0),r=x(""),l=x(""),m=x(!1),S=x(!1),k=x({}),h=x(null),d=x(0),p=me(()=>{var f;return((f=k.value)==null?void 0:f.couleur)||"#6b7280"}),y=async()=>{if(!s.user){c.error("Veuillez vous connecter pour accÃ©der Ã  cette page"),g.push("/login");return}try{const w=(await F.get("/parrainages/dashboard")).data;o.value=w.code||"",console.log(w),n.value=w.code?`https://espacecameroun.cm/invite/${w.code}`:"",i.value=w.parrainages||[],b.value=w.total_gains||0,k.value=w.niveau_actuel,console.log(k.value),h.value=w.niveau_suivant,d.value=w.progression}catch(f){c.error("Erreur lors de la rÃ©cupÃ©ration des donnÃ©es de parrainage"),console.error(f)}},D=async()=>{if(!s.user){c.error("Veuillez vous connecter");return}m.value=!0;try{const f=await F.post("/parrainages/generateCode");r.value=f.data.suggested_code,l.value=r.value,c.success("Nouveau code suggÃ©rÃ© avec succÃ¨s !")}catch(f){c.error("Erreur lors de la gÃ©nÃ©ration du code"),console.error(f)}finally{m.value=!1}},$=async()=>{var f,w;if(!s.user){c.error("Veuillez vous connecter");return}if(!l.value.trim()){c.error("Veuillez entrer un code valide");return}S.value=!0;try{const j=await F.post("/parrainages/create-code",{code:l.value.trim()});o.value=j.data.code,n.value=j.data.link||`https://espacecameroun.cm/invite/${j.data.code}`,c.success(j.data.message||"Code crÃ©Ã© avec succÃ¨s !"),await y()}catch(j){c.error(((w=(f=j.response)==null?void 0:f.data)==null?void 0:w.message)||"Erreur lors de la crÃ©ation du code"),console.error(j)}finally{S.value=!1}},z=f=>{if(!n.value){c.error("Aucun lien disponible pour le partage");return}let w="";const j=encodeURIComponent(`Rejoins-moi sur Espace Cameroun avec mon lien : ${n.value}`);switch(f){case"whatsapp":w=`https://api.whatsapp.com/send?text=${j}`;break;case"facebook":w=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(n.value)}`;break;default:c.error("Plateforme non prise en charge");return}window.open(w,"_blank")};return re(()=>{y()}),(f,w)=>{var j,B,L,P,V;return t(),a("div",Xr,[e("div",Gr,[e("div",Kr,[w[6]||(w[6]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Niveaux de Parrainage",-1)),e("p",{class:"text-[var(--espace-gris)] text-sm mb-2",style:ve({color:p.value})},[w[4]||(w[4]=_(" Votre niveau actuel : ")),e("strong",null,v(k.value?k.value.nom:"pas niveau")+" "+v((j=k.value)==null?void 0:j.emoji)+" ("+v(i.value.length)+"/"+v(h.value?h.value.filleuls_requis:(B=k.value)==null?void 0:B.filleuls_requis)+")",1),((L=k.value)==null?void 0:L.jetons_bonus)>0?(t(),a("span",Qr,"+"+v((P=k.value)==null?void 0:P.jetons_bonus)+" jetons bonus",1)):C("",!0)],4),e("div",Zr,[e("div",{class:"h-4 rounded-full bg-[var(--espace-or)] transition-all duration-300",style:ve({width:`${d.value}%`,background:`${p.value}`})},null,4)]),e("p",Yr," Prochain niveau : "+v(h.value?h.value.nom:"LÃ©gende ğŸ†")+" Ã  "+v(h.value?h.value.filleuls_requis:"1000+")+" parrainages ",1),(V=k.value.avantages)!=null&&V.length?(t(),a("p",el," Avantages : "+v(k.value.avantages.join(", ")),1)):C("",!0),e("button",{onClick:w[0]||(w[0]=u=>A(g).push("/parrainage/info")),class:"mt-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},w[5]||(w[5]=[e("i",{class:"fas fa-info-circle mr-2"},null,-1),_(" En savoir plus ")]))]),w[23]||(w[23]=e("div",{class:"bg-white rounded-lg shadow-md p-6 mb-6"},[e("p",{class:"text-[var(--espace-gris)] text-sm sm:text-base"},[_(" Invitez des amis avec votre lien ou code unique et gagnez des rÃ©compenses ! Recevez "),e("strong",null,"1 jeton"),_(" pour chaque commerÃ§ant actif parrainÃ©. ")])],-1)),e("div",tl,[w[15]||(w[15]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Votre Code de Parrainage",-1)),o.value?(t(),a("div",sl,[e("p",al,[w[7]||(w[7]=_(" Code : ")),e("span",ol,v(o.value),1)]),e("p",rl,[w[8]||(w[8]=_(" Lien : ")),e("a",{href:n.value,target:"_blank",class:"text-blue-500 underline hover:text-blue-700"},v(n.value),9,ll)])])):(t(),a("div",nl,[R(e("input",{"onUpdate:modelValue":w[1]||(w[1]=u=>l.value=u),type:"text",placeholder:r.value||"Entrez ou gÃ©nÃ©rez un code (ex: DOM2025)",class:"w-full p-2 border rounded mb-2 focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",maxlength:"10"},null,8,il),[[W,l.value]]),e("div",ul,[e("button",{onClick:D,disabled:m.value,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition flex-1 disabled:opacity-50"},[m.value?(t(),a("span",cl,w[9]||(w[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),_(" GÃ©nÃ©ration... ")]))):(t(),a("span",pl,w[10]||(w[10]=[e("i",{class:"fas fa-magic mr-2"},null,-1),_(" GÃ©nÃ©rer un code ")])))],8,dl),e("button",{onClick:$,disabled:S.value||!l.value.trim(),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1 disabled:opacity-50"},[S.value?(t(),a("span",ml,w[11]||(w[11]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),_(" CrÃ©ation... ")]))):(t(),a("span",fl,w[12]||(w[12]=[e("i",{class:"fas fa-check mr-2"},null,-1),_(" CrÃ©er le code ")])))],8,vl)])])),o.value?(t(),a("div",gl,[e("button",{onClick:w[2]||(w[2]=u=>z("whatsapp")),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition flex-1"},w[13]||(w[13]=[e("i",{class:"fab fa-whatsapp mr-2"},null,-1),_(" Partager sur WhatsApp ")])),e("button",{onClick:w[3]||(w[3]=u=>z("facebook")),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition flex-1"},w[14]||(w[14]=[e("i",{class:"fab fa-facebook-f mr-2"},null,-1),_(" Partager sur Facebook ")]))])):C("",!0)]),e("div",xl,[w[17]||(w[17]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Mes Utilisateurs ParrainÃ©s",-1)),i.value.length?(t(),a("div",bl,[e("table",hl,[w[16]||(w[16]=e("thead",{class:"bg-[var(--espace-vert)] text-[var(--espace-blanc)]"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Nom"),e("th",{class:"px-4 py-2"},"Date d'inscription"),e("th",{class:"px-4 py-2"},"Est commerÃ§ant")])],-1)),e("tbody",null,[(t(!0),a(T,null,O(i.value,u=>(t(),a("tr",{key:u.id,class:"border-b hover:bg-gray-50"},[e("td",yl,v(u.filleul_nom||"Anonyme"),1),e("td",_l,v(new Date(u.date_inscription).toLocaleDateString("fr-FR")),1),e("td",wl,v(u.est_commerÃ§ant?"Oui":"Non"),1)]))),128))])])])):(t(),a("p",kl," Aucun utilisateur parrainÃ© pour le moment. Commencez Ã  inviter dÃ¨s maintenant ! "))]),e("div",$l,[w[21]||(w[21]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-2"},"Vos Gains",-1)),e("p",Al,v(b.value)+" jetons ",1),e("p",Cl,[w[18]||(w[18]=_(" ğŸ‰ Vous avez invitÃ© ")),e("strong",null,v(i.value.length),1),w[19]||(w[19]=_(" utilisateurs, dont ")),e("strong",null,v(i.value.filter(u=>u.est_commerÃ§ant).length),1),w[20]||(w[20]=_(" sont commerÃ§ants ! "))]),w[22]||(w[22]=e("p",{class:"text-[var(--espace-gris)]"},[_("â¬‡ï¸ Gagnez "),e("strong",null,"1 jeton"),_(" par commerÃ§ant actif parrainÃ©. ")],-1))])])])}}}),Ei=G(Pl,[["__scopeId","data-v-948a6d84"]]),Sl={class:"min-h-screen bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},jl={class:"container mx-auto max-w-4xl"},Vl={key:0,class:"grid grid-cols-1 gap-4"},Ml={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},zl=["onClick"],El={class:"text-sm text-[var(--espace-gris)]"},Il={class:"text-sm text-[var(--espace-gris)]"},Ll=["onClick"],Fl={key:1,class:"text-center text-[var(--espace-gris)]"},Ul=X({__name:"Collaborations",setup(E){const s=Q(),g=oe(),c=x([]),o=x(!0),n=async()=>{try{const b=await F.get("/collaborations");console.log(b.data),c.value=b.data.collaborations}catch{s.error("Erreur lors du chargement des collaborations")}finally{o.value=!1}},i=b=>{g.push({path:`/produits/${b}`})};return re(()=>{o.value=!0,n()}),(b,r)=>(t(),a(T,null,[U($e,{isLoading:o.value},null,8,["isLoading"]),e("div",Sl,[e("div",jl,[r[1]||(r[1]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6"},[e("i",{class:"fas fa-handshake mr-2 text-[var(--espace-or)]"}),_(" Mes Collaborations ")],-1)),!o.value&&c.value.length?(t(),a("div",Vl,[(t(!0),a(T,null,O(c.value,l=>(t(),a("div",{key:l.id,class:"bg-[var(--espace-blanc)] rounded-lg shadow-md p-4 hover:shadow-lg transition"},[e("div",Ml,[e("div",null,[e("h2",{onClick:m=>i(l.produit_id),class:"text-lg font-semibold text-[var(--espace-vert)] hover:text-[var(--espace-or)] hover:underline cursor-pointer"},v(l.produit.nom),9,zl),e("p",El," Prix de revente : "+v(l.prix_revente)+" FCFA ",1),e("p",Il,[r[0]||(r[0]=_(" Statut : ")),e("span",{class:q({"text-green-600":l.statut==="accepted","text-yellow-600":l.statut==="pending","text-red-600":l.statut==="rejected"})},v(l.statut==="pending"?"En attente":l.statut==="accepted"?"AcceptÃ©e":"RejetÃ©e"),3)])]),e("button",{onClick:m=>i(l.produit_id),class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-semibold px-3 py-1.5 rounded hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition sm:text-sm text-xs","aria-label":"Voir le produit"}," Voir le produit ",8,Ll)])]))),128))])):o.value?C("",!0):(t(),a("p",Fl," Aucune collaboration pour le moment. "))])])],64))}}),Ii=G(Ul,[["__scopeId","data-v-1fb45e53"]]),Tl={class:"min-h-screen bg-gray-100"},Rl={class:"container mx-auto px-4 sm:px-6 py-8"},ql={key:0,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mb-8 border border-gray-100 overflow-hidden"},Dl={class:"flex flex-col sm:flex-row items-center gap-6"},Ol={class:"w-24 h-24 bg-[var(--espace-or)] rounded-full flex items-center justify-center overflow-hidden"},Nl=["src"],Wl={key:1,class:"fas fa-user text-3xl text-[var(--espace-vert)]"},Jl={class:"flex-1"},Hl={class:"text-3xl font-bold text-[var(--espace-vert)] mb-2"},Bl={class:"text-sm text-[var(--espace-gris)] mb-1"},Xl={class:"text-sm text-[var(--espace-gris)] mb-1"},Gl={class:"text-sm text-[var(--espace-gris)]"},Kl={key:0,class:"text-sm text-[var(--espace-gris)]"},Ql={class:"mt-2 flex space-x-2 flex-col"},Zl={class:"text-sm text-[var(--espace-gris)]"},Yl={class:"text-xs text-[var(--espace-gris)]"},en={class:"mt-4 flex flex-wrap gap-4"},tn={class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},sn={key:0,class:"px-3 py-1 bg-[var(--espace-or)] text-[var(--espace-vert)] rounded-full text-sm font-medium"},an={key:1,class:"text-base text-[var(--espace-gris)] italic"},on={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},rn={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},ln={class:"flex items-center space-x-2"},nn={key:3},un={key:4,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-4 border border-gray-100"},dn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},cn={key:5,class:"text-base text-[var(--espace-gris)] italic"},pn={key:6,class:"bg-[rgba(255,255,255,0.9)] rounded-xl shadow-lg p-6 mt-8 border border-gray-100"},vn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},mn={class:"text-sm text-[var(--espace-gris)]"},fn={class:"text-sm text-[var(--espace-gris)]"},gn=X({__name:"CommercantDetails",setup(E){const s=Se(),g=Q(),c=x(!1),o=x(null),n=x(null),i=x(0),b=x(0),r=x(!1),l=ke(),m=async()=>{c.value=!0;try{const d=await F.get(`/commercant/${s.params.commercantId}`);console.log(d.data),o.value=d.data.commercant,i.value=d.data.average_rating||0,b.value=d.data.vote_count||0,l.products.length===0&&await l.fetchProducts({per_page:"all"})}catch{g.error("Erreur lors du chargement des dÃ©tails du commerÃ§ant.")}finally{c.value=!1}},S=async()=>{var d,p;if(n.value===null||n.value<1||n.value>5){g.error("Veuillez sÃ©lectionner une note entre 1 et 5.");return}try{const y=await F.post(`/commercant/${s.params.commercantId}/rate`,{rating:n.value});i.value=y.data.average_rating||0,g.success("Merci pour votre note !"),n.value=null,r.value=!1,b.value=y.data.vote_count||b.value+1}catch(y){g.error(((p=(d=y.response)==null?void 0:d.data)==null?void 0:p.message)||"Erreur lors de la notation.")}},k=me(()=>l.products.filter(d=>d.commercant_id===s.params.commercantId)),h=()=>{r.value=!0};return re(async()=>{m()}),(d,p)=>(t(),a(T,null,[U($e,{isLoading:c.value},null,8,["isLoading"]),e("div",Tl,[U(Be),e("div",Rl,[o.value?(t(),a("div",ql,[e("div",Dl,[e("div",Ol,[o.value.photo_url?(t(),a("img",{key:0,src:o.value.photo_url,alt:"Photo du commerÃ§ant",class:"w-full h-full object-cover"},null,8,Nl)):(t(),a("i",Wl))]),e("div",Jl,[e("h1",Hl,v(o.value.nom),1),e("p",Bl,[p[2]||(p[2]=e("strong",null,"Ville :",-1)),_(" "+v(o.value.ville),1)]),e("p",Xl,[p[3]||(p[3]=e("strong",null,"Inscrit depuis :",-1)),_(" "+v(new Date(o.value.created_at).toLocaleDateString()),1)]),e("p",Gl,[p[4]||(p[4]=e("strong",null,"Contact :",-1)),_(" "+v(o.value.email||"Non disponible"),1)]),o.value.telephone?(t(),a("p",Kl,[p[5]||(p[5]=e("strong",null,"TÃ©lÃ©phone :",-1)),_(" "+v(o.value.telephone),1)])):C("",!0),e("div",Ql,[e("div",{class:"flex items-center space-x-1 cursor-pointer",onClick:h},[(t(),a(T,null,O(5,y=>e("span",{key:y,class:"text-yellow-400"},[e("i",{class:q(y<=Math.round(i.value)?"fas fa-star":"far fa-star")},null,2)])),64)),e("p",Zl,v(i.value.toFixed(1))+"/5 ",1)]),e("span",Yl,"("+v(b.value)+" votes)",1)])])]),e("div",en,[e("span",tn,"Produits : "+v(k.value.length),1),o.value.revenus?(t(),a("span",sn,"Revenus : "+v(o.value.revenus)+" FCFA",1)):C("",!0)])])):c.value?C("",!0):(t(),a("div",an,"CommerÃ§ant non trouvÃ©.")),r.value?(t(),a("div",on,[e("div",rn,[p[6]||(p[6]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Noter ce CommerÃ§ant",-1)),e("div",ln,[R(e("input",{"onUpdate:modelValue":p[0]||(p[0]=y=>n.value=y),type:"number",min:"1",max:"5",step:"1",class:"w-16 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"1-5"},null,512),[[W,n.value,void 0,{number:!0}]]),e("button",{onClick:S,class:"bg-[var(--espace-or)] text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors"}," Soumettre "),e("button",{onClick:p[1]||(p[1]=y=>r.value=!1),class:"bg-gray-300 text-[var(--espace-vert)] font-medium px-4 py-2 rounded-md hover:bg-[var(--espace-vert)] hover:text-[var(--espace-blanc)] transition-colors ml-2"}," Annuler ")])])])):C("",!0),c.value?(t(),a("div",nn)):k.value.length>0?(t(),a("div",un,[p[7]||(p[7]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-6"},"Produits du CommerÃ§ant",-1)),e("div",dn,[(t(!0),a(T,null,O(k.value,y=>(t(),te(Me,{key:y.id,produit:y},null,8,["produit"]))),128))])])):o.value&&k.value.length===0?(t(),a("div",cn,"Aucun produit disponible pour ce commerÃ§ant.")):C("",!0),o.value&&o.value.statistiques?(t(),a("div",pn,[p[10]||(p[10]=e("h2",{class:"text-2xl font-semibold text-[var(--espace-vert)] mb-4"},"Statistiques",-1)),e("div",vn,[e("p",mn,[p[8]||(p[8]=e("strong",null,"Vues totales :",-1)),_(" "+v(o.value.statistiques.total_views),1)]),e("p",fn,[p[9]||(p[9]=e("strong",null,"Produits populaires :",-1)),_(" "+v(o.value.statistiques.popular_products),1)])])])):C("",!0)])])],64))}}),Li=G(gn,[["__scopeId","data-v-b4ed11a4"]]),xn={class:"overflow-y-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},bn={class:"container mx-auto max-w-2xl"},hn={class:"bg-white rounded-lg shadow-md p-6"},yn={key:0,class:"text-red-500 text-xs"},_n={key:0,class:"text-red-500 text-xs"},wn={key:0,class:"text-red-500 text-xs"},kn={key:0,class:"text-red-500 text-xs"},$n={key:0,class:"text-red-500 text-xs"},An=["disabled"],Cn={key:0},Pn={key:1},Sn=X({__name:"CommercantCreate",setup(E){const s=oe(),g=Q(),c=x({nom:"",ville:"",email:"",telephone:"",photo:null}),o=x(!1),n=x({}),i=r=>{const l=r.target;l.files&&l.files[0]&&(c.value.photo=l.files[0])},b=async()=>{var r,l;o.value=!0,n.value={};try{const m=new FormData;m.append("nom",c.value.nom),m.append("ville",c.value.ville),m.append("email",c.value.email),m.append("telephone",c.value.telephone),c.value.photo&&m.append("photo",c.value.photo);const S=await F.post("/commercants",m,{headers:{"Content-Type":"multipart/form-data"}});console.log(S.data.message),g.success("CommerÃ§ant crÃ©Ã© avec succÃ¨s !"),s.push("/profil")}catch(m){(l=(r=m.response)==null?void 0:r.data)!=null&&l.errors?n.value=m.response.data.errors:g.error("Erreur lors de la crÃ©ation du commerÃ§ant"),console.error(m)}finally{o.value=!1}};return(r,l)=>(t(),a("div",xn,[e("div",bn,[l[11]||(l[11]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-store mr-2 text-[var(--espace-or)]"}),_(" CrÃ©er un CommerÃ§ant ")],-1)),e("div",hn,[e("form",{onSubmit:ee(b,["prevent"]),class:"space-y-6"},[e("div",null,[l[4]||(l[4]=e("label",{for:"nom",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Nom *",-1)),R(e("input",{"onUpdate:modelValue":l[0]||(l[0]=m=>c.value.nom=m),id:"nom",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Nom du commerÃ§ant",required:""},null,512),[[W,c.value.nom]]),n.value.nom?(t(),a("span",yn,v(n.value.nom),1)):C("",!0)]),e("div",null,[l[5]||(l[5]=e("label",{for:"ville",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Ville *",-1)),R(e("input",{"onUpdate:modelValue":l[1]||(l[1]=m=>c.value.ville=m),id:"ville",type:"text",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"Ville",required:""},null,512),[[W,c.value.ville]]),n.value.ville?(t(),a("span",_n,v(n.value.ville),1)):C("",!0)]),e("div",null,[l[6]||(l[6]=e("label",{for:"email",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Email",-1)),R(e("input",{"onUpdate:modelValue":l[2]||(l[2]=m=>c.value.email=m),id:"email",type:"email",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"email@exemple.com"},null,512),[[W,c.value.email]]),n.value.email?(t(),a("span",wn,v(n.value.email),1)):C("",!0)]),e("div",null,[l[7]||(l[7]=e("label",{for:"telephone",class:"block text-sm font-medium text-[var(--espace-vert)]"},"TÃ©lÃ©phone",-1)),R(e("input",{"onUpdate:modelValue":l[3]||(l[3]=m=>c.value.telephone=m),id:"telephone",type:"tel",class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",placeholder:"+237 6XX XX XX XX"},null,512),[[W,c.value.telephone]]),n.value.telephone?(t(),a("span",kn,v(n.value.telephone),1)):C("",!0)]),e("div",null,[l[8]||(l[8]=e("label",{for:"photo",class:"block text-sm font-medium text-[var(--espace-vert)]"},"Photo (optionnel)",-1)),e("input",{id:"photo",type:"file",onChange:i,class:"mt-1 w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-[var(--espace-vert)]",accept:"image/*"},null,32),n.value.photo?(t(),a("span",$n,v(n.value.photo),1)):C("",!0)]),e("div",null,[e("button",{type:"submit",disabled:o.value,class:"w-full bg-[var(--espace-or)] text-[var(--espace-vert)] px-4 py-2 rounded hover:bg-[var(--espace-vert)] hover:text-white transition disabled:opacity-50"},[o.value?(t(),a("span",Cn,l[9]||(l[9]=[e("i",{class:"fas fa-spinner animate-spin mr-2"},null,-1),_(" CrÃ©ation en cours... ")]))):(t(),a("span",Pn,l[10]||(l[10]=[e("i",{class:"fas fa-plus mr-2"},null,-1),_(" CrÃ©er le commerÃ§ant ")])))],8,An)])],32)])])]))}}),Fi=G(Sn,[["__scopeId","data-v-0c50a6f0"]]),jn={class:"overflow-scroll bg-gray-100 pt-16 pb-20 px-4 sm:px-6"},Vn={class:"container mx-auto max-w-4xl"},Mn={class:"bg-white rounded-lg shadow-md p-6"},zn={class:"text-md font-semibold text-[var(--espace-vert)] flex items-center"},En={class:"ml-2 text-sm text-[var(--espace-gris)]"},In={class:"text-[var(--espace-gris)] text-sm mt-2"},Ln={key:0,class:"text-[var(--espace-gris)] text-sm mt-1"},Fn={class:"list-disc list-inside ml-4"},Un=X({__name:"ParrainageInfo",setup(E){const s=oe(),g=Q(),c=x([]),o=async()=>{try{const i=await F.get("/parrainages/niveaux");c.value=i.data.niveaux}catch(i){g.error("Erreur lors de la rÃ©cupÃ©ration des niveaux de parrainage"),console.error(i)}},n=()=>{s.go(-1)};return re(()=>{o()}),(i,b)=>(t(),a("div",jn,[e("div",Vn,[b[6]||(b[6]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-[var(--espace-vert)] mb-6 font-poppins"},[e("i",{class:"fas fa-info-circle mr-2 text-[var(--espace-or)]"}),_(" Tout Savoir sur le Parrainage ")],-1)),e("button",{onClick:n,class:"mb-4 bg-[var(--espace-vert)] text-white px-4 py-2 rounded hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},b[0]||(b[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),_(" Retour ")])),b[7]||(b[7]=Pe('<div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-c86d6ea1><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-c86d6ea1>Qu&#39;est-ce que le Parrainage ?</h2><p class="text-[var(--espace-gris)] text-sm sm:text-base" data-v-c86d6ea1> Le systÃ¨me de parrainage d&#39;Espace Cameroun vous permet d&#39;inviter des amis Ã  rejoindre la plateforme en utilisant votre code ou lien unique. Pour chaque commerÃ§ant actif que vous parrainez, vous recevez <strong data-v-c86d6ea1>1 jeton </strong>. En plus de cela, vous pouvez dÃ©bloquer des niveaux en fonction du nombre total de parrainages, chacun offrant des bonus en jetons et des avantages exclusifs. Voici les Ã©tapes et dÃ©tails complets : </p></div><div class="bg-white rounded-lg shadow-md p-6 mb-6" data-v-c86d6ea1><h2 class="text-lg font-semibold text-[var(--espace-vert)] mb-4" data-v-c86d6ea1>Comment Ã§a fonctionne ?</h2><ol class="list-decimal list-inside text-[var(--espace-gris)] text-sm sm:text-base space-y-2" data-v-c86d6ea1><li data-v-c86d6ea1>Obtenez votre code de parrainage unique via la page &quot;Mon Parrainage&quot;.</li><li data-v-c86d6ea1>Partagez votre lien ou code avec vos amis via WhatsApp, Facebook, ou autre.</li><li data-v-c86d6ea1>Lorsqu&#39;un ami s&#39;inscrit avec votre code et devient un commerÃ§ant actif, vous gagnez 1 jeton. </li><li data-v-c86d6ea1>Accumulez des parrainages pour progresser dans les niveaux et dÃ©bloquer des bonus supplÃ©mentaires.</li><li data-v-c86d6ea1>Consultez vos gains et votre niveau actuel sur la page &quot;Mon Parrainage&quot;.</li></ol></div>',2)),e("div",Mn,[b[4]||(b[4]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"DÃ©tails des Niveaux",-1)),(t(!0),a(T,null,O(c.value,r=>(t(),a("div",{key:r.id,class:"mb-6 p-4 border rounded-lg bg-gray-50"},[e("h3",zn,[_(v(r.nom)+" "+v(r.emoji)+" ",1),e("span",En,"("+v(r.filleuls_requis)+" parrainages requis)",1)]),e("p",In,[b[1]||(b[1]=e("strong",null,"Bonus en jetons :",-1)),_(" "+v(r.jetons_bonus)+" jetons ",1)]),r.avantages.length?(t(),a("p",Ln,[b[2]||(b[2]=e("strong",null,"Avantages exclusifs :",-1)),e("ul",Fn,[(t(!0),a(T,null,O(r.avantages,l=>(t(),a("li",{key:l},v(l),1))),128))])])):C("",!0),b[3]||(b[3]=e("p",{class:"text-[var(--espace-gris)] text-xs mt-1 italic"}," * Les jetons bonus sont crÃ©ditÃ©s une fois le niveau atteint et cumulables avec les jetons gagnÃ©s par commerÃ§ant. ",-1))]))),128)),b[5]||(b[5]=e("p",{class:"text-[var(--espace-gris)] text-sm mt-4"},[e("strong",null,"Note importante :"),_(' Le niveau maximum ("LÃ©gende ğŸ›¡ï¸") est atteint Ã  1000 parrainages. Continuez Ã  inviter pour maximiser vos rÃ©compenses ! ')],-1))])])]))}}),Ui=G(Un,[["__scopeId","data-v-c86d6ea1"]]),Tn={class:"w-full flex relative px-0"},Rn=["onClick"],qn={class:"w-10 h-10 bg-[var(--espace-or)] rounded-full mr-2 flex items-center justify-center"},Dn={class:"text-white font-bold"},On={class:"min-w-0"},Nn={class:"font-semibold text-[var(--espace-vert)] truncate"},Wn={class:"text-xs text-[var(--espace-gris)] truncate"},Jn={class:"w-full grid grid-rows-[10%_86%]"},Hn={class:"flex border-b"},Bn={key:1,class:"text-xl h-[10%] font-semibold text-[var(--espace-vert)] p-4 md:z-0"},Xn={key:0,class:"h-full flex flex-col"},Gn={class:"block text-[var(--espace-vert)]"},Kn={class:"text-gray-800"},Qn={class:"text-xs text-[var(--espace-gris)] text-right mr-2"},Zn={key:0,class:"text-center text-[var(--espace-gris)]"},Yn={class:"px-2 md:px-4 z-20"},ei={class:"bg-white shadow-lg rounded-full flex items-center flex-wrap p-2 border max-w-3xl mx-auto gap-2"},ti={key:0,class:"bg-yellow-200 text-yellow-800 text-xs px-3 py-1 rounded-full flex items-center gap-2 ml-4"},si={key:1,class:"flex items-center justify-center h-full"},ai=X({__name:"Messages",setup(E){const s=oe(),g=Se(),c=le(),o=Q(),n=Ve(),i=x([]),b=x([]),r=x(null),l=x(""),m=x(!0),S=x(0),k=x(!1),h=x(!1),d=x(null),p=x(null),y=x(window.innerWidth<768),D=x(null),$=()=>{Ee(()=>{var M;(M=d.value)==null||M.scrollTo({top:d.value.scrollHeight,behavior:"smooth"})})},z=()=>{p.value=null,D.value=null,window.localStorage.removeItem("chatProductId")},f=async()=>{try{const M=await F.get("/conversations");i.value=M.data.conversations}catch(M){o.error("Erreur lors de la rÃ©cupÃ©ration des conversations"),console.error(M)}},w=async(M,I=!0)=>{if(!h.value){h.value=!0;try{I&&(S.value=0,b.value=[]),m.value=!1;const J=await F.get(`/chat/${M}?offset=${S.value}`);b.value=[...J.data.messages],console.log(J.data),k.value=J.data.hasMore,r.value=i.value.find(K=>K.user_id===M)||{user_id:M,name:`Utilisateur #${M}`};const Z=localStorage.getItem("chatProductId");if(Z){p.value=parseInt(Z);const K=await F.get(`/products/${p.value}`);D.value=K.data}await V(M),$()}catch(J){o.error("Erreur lors du chargement des messages"),console.error(J)}finally{h.value=!1}}},j=M=>{s.push({name:"messages",params:{receiverId:M}}),y.value&&(m.value=!1)},B=async()=>{var J,Z,K,H,Y,ie,ue,fe,ge,xe;if(!l.value.trim()||!r.value){o.error("Veuillez sÃ©lectionner une conversation et Ã©crire un message");return}const M=l.value.trim(),I={id:-Date.now(),sender_id:(J=c.user)==null?void 0:J.id,receiver_id:r.value.user_id,content:M,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_read:!1,product_id:((Z=p.value)==null?void 0:Z.toString())||null,sender:{id:((K=c.user)==null?void 0:K.id)??0,nom:((H=c.user)==null?void 0:H.nom)??"",email:((Y=c.user)==null?void 0:Y.email)??"",telephone:((ie=c.user)==null?void 0:ie.telephone)??"",ville:((ue=c.user)==null?void 0:ue.ville)??"",premium:((fe=c.user)==null?void 0:fe.premium)??!1,parrain_id:((ge=c.user)==null?void 0:ge.parrain_id)??0},receiver:{id:r.value.user_id,nom:r.value.name,email:null,telephone:null,ville:null,premium:!1,parrain_id:null},product:D.value||null};b.value.push(I),l.value="",$();try{const pe=await F.post(`/chat/${r.value.user_id}`,{content:M,product_id:p.value});console.log(pe.data),p.value&&(localStorage.removeItem("chatProductId"),p.value=null,D.value=null),(xe=c.user)!=null&&xe.id&&window.Echo.channel(`chat.${c.user.id}`).listen("MessageSent",de=>{var be;((be=r.value)==null?void 0:be.user_id)===de.sender_id&&(console.log("ğŸ“© Nouveau message reÃ§u :",de.message),b.value.push(de.message),$())})}catch(pe){o.error("Ã‰chec d'envoi"),console.error(pe),b.value=b.value.filter(de=>de.id!==I.id)}},L=()=>{!d.value||!k.value||h.value||d.value.scrollTop<=100&&(S.value+=30,w(r.value.user_id,!1))},P=()=>{y.value=window.innerWidth<768,m.value=window.innerWidth>768},V=async M=>{try{const I=await F.put("/messages/mark-all-as-read");n.saveUnreadMessagesToLocalStorage(I.data.unread_messages)}catch(I){console.error("Erreur lors du marquage des messages comme lus:",I),o.error("Erreur lors de la mise Ã  jour des messages lus")}},u=()=>{m.value=!m.value};return re(()=>{var M;f(),g.params.receiverId&&w(parseInt(g.params.receiverId)),window.addEventListener("resize",P),(M=c.user)!=null&&M.id&&window.Echo.channel("public-channel").listen(".message.sent",I=>{var Z,K;const J=JSON.parse(I.message);((Z=r.value)==null?void 0:Z.user_id)===((K=J.sender)==null?void 0:K.id)&&(console.log("ğŸ“©  receiver:",J.receiver),console.log("ğŸ“©  sender:",J.sender),b.value.push(J),$(),console.log(I.unread_messages),n.saveUnreadMessagesToLocalStorage(I.unread_messages))}).error(I=>{console.error("Erreur Echo:",I)})}),we(()=>{var M;window.removeEventListener("resize",P),(M=c.user)!=null&&M.id&&window.Echo.leave(`chat.${c.user.id}`)}),ae(()=>g.params.receiverId,async M=>{M&&await w(parseInt(M))}),(M,I)=>{var Z,K;const J=ne("router-link");return t(),a("div",Tn,[U(ce,{name:"slide-fade"},{default:N(()=>[m.value||!y.value?(t(),a("div",{key:0,class:q(["bg-white pt-8 shadow-md p-4 overflow-y-auto transition-all",y.value?"absolute top-0 left-0 h-full z-30 w-full":"w-[400px]"])},[I[2]||(I[2]=e("h2",{class:"text-lg font-semibold text-[var(--espace-vert)] mb-4"},"Conversations",-1)),(t(!0),a(T,null,O(i.value,H=>(t(),a("div",{key:H.user_id,onClick:Y=>j(H.user_id),class:"p-2 hover:bg-gray-100 cursor-pointer rounded flex items-center transition-colors"},[e("div",qn,[e("span",Dn,v(H.name.charAt(0)),1)]),e("div",On,[e("p",Nn,v(H.name),1),e("p",Wn,v(H.last_message),1)])],8,Rn))),128))],2)):C("",!0)]),_:1}),e("div",Jn,[e("div",Hn,[!m.value&&y.value&&r.value?(t(),a("button",{key:0,onClick:u,class:"text-green-900 p-2 rounded-full hover:bg-[var(--espace-or)] transition text-start md:hidden"},I[3]||(I[3]=[e("i",{class:"fas fa-arrow-left text-2xl"},null,-1)]))):C("",!0),r.value?(t(),a("h2",Bn,v(r.value.name),1)):C("",!0)]),e("div",{class:q(["bg-white shadow-md transition-all duration-300 flex flex-col flex-1 h-full overflow-hidden w-full",m.value&&!y.value?"":"rounded-r-lg"]),onScroll:L},[r.value?(t(),a("div",Xn,[e("div",{ref_key:"messagesContainer",ref:d,class:"h-full flex-1 overflow-y-auto p-2 md:p-4 space-y-3 bg-gray-50 messages-container"},[(t(!0),a(T,null,O(b.value,H=>{var Y,ie,ue;return t(),a("div",{key:H.id,class:q(["p-3 rounded-full break-words",{"bg-blue-200 ml-auto max-w-[85%] md:max-w-[70%]":H.sender_id===((Y=A(c).user)==null?void 0:Y.id),"bg-gray-200 max-w-[85%] md:max-w-[70%]":H.sender_id!==((ie=A(c).user)==null?void 0:ie.id)}])},[e("strong",Gn,v(H.sender.nom)+" :",1),e("p",Kn,[(ue=H.product)!=null&&ue.id?(t(),te(J,{key:0,to:{name:"produit",params:{id:H.product.id}},class:"text-blue-500 underline hover:text-blue-700 ml-1"},{default:N(()=>[_("[Produit "+v(H.product.nom)+"]",1)]),_:2},1032,["to"])):C("",!0),_(" "+v(H.content),1)]),e("p",Qn,v(new Date(H.created_at).toLocaleTimeString()),1)],2)}),128)),h.value?(t(),a("div",Zn,"Chargement...")):C("",!0)],512),e("div",Yn,[e("div",ei,[(Z=D.value)!=null&&Z.id?(t(),a("span",ti,[_(" Produit "+v((K=D.value)==null?void 0:K.nom)+" ",1),e("button",{onClick:I[0]||(I[0]=()=>z()),class:"ml-2 text-yellow-800 hover:text-red-600 font-bold",title:"Retirer le tag"}," Ã— ")])):C("",!0),R(e("input",{"onUpdate:modelValue":I[1]||(I[1]=H=>l.value=H),type:"text",placeholder:"Ã‰crivez votre message...",class:"flex-1 px-4 py-2 rounded-full focus:outline-none text-gray-700 text-sm placeholder-gray-400 min-w-[100px] md:min-w-[200px]"},null,512),[[W,l.value]]),e("button",{onClick:B,onKeyup:ze(B,["enter"]),class:"ml-2 p-3 rounded-full bg-[var(--espace-vert)] text-white hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)] transition"},I[4]||(I[4]=[e("i",{class:"fas fa-location-arrow text-lg"},null,-1)]),32)])])])):(t(),a("div",si,I[5]||(I[5]=[e("p",{class:"text-[var(--espace-gris)] text-lg"},"SÃ©lectionnez une conversation pour commencer.",-1)])))],34)])])}}}),Ti=G(ai,[["__scopeId","data-v-2e9886a8"]]),oi={class:"mx-auto max-w-4xl py-5 px-4 flex flex-col gap-3"},ri={key:0,class:"overflow-scroll space-y-4"},li={class:"flex justify-between items-center"},ni={class:"text-lg font-semibold"},ii={class:"text-gray-600"},ui={class:"text-gray-600"},di={class:"text-gray-600"},ci={class:"text-gray-600"},pi={class:"text-gray-600"},vi={key:0,class:"text-gray-600"},mi={class:"text-right"},fi=["onClick"],gi={key:1,class:"text-gray-500"},xi={class:"mt-6 flex gap-4"},bi={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},hi=X({__name:"JetonHistory",setup(E){const g=le().user,c=x([]),o=x(!1),n=Q(),i=async()=>{try{const l=await F.get(`/jeton-transactions/${g==null?void 0:g.id}`);console.log(l.data),c.value=l.data}catch(l){console.error("Erreur lors du chargement des transactions:",l)}},b=l=>new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),r=async l=>{var m,S;if(console.log("Refaire la transaction:",l),!!confirm(`Refaire l'achat de ${l.nombre_jetons} jetons avec le mÃªme service (${l.methode_paiement}) ?`)){o.value=!0;try{const k=await F.post("/acheter-jetons",{nombre_jetons:l.nombre_jetons,payment_service:l.methode_paiement,phone_number:l.phone_number});n.success(k.data.message),i()}catch(k){n.error(((S=(m=k.response)==null?void 0:m.data)==null?void 0:S.message)||"Erreur lors de l'achat."),console.error(k)}finally{o.value=!1}}};return re(()=>{g&&i()}),(l,m)=>{const S=ne("router-link");return t(),a("div",oi,[m[4]||(m[4]=e("h1",{class:"text-3xl font-bold text-[var(--espace-vert)]"},"Historique des Transactions de Jetons",-1)),c.value.length>0?(t(),a("div",ri,[(t(!0),a(T,null,O(c.value,k=>(t(),a("div",{key:k.id,class:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow"},[e("div",li,[e("div",null,[e("p",ni,"Achat de "+v(k.nombre_jetons)+" jetons",1),e("p",ii,"Montant: "+v(k.montant)+" FCFA",1),e("p",ui,"MÃ©thode: "+v(k.methode_paiement),1),e("p",di,"NumÃ©ro: "+v(k.phone_number),1),e("p",ci,"Statut: "+v(k.statut),1),e("p",pi,"Date: "+v(b(k.date_transaction)),1),k.transaction_id_mesomb?(t(),a("p",vi," ID Transaction: "+v(k.transaction_id_mesomb),1)):C("",!0)]),e("div",mi,[e("button",{onClick:h=>r(k),class:"text-[var(--espace-vert)] hover:text-[var(--espace-or)] mr-2"},m[0]||(m[0]=[e("i",{class:"fas fa-redo"},null,-1),_(" Refaire ")]),8,fi)])])]))),128))])):(t(),a("p",gi,"Aucune transaction trouvÃ©e.")),e("div",xi,[U(S,{to:"/acheter-jetons",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:N(()=>m[1]||(m[1]=[_(" Acheter des Jetons ")])),_:1,__:[1]}),U(S,{to:"/commercant/produits",class:"bg-[var(--espace-vert)] text-white px-4 py-2 rounded-md font-semibold hover:bg-[var(--espace-or)] hover:text-[var(--espace-vert)]"},{default:N(()=>m[2]||(m[2]=[_(" Booster un Produit ")])),_:1,__:[2]})]),o.value?(t(),a("div",bi,m[3]||(m[3]=[Pe('<div class="bg-white p-6 rounded-lg shadow-lg text-center" data-v-4fde7a0c><p class="text-lg text-[var(--espace-vert)]" data-v-4fde7a0c>Veuillez patienter...</p><svg class="animate-spin h-8 w-8 text-[var(--espace-vert)] mx-auto mt-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-4fde7a0c><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-4fde7a0c></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" data-v-4fde7a0c></path></svg></div>',1)]))):C("",!0)])}}}),Ri=G(hi,[["__scopeId","data-v-4fde7a0c"]]);export{Ri as A,Ci as C,$i as F,ki as H,Ai as L,Ti as M,Si as P,Pi as R,Vi as a,Li as b,Fi as c,zi as d,ji as e,Ei as f,Ui as g,Mi as h,Ii as i,le as u};
